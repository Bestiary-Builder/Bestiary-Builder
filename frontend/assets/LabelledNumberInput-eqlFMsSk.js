import{X as Xi,L as Ue,d as Pn,_ as Dn,B as Ms,o as N,c as T,b as y,e as U,f as O,D as Ie,i as P,Y as Ps,F as ue,H as fe,p as Zi,j as Qi,r as os,G as er,C as tr,w as as,a as nr}from"./index-5v66Jwhn.js";import{M as sr}from"./index-5Jdbla-E.js";const Rn=Symbol.for("yaml.alias"),En=Symbol.for("yaml.document"),Fe=Symbol.for("yaml.map"),Ds=Symbol.for("yaml.pair"),De=Symbol.for("yaml.scalar"),ct=Symbol.for("yaml.seq"),Se=Symbol.for("yaml.node.type"),Ge=t=>!!t&&typeof t=="object"&&t[Se]===Rn,ut=t=>!!t&&typeof t=="object"&&t[Se]===En,ft=t=>!!t&&typeof t=="object"&&t[Se]===Fe,Q=t=>!!t&&typeof t=="object"&&t[Se]===Ds,Z=t=>!!t&&typeof t=="object"&&t[Se]===De,ht=t=>!!t&&typeof t=="object"&&t[Se]===ct;function ee(t){if(t&&typeof t=="object")switch(t[Se]){case Fe:case ct:return!0}return!1}function te(t){if(t&&typeof t=="object")switch(t[Se]){case Rn:case Fe:case De:case ct:return!0}return!1}const ir=t=>(Z(t)||ee(t))&&!!t.anchor,de=Symbol("break visit"),Rs=Symbol("skip children"),ve=Symbol("remove node");function He(t,e){const n=js(e);ut(t)?Ze(null,t.contents,n,Object.freeze([t]))===ve&&(t.contents=null):Ze(null,t,n,Object.freeze([]))}He.BREAK=de;He.SKIP=Rs;He.REMOVE=ve;function Ze(t,e,n,s){const i=Fs(t,e,n,s);if(te(i)||Q(i))return Us(t,s,i),Ze(t,i,n,s);if(typeof i!="symbol"){if(ee(e)){s=Object.freeze(s.concat(e));for(let r=0;r<e.items.length;++r){const o=Ze(r,e.items[r],n,s);if(typeof o=="number")r=o-1;else{if(o===de)return de;o===ve&&(e.items.splice(r,1),r-=1)}}}else if(Q(e)){s=Object.freeze(s.concat(e));const r=Ze("key",e.key,n,s);if(r===de)return de;r===ve&&(e.key=null);const o=Ze("value",e.value,n,s);if(o===de)return de;o===ve&&(e.value=null)}}return i}async function Gt(t,e){const n=js(e);ut(t)?await Qe(null,t.contents,n,Object.freeze([t]))===ve&&(t.contents=null):await Qe(null,t,n,Object.freeze([]))}Gt.BREAK=de;Gt.SKIP=Rs;Gt.REMOVE=ve;async function Qe(t,e,n,s){const i=await Fs(t,e,n,s);if(te(i)||Q(i))return Us(t,s,i),Qe(t,i,n,s);if(typeof i!="symbol"){if(ee(e)){s=Object.freeze(s.concat(e));for(let r=0;r<e.items.length;++r){const o=await Qe(r,e.items[r],n,s);if(typeof o=="number")r=o-1;else{if(o===de)return de;o===ve&&(e.items.splice(r,1),r-=1)}}}else if(Q(e)){s=Object.freeze(s.concat(e));const r=await Qe("key",e.key,n,s);if(r===de)return de;r===ve&&(e.key=null);const o=await Qe("value",e.value,n,s);if(o===de)return de;o===ve&&(e.value=null)}}return i}function js(t){return typeof t=="object"&&(t.Collection||t.Node||t.Value)?Object.assign({Alias:t.Node,Map:t.Node,Scalar:t.Node,Seq:t.Node},t.Value&&{Map:t.Value,Scalar:t.Value,Seq:t.Value},t.Collection&&{Map:t.Collection,Seq:t.Collection},t):t}function Fs(t,e,n,s){if(typeof n=="function")return n(t,e,s);if(ft(e))return n.Map?.(t,e,s);if(ht(e))return n.Seq?.(t,e,s);if(Q(e))return n.Pair?.(t,e,s);if(Z(e))return n.Scalar?.(t,e,s);if(Ge(e))return n.Alias?.(t,e,s)}function Us(t,e,n){const s=e[e.length-1];if(ee(s))s.items[t]=n;else if(Q(s))t==="key"?s.key=n:s.value=n;else if(ut(s))s.contents=n;else{const i=Ge(s)?"alias":"scalar";throw new Error(`Cannot replace node with ${i} parent`)}}const rr={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},or=t=>t.replace(/[!,[\]{}]/g,e=>rr[e]);class ce{constructor(e,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},ce.defaultYaml,e),this.tags=Object.assign({},ce.defaultTags,n)}clone(){const e=new ce(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new ce(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:ce.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},ce.defaultTags);break}return e}add(e,n){this.atNextDocument&&(this.yaml={explicit:ce.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},ce.defaultTags),this.atNextDocument=!1);const s=e.trim().split(/[ \t]+/),i=s.shift();switch(i){case"%TAG":{if(s.length!==2&&(n(0,"%TAG directive should contain exactly two parts"),s.length<2))return!1;const[r,o]=s;return this.tags[r]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,s.length!==1)return n(0,"%YAML directive should contain exactly one part"),!1;const[r]=s;if(r==="1.1"||r==="1.2")return this.yaml.version=r,!0;{const o=/^\d+\.\d+$/.test(r);return n(6,`Unsupported YAML version ${r}`,o),!1}}default:return n(0,`Unknown directive ${i}`,!0),!1}}tagName(e,n){if(e==="!")return"!";if(e[0]!=="!")return n(`Not a valid tag: ${e}`),null;if(e[1]==="<"){const o=e.slice(2,-1);return o==="!"||o==="!!"?(n(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(e[e.length-1]!==">"&&n("Verbatim tags must end with a >"),o)}const[,s,i]=e.match(/^(.*!)([^!]*)$/s);i||n(`The ${e} tag has no suffix`);const r=this.tags[s];if(r)try{return r+decodeURIComponent(i)}catch(o){return n(String(o)),null}return s==="!"?e:(n(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[n,s]of Object.entries(this.tags))if(e.startsWith(s))return n+or(e.substring(s.length));return e[0]==="!"?e:`!<${e}>`}toString(e){const n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],s=Object.entries(this.tags);let i;if(e&&s.length>0&&te(e.contents)){const r={};He(e.contents,(o,a)=>{te(a)&&a.tag&&(r[a.tag]=!0)}),i=Object.keys(r)}else i=[];for(const[r,o]of s)r==="!!"&&o==="tag:yaml.org,2002:"||(!e||i.some(a=>a.startsWith(o)))&&n.push(`%TAG ${r} ${o}`);return n.join(`
`)}}ce.defaultYaml={explicit:!1,version:"1.2"};ce.defaultTags={"!!":"tag:yaml.org,2002:"};function Hs(t){if(/[\x00-\x19\s,[\]{}]/.test(t)){const n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(t)}`;throw new Error(n)}return!0}function Vs(t){const e=new Set;return He(t,{Value(n,s){s.anchor&&e.add(s.anchor)}}),e}function qs(t,e){for(let n=1;;++n){const s=`${t}${n}`;if(!e.has(s))return s}}function ar(t,e){const n=[],s=new Map;let i=null;return{onAnchor:r=>{n.push(r),i||(i=Vs(t));const o=qs(e,i);return i.add(o),o},setAnchors:()=>{for(const r of n){const o=s.get(r);if(typeof o=="object"&&o.anchor&&(Z(o.node)||ee(o.node)))o.node.anchor=o.anchor;else{const a=new Error("Failed to resolve repeated object (this should not happen)");throw a.source=r,a}}},sourceObjects:s}}function et(t,e,n,s){if(s&&typeof s=="object")if(Array.isArray(s))for(let i=0,r=s.length;i<r;++i){const o=s[i],a=et(t,s,String(i),o);a===void 0?delete s[i]:a!==o&&(s[i]=a)}else if(s instanceof Map)for(const i of Array.from(s.keys())){const r=s.get(i),o=et(t,s,i,r);o===void 0?s.delete(i):o!==r&&s.set(i,o)}else if(s instanceof Set)for(const i of Array.from(s)){const r=et(t,s,i,i);r===void 0?s.delete(i):r!==i&&(s.delete(i),s.add(r))}else for(const[i,r]of Object.entries(s)){const o=et(t,s,i,r);o===void 0?delete s[i]:o!==r&&(s[i]=o)}return t.call(e,n,s)}function we(t,e,n){if(Array.isArray(t))return t.map((s,i)=>we(s,String(i),n));if(t&&typeof t.toJSON=="function"){if(!n||!ir(t))return t.toJSON(e,n);const s={aliasCount:0,count:1,res:void 0};n.anchors.set(t,s),n.onCreate=r=>{s.res=r,delete n.onCreate};const i=t.toJSON(e,n);return n.onCreate&&n.onCreate(i),i}return typeof t=="bigint"&&!n?.keep?Number(t):t}class jn{constructor(e){Object.defineProperty(this,Se,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:n,maxAliasCount:s,onAnchor:i,reviver:r}={}){if(!ut(e))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:e,keep:!0,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof s=="number"?s:100},a=we(this,"",o);if(typeof i=="function")for(const{count:l,res:c}of o.anchors.values())i(c,l);return typeof r=="function"?et(r,{"":a},"",a):a}}class Yt extends jn{constructor(e){super(Rn),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let n;return He(e,{Node:(s,i)=>{if(i===this)return He.BREAK;i.anchor===this.source&&(n=i)}}),n}toJSON(e,n){if(!n)return{source:this.source};const{anchors:s,doc:i,maxAliasCount:r}=n,o=this.resolve(i);if(!o){const l=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(l)}let a=s.get(o);if(a||(we(o,null,n),a=s.get(o)),!a||a.res===void 0){const l="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(l)}if(r>=0&&(a.count+=1,a.aliasCount===0&&(a.aliasCount=Ft(i,o,s)),a.count*a.aliasCount>r)){const l="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(l)}return a.res}toString(e,n,s){const i=`*${this.source}`;if(e){if(Hs(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const r=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(r)}if(e.implicitKey)return`${i} `}return i}}function Ft(t,e,n){if(Ge(e)){const s=e.resolve(t),i=n&&s&&n.get(s);return i?i.count*i.aliasCount:0}else if(ee(e)){let s=0;for(const i of e.items){const r=Ft(t,i,n);r>s&&(s=r)}return s}else if(Q(e)){const s=Ft(t,e.key,n),i=Ft(t,e.value,n);return Math.max(s,i)}return 1}const xs=t=>!t||typeof t!="function"&&typeof t!="object";class H extends jn{constructor(e){super(De),this.value=e}toJSON(e,n){return n?.keep?this.value:we(this.value,e,n)}toString(){return String(this.value)}}H.BLOCK_FOLDED="BLOCK_FOLDED";H.BLOCK_LITERAL="BLOCK_LITERAL";H.PLAIN="PLAIN";H.QUOTE_DOUBLE="QUOTE_DOUBLE";H.QUOTE_SINGLE="QUOTE_SINGLE";const lr="tag:yaml.org,2002:";function cr(t,e,n){if(e){const s=n.filter(r=>r.tag===e),i=s.find(r=>!r.format)??s[0];if(!i)throw new Error(`Tag ${e} not found`);return i}return n.find(s=>s.identify?.(t)&&!s.format)}function Nt(t,e,n){if(ut(t)&&(t=t.contents),te(t))return t;if(Q(t)){const u=n.schema[Fe].createNode?.(n.schema,null,n);return u.items.push(t),u}(t instanceof String||t instanceof Number||t instanceof Boolean||typeof BigInt<"u"&&t instanceof BigInt)&&(t=t.valueOf());const{aliasDuplicateObjects:s,onAnchor:i,onTagObj:r,schema:o,sourceObjects:a}=n;let l;if(s&&t&&typeof t=="object"){if(l=a.get(t),l)return l.anchor||(l.anchor=i(t)),new Yt(l.anchor);l={anchor:null,node:null},a.set(t,l)}e?.startsWith("!!")&&(e=lr+e.slice(2));let c=cr(t,e,o.tags);if(!c){if(t&&typeof t.toJSON=="function"&&(t=t.toJSON()),!t||typeof t!="object"){const u=new H(t);return l&&(l.node=u),u}c=t instanceof Map?o[Fe]:Symbol.iterator in Object(t)?o[ct]:o[Fe]}r&&(r(c),delete n.onTagObj);const h=c?.createNode?c.createNode(n.schema,t,n):typeof c?.nodeClass?.from=="function"?c.nodeClass.from(n.schema,t,n):new H(t);return e?h.tag=e:c.default||(h.tag=c.tag),l&&(l.node=h),h}function xt(t,e,n){let s=n;for(let i=e.length-1;i>=0;--i){const r=e[i];if(typeof r=="number"&&Number.isInteger(r)&&r>=0){const o=[];o[r]=s,s=o}else s=new Map([[r,s]])}return Nt(s,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:t,sourceObjects:new Map})}const St=t=>t==null||typeof t=="object"&&!!t[Symbol.iterator]().next().done;class zt extends jn{constructor(e,n){super(e),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(e){const n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(n.schema=e),n.items=n.items.map(s=>te(s)||Q(s)?s.clone(e):s),this.range&&(n.range=this.range.slice()),n}addIn(e,n){if(St(e))this.add(n);else{const[s,...i]=e,r=this.get(s,!0);if(ee(r))r.addIn(i,n);else if(r===void 0&&this.schema)this.set(s,xt(this.schema,i,n));else throw new Error(`Expected YAML collection at ${s}. Remaining path: ${i}`)}}deleteIn(e){const[n,...s]=e;if(s.length===0)return this.delete(n);const i=this.get(n,!0);if(ee(i))return i.deleteIn(s);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${s}`)}getIn(e,n){const[s,...i]=e,r=this.get(s,!0);return i.length===0?!n&&Z(r)?r.value:r:ee(r)?r.getIn(i,n):void 0}hasAllNullValues(e){return this.items.every(n=>{if(!Q(n))return!1;const s=n.value;return s==null||e&&Z(s)&&s.value==null&&!s.commentBefore&&!s.comment&&!s.tag})}hasIn(e){const[n,...s]=e;if(s.length===0)return this.has(n);const i=this.get(n,!0);return ee(i)?i.hasIn(s):!1}setIn(e,n){const[s,...i]=e;if(i.length===0)this.set(s,n);else{const r=this.get(s,!0);if(ee(r))r.setIn(i,n);else if(r===void 0&&this.schema)this.set(s,xt(this.schema,i,n));else throw new Error(`Expected YAML collection at ${s}. Remaining path: ${i}`)}}}zt.maxFlowStringSingleLineLength=60;const ur=t=>t.replace(/^(?!$)(?: $)?/gm,"#");function Me(t,e){return/^\n+$/.test(t)?t.substring(1):e?t.replace(/^(?! *$)/gm,e):t}const je=(t,e,n)=>t.endsWith(`
`)?Me(n,e):n.includes(`
`)?`
`+Me(n,e):(t.endsWith(" ")?"":" ")+n,Ws="flow",vn="block",Ut="quoted";function Xt(t,e,n="flow",{indentAtStart:s,lineWidth:i=80,minContentWidth:r=20,onFold:o,onOverflow:a}={}){if(!i||i<0)return t;const l=Math.max(1+r,1+i-e.length);if(t.length<=l)return t;const c=[],h={};let u=i-e.length;typeof s=="number"&&(s>i-Math.max(2,r)?c.push(0):u=i-s);let d,m,C=!1,p=-1,b=-1,I=-1;n===vn&&(p=ls(t,p),p!==-1&&(u=p+l));for(let B;B=t[p+=1];){if(n===Ut&&B==="\\"){switch(b=p,t[p+1]){case"x":p+=3;break;case"u":p+=5;break;case"U":p+=9;break;default:p+=1}I=p}if(B===`
`)n===vn&&(p=ls(t,p)),u=p+l,d=void 0;else{if(B===" "&&m&&m!==" "&&m!==`
`&&m!=="	"){const w=t[p+1];w&&w!==" "&&w!==`
`&&w!=="	"&&(d=p)}if(p>=u)if(d)c.push(d),u=d+l,d=void 0;else if(n===Ut){for(;m===" "||m==="	";)m=B,B=t[p+=1],C=!0;const w=p>I+1?p-2:b-1;if(h[w])return t;c.push(w),h[w]=!0,u=w+l,d=void 0}else C=!0}m=B}if(C&&a&&a(),c.length===0)return t;o&&o();let v=t.slice(0,c[0]);for(let B=0;B<c.length;++B){const w=c[B],L=c[B+1]||t.length;w===0?v=`
${e}${t.slice(0,L)}`:(n===Ut&&h[w]&&(v+=`${t[w]}\\`),v+=`
${e}${t.slice(w+1,L)}`)}return v}function ls(t,e){let n=t[e+1];for(;n===" "||n==="	";){do n=t[e+=1];while(n&&n!==`
`);n=t[e+1]}return e}const Zt=(t,e)=>({indentAtStart:e?t.indent.length:t.indentAtStart,lineWidth:t.options.lineWidth,minContentWidth:t.options.minContentWidth}),Qt=t=>/^(%|---|\.\.\.)/m.test(t);function fr(t,e,n){if(!e||e<0)return!1;const s=e-n,i=t.length;if(i<=s)return!1;for(let r=0,o=0;r<i;++r)if(t[r]===`
`){if(r-o>s)return!0;if(o=r+1,i-o<=s)return!1}return!0}function kt(t,e){const n=JSON.stringify(t);if(e.options.doubleQuotedAsJSON)return n;const{implicitKey:s}=e,i=e.options.doubleQuotedMinMultiLineLength,r=e.indent||(Qt(t)?"  ":"");let o="",a=0;for(let l=0,c=n[l];c;c=n[++l])if(c===" "&&n[l+1]==="\\"&&n[l+2]==="n"&&(o+=n.slice(a,l)+"\\ ",l+=1,a=l,c="\\"),c==="\\")switch(n[l+1]){case"u":{o+=n.slice(a,l);const h=n.substr(l+2,4);switch(h){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:h.substr(0,2)==="00"?o+="\\x"+h.substr(2):o+=n.substr(l,6)}l+=5,a=l+1}break;case"n":if(s||n[l+2]==='"'||n.length<i)l+=1;else{for(o+=n.slice(a,l)+`

`;n[l+2]==="\\"&&n[l+3]==="n"&&n[l+4]!=='"';)o+=`
`,l+=2;o+=r,n[l+2]===" "&&(o+="\\"),l+=1,a=l+1}break;default:l+=1}return o=a?o+n.slice(a):n,s?o:Xt(o,r,Ut,Zt(e,!1))}function _n(t,e){if(e.options.singleQuote===!1||e.implicitKey&&t.includes(`
`)||/[ \t]\n|\n[ \t]/.test(t))return kt(t,e);const n=e.indent||(Qt(t)?"  ":""),s="'"+t.replace(/'/g,"''").replace(/\n+/g,`$&
${n}`)+"'";return e.implicitKey?s:Xt(s,n,Ws,Zt(e,!1))}function tt(t,e){const{singleQuote:n}=e.options;let s;if(n===!1)s=kt;else{const i=t.includes('"'),r=t.includes("'");i&&!r?s=_n:r&&!i?s=kt:s=n?_n:kt}return s(t,e)}let Cn;try{Cn=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{Cn=/\n+(?!\n|$)/g}function Ht({comment:t,type:e,value:n},s,i,r){const{blockQuote:o,commentString:a,lineWidth:l}=s.options;if(!o||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return tt(n,s);const c=s.indent||(s.forceBlockIndent||Qt(n)?"  ":""),h=o==="literal"?!0:o==="folded"||e===H.BLOCK_FOLDED?!1:e===H.BLOCK_LITERAL?!0:!fr(n,l,c.length);if(!n)return h?`|
`:`>
`;let u,d;for(d=n.length;d>0;--d){const _=n[d-1];if(_!==`
`&&_!=="	"&&_!==" ")break}let m=n.substring(d);const C=m.indexOf(`
`);C===-1?u="-":n===m||C!==m.length-1?(u="+",r&&r()):u="",m&&(n=n.slice(0,-m.length),m[m.length-1]===`
`&&(m=m.slice(0,-1)),m=m.replace(Cn,`$&${c}`));let p=!1,b,I=-1;for(b=0;b<n.length;++b){const _=n[b];if(_===" ")p=!0;else if(_===`
`)I=b;else break}let v=n.substring(0,I<b?I+1:b);v&&(n=n.substring(v.length),v=v.replace(/\n+/g,`$&${c}`));let w=(h?"|":">")+(p?c?"2":"1":"")+u;if(t&&(w+=" "+a(t.replace(/ ?[\r\n]+/g," ")),i&&i()),h)return n=n.replace(/\n+/g,`$&${c}`),`${w}
${c}${v}${n}${m}`;n=n.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`);const L=Xt(`${v}${n}${m}`,c,vn,Zt(s,!0));return`${w}
${c}${L}`}function hr(t,e,n,s){const{type:i,value:r}=t,{actualString:o,implicitKey:a,indent:l,indentStep:c,inFlow:h}=e;if(a&&r.includes(`
`)||h&&/[[\]{},]/.test(r))return tt(r,e);if(!r||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(r))return a||h||!r.includes(`
`)?tt(r,e):Ht(t,e,n,s);if(!a&&!h&&i!==H.PLAIN&&r.includes(`
`))return Ht(t,e,n,s);if(Qt(r)){if(l==="")return e.forceBlockIndent=!0,Ht(t,e,n,s);if(a&&l===c)return tt(r,e)}const u=r.replace(/\n+/g,`$&
${l}`);if(o){const d=p=>p.default&&p.tag!=="tag:yaml.org,2002:str"&&p.test?.test(u),{compat:m,tags:C}=e.doc.schema;if(C.some(d)||m?.some(d))return tt(r,e)}return a?u:Xt(u,l,Ws,Zt(e,!1))}function At(t,e,n,s){const{implicitKey:i,inFlow:r}=e,o=typeof t.value=="string"?t:Object.assign({},t,{value:String(t.value)});let{type:a}=t;a!==H.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(a=H.QUOTE_DOUBLE);const l=h=>{switch(h){case H.BLOCK_FOLDED:case H.BLOCK_LITERAL:return i||r?tt(o.value,e):Ht(o,e,n,s);case H.QUOTE_DOUBLE:return kt(o.value,e);case H.QUOTE_SINGLE:return _n(o.value,e);case H.PLAIN:return hr(o,e,n,s);default:return null}};let c=l(a);if(c===null){const{defaultKeyType:h,defaultStringType:u}=e.options,d=i&&h||u;if(c=l(d),c===null)throw new Error(`Unsupported default string type ${d}`)}return c}function Ks(t,e){const n=Object.assign({blockQuote:!0,commentString:ur,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},t.schema.toStringOptions,e);let s;switch(n.collectionStyle){case"block":s=!1;break;case"flow":s=!0;break;default:s=null}return{anchors:new Set,doc:t,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:typeof n.indent=="number"?" ".repeat(n.indent):"  ",inFlow:s,options:n}}function dr(t,e){if(e.tag){const i=t.filter(r=>r.tag===e.tag);if(i.length>0)return i.find(r=>r.format===e.format)??i[0]}let n,s;if(Z(e)){s=e.value;const i=t.filter(r=>r.identify?.(s));n=i.find(r=>r.format===e.format)??i.find(r=>!r.format)}else s=e,n=t.find(i=>i.nodeClass&&s instanceof i.nodeClass);if(!n){const i=s?.constructor?.name??typeof s;throw new Error(`Tag not resolved for ${i} value`)}return n}function pr(t,e,{anchors:n,doc:s}){if(!s.directives)return"";const i=[],r=(Z(t)||ee(t))&&t.anchor;r&&Hs(r)&&(n.add(r),i.push(`&${r}`));const o=t.tag?t.tag:e.default?null:e.tag;return o&&i.push(s.directives.tagString(o)),i.join(" ")}function ot(t,e,n,s){if(Q(t))return t.toString(e,n,s);if(Ge(t)){if(e.doc.directives)return t.toString(e);if(e.resolvedAliases?.has(t))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(t):e.resolvedAliases=new Set([t]),t=t.resolve(e.doc)}let i;const r=te(t)?t:e.doc.createNode(t,{onTagObj:l=>i=l});i||(i=dr(e.doc.schema.tags,r));const o=pr(r,i,e);o.length>0&&(e.indentAtStart=(e.indentAtStart??0)+o.length+1);const a=typeof i.stringify=="function"?i.stringify(r,e,n,s):Z(r)?At(r,e,n,s):r.toString(e,n,s);return o?Z(r)||a[0]==="{"||a[0]==="["?`${o} ${a}`:`${o}
${e.indent}${a}`:a}function mr({key:t,value:e},n,s,i){const{allNullValues:r,doc:o,indent:a,indentStep:l,options:{commentString:c,indentSeq:h,simpleKeys:u}}=n;let d=te(t)&&t.comment||null;if(u){if(d)throw new Error("With simple keys, key nodes cannot have comments");if(ee(t)){const G="With simple keys, collection cannot be used as a key value";throw new Error(G)}}let m=!u&&(!t||d&&e==null&&!n.inFlow||ee(t)||(Z(t)?t.type===H.BLOCK_FOLDED||t.type===H.BLOCK_LITERAL:typeof t=="object"));n=Object.assign({},n,{allNullValues:!1,implicitKey:!m&&(u||!r),indent:a+l});let C=!1,p=!1,b=ot(t,n,()=>C=!0,()=>p=!0);if(!m&&!n.inFlow&&b.length>1024){if(u)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");m=!0}if(n.inFlow){if(r||e==null)return C&&s&&s(),b===""?"?":m?`? ${b}`:b}else if(r&&!u||e==null&&m)return b=`? ${b}`,d&&!C?b+=je(b,n.indent,c(d)):p&&i&&i(),b;C&&(d=null),m?(d&&(b+=je(b,n.indent,c(d))),b=`? ${b}
${a}:`):(b=`${b}:`,d&&(b+=je(b,n.indent,c(d))));let I,v,B;te(e)?(I=!!e.spaceBefore,v=e.commentBefore,B=e.comment):(I=!1,v=null,B=null,e&&typeof e=="object"&&(e=o.createNode(e))),n.implicitKey=!1,!m&&!d&&Z(e)&&(n.indentAtStart=b.length+1),p=!1,!h&&l.length>=2&&!n.inFlow&&!m&&ht(e)&&!e.flow&&!e.tag&&!e.anchor&&(n.indent=n.indent.substring(2));let w=!1;const L=ot(e,n,()=>w=!0,()=>p=!0);let _=" ";if(d||I||v){if(_=I?`
`:"",v){const G=c(v);_+=`
${Me(G,n.indent)}`}L===""&&!n.inFlow?_===`
`&&(_=`

`):_+=`
${n.indent}`}else if(!m&&ee(e)){const G=L[0],W=L.indexOf(`
`),j=W!==-1,Y=n.inFlow??e.flow??e.items.length===0;if(j||!Y){let q=!1;if(j&&(G==="&"||G==="!")){let z=L.indexOf(" ");G==="&"&&z!==-1&&z<W&&L[z+1]==="!"&&(z=L.indexOf(" ",z+1)),(z===-1||W<z)&&(q=!0)}q||(_=`
${n.indent}`)}}else(L===""||L[0]===`
`)&&(_="");return b+=_+L,n.inFlow?w&&s&&s():B&&!w?b+=je(b,n.indent,c(B)):p&&i&&i(),b}function Js(t,e){(t==="debug"||t==="warn")&&(typeof process<"u"&&process.emitWarning?process.emitWarning(e):console.warn(e))}const cs="<<";function Gs(t,e,{key:n,value:s}){if(t?.doc.schema.merge&&gr(n))if(s=Ge(s)?s.resolve(t.doc):s,ht(s))for(const i of s.items)mn(t,e,i);else if(Array.isArray(s))for(const i of s)mn(t,e,i);else mn(t,e,s);else{const i=we(n,"",t);if(e instanceof Map)e.set(i,we(s,i,t));else if(e instanceof Set)e.add(i);else{const r=yr(n,i,t),o=we(s,r,t);r in e?Object.defineProperty(e,r,{value:o,writable:!0,enumerable:!0,configurable:!0}):e[r]=o}}return e}const gr=t=>t===cs||Z(t)&&t.value===cs&&(!t.type||t.type===H.PLAIN);function mn(t,e,n){const s=t&&Ge(n)?n.resolve(t.doc):n;if(!ft(s))throw new Error("Merge sources must be maps or map aliases");const i=s.toJSON(null,t,Map);for(const[r,o]of i)e instanceof Map?e.has(r)||e.set(r,o):e instanceof Set?e.add(r):Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(e,r,{value:o,writable:!0,enumerable:!0,configurable:!0});return e}function yr(t,e,n){if(e===null)return"";if(typeof e!="object")return String(e);if(te(t)&&n?.doc){const s=Ks(n.doc,{});s.anchors=new Set;for(const r of n.anchors.keys())s.anchors.add(r.anchor);s.inFlow=!0,s.inStringifyKey=!0;const i=t.toString(s);if(!n.mapKeyWarned){let r=JSON.stringify(i);r.length>40&&(r=r.substring(0,36)+'..."'),Js(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${r}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return i}return JSON.stringify(e)}function Fn(t,e,n){const s=Nt(t,void 0,n),i=Nt(e,void 0,n);return new le(s,i)}class le{constructor(e,n=null){Object.defineProperty(this,Se,{value:Ds}),this.key=e,this.value=n}clone(e){let{key:n,value:s}=this;return te(n)&&(n=n.clone(e)),te(s)&&(s=s.clone(e)),new le(n,s)}toJSON(e,n){const s=n?.mapAsMap?new Map:{};return Gs(n,s,this)}toString(e,n,s){return e?.doc?mr(this,e,n,s):JSON.stringify(this)}}function Ys(t,e,n){return(e.inFlow??t.flow?wr:br)(t,e,n)}function br({comment:t,items:e},n,{blockItemPrefix:s,flowChars:i,itemIndent:r,onChompKeep:o,onComment:a}){const{indent:l,options:{commentString:c}}=n,h=Object.assign({},n,{indent:r,type:null});let u=!1;const d=[];for(let C=0;C<e.length;++C){const p=e[C];let b=null;if(te(p))!u&&p.spaceBefore&&d.push(""),Wt(n,d,p.commentBefore,u),p.comment&&(b=p.comment);else if(Q(p)){const v=te(p.key)?p.key:null;v&&(!u&&v.spaceBefore&&d.push(""),Wt(n,d,v.commentBefore,u))}u=!1;let I=ot(p,h,()=>b=null,()=>u=!0);b&&(I+=je(I,r,c(b))),u&&b&&(u=!1),d.push(s+I)}let m;if(d.length===0)m=i.start+i.end;else{m=d[0];for(let C=1;C<d.length;++C){const p=d[C];m+=p?`
${l}${p}`:`
`}}return t?(m+=`
`+Me(c(t),l),a&&a()):u&&o&&o(),m}function wr({comment:t,items:e},n,{flowChars:s,itemIndent:i,onComment:r}){const{indent:o,indentStep:a,flowCollectionPadding:l,options:{commentString:c}}=n;i+=a;const h=Object.assign({},n,{indent:i,inFlow:!0,type:null});let u=!1,d=0;const m=[];for(let I=0;I<e.length;++I){const v=e[I];let B=null;if(te(v))v.spaceBefore&&m.push(""),Wt(n,m,v.commentBefore,!1),v.comment&&(B=v.comment);else if(Q(v)){const L=te(v.key)?v.key:null;L&&(L.spaceBefore&&m.push(""),Wt(n,m,L.commentBefore,!1),L.comment&&(u=!0));const _=te(v.value)?v.value:null;_?(_.comment&&(B=_.comment),_.commentBefore&&(u=!0)):v.value==null&&L?.comment&&(B=L.comment)}B&&(u=!0);let w=ot(v,h,()=>B=null);I<e.length-1&&(w+=","),B&&(w+=je(w,i,c(B))),!u&&(m.length>d||w.includes(`
`))&&(u=!0),m.push(w),d=m.length}let C;const{start:p,end:b}=s;if(m.length===0)C=p+b;else if(u||(u=m.reduce((v,B)=>v+B.length+2,2)>zt.maxFlowStringSingleLineLength),u){C=p;for(const I of m)C+=I?`
${a}${o}${I}`:`
`;C+=`
${o}${b}`}else C=`${p}${l}${m.join(" ")}${l}${b}`;return t&&(C+=je(C,o,c(t)),r&&r()),C}function Wt({indent:t,options:{commentString:e}},n,s,i){if(s&&i&&(s=s.replace(/^\n+/,"")),s){const r=Me(e(s),t);n.push(r.trimStart())}}function We(t,e){const n=Z(e)?e.value:e;for(const s of t)if(Q(s)&&(s.key===e||s.key===n||Z(s.key)&&s.key.value===n))return s}class me extends zt{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(Fe,e),this.items=[]}static from(e,n,s){const{keepUndefined:i,replacer:r}=s,o=new this(e),a=(l,c)=>{if(typeof r=="function")c=r.call(n,l,c);else if(Array.isArray(r)&&!r.includes(l))return;(c!==void 0||i)&&o.items.push(Fn(l,c,s))};if(n instanceof Map)for(const[l,c]of n)a(l,c);else if(n&&typeof n=="object")for(const l of Object.keys(n))a(l,n[l]);return typeof e.sortMapEntries=="function"&&o.items.sort(e.sortMapEntries),o}add(e,n){let s;Q(e)?s=e:!e||typeof e!="object"||!("key"in e)?s=new le(e,e?.value):s=new le(e.key,e.value);const i=We(this.items,s.key),r=this.schema?.sortMapEntries;if(i){if(!n)throw new Error(`Key ${s.key} already set`);Z(i.value)&&xs(s.value)?i.value.value=s.value:i.value=s.value}else if(r){const o=this.items.findIndex(a=>r(s,a)<0);o===-1?this.items.push(s):this.items.splice(o,0,s)}else this.items.push(s)}delete(e){const n=We(this.items,e);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(e,n){const i=We(this.items,e)?.value;return(!n&&Z(i)?i.value:i)??void 0}has(e){return!!We(this.items,e)}set(e,n){this.add(new le(e,n),!0)}toJSON(e,n,s){const i=s?new s:n?.mapAsMap?new Map:{};n?.onCreate&&n.onCreate(i);for(const r of this.items)Gs(n,i,r);return i}toString(e,n,s){if(!e)return JSON.stringify(this);for(const i of this.items)if(!Q(i))throw new Error(`Map items must all be pairs; found ${JSON.stringify(i)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),Ys(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:s,onComment:n})}}const dt={collection:"map",default:!0,nodeClass:me,tag:"tag:yaml.org,2002:map",resolve(t,e){return ft(t)||e("Expected a mapping for this tag"),t},createNode:(t,e,n)=>me.from(t,e,n)};class Ve extends zt{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(ct,e),this.items=[]}add(e){this.items.push(e)}delete(e){const n=Bt(e);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(e,n){const s=Bt(e);if(typeof s!="number")return;const i=this.items[s];return!n&&Z(i)?i.value:i}has(e){const n=Bt(e);return typeof n=="number"&&n<this.items.length}set(e,n){const s=Bt(e);if(typeof s!="number")throw new Error(`Expected a valid index, not ${e}.`);const i=this.items[s];Z(i)&&xs(n)?i.value=n:this.items[s]=n}toJSON(e,n){const s=[];n?.onCreate&&n.onCreate(s);let i=0;for(const r of this.items)s.push(we(r,String(i++),n));return s}toString(e,n,s){return e?Ys(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:s,onComment:n}):JSON.stringify(this)}static from(e,n,s){const{replacer:i}=s,r=new this(e);if(n&&Symbol.iterator in Object(n)){let o=0;for(let a of n){if(typeof i=="function"){const l=n instanceof Set?a:String(o++);a=i.call(n,l,a)}r.items.push(Nt(a,void 0,s))}}return r}}function Bt(t){let e=Z(t)?t.value:t;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}const pt={collection:"seq",default:!0,nodeClass:Ve,tag:"tag:yaml.org,2002:seq",resolve(t,e){return ht(t)||e("Expected a sequence for this tag"),t},createNode:(t,e,n)=>Ve.from(t,e,n)},en={identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify(t,e,n,s){return e=Object.assign({actualString:!0},e),At(t,e,n,s)}},tn={identify:t=>t==null,createNode:()=>new H(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new H(null),stringify:({source:t},e)=>typeof t=="string"&&tn.test.test(t)?t:e.options.nullStr},Un={identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:t=>new H(t[0]==="t"||t[0]==="T"),stringify({source:t,value:e},n){if(t&&Un.test.test(t)){const s=t[0]==="t"||t[0]==="T";if(e===s)return t}return e?n.options.trueStr:n.options.falseStr}};function Ae({format:t,minFractionDigits:e,tag:n,value:s}){if(typeof s=="bigint")return String(s);const i=typeof s=="number"?s:Number(s);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let r=JSON.stringify(s);if(!t&&e&&(!n||n==="tag:yaml.org,2002:float")&&/^\d/.test(r)){let o=r.indexOf(".");o<0&&(o=r.length,r+=".");let a=e-(r.length-o-1);for(;a-- >0;)r+="0"}return r}const zs={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN))$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ae},Xs={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t),stringify(t){const e=Number(t.value);return isFinite(e)?e.toExponential():Ae(t)}},Zs={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(t){const e=new H(parseFloat(t)),n=t.indexOf(".");return n!==-1&&t[t.length-1]==="0"&&(e.minFractionDigits=t.length-n-1),e},stringify:Ae},nn=t=>typeof t=="bigint"||Number.isInteger(t),Hn=(t,e,n,{intAsBigInt:s})=>s?BigInt(t):parseInt(t.substring(e),n);function Qs(t,e,n){const{value:s}=t;return nn(s)&&s>=0?n+s.toString(e):Ae(t)}const ei={identify:t=>nn(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(t,e,n)=>Hn(t,2,8,n),stringify:t=>Qs(t,8,"0o")},ti={identify:nn,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(t,e,n)=>Hn(t,0,10,n),stringify:Ae},ni={identify:t=>nn(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(t,e,n)=>Hn(t,2,16,n),stringify:t=>Qs(t,16,"0x")},Sr=[dt,pt,en,tn,Un,ei,ti,ni,zs,Xs,Zs];function us(t){return typeof t=="bigint"||Number.isInteger(t)}const Lt=({value:t})=>JSON.stringify(t),kr=[{identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify:Lt},{identify:t=>t==null,createNode:()=>new H(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:Lt},{identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:t=>t==="true",stringify:Lt},{identify:us,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(t,e,{intAsBigInt:n})=>n?BigInt(t):parseInt(t,10),stringify:({value:t})=>us(t)?t.toString():JSON.stringify(t)},{identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:t=>parseFloat(t),stringify:Lt}],Nr={default:!0,tag:"",test:/^/,resolve(t,e){return e(`Unresolved plain scalar ${JSON.stringify(t)}`),t}},Tr=[dt,pt].concat(kr,Nr),Vn={identify:t=>t instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(t,e){if(typeof Buffer=="function")return Buffer.from(t,"base64");if(typeof atob=="function"){const n=atob(t.replace(/[\n\r]/g,"")),s=new Uint8Array(n.length);for(let i=0;i<n.length;++i)s[i]=n.charCodeAt(i);return s}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),t},stringify({comment:t,type:e,value:n},s,i,r){const o=n;let a;if(typeof Buffer=="function")a=o instanceof Buffer?o.toString("base64"):Buffer.from(o.buffer).toString("base64");else if(typeof btoa=="function"){let l="";for(let c=0;c<o.length;++c)l+=String.fromCharCode(o[c]);a=btoa(l)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e||(e=H.BLOCK_LITERAL),e!==H.QUOTE_DOUBLE){const l=Math.max(s.options.lineWidth-s.indent.length,s.options.minContentWidth),c=Math.ceil(a.length/l),h=new Array(c);for(let u=0,d=0;u<c;++u,d+=l)h[u]=a.substr(d,l);a=h.join(e===H.BLOCK_LITERAL?`
`:" ")}return At({comment:t,type:e,value:a},s,i,r)}};function si(t,e){if(ht(t))for(let n=0;n<t.items.length;++n){let s=t.items[n];if(!Q(s)){if(ft(s)){s.items.length>1&&e("Each pair must have its own sequence indicator");const i=s.items[0]||new le(new H(null));if(s.commentBefore&&(i.key.commentBefore=i.key.commentBefore?`${s.commentBefore}
${i.key.commentBefore}`:s.commentBefore),s.comment){const r=i.value??i.key;r.comment=r.comment?`${s.comment}
${r.comment}`:s.comment}s=i}t.items[n]=Q(s)?s:new le(s)}}else e("Expected a sequence for this tag");return t}function ii(t,e,n){const{replacer:s}=n,i=new Ve(t);i.tag="tag:yaml.org,2002:pairs";let r=0;if(e&&Symbol.iterator in Object(e))for(let o of e){typeof s=="function"&&(o=s.call(e,String(r++),o));let a,l;if(Array.isArray(o))if(o.length===2)a=o[0],l=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const c=Object.keys(o);if(c.length===1)a=c[0],l=o[a];else throw new TypeError(`Expected tuple with one key, not ${c.length} keys`)}else a=o;i.items.push(Fn(a,l,n))}return i}const qn={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:si,createNode:ii};class st extends Ve{constructor(){super(),this.add=me.prototype.add.bind(this),this.delete=me.prototype.delete.bind(this),this.get=me.prototype.get.bind(this),this.has=me.prototype.has.bind(this),this.set=me.prototype.set.bind(this),this.tag=st.tag}toJSON(e,n){if(!n)return super.toJSON(e);const s=new Map;n?.onCreate&&n.onCreate(s);for(const i of this.items){let r,o;if(Q(i)?(r=we(i.key,"",n),o=we(i.value,r,n)):r=we(i,"",n),s.has(r))throw new Error("Ordered maps must not include duplicate keys");s.set(r,o)}return s}static from(e,n,s){const i=ii(e,n,s),r=new this;return r.items=i.items,r}}st.tag="tag:yaml.org,2002:omap";const xn={collection:"seq",identify:t=>t instanceof Map,nodeClass:st,default:!1,tag:"tag:yaml.org,2002:omap",resolve(t,e){const n=si(t,e),s=[];for(const{key:i}of n.items)Z(i)&&(s.includes(i.value)?e(`Ordered maps must not include duplicate keys: ${i.value}`):s.push(i.value));return Object.assign(new st,n)},createNode:(t,e,n)=>st.from(t,e,n)};function ri({value:t,source:e},n){return e&&(t?oi:ai).test.test(e)?e:t?n.options.trueStr:n.options.falseStr}const oi={identify:t=>t===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new H(!0),stringify:ri},ai={identify:t=>t===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/i,resolve:()=>new H(!1),stringify:ri},Or={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ae},Ar={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t.replace(/_/g,"")),stringify(t){const e=Number(t.value);return isFinite(e)?e.toExponential():Ae(t)}},Er={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(t){const e=new H(parseFloat(t.replace(/_/g,""))),n=t.indexOf(".");if(n!==-1){const s=t.substring(n+1).replace(/_/g,"");s[s.length-1]==="0"&&(e.minFractionDigits=s.length)}return e},stringify:Ae},Et=t=>typeof t=="bigint"||Number.isInteger(t);function sn(t,e,n,{intAsBigInt:s}){const i=t[0];if((i==="-"||i==="+")&&(e+=1),t=t.substring(e).replace(/_/g,""),s){switch(n){case 2:t=`0b${t}`;break;case 8:t=`0o${t}`;break;case 16:t=`0x${t}`;break}const o=BigInt(t);return i==="-"?BigInt(-1)*o:o}const r=parseInt(t,n);return i==="-"?-1*r:r}function Wn(t,e,n){const{value:s}=t;if(Et(s)){const i=s.toString(e);return s<0?"-"+n+i.substr(1):n+i}return Ae(t)}const vr={identify:Et,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(t,e,n)=>sn(t,2,2,n),stringify:t=>Wn(t,2,"0b")},_r={identify:Et,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(t,e,n)=>sn(t,1,8,n),stringify:t=>Wn(t,8,"0")},Cr={identify:Et,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(t,e,n)=>sn(t,0,10,n),stringify:Ae},$r={identify:Et,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(t,e,n)=>sn(t,2,16,n),stringify:t=>Wn(t,16,"0x")};class it extends me{constructor(e){super(e),this.tag=it.tag}add(e){let n;Q(e)?n=e:e&&typeof e=="object"&&"key"in e&&"value"in e&&e.value===null?n=new le(e.key,null):n=new le(e,null),We(this.items,n.key)||this.items.push(n)}get(e,n){const s=We(this.items,e);return!n&&Q(s)?Z(s.key)?s.key.value:s.key:s}set(e,n){if(typeof n!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);const s=We(this.items,e);s&&!n?this.items.splice(this.items.indexOf(s),1):!s&&n&&this.items.push(new le(e))}toJSON(e,n){return super.toJSON(e,n,Set)}toString(e,n,s){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),n,s);throw new Error("Set items must all have null values")}static from(e,n,s){const{replacer:i}=s,r=new this(e);if(n&&Symbol.iterator in Object(n))for(let o of n)typeof i=="function"&&(o=i.call(n,o,o)),r.items.push(Fn(o,null,s));return r}}it.tag="tag:yaml.org,2002:set";const Kn={collection:"map",identify:t=>t instanceof Set,nodeClass:it,default:!1,tag:"tag:yaml.org,2002:set",createNode:(t,e,n)=>it.from(t,e,n),resolve(t,e){if(ft(t)){if(t.hasAllNullValues(!0))return Object.assign(new it,t);e("Set items must all have null values")}else e("Expected a mapping for this tag");return t}};function Jn(t,e){const n=t[0],s=n==="-"||n==="+"?t.substring(1):t,i=o=>e?BigInt(o):Number(o),r=s.replace(/_/g,"").split(":").reduce((o,a)=>o*i(60)+i(a),i(0));return n==="-"?i(-1)*r:r}function li(t){let{value:e}=t,n=o=>o;if(typeof e=="bigint")n=o=>BigInt(o);else if(isNaN(e)||!isFinite(e))return Ae(t);let s="";e<0&&(s="-",e*=n(-1));const i=n(60),r=[e%i];return e<60?r.unshift(0):(e=(e-r[0])/i,r.unshift(e%i),e>=60&&(e=(e-r[0])/i,r.unshift(e))),s+r.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const ci={identify:t=>typeof t=="bigint"||Number.isInteger(t),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(t,e,{intAsBigInt:n})=>Jn(t,n),stringify:li},ui={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:t=>Jn(t,!1),stringify:li},rn={identify:t=>t instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(t){const e=t.match(rn.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,s,i,r,o,a]=e.map(Number),l=e[7]?Number((e[7]+"00").substr(1,3)):0;let c=Date.UTC(n,s-1,i,r||0,o||0,a||0,l);const h=e[8];if(h&&h!=="Z"){let u=Jn(h,!1);Math.abs(u)<30&&(u*=60),c-=6e4*u}return new Date(c)},stringify:({value:t})=>t.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")},fs=[dt,pt,en,tn,oi,ai,vr,_r,Cr,$r,Or,Ar,Er,Vn,xn,qn,Kn,ci,ui,rn],hs=new Map([["core",Sr],["failsafe",[dt,pt,en]],["json",Tr],["yaml11",fs],["yaml-1.1",fs]]),ds={binary:Vn,bool:Un,float:Zs,floatExp:Xs,floatNaN:zs,floatTime:ui,int:ti,intHex:ni,intOct:ei,intTime:ci,map:dt,null:tn,omap:xn,pairs:qn,seq:pt,set:Kn,timestamp:rn},Ir={"tag:yaml.org,2002:binary":Vn,"tag:yaml.org,2002:omap":xn,"tag:yaml.org,2002:pairs":qn,"tag:yaml.org,2002:set":Kn,"tag:yaml.org,2002:timestamp":rn};function gn(t,e){let n=hs.get(e);if(!n)if(Array.isArray(t))n=[];else{const s=Array.from(hs.keys()).filter(i=>i!=="yaml11").map(i=>JSON.stringify(i)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${s} or define customTags array`)}if(Array.isArray(t))for(const s of t)n=n.concat(s);else typeof t=="function"&&(n=t(n.slice()));return n.map(s=>{if(typeof s!="string")return s;const i=ds[s];if(i)return i;const r=Object.keys(ds).map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown custom tag "${s}"; use one of ${r}`)})}const Br=(t,e)=>t.key<e.key?-1:t.key>e.key?1:0;class on{constructor({compat:e,customTags:n,merge:s,resolveKnownTags:i,schema:r,sortMapEntries:o,toStringDefaults:a}){this.compat=Array.isArray(e)?gn(e,"compat"):e?gn(null,e):null,this.merge=!!s,this.name=typeof r=="string"&&r||"core",this.knownTags=i?Ir:{},this.tags=gn(n,this.name),this.toStringOptions=a??null,Object.defineProperty(this,Fe,{value:dt}),Object.defineProperty(this,De,{value:en}),Object.defineProperty(this,ct,{value:pt}),this.sortMapEntries=typeof o=="function"?o:o===!0?Br:null}clone(){const e=Object.create(on.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}function Lr(t,e){const n=[];let s=e.directives===!0;if(e.directives!==!1&&t.directives){const l=t.directives.toString(t);l?(n.push(l),s=!0):t.directives.docStart&&(s=!0)}s&&n.push("---");const i=Ks(t,e),{commentString:r}=i.options;if(t.commentBefore){n.length!==1&&n.unshift("");const l=r(t.commentBefore);n.unshift(Me(l,""))}let o=!1,a=null;if(t.contents){if(te(t.contents)){if(t.contents.spaceBefore&&s&&n.push(""),t.contents.commentBefore){const h=r(t.contents.commentBefore);n.push(Me(h,""))}i.forceBlockIndent=!!t.comment,a=t.contents.comment}const l=a?void 0:()=>o=!0;let c=ot(t.contents,i,()=>a=null,l);a&&(c+=je(c,"",r(a))),(c[0]==="|"||c[0]===">")&&n[n.length-1]==="---"?n[n.length-1]=`--- ${c}`:n.push(c)}else n.push(ot(t.contents,i));if(t.directives?.docEnd)if(t.comment){const l=r(t.comment);l.includes(`
`)?(n.push("..."),n.push(Me(l,""))):n.push(`... ${l}`)}else n.push("...");else{let l=t.comment;l&&o&&(l=l.replace(/^\n+/,"")),l&&((!o||a)&&n[n.length-1]!==""&&n.push(""),n.push(Me(r(l),"")))}return n.join(`
`)+`
`}class mt{constructor(e,n,s){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Se,{value:En});let i=null;typeof n=="function"||Array.isArray(n)?i=n:s===void 0&&n&&(s=n,n=void 0);const r=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},s);this.options=r;let{version:o}=r;s?._directives?(this.directives=s._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new ce({version:o}),this.setSchema(o,s),this.contents=e===void 0?null:this.createNode(e,i,s)}clone(){const e=Object.create(mt.prototype,{[Se]:{value:En}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=te(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){Ye(this.contents)&&this.contents.add(e)}addIn(e,n){Ye(this.contents)&&this.contents.addIn(e,n)}createAlias(e,n){if(!e.anchor){const s=Vs(this);e.anchor=!n||s.has(n)?qs(n||"a",s):n}return new Yt(e.anchor)}createNode(e,n,s){let i;if(typeof n=="function")e=n.call({"":e},"",e),i=n;else if(Array.isArray(n)){const b=v=>typeof v=="number"||v instanceof String||v instanceof Number,I=n.filter(b).map(String);I.length>0&&(n=n.concat(I)),i=n}else s===void 0&&n&&(s=n,n=void 0);const{aliasDuplicateObjects:r,anchorPrefix:o,flow:a,keepUndefined:l,onTagObj:c,tag:h}=s??{},{onAnchor:u,setAnchors:d,sourceObjects:m}=ar(this,o||"a"),C={aliasDuplicateObjects:r??!0,keepUndefined:l??!1,onAnchor:u,onTagObj:c,replacer:i,schema:this.schema,sourceObjects:m},p=Nt(e,h,C);return a&&ee(p)&&(p.flow=!0),d(),p}createPair(e,n,s={}){const i=this.createNode(e,null,s),r=this.createNode(n,null,s);return new le(i,r)}delete(e){return Ye(this.contents)?this.contents.delete(e):!1}deleteIn(e){return St(e)?this.contents==null?!1:(this.contents=null,!0):Ye(this.contents)?this.contents.deleteIn(e):!1}get(e,n){return ee(this.contents)?this.contents.get(e,n):void 0}getIn(e,n){return St(e)?!n&&Z(this.contents)?this.contents.value:this.contents:ee(this.contents)?this.contents.getIn(e,n):void 0}has(e){return ee(this.contents)?this.contents.has(e):!1}hasIn(e){return St(e)?this.contents!==void 0:ee(this.contents)?this.contents.hasIn(e):!1}set(e,n){this.contents==null?this.contents=xt(this.schema,[e],n):Ye(this.contents)&&this.contents.set(e,n)}setIn(e,n){St(e)?this.contents=n:this.contents==null?this.contents=xt(this.schema,Array.from(e),n):Ye(this.contents)&&this.contents.setIn(e,n)}setSchema(e,n={}){typeof e=="number"&&(e=String(e));let s;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new ce({version:"1.1"}),s={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new ce({version:e}),s={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,s=null;break;default:{const i=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${i}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(s)this.schema=new on(Object.assign(s,n));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:n,mapAsMap:s,maxAliasCount:i,onAnchor:r,reviver:o}={}){const a={anchors:new Map,doc:this,keep:!e,mapAsMap:s===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},l=we(this.contents,n??"",a);if(typeof r=="function")for(const{count:c,res:h}of a.anchors.values())r(h,c);return typeof o=="function"?et(o,{"":l},"",l):l}toJSON(e,n){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:n})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const n=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${n}`)}return Lr(this,e)}}function Ye(t){if(ee(t))return!0;throw new Error("Expected a YAML collection as document contents")}class Gn extends Error{constructor(e,n,s,i){super(),this.name=e,this.code=s,this.message=i,this.pos=n}}class Ke extends Gn{constructor(e,n,s){super("YAMLParseError",e,n,s)}}class fi extends Gn{constructor(e,n,s){super("YAMLWarning",e,n,s)}}const Kt=(t,e)=>n=>{if(n.pos[0]===-1)return;n.linePos=n.pos.map(a=>e.linePos(a));const{line:s,col:i}=n.linePos[0];n.message+=` at line ${s}, column ${i}`;let r=i-1,o=t.substring(e.lineStarts[s-1],e.lineStarts[s]).replace(/[\n\r]+$/,"");if(r>=60&&o.length>80){const a=Math.min(r-39,o.length-79);o="…"+o.substring(a),r-=a-1}if(o.length>80&&(o=o.substring(0,79)+"…"),s>1&&/^ *$/.test(o.substring(0,r))){let a=t.substring(e.lineStarts[s-2],e.lineStarts[s-1]);a.length>80&&(a=a.substring(0,79)+`…
`),o=a+o}if(/[^ ]/.test(o)){let a=1;const l=n.linePos[1];l&&l.line===s&&l.col>i&&(a=Math.max(1,Math.min(l.col-i,80-r)));const c=" ".repeat(r)+"^".repeat(a);n.message+=`:

${o}
${c}
`}};function at(t,{flow:e,indicator:n,next:s,offset:i,onError:r,startOnNewline:o}){let a=!1,l=o,c=o,h="",u="",d=!1,m=!1,C=!1,p=null,b=null,I=null,v=null,B=null;for(const _ of t)switch(C&&(_.type!=="space"&&_.type!=="newline"&&_.type!=="comma"&&r(_.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),C=!1),_.type){case"space":!e&&l&&n!=="doc-start"&&_.source[0]==="	"&&r(_,"TAB_AS_INDENT","Tabs are not allowed as indentation"),c=!0;break;case"comment":{c||r(_,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const G=_.source.substring(1)||" ";h?h+=u+G:h=G,u="",l=!1;break}case"newline":l?h?h+=_.source:a=!0:u+=_.source,l=!0,d=!0,(p||b)&&(m=!0),c=!0;break;case"anchor":p&&r(_,"MULTIPLE_ANCHORS","A node can have at most one anchor"),_.source.endsWith(":")&&r(_.offset+_.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),p=_,B===null&&(B=_.offset),l=!1,c=!1,C=!0;break;case"tag":{b&&r(_,"MULTIPLE_TAGS","A node can have at most one tag"),b=_,B===null&&(B=_.offset),l=!1,c=!1,C=!0;break}case n:(p||b)&&r(_,"BAD_PROP_ORDER",`Anchors and tags must be after the ${_.source} indicator`),v&&r(_,"UNEXPECTED_TOKEN",`Unexpected ${_.source} in ${e??"collection"}`),v=_,l=!1,c=!1;break;case"comma":if(e){I&&r(_,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),I=_,l=!1,c=!1;break}default:r(_,"UNEXPECTED_TOKEN",`Unexpected ${_.type} token`),l=!1,c=!1}const w=t[t.length-1],L=w?w.offset+w.source.length:i;return C&&s&&s.type!=="space"&&s.type!=="newline"&&s.type!=="comma"&&(s.type!=="scalar"||s.source!=="")&&r(s.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),{comma:I,found:v,spaceBefore:a,comment:h,hasNewline:d,hasNewlineAfterProp:m,anchor:p,tag:b,end:L,start:B??L}}function Tt(t){if(!t)return null;switch(t.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(t.source.includes(`
`))return!0;if(t.end){for(const e of t.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(const e of t.items){for(const n of e.start)if(n.type==="newline")return!0;if(e.sep){for(const n of e.sep)if(n.type==="newline")return!0}if(Tt(e.key)||Tt(e.value))return!0}return!1;default:return!0}}function $n(t,e,n){if(e?.type==="flow-collection"){const s=e.end[0];s.indent===t&&(s.source==="]"||s.source==="}")&&Tt(e)&&n(s,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function hi(t,e,n){const{uniqueKeys:s}=t.options;if(s===!1)return!1;const i=typeof s=="function"?s:(r,o)=>r===o||Z(r)&&Z(o)&&r.value===o.value&&!(r.value==="<<"&&t.schema.merge);return e.some(r=>i(r.key,n))}const ps="All mapping items must start at the same column";function Mr({composeNode:t,composeEmptyNode:e},n,s,i,r){const o=r?.nodeClass??me,a=new o(n.schema);n.atRoot&&(n.atRoot=!1);let l=s.offset,c=null;for(const h of s.items){const{start:u,key:d,sep:m,value:C}=h,p=at(u,{indicator:"explicit-key-ind",next:d??m?.[0],offset:l,onError:i,startOnNewline:!0}),b=!p.found;if(b){if(d&&(d.type==="block-seq"?i(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in d&&d.indent!==s.indent&&i(l,"BAD_INDENT",ps)),!p.anchor&&!p.tag&&!m){c=p.end,p.comment&&(a.comment?a.comment+=`
`+p.comment:a.comment=p.comment);continue}(p.hasNewlineAfterProp||Tt(d))&&i(d??u[u.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else p.found?.indent!==s.indent&&i(l,"BAD_INDENT",ps);const I=p.end,v=d?t(n,d,p,i):e(n,I,u,null,p,i);n.schema.compat&&$n(s.indent,d,i),hi(n,a.items,v)&&i(I,"DUPLICATE_KEY","Map keys must be unique");const B=at(m??[],{indicator:"map-value-ind",next:C,offset:v.range[2],onError:i,startOnNewline:!d||d.type==="block-scalar"});if(l=B.end,B.found){b&&(C?.type==="block-map"&&!B.hasNewline&&i(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&p.start<B.found.offset-1024&&i(v.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const w=C?t(n,C,B,i):e(n,l,m,null,B,i);n.schema.compat&&$n(s.indent,C,i),l=w.range[2];const L=new le(v,w);n.options.keepSourceTokens&&(L.srcToken=h),a.items.push(L)}else{b&&i(v.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),B.comment&&(v.comment?v.comment+=`
`+B.comment:v.comment=B.comment);const w=new le(v);n.options.keepSourceTokens&&(w.srcToken=h),a.items.push(w)}}return c&&c<l&&i(c,"IMPOSSIBLE","Map comment with trailing content"),a.range=[s.offset,l,c??l],a}function Pr({composeNode:t,composeEmptyNode:e},n,s,i,r){const o=r?.nodeClass??Ve,a=new o(n.schema);n.atRoot&&(n.atRoot=!1);let l=s.offset,c=null;for(const{start:h,value:u}of s.items){const d=at(h,{indicator:"seq-item-ind",next:u,offset:l,onError:i,startOnNewline:!0});if(!d.found)if(d.anchor||d.tag||u)u&&u.type==="block-seq"?i(d.end,"BAD_INDENT","All sequence items must start at the same column"):i(l,"MISSING_CHAR","Sequence item without - indicator");else{c=d.end,d.comment&&(a.comment=d.comment);continue}const m=u?t(n,u,d,i):e(n,d.end,h,null,d,i);n.schema.compat&&$n(s.indent,u,i),l=m.range[2],a.items.push(m)}return a.range=[s.offset,l,c??l],a}function vt(t,e,n,s){let i="";if(t){let r=!1,o="";for(const a of t){const{source:l,type:c}=a;switch(c){case"space":r=!0;break;case"comment":{n&&!r&&s(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const h=l.substring(1)||" ";i?i+=o+h:i=h,o="";break}case"newline":i&&(o+=l),r=!0;break;default:s(a,"UNEXPECTED_TOKEN",`Unexpected ${c} at node end`)}e+=l.length}}return{comment:i,offset:e}}const yn="Block collections are not allowed within flow collections",bn=t=>t&&(t.type==="block-map"||t.type==="block-seq");function Dr({composeNode:t,composeEmptyNode:e},n,s,i,r){const o=s.start.source==="{",a=o?"flow map":"flow sequence",l=r?.nodeClass??(o?me:Ve),c=new l(n.schema);c.flow=!0;const h=n.atRoot;h&&(n.atRoot=!1);let u=s.offset+s.start.source.length;for(let b=0;b<s.items.length;++b){const I=s.items[b],{start:v,key:B,sep:w,value:L}=I,_=at(v,{flow:a,indicator:"explicit-key-ind",next:B??w?.[0],offset:u,onError:i,startOnNewline:!1});if(!_.found){if(!_.anchor&&!_.tag&&!w&&!L){b===0&&_.comma?i(_.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):b<s.items.length-1&&i(_.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),_.comment&&(c.comment?c.comment+=`
`+_.comment:c.comment=_.comment),u=_.end;continue}!o&&n.options.strict&&Tt(B)&&i(B,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(b===0)_.comma&&i(_.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(_.comma||i(_.start,"MISSING_CHAR",`Missing , between ${a} items`),_.comment){let G="";e:for(const W of v)switch(W.type){case"comma":case"space":break;case"comment":G=W.source.substring(1);break e;default:break e}if(G){let W=c.items[c.items.length-1];Q(W)&&(W=W.value??W.key),W.comment?W.comment+=`
`+G:W.comment=G,_.comment=_.comment.substring(G.length+1)}}if(!o&&!w&&!_.found){const G=L?t(n,L,_,i):e(n,_.end,w,null,_,i);c.items.push(G),u=G.range[2],bn(L)&&i(G.range,"BLOCK_IN_FLOW",yn)}else{const G=_.end,W=B?t(n,B,_,i):e(n,G,v,null,_,i);bn(B)&&i(W.range,"BLOCK_IN_FLOW",yn);const j=at(w??[],{flow:a,indicator:"map-value-ind",next:L,offset:W.range[2],onError:i,startOnNewline:!1});if(j.found){if(!o&&!_.found&&n.options.strict){if(w)for(const z of w){if(z===j.found)break;if(z.type==="newline"){i(z,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}_.start<j.found.offset-1024&&i(j.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else L&&("source"in L&&L.source&&L.source[0]===":"?i(L,"MISSING_CHAR",`Missing space after : in ${a}`):i(j.start,"MISSING_CHAR",`Missing , or : between ${a} items`));const Y=L?t(n,L,j,i):j.found?e(n,j.end,w,null,j,i):null;Y?bn(L)&&i(Y.range,"BLOCK_IN_FLOW",yn):j.comment&&(W.comment?W.comment+=`
`+j.comment:W.comment=j.comment);const q=new le(W,Y);if(n.options.keepSourceTokens&&(q.srcToken=I),o){const z=c;hi(n,z.items,W)&&i(G,"DUPLICATE_KEY","Map keys must be unique"),z.items.push(q)}else{const z=new me(n.schema);z.flow=!0,z.items.push(q),c.items.push(z)}u=Y?Y.range[2]:j.end}}const d=o?"}":"]",[m,...C]=s.end;let p=u;if(m&&m.source===d)p=m.offset+m.source.length;else{const b=a[0].toUpperCase()+a.substring(1),I=h?`${b} must end with a ${d}`:`${b} in block collection must be sufficiently indented and end with a ${d}`;i(u,h?"MISSING_CHAR":"BAD_INDENT",I),m&&m.source.length!==1&&C.unshift(m)}if(C.length>0){const b=vt(C,p,n.options.strict,i);b.comment&&(c.comment?c.comment+=`
`+b.comment:c.comment=b.comment),c.range=[s.offset,p,b.offset]}else c.range=[s.offset,p,p];return c}function wn(t,e,n,s,i,r){const o=n.type==="block-map"?Mr(t,e,n,s,r):n.type==="block-seq"?Pr(t,e,n,s,r):Dr(t,e,n,s,r),a=o.constructor;return i==="!"||i===a.tagName?(o.tag=a.tagName,o):(i&&(o.tag=i),o)}function Rr(t,e,n,s,i){const r=s?e.directives.tagName(s.source,u=>i(s,"TAG_RESOLVE_FAILED",u)):null,o=n.type==="block-map"?"map":n.type==="block-seq"?"seq":n.start.source==="{"?"map":"seq";if(!s||!r||r==="!"||r===me.tagName&&o==="map"||r===Ve.tagName&&o==="seq"||!o)return wn(t,e,n,i,r);let a=e.schema.tags.find(u=>u.tag===r&&u.collection===o);if(!a){const u=e.schema.knownTags[r];if(u&&u.collection===o)e.schema.tags.push(Object.assign({},u,{default:!1})),a=u;else return u?.collection?i(s,"BAD_COLLECTION_TYPE",`${u.tag} used for ${o} collection, but expects ${u.collection}`,!0):i(s,"TAG_RESOLVE_FAILED",`Unresolved tag: ${r}`,!0),wn(t,e,n,i,r)}const l=wn(t,e,n,i,r,a),c=a.resolve?.(l,u=>i(s,"TAG_RESOLVE_FAILED",u),e.options)??l,h=te(c)?c:new H(c);return h.range=l.range,h.tag=r,a?.format&&(h.format=a.format),h}function di(t,e,n){const s=t.offset,i=jr(t,e,n);if(!i)return{value:"",type:null,comment:"",range:[s,s,s]};const r=i.mode===">"?H.BLOCK_FOLDED:H.BLOCK_LITERAL,o=t.source?Fr(t.source):[];let a=o.length;for(let p=o.length-1;p>=0;--p){const b=o[p][1];if(b===""||b==="\r")a=p;else break}if(a===0){const p=i.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let b=s+i.length;return t.source&&(b+=t.source.length),{value:p,type:r,comment:i.comment,range:[s,b,b]}}let l=t.indent+i.indent,c=t.offset+i.length,h=0;for(let p=0;p<a;++p){const[b,I]=o[p];if(I===""||I==="\r")i.indent===0&&b.length>l&&(l=b.length);else{if(b.length<l){const v="Block scalars with more-indented leading empty lines must use an explicit indentation indicator";n(c+b.length,"MISSING_CHAR",v)}i.indent===0&&(l=b.length),h=p;break}c+=b.length+I.length+1}for(let p=o.length-1;p>=a;--p)o[p][0].length>l&&(a=p+1);let u="",d="",m=!1;for(let p=0;p<h;++p)u+=o[p][0].slice(l)+`
`;for(let p=h;p<a;++p){let[b,I]=o[p];c+=b.length+I.length+1;const v=I[I.length-1]==="\r";if(v&&(I=I.slice(0,-1)),I&&b.length<l){const w=`Block scalar lines must not be less indented than their ${i.indent?"explicit indentation indicator":"first line"}`;n(c-I.length-(v?2:1),"BAD_INDENT",w),b=""}r===H.BLOCK_LITERAL?(u+=d+b.slice(l)+I,d=`
`):b.length>l||I[0]==="	"?(d===" "?d=`
`:!m&&d===`
`&&(d=`

`),u+=d+b.slice(l)+I,d=`
`,m=!0):I===""?d===`
`?u+=`
`:d=`
`:(u+=d+I,d=" ",m=!1)}switch(i.chomp){case"-":break;case"+":for(let p=a;p<o.length;++p)u+=`
`+o[p][0].slice(l);u[u.length-1]!==`
`&&(u+=`
`);break;default:u+=`
`}const C=s+i.length+t.source.length;return{value:u,type:r,comment:i.comment,range:[s,C,C]}}function jr({offset:t,props:e},n,s){if(e[0].type!=="block-scalar-header")return s(e[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:i}=e[0],r=i[0];let o=0,a="",l=-1;for(let d=1;d<i.length;++d){const m=i[d];if(!a&&(m==="-"||m==="+"))a=m;else{const C=Number(m);!o&&C?o=C:l===-1&&(l=t+d)}}l!==-1&&s(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${i}`);let c=!1,h="",u=i.length;for(let d=1;d<e.length;++d){const m=e[d];switch(m.type){case"space":c=!0;case"newline":u+=m.source.length;break;case"comment":n&&!c&&s(m,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),u+=m.source.length,h=m.source.substring(1);break;case"error":s(m,"UNEXPECTED_TOKEN",m.message),u+=m.source.length;break;default:{const C=`Unexpected token in block scalar header: ${m.type}`;s(m,"UNEXPECTED_TOKEN",C);const p=m.source;p&&typeof p=="string"&&(u+=p.length)}}}return{mode:r,indent:o,chomp:a,comment:h,length:u}}function Fr(t){const e=t.split(/\n( *)/),n=e[0],s=n.match(/^( *)/),r=[s?.[1]?[s[1],n.slice(s[1].length)]:["",n]];for(let o=1;o<e.length;o+=2)r.push([e[o],e[o+1]]);return r}function pi(t,e,n){const{offset:s,type:i,source:r,end:o}=t;let a,l;const c=(d,m,C)=>n(s+d,m,C);switch(i){case"scalar":a=H.PLAIN,l=Ur(r,c);break;case"single-quoted-scalar":a=H.QUOTE_SINGLE,l=Hr(r,c);break;case"double-quoted-scalar":a=H.QUOTE_DOUBLE,l=Vr(r,c);break;default:return n(t,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${i}`),{value:"",type:null,comment:"",range:[s,s+r.length,s+r.length]}}const h=s+r.length,u=vt(o,h,e,n);return{value:l,type:a,comment:u.comment,range:[s,h,u.offset]}}function Ur(t,e){let n="";switch(t[0]){case"	":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":{n=`block scalar indicator ${t[0]}`;break}case"@":case"`":{n=`reserved character ${t[0]}`;break}}return n&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),mi(t)}function Hr(t,e){return(t[t.length-1]!=="'"||t.length===1)&&e(t.length,"MISSING_CHAR","Missing closing 'quote"),mi(t.slice(1,-1)).replace(/''/g,"'")}function mi(t){let e,n;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),n=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let s=e.exec(t);if(!s)return t;let i=s[1],r=" ",o=e.lastIndex;for(n.lastIndex=o;s=n.exec(t);)s[1]===""?r===`
`?i+=r:r=`
`:(i+=r+s[1],r=" "),o=n.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=o,s=a.exec(t),i+r+(s?.[1]??"")}function Vr(t,e){let n="";for(let s=1;s<t.length-1;++s){const i=t[s];if(!(i==="\r"&&t[s+1]===`
`))if(i===`
`){const{fold:r,offset:o}=qr(t,s);n+=r,s=o}else if(i==="\\"){let r=t[++s];const o=xr[r];if(o)n+=o;else if(r===`
`)for(r=t[s+1];r===" "||r==="	";)r=t[++s+1];else if(r==="\r"&&t[s+1]===`
`)for(r=t[++s+1];r===" "||r==="	";)r=t[++s+1];else if(r==="x"||r==="u"||r==="U"){const a={x:2,u:4,U:8}[r];n+=Wr(t,s+1,a,e),s+=a}else{const a=t.substr(s-1,2);e(s-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),n+=a}}else if(i===" "||i==="	"){const r=s;let o=t[s+1];for(;o===" "||o==="	";)o=t[++s+1];o!==`
`&&!(o==="\r"&&t[s+2]===`
`)&&(n+=s>r?t.slice(r,s+1):i)}else n+=i}return(t[t.length-1]!=='"'||t.length===1)&&e(t.length,"MISSING_CHAR",'Missing closing "quote'),n}function qr(t,e){let n="",s=t[e+1];for(;(s===" "||s==="	"||s===`
`||s==="\r")&&!(s==="\r"&&t[e+2]!==`
`);)s===`
`&&(n+=`
`),e+=1,s=t[e+1];return n||(n=" "),{fold:n,offset:e}}const xr={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function Wr(t,e,n,s){const i=t.substr(e,n),o=i.length===n&&/^[0-9a-fA-F]+$/.test(i)?parseInt(i,16):NaN;if(isNaN(o)){const a=t.substr(e-2,n+2);return s(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),a}return String.fromCodePoint(o)}function gi(t,e,n,s){const{value:i,type:r,comment:o,range:a}=e.type==="block-scalar"?di(e,t.options.strict,s):pi(e,t.options.strict,s),l=n?t.directives.tagName(n.source,u=>s(n,"TAG_RESOLVE_FAILED",u)):null,c=n&&l?Kr(t.schema,i,l,n,s):e.type==="scalar"?Jr(t,i,e,s):t.schema[De];let h;try{const u=c.resolve(i,d=>s(n??e,"TAG_RESOLVE_FAILED",d),t.options);h=Z(u)?u:new H(u)}catch(u){const d=u instanceof Error?u.message:String(u);s(n??e,"TAG_RESOLVE_FAILED",d),h=new H(i)}return h.range=a,h.source=i,r&&(h.type=r),l&&(h.tag=l),c.format&&(h.format=c.format),o&&(h.comment=o),h}function Kr(t,e,n,s,i){if(n==="!")return t[De];const r=[];for(const a of t.tags)if(!a.collection&&a.tag===n)if(a.default&&a.test)r.push(a);else return a;for(const a of r)if(a.test?.test(e))return a;const o=t.knownTags[n];return o&&!o.collection?(t.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(i(s,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,n!=="tag:yaml.org,2002:str"),t[De])}function Jr({directives:t,schema:e},n,s,i){const r=e.tags.find(o=>o.default&&o.test?.test(n))||e[De];if(e.compat){const o=e.compat.find(a=>a.default&&a.test?.test(n))??e[De];if(r.tag!==o.tag){const a=t.tagString(r.tag),l=t.tagString(o.tag),c=`Value may be parsed as either ${a} or ${l}`;i(s,"TAG_RESOLVE_FAILED",c,!0)}}return r}function Gr(t,e,n){if(e){n===null&&(n=e.length);for(let s=n-1;s>=0;--s){let i=e[s];switch(i.type){case"space":case"comment":case"newline":t-=i.source.length;continue}for(i=e[++s];i?.type==="space";)t+=i.source.length,i=e[++s];break}}return t}const Yr={composeNode:yi,composeEmptyNode:Yn};function yi(t,e,n,s){const{spaceBefore:i,comment:r,anchor:o,tag:a}=n;let l,c=!0;switch(e.type){case"alias":l=zr(t,e,s),(o||a)&&s(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":l=gi(t,e,a,s),o&&(l.anchor=o.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":l=Rr(Yr,t,e,a,s),o&&(l.anchor=o.source.substring(1));break;default:{const h=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;s(e,"UNEXPECTED_TOKEN",h),l=Yn(t,e.offset,void 0,null,n,s),c=!1}}return o&&l.anchor===""&&s(o,"BAD_ALIAS","Anchor cannot be an empty string"),i&&(l.spaceBefore=!0),r&&(e.type==="scalar"&&e.source===""?l.comment=r:l.commentBefore=r),t.options.keepSourceTokens&&c&&(l.srcToken=e),l}function Yn(t,e,n,s,{spaceBefore:i,comment:r,anchor:o,tag:a,end:l},c){const h={type:"scalar",offset:Gr(e,n,s),indent:-1,source:""},u=gi(t,h,a,c);return o&&(u.anchor=o.source.substring(1),u.anchor===""&&c(o,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(u.spaceBefore=!0),r&&(u.comment=r,u.range[2]=l),u}function zr({options:t},{offset:e,source:n,end:s},i){const r=new Yt(n.substring(1));r.source===""&&i(e,"BAD_ALIAS","Alias cannot be an empty string"),r.source.endsWith(":")&&i(e+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=e+n.length,a=vt(s,o,t.strict,i);return r.range=[e,o,a.offset],a.comment&&(r.comment=a.comment),r}function Xr(t,e,{offset:n,start:s,value:i,end:r},o){const a=Object.assign({_directives:e},t),l=new mt(void 0,a),c={atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},h=at(s,{indicator:"doc-start",next:i??r?.[0],offset:n,onError:o,startOnNewline:!0});h.found&&(l.directives.docStart=!0,i&&(i.type==="block-map"||i.type==="block-seq")&&!h.hasNewline&&o(h.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=i?yi(c,i,h,o):Yn(c,h.end,s,null,h,o);const u=l.contents.range[2],d=vt(r,u,!1,o);return d.comment&&(l.comment=d.comment),l.range=[n,u,d.offset],l}function bt(t){if(typeof t=="number")return[t,t+1];if(Array.isArray(t))return t.length===2?t:[t[0],t[1]];const{offset:e,source:n}=t;return[e,e+(typeof n=="string"?n.length:1)]}function ms(t){let e="",n=!1,s=!1;for(let i=0;i<t.length;++i){const r=t[i];switch(r[0]){case"#":e+=(e===""?"":s?`

`:`
`)+(r.substring(1)||" "),n=!0,s=!1;break;case"%":t[i+1]?.[0]!=="#"&&(i+=1),n=!1;break;default:n||(s=!0),n=!1}}return{comment:e,afterEmptyLine:s}}class zn{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(n,s,i,r)=>{const o=bt(n);r?this.warnings.push(new fi(o,s,i)):this.errors.push(new Ke(o,s,i))},this.directives=new ce({version:e.version||"1.2"}),this.options=e}decorate(e,n){const{comment:s,afterEmptyLine:i}=ms(this.prelude);if(s){const r=e.contents;if(n)e.comment=e.comment?`${e.comment}
${s}`:s;else if(i||e.directives.docStart||!r)e.commentBefore=s;else if(ee(r)&&!r.flow&&r.items.length>0){let o=r.items[0];Q(o)&&(o=o.key);const a=o.commentBefore;o.commentBefore=a?`${s}
${a}`:s}else{const o=r.commentBefore;r.commentBefore=o?`${s}
${o}`:s}}n?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:ms(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,n=!1,s=-1){for(const i of e)yield*this.next(i);yield*this.end(n,s)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(n,s,i)=>{const r=bt(e);r[0]+=n,this.onError(r,"BAD_DIRECTIVE",s,i)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const n=Xr(this.options,this.directives,e,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const n=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,s=new Ke(bt(e),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(s):this.doc.errors.push(s);break}case"doc-end":{if(!this.doc){const s="Unexpected doc-end without preceding document";this.errors.push(new Ke(bt(e),"UNEXPECTED_TOKEN",s));break}this.doc.directives.docEnd=!0;const n=vt(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){const s=this.doc.comment;this.doc.comment=s?`${s}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new Ke(bt(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const s=Object.assign({_directives:this.directives},this.options),i=new mt(void 0,s);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),i.range=[0,n,n],this.decorate(i,!1),yield i}}}function Zr(t,e=!0,n){if(t){const s=(i,r,o)=>{const a=typeof i=="number"?i:Array.isArray(i)?i[0]:i.offset;if(n)n(a,r,o);else throw new Ke([a,a+1],r,o)};switch(t.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return pi(t,e,s);case"block-scalar":return di(t,e,s)}}return null}function Qr(t,e){const{implicitKey:n=!1,indent:s,inFlow:i=!1,offset:r=-1,type:o="PLAIN"}=e,a=At({type:o,value:t},{implicitKey:n,indent:s>0?" ".repeat(s):"",inFlow:i,options:{blockQuote:!0,lineWidth:-1}}),l=e.end??[{type:"newline",offset:-1,indent:s,source:`
`}];switch(a[0]){case"|":case">":{const c=a.indexOf(`
`),h=a.substring(0,c),u=a.substring(c+1)+`
`,d=[{type:"block-scalar-header",offset:r,indent:s,source:h}];return bi(d,l)||d.push({type:"newline",offset:-1,indent:s,source:`
`}),{type:"block-scalar",offset:r,indent:s,props:d,source:u}}case'"':return{type:"double-quoted-scalar",offset:r,indent:s,source:a,end:l};case"'":return{type:"single-quoted-scalar",offset:r,indent:s,source:a,end:l};default:return{type:"scalar",offset:r,indent:s,source:a,end:l}}}function eo(t,e,n={}){let{afterKey:s=!1,implicitKey:i=!1,inFlow:r=!1,type:o}=n,a="indent"in t?t.indent:null;if(s&&typeof a=="number"&&(a+=2),!o)switch(t.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{const c=t.props[0];if(c.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=c.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}const l=At({type:o,value:e},{implicitKey:i||a===null,indent:a!==null&&a>0?" ".repeat(a):"",inFlow:r,options:{blockQuote:!0,lineWidth:-1}});switch(l[0]){case"|":case">":to(t,l);break;case'"':Sn(t,l,"double-quoted-scalar");break;case"'":Sn(t,l,"single-quoted-scalar");break;default:Sn(t,l,"scalar")}}function to(t,e){const n=e.indexOf(`
`),s=e.substring(0,n),i=e.substring(n+1)+`
`;if(t.type==="block-scalar"){const r=t.props[0];if(r.type!=="block-scalar-header")throw new Error("Invalid block scalar header");r.source=s,t.source=i}else{const{offset:r}=t,o="indent"in t?t.indent:-1,a=[{type:"block-scalar-header",offset:r,indent:o,source:s}];bi(a,"end"in t?t.end:void 0)||a.push({type:"newline",offset:-1,indent:o,source:`
`});for(const l of Object.keys(t))l!=="type"&&l!=="offset"&&delete t[l];Object.assign(t,{type:"block-scalar",indent:o,props:a,source:i})}}function bi(t,e){if(e)for(const n of e)switch(n.type){case"space":case"comment":t.push(n);break;case"newline":return t.push(n),!0}return!1}function Sn(t,e,n){switch(t.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":t.type=n,t.source=e;break;case"block-scalar":{const s=t.props.slice(1);let i=e.length;t.props[0].type==="block-scalar-header"&&(i-=t.props[0].source.length);for(const r of s)r.offset+=i;delete t.props,Object.assign(t,{type:n,source:e,end:s});break}case"block-map":case"block-seq":{const i={type:"newline",offset:t.offset+e.length,indent:t.indent,source:`
`};delete t.items,Object.assign(t,{type:n,source:e,end:[i]});break}default:{const s="indent"in t?t.indent:-1,i="end"in t&&Array.isArray(t.end)?t.end.filter(r=>r.type==="space"||r.type==="comment"||r.type==="newline"):[];for(const r of Object.keys(t))r!=="type"&&r!=="offset"&&delete t[r];Object.assign(t,{type:n,indent:s,source:e,end:i})}}}const no=t=>"type"in t?Jt(t):Vt(t);function Jt(t){switch(t.type){case"block-scalar":{let e="";for(const n of t.props)e+=Jt(n);return e+t.source}case"block-map":case"block-seq":{let e="";for(const n of t.items)e+=Vt(n);return e}case"flow-collection":{let e=t.start.source;for(const n of t.items)e+=Vt(n);for(const n of t.end)e+=n.source;return e}case"document":{let e=Vt(t);if(t.end)for(const n of t.end)e+=n.source;return e}default:{let e=t.source;if("end"in t&&t.end)for(const n of t.end)e+=n.source;return e}}}function Vt({start:t,key:e,sep:n,value:s}){let i="";for(const r of t)i+=r.source;if(e&&(i+=Jt(e)),n)for(const r of n)i+=r.source;return s&&(i+=Jt(s)),i}const In=Symbol("break visit"),so=Symbol("skip children"),wi=Symbol("remove item");function Je(t,e){"type"in t&&t.type==="document"&&(t={start:t.start,value:t.value}),Si(Object.freeze([]),t,e)}Je.BREAK=In;Je.SKIP=so;Je.REMOVE=wi;Je.itemAtPath=(t,e)=>{let n=t;for(const[s,i]of e){const r=n?.[s];if(r&&"items"in r)n=r.items[i];else return}return n};Je.parentCollection=(t,e)=>{const n=Je.itemAtPath(t,e.slice(0,-1)),s=e[e.length-1][0],i=n?.[s];if(i&&"items"in i)return i;throw new Error("Parent collection not found")};function Si(t,e,n){let s=n(e,t);if(typeof s=="symbol")return s;for(const i of["key","value"]){const r=e[i];if(r&&"items"in r){for(let o=0;o<r.items.length;++o){const a=Si(Object.freeze(t.concat([[i,o]])),r.items[o],n);if(typeof a=="number")o=a-1;else{if(a===In)return In;a===wi&&(r.items.splice(o,1),o-=1)}}typeof s=="function"&&i==="key"&&(s=s(e,t))}}return typeof s=="function"?s(e,t):s}const an="\uFEFF",ln="",cn="",Ot="",io=t=>!!t&&"items"in t,ro=t=>!!t&&(t.type==="scalar"||t.type==="single-quoted-scalar"||t.type==="double-quoted-scalar"||t.type==="block-scalar");function oo(t){switch(t){case an:return"<BOM>";case ln:return"<DOC>";case cn:return"<FLOW_END>";case Ot:return"<SCALAR>";default:return JSON.stringify(t)}}function ki(t){switch(t){case an:return"byte-order-mark";case ln:return"doc-mode";case cn:return"flow-error-end";case Ot:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(t[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const ao=Object.freeze(Object.defineProperty({__proto__:null,BOM:an,DOCUMENT:ln,FLOW_END:cn,SCALAR:Ot,createScalarToken:Qr,isCollection:io,isScalar:ro,prettyToken:oo,resolveAsScalar:Zr,setScalarValue:eo,stringify:no,tokenType:ki,visit:Je},Symbol.toStringTag,{value:"Module"}));function ye(t){switch(t){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const gs="0123456789ABCDEFabcdef".split(""),lo="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()".split(""),kn=",[]{}".split(""),co=` ,[]{}
\r	`.split(""),Nn=t=>!t||co.includes(t);class Ni{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,n=!1){e&&(this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null),this.atEnd=!n;let s=this.next??"stream";for(;s&&(n||this.hasChars(1));)s=yield*this.parseNext(s)}atLineEnd(){let e=this.pos,n=this.buffer[e];for(;n===" "||n==="	";)n=this.buffer[++e];return!n||n==="#"||n===`
`?!0:n==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let n=this.buffer[e];if(this.indentNext>0){let s=0;for(;n===" ";)n=this.buffer[++s+e];if(n==="\r"){const i=this.buffer[s+e+1];if(i===`
`||!i&&!this.atEnd)return e+s+1}return n===`
`||s>=this.indentNext||!n&&!this.atEnd?e+s:-1}if(n==="-"||n==="."){const s=this.buffer.substr(e,3);if((s==="---"||s==="...")&&ye(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===an&&(yield*this.pushCount(1),e=e.substring(1)),e[0]==="%"){let n=e.length;const s=e.indexOf("#");if(s!==-1){const r=e[s-1];(r===" "||r==="	")&&(n=s-1)}for(;;){const r=e[n-1];if(r===" "||r==="	")n-=1;else break}const i=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-i),this.pushNewline(),"stream"}if(this.atLineEnd()){const n=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-n),yield*this.pushNewline(),"stream"}return yield ln,yield*this.parseLineStart()}*parseLineStart(){const e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const n=this.peek(3);if(n==="---"&&ye(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"doc";if(n==="..."&&ye(this.charAt(3)))return yield*this.pushCount(3),"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!ye(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[e,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&ye(n)){const s=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=s,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const e=this.getLine();if(e===null)return this.setNext("doc");let n=yield*this.pushIndicators();switch(e[n]){case"#":yield*this.pushCount(e.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Nn),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=yield*this.parseBlockScalarHeader(),n+=yield*this.pushSpaces(!0),yield*this.pushCount(e.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,n,s=-1;do e=yield*this.pushNewline(),e>0?(n=yield*this.pushSpaces(!1),this.indentValue=s=n):n=0,n+=yield*this.pushSpaces(!0);while(e+n>0);const i=this.getLine();if(i===null)return this.setNext("flow");if((s!==-1&&s<this.indentNext&&i[0]!=="#"||s===0&&(i.startsWith("---")||i.startsWith("..."))&&ye(i[3]))&&!(s===this.indentNext-1&&this.flowLevel===1&&(i[0]==="]"||i[0]==="}")))return this.flowLevel=0,yield cn,yield*this.parseLineStart();let r=0;for(;i[r]===",";)r+=yield*this.pushCount(1),r+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(r+=yield*this.pushIndicators(),i[r]){case void 0:return"flow";case"#":return yield*this.pushCount(i.length-r),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Nn),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||ye(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const e=this.charAt(0);let n=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;n!==-1&&this.buffer[n+1]==="'";)n=this.buffer.indexOf("'",n+2);else for(;n!==-1;){let r=0;for(;this.buffer[n-1-r]==="\\";)r+=1;if(r%2===0)break;n=this.buffer.indexOf('"',n+1)}const s=this.buffer.substring(0,n);let i=s.indexOf(`
`,this.pos);if(i!==-1){for(;i!==-1;){const r=this.continueScalar(i+1);if(r===-1)break;i=s.indexOf(`
`,r)}i!==-1&&(n=i-(s[i-1]==="\r"?2:1))}if(n===-1){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){const n=this.buffer[++e];if(n==="+")this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if(n!=="-")break}return yield*this.pushUntil(n=>ye(n)||n==="#")}*parseBlockScalar(){let e=this.pos-1,n=0,s;e:for(let i=this.pos;s=this.buffer[i];++i)switch(s){case" ":n+=1;break;case`
`:e=i,n=0;break;case"\r":{const r=this.buffer[i+1];if(!r&&!this.atEnd)return this.setNext("block-scalar");if(r===`
`)break}default:break e}if(!s&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=n:this.indentNext+=this.blockScalarIndent;do{const i=this.continueScalar(e+1);if(i===-1)break;e=this.buffer.indexOf(`
`,i)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}if(!this.blockScalarKeep)do{let i=e-1,r=this.buffer[i];r==="\r"&&(r=this.buffer[--i]);const o=i;for(;r===" "||r==="	";)r=this.buffer[--i];if(r===`
`&&i>=this.pos&&i+1+n>o)e=i;else break}while(!0);return yield Ot,yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const e=this.flowLevel>0;let n=this.pos-1,s=this.pos-1,i;for(;i=this.buffer[++s];)if(i===":"){const r=this.buffer[s+1];if(ye(r)||e&&r===",")break;n=s}else if(ye(i)){let r=this.buffer[s+1];if(i==="\r"&&(r===`
`?(s+=1,i=`
`,r=this.buffer[s+1]):n=s),r==="#"||e&&kn.includes(r))break;if(i===`
`){const o=this.continueScalar(s+1);if(o===-1)break;s=Math.max(s,o-2)}}else{if(e&&kn.includes(i))break;n=s}return!i&&!this.atEnd?this.setNext("plain-scalar"):(yield Ot,yield*this.pushToIndex(n+1,!0),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,n){const s=this.buffer.slice(this.pos,e);return s?(yield s,this.pos+=s.length,s.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Nn))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const e=this.flowLevel>0,n=this.charAt(1);if(ye(n)||e&&kn.includes(n))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,n=this.buffer[e];for(;!ye(n)&&n!==">";)n=this.buffer[++e];return yield*this.pushToIndex(n===">"?e+1:e,!1)}else{let e=this.pos+1,n=this.buffer[e];for(;n;)if(lo.includes(n))n=this.buffer[++e];else if(n==="%"&&gs.includes(this.buffer[e+1])&&gs.includes(this.buffer[e+2]))n=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){const e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):e==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let n=this.pos-1,s;do s=this.buffer[++n];while(s===" "||e&&s==="	");const i=n-this.pos;return i>0&&(yield this.buffer.substr(this.pos,i),this.pos=n),i}*pushUntil(e){let n=this.pos,s=this.buffer[n];for(;!e(s);)s=this.buffer[++n];return yield*this.pushToIndex(n,!1)}}class Ti{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let n=0,s=this.lineStarts.length;for(;n<s;){const r=n+s>>1;this.lineStarts[r]<e?n=r+1:s=r}if(this.lineStarts[n]===e)return{line:n+1,col:1};if(n===0)return{line:0,col:e};const i=this.lineStarts[n-1];return{line:n,col:e-i+1}}}}function Oe(t,e){for(let n=0;n<t.length;++n)if(t[n].type===e)return!0;return!1}function ys(t){for(let e=0;e<t.length;++e)switch(t[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function Oi(t){switch(t?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function Mt(t){switch(t.type){case"document":return t.start;case"block-map":{const e=t.items[t.items.length-1];return e.sep??e.start}case"block-seq":return t.items[t.items.length-1].start;default:return[]}}function ze(t){if(t.length===0)return[];let e=t.length;e:for(;--e>=0;)switch(t[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;t[++e]?.type==="space";);return t.splice(e,t.length)}function bs(t){if(t.start.type==="flow-seq-start")for(const e of t.items)e.sep&&!e.value&&!Oe(e.start,"explicit-key-ind")&&!Oe(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,Oi(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}class Xn{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Ni,this.onNewLine=e}*parse(e,n=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const s of this.lexer.lex(e,n))yield*this.next(s);n||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}const n=ki(e);if(n)if(n==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const s=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:s,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){const n=e??this.stack.pop();if(n)if(this.stack.length===0)yield n;else{const s=this.peek(1);switch(n.type==="block-scalar"?n.indent="indent"in s?s.indent:0:n.type==="flow-collection"&&s.type==="document"&&(n.indent=0),n.type==="flow-collection"&&bs(n),s.type){case"document":s.value=n;break;case"block-scalar":s.props.push(n);break;case"block-map":{const i=s.items[s.items.length-1];if(i.value){s.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}else if(i.sep)i.value=n;else{Object.assign(i,{key:n,sep:[]}),this.onKeyLine=!Oe(i.start,"explicit-key-ind");return}break}case"block-seq":{const i=s.items[s.items.length-1];i.value?s.items.push({start:[],value:n}):i.value=n;break}case"flow-collection":{const i=s.items[s.items.length-1];!i||i.value?s.items.push({start:[],key:n,sep:[]}):i.sep?i.value=n:Object.assign(i,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if((s.type==="document"||s.type==="block-map"||s.type==="block-seq")&&(n.type==="block-map"||n.type==="block-seq")){const i=n.items[n.items.length-1];i&&!i.sep&&!i.value&&i.start.length>0&&ys(i.start)===-1&&(n.indent===0||i.start.every(r=>r.type!=="comment"||r.indent<n.indent))&&(s.type==="document"?s.end=i.start:s.items.push({start:i.start}),n.items.splice(-1,1))}}else{const s="Tried to pop an empty stack";yield{type:"error",offset:this.offset,source:"",message:s}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{ys(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}const n=this.startBlockValue(e);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){const n=Mt(this.peek(2)),s=ze(n);let i;e.end?(i=e.end,i.push(this.sourceToken),delete e.end):i=[this.sourceToken];const r={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:s,key:e,sep:i}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=r}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){const n=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,n.value){const s="end"in n.value?n.value.end:void 0;(Array.isArray(s)?s[s.length-1]:void 0)?.type==="comment"?s?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)e.items.push({start:[this.sourceToken]});else if(n.sep)n.sep.push(this.sourceToken);else{if(this.atIndentedComment(n.start,e.indent)){const i=e.items[e.items.length-2]?.value?.end;if(Array.isArray(i)){Array.prototype.push.apply(i,n.start),i.push(this.sourceToken),e.items.pop();return}}n.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const s=!this.onKeyLine&&this.indent===e.indent&&n.sep;let i=[];if(s&&n.sep&&!n.value){const r=[];for(let o=0;o<n.sep.length;++o){const a=n.sep[o];switch(a.type){case"newline":r.push(o);break;case"space":break;case"comment":a.indent>e.indent&&(r.length=0);break;default:r.length=0}}r.length>=2&&(i=n.sep.splice(r[1]))}switch(this.type){case"anchor":case"tag":s||n.value?(i.push(this.sourceToken),e.items.push({start:i}),this.onKeyLine=!0):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"explicit-key-ind":!n.sep&&!Oe(n.start,"explicit-key-ind")?n.start.push(this.sourceToken):s||n.value?(i.push(this.sourceToken),e.items.push({start:i})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]}),this.onKeyLine=!0;return;case"map-value-ind":if(Oe(n.start,"explicit-key-ind"))if(n.sep)if(n.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Oe(n.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,key:null,sep:[this.sourceToken]}]});else if(Oi(n.key)&&!Oe(n.sep,"newline")){const r=ze(n.start),o=n.key,a=n.sep;a.push(this.sourceToken),delete n.key,delete n.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:o,sep:a}]})}else i.length>0?n.sep=n.sep.concat(i,this.sourceToken):n.sep.push(this.sourceToken);else if(Oe(n.start,"newline"))Object.assign(n,{key:null,sep:[this.sourceToken]});else{const r=ze(n.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]})}else n.sep?n.value||s?e.items.push({start:i,key:null,sep:[this.sourceToken]}):Oe(n.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);s||n.value?(e.items.push({start:i,key:r,sep:[]}),this.onKeyLine=!0):n.sep?this.stack.push(r):(Object.assign(n,{key:r,sep:[]}),this.onKeyLine=!0);return}default:{const r=this.startBlockValue(e);if(r){s&&r.type!=="block-seq"&&Oe(n.start,"explicit-key-ind")&&e.items.push({start:i}),this.stack.push(r);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){const n=e.items[e.items.length-1];switch(this.type){case"newline":if(n.value){const s="end"in n.value?n.value.end:void 0;(Array.isArray(s)?s[s.length-1]:void 0)?.type==="comment"?s?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(n.start,e.indent)){const i=e.items[e.items.length-2]?.value?.end;if(Array.isArray(i)){Array.prototype.push.apply(i,n.start),i.push(this.sourceToken),e.items.pop();return}}n.start.push(this.sourceToken)}return;case"anchor":case"tag":if(n.value||this.indent<=e.indent)break;n.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;n.value||Oe(n.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return}if(this.indent>e.indent){const s=this.startBlockValue(e);if(s){this.stack.push(s);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){const n=e.items[e.items.length-1];if(this.type==="flow-error-end"){let s;do yield*this.pop(),s=this.peek(1);while(s&&s.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?e.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?e.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const i=this.flowScalar(this.type);!n||n.value?e.items.push({start:[],key:i,sep:[]}):n.sep?this.stack.push(i):Object.assign(n,{key:i,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}const s=this.startBlockValue(e);s?this.stack.push(s):(yield*this.pop(),yield*this.step())}else{const s=this.peek(2);if(s.type==="block-map"&&(this.type==="map-value-ind"&&s.indent===e.indent||this.type==="newline"&&!s.items[s.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&s.type!=="flow-collection"){const i=Mt(s),r=ze(i);bs(e);const o=e.end.splice(1,e.end.length);o.push(this.sourceToken);const a={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:r,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const n=Mt(e),s=ze(n);return s.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s}]}}case"map-value-ind":{this.onKeyLine=!0;const n=Mt(e),s=ze(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,n){return this.type!=="comment"||this.indent<=n?!1:e.every(s=>s.type==="newline"||s.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function Ai(t){const e=t.prettyErrors!==!1;return{lineCounter:t.lineCounter||e&&new Ti||null,prettyErrors:e}}function uo(t,e={}){const{lineCounter:n,prettyErrors:s}=Ai(e),i=new Xn(n?.addNewLine),r=new zn(e),o=Array.from(r.compose(i.parse(t)));if(s&&n)for(const a of o)a.errors.forEach(Kt(t,n)),a.warnings.forEach(Kt(t,n));return o.length>0?o:Object.assign([],{empty:!0},r.streamInfo())}function Ei(t,e={}){const{lineCounter:n,prettyErrors:s}=Ai(e),i=new Xn(n?.addNewLine),r=new zn(e);let o=null;for(const a of r.compose(i.parse(t),!0,t.length))if(!o)o=a;else if(o.options.logLevel!=="silent"){o.errors.push(new Ke(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return s&&n&&(o.errors.forEach(Kt(t,n)),o.warnings.forEach(Kt(t,n))),o}function fo(t,e,n){let s;typeof e=="function"?s=e:n===void 0&&e&&typeof e=="object"&&(n=e);const i=Ei(t,n);if(!i)return null;if(i.warnings.forEach(r=>Js(i.options.logLevel,r)),i.errors.length>0){if(i.options.logLevel!=="silent")throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:s},n))}function vi(t,e,n){let s=null;if(typeof e=="function"||Array.isArray(e)?s=e:n===void 0&&e&&(n=e),typeof n=="string"&&(n=n.length),typeof n=="number"){const i=Math.round(n);n=i<1?void 0:i>8?{indent:8}:{indent:i}}if(t===void 0){const{keepUndefined:i}=n??e??{};if(!i)return}return new mt(t,s,n).toString(n)}const ho=Object.freeze(Object.defineProperty({__proto__:null,Alias:Yt,CST:ao,Composer:zn,Document:mt,Lexer:Ni,LineCounter:Ti,Pair:le,Parser:Xn,Scalar:H,Schema:on,YAMLError:Gn,YAMLMap:me,YAMLParseError:Ke,YAMLSeq:Ve,YAMLWarning:fi,isAlias:Ge,isCollection:ee,isDocument:ut,isMap:ft,isNode:te,isPair:Q,isScalar:Z,isSeq:ht,parse:fo,parseAllDocuments:uo,parseDocument:Ei,stringify:vi,visit:He,visitAsync:Gt},Symbol.toStringTag,{value:"Module"}));function po(t){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(t))}function _i(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}function mo(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Ci(t){return Object.prototype.toString.call(t)==="[object Map]"}function go(t){return Object.prototype.toString.call(t)==="[object Date]"}function ge(t,e){return JSON.stringify(t,(n,s)=>typeof s=="bigint"?{$numberLong:`${s}`}:Ci(s)?Object.fromEntries(s):s)}function yo(t){if(t!=null&&typeof t=="object"&&"stylize"in t&&typeof t.stylize=="function")return t.stylize}const Zn=6,$i=2147483647,Ii=-2147483648,Bi=Math.pow(2,63)-1,Li=-Math.pow(2,63),bo=Math.pow(2,53),wo=-Math.pow(2,53),Mi=4;class R extends Error{get bsonError(){return!0}get name(){return"BSONError"}constructor(e,n){super(e,n)}static isBSONError(e){return e!=null&&typeof e=="object"&&"bsonError"in e&&e.bsonError===!0&&"name"in e&&"message"in e&&"stack"in e}}class So extends R{get name(){return"BSONVersionError"}constructor(){super(`Unsupported BSON version, bson types must be from bson ${Zn}.x.x`)}}class ws extends R{get name(){return"BSONRuntimeError"}constructor(e){super(e)}}const ko=128,No=192,To=224,Oo=240,Ao=248,Eo=192,vo=224,_o=240,Co=128;function $o(t,e,n){let s=0;for(let i=e;i<n;i+=1){const r=t[i];if(s){if((r&No)!==Co)return!1;s-=1}else if(r&ko)if((r&To)===Eo)s=1;else if((r&Oo)===vo)s=2;else if((r&Ao)===_o)s=3;else return!1}return!s}function Pi(t,e,n){if(t.length===0)return"";const s=n-e;if(s===0)return"";if(s>20)return null;if(s===1&&t[e]<128)return String.fromCharCode(t[e]);if(s===2&&t[e]<128&&t[e+1]<128)return String.fromCharCode(t[e])+String.fromCharCode(t[e+1]);if(s===3&&t[e]<128&&t[e+1]<128&&t[e+2]<128)return String.fromCharCode(t[e])+String.fromCharCode(t[e+1])+String.fromCharCode(t[e+2]);const i=[];for(let r=e;r<n;r++){const o=t[r];if(o>127)return null;i.push(o)}return String.fromCharCode(...i)}function Io(t){return Re.fromNumberArray(Array.from({length:t},()=>Math.floor(Math.random()*256)))}const Bo=await(async()=>{try{return(await Xi(()=>import("./__vite-browser-external-XPXQPciS.js"),__vite__mapDeps([]))).randomBytes}catch{return Io}})(),Re={toLocalBufferType(t){if(Buffer.isBuffer(t))return t;if(ArrayBuffer.isView(t))return Buffer.from(t.buffer,t.byteOffset,t.byteLength);const e=t?.[Symbol.toStringTag]??Object.prototype.toString.call(t);if(e==="ArrayBuffer"||e==="SharedArrayBuffer"||e==="[object ArrayBuffer]"||e==="[object SharedArrayBuffer]")return Buffer.from(t);throw new R(`Cannot create Buffer from ${String(t)}`)},allocate(t){return Buffer.alloc(t)},equals(t,e){return Re.toLocalBufferType(t).equals(e)},fromNumberArray(t){return Buffer.from(t)},fromBase64(t){return Buffer.from(t,"base64")},toBase64(t){return Re.toLocalBufferType(t).toString("base64")},fromISO88591(t){return Buffer.from(t,"binary")},toISO88591(t){return Re.toLocalBufferType(t).toString("binary")},fromHex(t){return Buffer.from(t,"hex")},toHex(t){return Re.toLocalBufferType(t).toString("hex")},fromUTF8(t){return Buffer.from(t,"utf8")},toUTF8(t,e,n,s){const i=n-e<=20?Pi(t,e,n):null;if(i!=null)return i;const r=Re.toLocalBufferType(t).toString("utf8",e,n);if(s){for(let o=0;o<r.length;o++)if(r.charCodeAt(o)===65533){if(!$o(t,e,n))throw new R("Invalid UTF-8 string in BSON document");break}}return r},utf8ByteLength(t){return Buffer.byteLength(t,"utf8")},encodeUTF8Into(t,e,n){return Re.toLocalBufferType(t).write(e,n,void 0,"utf8")},randomBytes:Bo};function Lo(){const{navigator:t}=globalThis;return typeof t=="object"&&t.product==="ReactNative"}function Mo(t){if(t<0)throw new RangeError(`The argument 'byteLength' is invalid. Received ${t}`);return rt.fromNumberArray(Array.from({length:t},()=>Math.floor(Math.random()*256)))}const Po=(()=>{const{crypto:t}=globalThis;if(t!=null&&typeof t.getRandomValues=="function")return e=>t.getRandomValues(rt.allocate(e));if(Lo()){const{console:e}=globalThis;e?.warn?.("BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.")}return Mo})(),Ss=/(\d|[a-f])/i,rt={toLocalBufferType(t){const e=t?.[Symbol.toStringTag]??Object.prototype.toString.call(t);if(e==="Uint8Array")return t;if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength));if(e==="ArrayBuffer"||e==="SharedArrayBuffer"||e==="[object ArrayBuffer]"||e==="[object SharedArrayBuffer]")return new Uint8Array(t);throw new R(`Cannot make a Uint8Array from ${String(t)}`)},allocate(t){if(typeof t!="number")throw new TypeError(`The "size" argument must be of type number. Received ${String(t)}`);return new Uint8Array(t)},equals(t,e){if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.byteLength;n++)if(t[n]!==e[n])return!1;return!0},fromNumberArray(t){return Uint8Array.from(t)},fromBase64(t){return Uint8Array.from(atob(t),e=>e.charCodeAt(0))},toBase64(t){return btoa(rt.toISO88591(t))},fromISO88591(t){return Uint8Array.from(t,e=>e.charCodeAt(0)&255)},toISO88591(t){return Array.from(Uint16Array.from(t),e=>String.fromCharCode(e)).join("")},fromHex(t){const e=t.length%2===0?t:t.slice(0,t.length-1),n=[];for(let s=0;s<e.length;s+=2){const i=e[s],r=e[s+1];if(!Ss.test(i)||!Ss.test(r))break;const o=Number.parseInt(`${i}${r}`,16);n.push(o)}return Uint8Array.from(n)},toHex(t){return Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")},fromUTF8(t){return new TextEncoder().encode(t)},toUTF8(t,e,n,s){const i=n-e<=20?Pi(t,e,n):null;if(i!=null)return i;if(s)try{return new TextDecoder("utf8",{fatal:s}).decode(t.slice(e,n))}catch(r){throw new R("Invalid UTF-8 string in BSON document",{cause:r})}return new TextDecoder("utf8",{fatal:s}).decode(t.slice(e,n))},utf8ByteLength(t){return rt.fromUTF8(t).byteLength},encodeUTF8Into(t,e,n){const s=rt.fromUTF8(e);return t.set(s,n),s.byteLength},randomBytes:Po},Do=typeof Buffer=="function"&&Buffer.prototype?._isBuffer!==!0,D=Do?Re:rt;class Tn extends DataView{static fromUint8Array(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}}class ke{get[Symbol.for("@@mdb.bson.version")](){return Zn}[Symbol.for("nodejs.util.inspect.custom")](e,n,s){return this.inspect(e,n,s)}}class X extends ke{get _bsontype(){return"Binary"}constructor(e,n){if(super(),e!=null&&typeof e=="string"&&!ArrayBuffer.isView(e)&&!po(e)&&!Array.isArray(e))throw new R("Binary can only be constructed from Uint8Array or number[]");this.sub_type=n??X.BSON_BINARY_SUBTYPE_DEFAULT,e==null?(this.buffer=D.allocate(X.BUFFER_SIZE),this.position=0):(this.buffer=Array.isArray(e)?D.fromNumberArray(e):D.toLocalBufferType(e),this.position=this.buffer.byteLength)}put(e){if(typeof e=="string"&&e.length!==1)throw new R("only accepts single character String");if(typeof e!="number"&&e.length!==1)throw new R("only accepts single character Uint8Array or Array");let n;if(typeof e=="string"?n=e.charCodeAt(0):typeof e=="number"?n=e:n=e[0],n<0||n>255)throw new R("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.byteLength>this.position)this.buffer[this.position++]=n;else{const s=D.allocate(X.BUFFER_SIZE+this.buffer.length);s.set(this.buffer,0),this.buffer=s,this.buffer[this.position++]=n}}write(e,n){if(n=typeof n=="number"?n:this.position,this.buffer.byteLength<n+e.length){const s=D.allocate(this.buffer.byteLength+e.length);s.set(this.buffer,0),this.buffer=s}if(ArrayBuffer.isView(e))this.buffer.set(D.toLocalBufferType(e),n),this.position=n+e.byteLength>this.position?n+e.length:this.position;else if(typeof e=="string")throw new R("input cannot be string")}read(e,n){return n=n&&n>0?n:this.position,this.buffer.slice(e,e+n)}value(){return this.buffer.length===this.position?this.buffer:this.buffer.subarray(0,this.position)}length(){return this.position}toJSON(){return D.toBase64(this.buffer)}toString(e){return e==="hex"?D.toHex(this.buffer):e==="base64"?D.toBase64(this.buffer):e==="utf8"||e==="utf-8"?D.toUTF8(this.buffer,0,this.buffer.byteLength,!1):D.toUTF8(this.buffer,0,this.buffer.byteLength,!1)}toExtendedJSON(e){e=e||{};const n=D.toBase64(this.buffer),s=Number(this.sub_type).toString(16);return e.legacy?{$binary:n,$type:s.length===1?"0"+s:s}:{$binary:{base64:n,subType:s.length===1?"0"+s:s}}}toUUID(){if(this.sub_type===X.SUBTYPE_UUID)return new he(this.buffer.slice(0,this.position));throw new R(`Binary sub_type "${this.sub_type}" is not supported for converting to UUID. Only "${X.SUBTYPE_UUID}" is currently supported.`)}static createFromHexString(e,n){return new X(D.fromHex(e),n)}static createFromBase64(e,n){return new X(D.fromBase64(e),n)}static fromExtendedJSON(e,n){n=n||{};let s,i;if("$binary"in e?n.legacy&&typeof e.$binary=="string"&&"$type"in e?(i=e.$type?parseInt(e.$type,16):0,s=D.fromBase64(e.$binary)):typeof e.$binary!="string"&&(i=e.$binary.subType?parseInt(e.$binary.subType,16):0,s=D.fromBase64(e.$binary.base64)):"$uuid"in e&&(i=4,s=he.bytesFromString(e.$uuid)),!s)throw new R(`Unexpected Binary Extended JSON format ${JSON.stringify(e)}`);return i===Mi?new he(s):new X(s,i)}inspect(e,n,s){s??=ge;const i=D.toBase64(this.buffer.subarray(0,this.position)),r=s(i,n),o=s(this.sub_type,n);return`Binary.createFromBase64(${r}, ${o})`}}X.BSON_BINARY_SUBTYPE_DEFAULT=0;X.BUFFER_SIZE=256;X.SUBTYPE_DEFAULT=0;X.SUBTYPE_FUNCTION=1;X.SUBTYPE_BYTE_ARRAY=2;X.SUBTYPE_UUID_OLD=3;X.SUBTYPE_UUID=4;X.SUBTYPE_MD5=5;X.SUBTYPE_ENCRYPTED=6;X.SUBTYPE_COLUMN=7;X.SUBTYPE_USER_DEFINED=128;const On=16,Ro=/^[0-9A-F]{32}$/i,jo=/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i;class he extends X{constructor(e){let n;if(e==null)n=he.generate();else if(e instanceof he)n=D.toLocalBufferType(new Uint8Array(e.buffer));else if(ArrayBuffer.isView(e)&&e.byteLength===On)n=D.toLocalBufferType(e);else if(typeof e=="string")n=he.bytesFromString(e);else throw new R("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");super(n,Mi)}get id(){return this.buffer}set id(e){this.buffer=e}toHexString(e=!0){return e?[D.toHex(this.buffer.subarray(0,4)),D.toHex(this.buffer.subarray(4,6)),D.toHex(this.buffer.subarray(6,8)),D.toHex(this.buffer.subarray(8,10)),D.toHex(this.buffer.subarray(10,16))].join("-"):D.toHex(this.buffer)}toString(e){return e==="hex"?D.toHex(this.id):e==="base64"?D.toBase64(this.id):this.toHexString()}toJSON(){return this.toHexString()}equals(e){if(!e)return!1;if(e instanceof he)return D.equals(e.id,this.id);try{return D.equals(new he(e).id,this.id)}catch{return!1}}toBinary(){return new X(this.id,X.SUBTYPE_UUID)}static generate(){const e=D.randomBytes(On);return e[6]=e[6]&15|64,e[8]=e[8]&63|128,e}static isValid(e){return e?typeof e=="string"?he.isValidUUIDString(e):_i(e)?e.byteLength===On:e._bsontype==="Binary"&&e.sub_type===this.SUBTYPE_UUID&&e.buffer.byteLength===16:!1}static createFromHexString(e){const n=he.bytesFromString(e);return new he(n)}static createFromBase64(e){return new he(D.fromBase64(e))}static bytesFromString(e){if(!he.isValidUUIDString(e))throw new R("UUID string representation must be 32 hex digits or canonical hyphenated representation");return D.fromHex(e.replace(/-/g,""))}static isValidUUIDString(e){return Ro.test(e)||jo.test(e)}inspect(e,n,s){return s??=ge,`new UUID(${s(this.toHexString(),n)})`}}class _t extends ke{get _bsontype(){return"Code"}constructor(e,n){super(),this.code=e.toString(),this.scope=n??null}toJSON(){return this.scope!=null?{code:this.code,scope:this.scope}:{code:this.code}}toExtendedJSON(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}static fromExtendedJSON(e){return new _t(e.$code,e.$scope)}inspect(e,n,s){s??=ge;let i=s(this.code,n);const r=i.includes(`
`);this.scope!=null&&(i+=`,${r?`
`:" "}${s(this.scope,n)}`);const o=r&&this.scope===null;return`new Code(${r?`
`:""}${i}${o?`
`:""})`}}function Fo(t){return t!=null&&typeof t=="object"&&"$id"in t&&t.$id!=null&&"$ref"in t&&typeof t.$ref=="string"&&(!("$db"in t)||"$db"in t&&typeof t.$db=="string")}class lt extends ke{get _bsontype(){return"DBRef"}constructor(e,n,s,i){super();const r=e.split(".");r.length===2&&(s=r.shift(),e=r.shift()),this.collection=e,this.oid=n,this.db=s,this.fields=i||{}}get namespace(){return this.collection}set namespace(e){this.collection=e}toJSON(){const e=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(e.$db=this.db),e}toExtendedJSON(e){e=e||{};let n={$ref:this.collection,$id:this.oid};return e.legacy||(this.db&&(n.$db=this.db),n=Object.assign(n,this.fields)),n}static fromExtendedJSON(e){const n=Object.assign({},e);return delete n.$ref,delete n.$id,delete n.$db,new lt(e.$ref,e.$id,e.$db,n)}inspect(e,n,s){s??=ge;const i=[s(this.namespace,n),s(this.oid,n),...this.db?[s(this.db,n)]:[],...Object.keys(this.fields).length>0?[s(this.fields,n)]:[]];return i[1]=s===ge?`new ObjectId(${i[1]})`:i[1],`new DBRef(${i.join(", ")})`}}let be;try{be=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}const ks=65536,Uo=1<<24,nt=ks*ks,Di=nt*nt,Ns=Di/2,Ts={},Os={},Ho=20,Vo=/^(\+?0|(\+|-)?[1-9][0-9]*)$/;class f extends ke{get _bsontype(){return"Long"}get __isLong__(){return!0}constructor(e=0,n,s){super(),typeof e=="bigint"?Object.assign(this,f.fromBigInt(e,!!n)):typeof e=="string"?Object.assign(this,f.fromString(e,!!n)):(this.low=e|0,this.high=n|0,this.unsigned=!!s)}static fromBits(e,n,s){return new f(e,n,s)}static fromInt(e,n){let s,i,r;return n?(e>>>=0,(r=0<=e&&e<256)&&(i=Os[e],i)?i:(s=f.fromBits(e,(e|0)<0?-1:0,!0),r&&(Os[e]=s),s)):(e|=0,(r=-128<=e&&e<128)&&(i=Ts[e],i)?i:(s=f.fromBits(e,e<0?-1:0,!1),r&&(Ts[e]=s),s))}static fromNumber(e,n){if(isNaN(e))return n?f.UZERO:f.ZERO;if(n){if(e<0)return f.UZERO;if(e>=Di)return f.MAX_UNSIGNED_VALUE}else{if(e<=-Ns)return f.MIN_VALUE;if(e+1>=Ns)return f.MAX_VALUE}return e<0?f.fromNumber(-e,n).neg():f.fromBits(e%nt|0,e/nt|0,n)}static fromBigInt(e,n){return f.fromString(e.toString(),n)}static fromString(e,n,s){if(e.length===0)throw new R("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return f.ZERO;if(typeof n=="number"?(s=n,n=!1):n=!!n,s=s||10,s<2||36<s)throw new R("radix");let i;if((i=e.indexOf("-"))>0)throw new R("interior hyphen");if(i===0)return f.fromString(e.substring(1),n,s).neg();const r=f.fromNumber(Math.pow(s,8));let o=f.ZERO;for(let a=0;a<e.length;a+=8){const l=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+l),s);if(l<8){const h=f.fromNumber(Math.pow(s,l));o=o.mul(h).add(f.fromNumber(c))}else o=o.mul(r),o=o.add(f.fromNumber(c))}return o.unsigned=n,o}static fromBytes(e,n,s){return s?f.fromBytesLE(e,n):f.fromBytesBE(e,n)}static fromBytesLE(e,n){return new f(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)}static fromBytesBE(e,n){return new f(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)}static isLong(e){return e!=null&&typeof e=="object"&&"__isLong__"in e&&e.__isLong__===!0}static fromValue(e,n){return typeof e=="number"?f.fromNumber(e,n):typeof e=="string"?f.fromString(e,n):f.fromBits(e.low,e.high,typeof n=="boolean"?n:e.unsigned)}add(e){f.isLong(e)||(e=f.fromValue(e));const n=this.high>>>16,s=this.high&65535,i=this.low>>>16,r=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535;let h=0,u=0,d=0,m=0;return m+=r+c,d+=m>>>16,m&=65535,d+=i+l,u+=d>>>16,d&=65535,u+=s+a,h+=u>>>16,u&=65535,h+=n+o,h&=65535,f.fromBits(d<<16|m,h<<16|u,this.unsigned)}and(e){return f.isLong(e)||(e=f.fromValue(e)),f.fromBits(this.low&e.low,this.high&e.high,this.unsigned)}compare(e){if(f.isLong(e)||(e=f.fromValue(e)),this.eq(e))return 0;const n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1}comp(e){return this.compare(e)}divide(e){if(f.isLong(e)||(e=f.fromValue(e)),e.isZero())throw new R("division by zero");if(be){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;const r=(this.unsigned?be.div_u:be.div_s)(this.low,this.high,e.low,e.high);return f.fromBits(r,be.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?f.UZERO:f.ZERO;let n,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return f.UZERO;if(e.gt(this.shru(1)))return f.UONE;i=f.UZERO}else{if(this.eq(f.MIN_VALUE))return e.eq(f.ONE)||e.eq(f.NEG_ONE)?f.MIN_VALUE:e.eq(f.MIN_VALUE)?f.ONE:(n=this.shr(1).div(e).shl(1),n.eq(f.ZERO)?e.isNegative()?f.ONE:f.NEG_ONE:(s=this.sub(e.mul(n)),i=n.add(s.div(e)),i));if(e.eq(f.MIN_VALUE))return this.unsigned?f.UZERO:f.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=f.ZERO}for(s=this;s.gte(e);){n=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));const r=Math.ceil(Math.log(n)/Math.LN2),o=r<=48?1:Math.pow(2,r-48);let a=f.fromNumber(n),l=a.mul(e);for(;l.isNegative()||l.gt(s);)n-=o,a=f.fromNumber(n,this.unsigned),l=a.mul(e);a.isZero()&&(a=f.ONE),i=i.add(a),s=s.sub(l)}return i}div(e){return this.divide(e)}equals(e){return f.isLong(e)||(e=f.fromValue(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low}eq(e){return this.equals(e)}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative())return this.eq(f.MIN_VALUE)?64:this.neg().getNumBitsAbs();const e=this.high!==0?this.high:this.low;let n;for(n=31;n>0&&!(e&1<<n);n--);return this.high!==0?n+33:n+1}greaterThan(e){return this.comp(e)>0}gt(e){return this.greaterThan(e)}greaterThanOrEqual(e){return this.comp(e)>=0}gte(e){return this.greaterThanOrEqual(e)}ge(e){return this.greaterThanOrEqual(e)}isEven(){return(this.low&1)===0}isNegative(){return!this.unsigned&&this.high<0}isOdd(){return(this.low&1)===1}isPositive(){return this.unsigned||this.high>=0}isZero(){return this.high===0&&this.low===0}lessThan(e){return this.comp(e)<0}lt(e){return this.lessThan(e)}lessThanOrEqual(e){return this.comp(e)<=0}lte(e){return this.lessThanOrEqual(e)}modulo(e){if(f.isLong(e)||(e=f.fromValue(e)),be){const n=(this.unsigned?be.rem_u:be.rem_s)(this.low,this.high,e.low,e.high);return f.fromBits(n,be.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))}mod(e){return this.modulo(e)}rem(e){return this.modulo(e)}multiply(e){if(this.isZero())return f.ZERO;if(f.isLong(e)||(e=f.fromValue(e)),be){const C=be.mul(this.low,this.high,e.low,e.high);return f.fromBits(C,be.get_high(),this.unsigned)}if(e.isZero())return f.ZERO;if(this.eq(f.MIN_VALUE))return e.isOdd()?f.MIN_VALUE:f.ZERO;if(e.eq(f.MIN_VALUE))return this.isOdd()?f.MIN_VALUE:f.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(f.TWO_PWR_24)&&e.lt(f.TWO_PWR_24))return f.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);const n=this.high>>>16,s=this.high&65535,i=this.low>>>16,r=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535;let h=0,u=0,d=0,m=0;return m+=r*c,d+=m>>>16,m&=65535,d+=i*c,u+=d>>>16,d&=65535,d+=r*l,u+=d>>>16,d&=65535,u+=s*c,h+=u>>>16,u&=65535,u+=i*l,h+=u>>>16,u&=65535,u+=r*a,h+=u>>>16,u&=65535,h+=n*c+s*l+i*a+r*o,h&=65535,f.fromBits(d<<16|m,h<<16|u,this.unsigned)}mul(e){return this.multiply(e)}negate(){return!this.unsigned&&this.eq(f.MIN_VALUE)?f.MIN_VALUE:this.not().add(f.ONE)}neg(){return this.negate()}not(){return f.fromBits(~this.low,~this.high,this.unsigned)}notEquals(e){return!this.equals(e)}neq(e){return this.notEquals(e)}ne(e){return this.notEquals(e)}or(e){return f.isLong(e)||(e=f.fromValue(e)),f.fromBits(this.low|e.low,this.high|e.high,this.unsigned)}shiftLeft(e){return f.isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?f.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):f.fromBits(0,this.low<<e-32,this.unsigned)}shl(e){return this.shiftLeft(e)}shiftRight(e){return f.isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?f.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):f.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)}shr(e){return this.shiftRight(e)}shiftRightUnsigned(e){if(f.isLong(e)&&(e=e.toInt()),e&=63,e===0)return this;{const n=this.high;if(e<32){const s=this.low;return f.fromBits(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?f.fromBits(n,0,this.unsigned):f.fromBits(n>>>e-32,0,this.unsigned)}}shr_u(e){return this.shiftRightUnsigned(e)}shru(e){return this.shiftRightUnsigned(e)}subtract(e){return f.isLong(e)||(e=f.fromValue(e)),this.add(e.neg())}sub(e){return this.subtract(e)}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){return this.unsigned?(this.high>>>0)*nt+(this.low>>>0):this.high*nt+(this.low>>>0)}toBigInt(){return BigInt(this.toString())}toBytes(e){return e?this.toBytesLE():this.toBytesBE()}toBytesLE(){const e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]}toBytesBE(){const e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]}toSigned(){return this.unsigned?f.fromBits(this.low,this.high,!1):this}toString(e){if(e=e||10,e<2||36<e)throw new R("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(f.MIN_VALUE)){const r=f.fromNumber(e),o=this.div(r),a=o.mul(r).sub(this);return o.toString(e)+a.toInt().toString(e)}else return"-"+this.neg().toString(e);const n=f.fromNumber(Math.pow(e,6),this.unsigned);let s=this,i="";for(;;){const r=s.div(n);let a=(s.sub(r.mul(n)).toInt()>>>0).toString(e);if(s=r,s.isZero())return a+i;for(;a.length<6;)a="0"+a;i=""+a+i}}toUnsigned(){return this.unsigned?this:f.fromBits(this.low,this.high,!0)}xor(e){return f.isLong(e)||(e=f.fromValue(e)),f.fromBits(this.low^e.low,this.high^e.high,this.unsigned)}eqz(){return this.isZero()}le(e){return this.lessThanOrEqual(e)}toExtendedJSON(e){return e&&e.relaxed?this.toNumber():{$numberLong:this.toString()}}static fromExtendedJSON(e,n){const{useBigInt64:s=!1,relaxed:i=!0}={...n};if(e.$numberLong.length>Ho)throw new R("$numberLong string is too long");if(!Vo.test(e.$numberLong))throw new R(`$numberLong string "${e.$numberLong}" is in an invalid format`);if(s){const o=BigInt(e.$numberLong);return BigInt.asIntN(64,o)}const r=f.fromString(e.$numberLong);return i?r.toNumber():r}inspect(e,n,s){s??=ge;const i=s(this.toString(),n),r=this.unsigned?`, ${s(this.unsigned,n)}`:"";return`new Long(${i}${r})`}}f.TWO_PWR_24=f.fromInt(Uo);f.MAX_UNSIGNED_VALUE=f.fromBits(-1,-1,!0);f.ZERO=f.fromInt(0);f.UZERO=f.fromInt(0,!0);f.ONE=f.fromInt(1);f.UONE=f.fromInt(1,!0);f.NEG_ONE=f.fromInt(-1);f.MAX_VALUE=f.fromBits(-1,2147483647,!1);f.MIN_VALUE=f.fromBits(0,-2147483648,!1);const qo=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,xo=/^(\+|-)?(Infinity|inf)$/i,Wo=/^(\+|-)?NaN$/i,Xe=6111,wt=-6176,As=6176,Es=34,An=D.fromNumberArray([124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),vs=D.fromNumberArray([248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),_s=D.fromNumberArray([120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),Ko=/^([-+])?(\d+)?$/,Jo=31,Cs=16383,Go=30,Yo=31;function $s(t){return!isNaN(parseInt(t,10))}function zo(t){const e=f.fromNumber(1e9);let n=f.fromNumber(0);if(!t.parts[0]&&!t.parts[1]&&!t.parts[2]&&!t.parts[3])return{quotient:t,rem:n};for(let s=0;s<=3;s++)n=n.shiftLeft(32),n=n.add(new f(t.parts[s],0)),t.parts[s]=n.div(e).low,n=n.modulo(e);return{quotient:t,rem:n}}function Xo(t,e){if(!t&&!e)return{high:f.fromNumber(0),low:f.fromNumber(0)};const n=t.shiftRightUnsigned(32),s=new f(t.getLowBits(),0),i=e.shiftRightUnsigned(32),r=new f(e.getLowBits(),0);let o=n.multiply(i),a=n.multiply(r);const l=s.multiply(i);let c=s.multiply(r);return o=o.add(a.shiftRightUnsigned(32)),a=new f(a.getLowBits(),0).add(l).add(c.shiftRightUnsigned(32)),o=o.add(a.shiftRightUnsigned(32)),c=a.shiftLeft(32).add(new f(c.getLowBits(),0)),{high:o,low:c}}function Zo(t,e){const n=t.high>>>0,s=e.high>>>0;if(n<s)return!0;if(n===s){const i=t.low>>>0,r=e.low>>>0;if(i<r)return!0}return!1}function Te(t,e){throw new R(`"${t}" is not a valid Decimal128 string - ${e}`)}class pe extends ke{get _bsontype(){return"Decimal128"}constructor(e){if(super(),typeof e=="string")this.bytes=pe.fromString(e).bytes;else if(_i(e)){if(e.byteLength!==16)throw new R("Decimal128 must take a Buffer of 16 bytes");this.bytes=e}else throw new R("Decimal128 must take a Buffer or string")}static fromString(e){return pe._fromString(e,{allowRounding:!1})}static fromStringWithRounding(e){return pe._fromString(e,{allowRounding:!0})}static _fromString(e,n){let s=!1,i=!1,r=!1,o=!1,a=0,l=0,c=0,h=0,u=0;const d=[0];let m=0,C=0,p=0,b=0,I=new f(0,0),v=new f(0,0),B=0,w=0;if(e.length>=7e3)throw new R(""+e+" not a valid Decimal128 string");const L=e.match(qo),_=e.match(xo),G=e.match(Wo);if(!L&&!_&&!G||e.length===0)throw new R(""+e+" not a valid Decimal128 string");if(L){const q=L[2],z=L[4],Ee=L[5],ie=L[6];z&&ie===void 0&&Te(e,"missing exponent power"),z&&q===void 0&&Te(e,"missing exponent base"),z===void 0&&(Ee||ie)&&Te(e,"missing e before exponent")}if((e[w]==="+"||e[w]==="-")&&(i=!0,s=e[w++]==="-"),!$s(e[w])&&e[w]!=="."){if(e[w]==="i"||e[w]==="I")return new pe(s?vs:_s);if(e[w]==="N")return new pe(An)}for(;$s(e[w])||e[w]===".";){if(e[w]==="."){r&&Te(e,"contains multiple periods"),r=!0,w=w+1;continue}m<Es&&(e[w]!=="0"||o)&&(o||(u=l),o=!0,d[C++]=parseInt(e[w],10),m=m+1),o&&(c=c+1),r&&(h=h+1),l=l+1,w=w+1}if(r&&!l)throw new R(""+e+" not a valid Decimal128 string");if(e[w]==="e"||e[w]==="E"){const q=e.substr(++w).match(Ko);if(!q||!q[2])return new pe(An);b=parseInt(q[0],10),w=w+q[0].length}if(e[w])return new pe(An);if(!m)d[0]=0,c=1,m=1,a=0;else if(p=m-1,a=c,a!==1)for(;e[u+a-1+Number(i)+Number(r)]==="0";)a=a-1;for(b<=h&&h>b+16384?b=wt:b=b-h;b>Xe;){if(p=p+1,p>=Es){if(a===0){b=Xe;break}Te(e,"overflow")}b=b-1}if(n.allowRounding){for(;b<wt||m<c;){if(p===0&&a<m){b=wt,a=0;break}if(m<c?c=c-1:p=p-1,b<Xe)b=b+1;else{if(d.join("").match(/^0+$/)){b=Xe;break}Te(e,"overflow")}}if(p+1<a){let q=l;r&&(u=u+1,q=q+1),i&&(u=u+1,q=q+1);const z=parseInt(e[u+p+1],10);let Ee=0;if(z>=5&&(Ee=1,z===5)){Ee=d[p]%2===1?1:0;for(let ie=u+p+2;ie<q;ie++)if(parseInt(e[ie],10)){Ee=1;break}}if(Ee){let ie=p;for(;ie>=0&&++d[ie]>9;ie--)if(d[ie]=0,ie===0)if(b<Xe)b=b+1,d[ie]=1;else return new pe(s?vs:_s)}}}else{for(;b<wt||m<c;){if(p===0){if(a===0){b=wt;break}Te(e,"exponent underflow")}m<c?(e[c-1+Number(i)+Number(r)]!=="0"&&a!==0&&Te(e,"inexact rounding"),c=c-1):(d[p]!==0&&Te(e,"inexact rounding"),p=p-1),b<Xe?b=b+1:Te(e,"overflow")}p+1<a&&(r&&(u=u+1),i&&(u=u+1),parseInt(e[u+p+1],10)!==0&&Te(e,"inexact rounding"))}if(I=f.fromNumber(0),v=f.fromNumber(0),a===0)I=f.fromNumber(0),v=f.fromNumber(0);else if(p<17){let q=0;for(v=f.fromNumber(d[q++]),I=new f(0,0);q<=p;q++)v=v.multiply(f.fromNumber(10)),v=v.add(f.fromNumber(d[q]))}else{let q=0;for(I=f.fromNumber(d[q++]);q<=p-17;q++)I=I.multiply(f.fromNumber(10)),I=I.add(f.fromNumber(d[q]));for(v=f.fromNumber(d[q++]);q<=p;q++)v=v.multiply(f.fromNumber(10)),v=v.add(f.fromNumber(d[q]))}const W=Xo(I,f.fromString("100000000000000000"));W.low=W.low.add(v),Zo(W.low,v)&&(W.high=W.high.add(f.fromNumber(1))),B=b+As;const j={low:f.fromNumber(0),high:f.fromNumber(0)};W.high.shiftRightUnsigned(49).and(f.fromNumber(1)).equals(f.fromNumber(1))?(j.high=j.high.or(f.fromNumber(3).shiftLeft(61)),j.high=j.high.or(f.fromNumber(B).and(f.fromNumber(16383).shiftLeft(47))),j.high=j.high.or(W.high.and(f.fromNumber(0x7fffffffffff)))):(j.high=j.high.or(f.fromNumber(B&16383).shiftLeft(49)),j.high=j.high.or(W.high.and(f.fromNumber(562949953421311)))),j.low=W.low,s&&(j.high=j.high.or(f.fromString("9223372036854775808")));const Y=D.allocate(16);return w=0,Y[w++]=j.low.low&255,Y[w++]=j.low.low>>8&255,Y[w++]=j.low.low>>16&255,Y[w++]=j.low.low>>24&255,Y[w++]=j.low.high&255,Y[w++]=j.low.high>>8&255,Y[w++]=j.low.high>>16&255,Y[w++]=j.low.high>>24&255,Y[w++]=j.high.low&255,Y[w++]=j.high.low>>8&255,Y[w++]=j.high.low>>16&255,Y[w++]=j.high.low>>24&255,Y[w++]=j.high.high&255,Y[w++]=j.high.high>>8&255,Y[w++]=j.high.high>>16&255,Y[w++]=j.high.high>>24&255,new pe(Y)}toString(){let e,n=0;const s=new Array(36);for(let w=0;w<s.length;w++)s[w]=0;let i=0,r=!1,o,a={parts:[0,0,0,0]},l,c;const h=[];i=0;const u=this.bytes,d=u[i++]|u[i++]<<8|u[i++]<<16|u[i++]<<24,m=u[i++]|u[i++]<<8|u[i++]<<16|u[i++]<<24,C=u[i++]|u[i++]<<8|u[i++]<<16|u[i++]<<24,p=u[i++]|u[i++]<<8|u[i++]<<16|u[i++]<<24;i=0,{low:new f(d,m),high:new f(C,p)}.high.lessThan(f.ZERO)&&h.push("-");const I=p>>26&Jo;if(I>>3===3){if(I===Go)return h.join("")+"Infinity";if(I===Yo)return"NaN";e=p>>15&Cs,o=8+(p>>14&1)}else o=p>>14&7,e=p>>17&Cs;const v=e-As;if(a.parts[0]=(p&16383)+((o&15)<<14),a.parts[1]=C,a.parts[2]=m,a.parts[3]=d,a.parts[0]===0&&a.parts[1]===0&&a.parts[2]===0&&a.parts[3]===0)r=!0;else for(c=3;c>=0;c--){let w=0;const L=zo(a);if(a=L.quotient,w=L.rem.low,!!w)for(l=8;l>=0;l--)s[c*9+l]=w%10,w=Math.floor(w/10)}if(r)n=1,s[i]=0;else for(n=36;!s[i];)n=n-1,i=i+1;const B=n-1+v;if(B>=34||B<=-7||v>0){if(n>34)return h.push("0"),v>0?h.push(`E+${v}`):v<0&&h.push(`E${v}`),h.join("");h.push(`${s[i++]}`),n=n-1,n&&h.push(".");for(let w=0;w<n;w++)h.push(`${s[i++]}`);h.push("E"),B>0?h.push(`+${B}`):h.push(`${B}`)}else if(v>=0)for(let w=0;w<n;w++)h.push(`${s[i++]}`);else{let w=n+v;if(w>0)for(let L=0;L<w;L++)h.push(`${s[i++]}`);else h.push("0");for(h.push(".");w++<0;)h.push("0");for(let L=0;L<n-Math.max(w-1,0);L++)h.push(`${s[i++]}`)}return h.join("")}toJSON(){return{$numberDecimal:this.toString()}}toExtendedJSON(){return{$numberDecimal:this.toString()}}static fromExtendedJSON(e){return pe.fromString(e.$numberDecimal)}inspect(e,n,s){return s??=ge,`new Decimal128(${s(this.toString(),n)})`}}class Ct extends ke{get _bsontype(){return"Double"}constructor(e){super(),e instanceof Number&&(e=e.valueOf()),this.value=+e}valueOf(){return this.value}toJSON(){return this.value}toString(e){return this.value.toString(e)}toExtendedJSON(e){return e&&(e.legacy||e.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-0.0"}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}}static fromExtendedJSON(e,n){const s=parseFloat(e.$numberDouble);return n&&n.relaxed?s:new Ct(s)}inspect(e,n,s){return s??=ge,`new Double(${s(this.value,n)})`}}class $t extends ke{get _bsontype(){return"Int32"}constructor(e){super(),e instanceof Number&&(e=e.valueOf()),this.value=+e|0}valueOf(){return this.value}toString(e){return this.value.toString(e)}toJSON(){return this.value}toExtendedJSON(e){return e&&(e.relaxed||e.legacy)?this.value:{$numberInt:this.value.toString()}}static fromExtendedJSON(e,n){return n&&n.relaxed?parseInt(e.$numberInt,10):new $t(e.$numberInt)}inspect(e,n,s){return s??=ge,`new Int32(${s(this.value,n)})`}}class un extends ke{get _bsontype(){return"MaxKey"}toExtendedJSON(){return{$maxKey:1}}static fromExtendedJSON(){return new un}inspect(){return"new MaxKey()"}}class fn extends ke{get _bsontype(){return"MinKey"}toExtendedJSON(){return{$minKey:1}}static fromExtendedJSON(){return new fn}inspect(){return"new MinKey()"}}const Qo=new RegExp("^[0-9a-fA-F]{24}$");let qe=null;const $e=Symbol("id");class ne extends ke{get _bsontype(){return"ObjectId"}constructor(e){super();let n;if(typeof e=="object"&&e&&"id"in e){if(typeof e.id!="string"&&!ArrayBuffer.isView(e.id))throw new R("Argument passed in must have an id that is of type string or Buffer");"toHexString"in e&&typeof e.toHexString=="function"?n=D.fromHex(e.toHexString()):n=e.id}else n=e;if(n==null||typeof n=="number")this[$e]=ne.generate(typeof n=="number"?n:void 0);else if(ArrayBuffer.isView(n)&&n.byteLength===12)this[$e]=D.toLocalBufferType(n);else if(typeof n=="string")if(n.length===24&&Qo.test(n))this[$e]=D.fromHex(n);else throw new R("input must be a 24 character hex string, 12 byte Uint8Array, or an integer");else throw new R("Argument passed in does not match the accepted types");ne.cacheHexString&&(this.__id=D.toHex(this.id))}get id(){return this[$e]}set id(e){this[$e]=e,ne.cacheHexString&&(this.__id=D.toHex(e))}toHexString(){if(ne.cacheHexString&&this.__id)return this.__id;const e=D.toHex(this.id);return ne.cacheHexString&&!this.__id&&(this.__id=e),e}static getInc(){return ne.index=(ne.index+1)%16777215}static generate(e){typeof e!="number"&&(e=Math.floor(Date.now()/1e3));const n=ne.getInc(),s=D.allocate(12);return Tn.fromUint8Array(s).setUint32(0,e,!1),qe===null&&(qe=D.randomBytes(5)),s[4]=qe[0],s[5]=qe[1],s[6]=qe[2],s[7]=qe[3],s[8]=qe[4],s[11]=n&255,s[10]=n>>8&255,s[9]=n>>16&255,s}toString(e){return e==="base64"?D.toBase64(this.id):e==="hex"?this.toHexString():this.toHexString()}toJSON(){return this.toHexString()}static is(e){return e!=null&&typeof e=="object"&&"_bsontype"in e&&e._bsontype==="ObjectId"}equals(e){if(e==null)return!1;if(ne.is(e))return this[$e][11]===e[$e][11]&&D.equals(this[$e],e[$e]);if(typeof e=="string")return e.toLowerCase()===this.toHexString();if(typeof e=="object"&&typeof e.toHexString=="function"){const n=e.toHexString(),s=this.toHexString();return typeof n=="string"&&n.toLowerCase()===s}return!1}getTimestamp(){const e=new Date,n=Tn.fromUint8Array(this.id).getUint32(0,!1);return e.setTime(Math.floor(n)*1e3),e}static createPk(){return new ne}static createFromTime(e){const n=D.fromNumberArray([0,0,0,0,0,0,0,0,0,0,0,0]);return Tn.fromUint8Array(n).setUint32(0,e,!1),new ne(n)}static createFromHexString(e){if(e?.length!==24)throw new R("hex string must be 24 characters");return new ne(D.fromHex(e))}static createFromBase64(e){if(e?.length!==16)throw new R("base64 string must be 16 characters");return new ne(D.fromBase64(e))}static isValid(e){if(e==null)return!1;try{return new ne(e),!0}catch{return!1}}toExtendedJSON(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}static fromExtendedJSON(e){return new ne(e.$oid)}inspect(e,n,s){return s??=ge,`new ObjectId(${s(this.toHexString(),n)})`}}ne.index=Math.floor(Math.random()*16777215);function ea(t){return t.split("").sort().join("")}class Pe extends ke{get _bsontype(){return"BSONRegExp"}constructor(e,n){if(super(),this.pattern=e,this.options=ea(n??""),this.pattern.indexOf("\0")!==-1)throw new R(`BSON Regex patterns cannot contain null bytes, found: ${JSON.stringify(this.pattern)}`);if(this.options.indexOf("\0")!==-1)throw new R(`BSON Regex options cannot contain null bytes, found: ${JSON.stringify(this.options)}`);for(let s=0;s<this.options.length;s++)if(!(this.options[s]==="i"||this.options[s]==="m"||this.options[s]==="x"||this.options[s]==="l"||this.options[s]==="s"||this.options[s]==="u"))throw new R(`The regular expression option [${this.options[s]}] is not supported`)}static parseOptions(e){return e?e.split("").sort().join(""):""}toExtendedJSON(e){return e=e||{},e.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}}static fromExtendedJSON(e){if("$regex"in e)if(typeof e.$regex!="string"){if(e.$regex._bsontype==="BSONRegExp")return e}else return new Pe(e.$regex,Pe.parseOptions(e.$options));if("$regularExpression"in e)return new Pe(e.$regularExpression.pattern,Pe.parseOptions(e.$regularExpression.options));throw new R(`Unexpected BSONRegExp EJSON object form: ${JSON.stringify(e)}`)}inspect(e,n,s){const i=yo(n)??(a=>a);s??=ge;const r=i(s(this.pattern),"regexp"),o=i(s(this.options),"regexp");return`new BSONRegExp(${r}, ${o})`}}class hn extends ke{get _bsontype(){return"BSONSymbol"}constructor(e){super(),this.value=e}valueOf(){return this.value}toString(){return this.value}toJSON(){return this.value}toExtendedJSON(){return{$symbol:this.value}}static fromExtendedJSON(e){return new hn(e.$symbol)}inspect(e,n,s){return s??=ge,`new BSONSymbol(${s(this.value,n)})`}}const ta=f;class Le extends ta{get _bsontype(){return"Timestamp"}constructor(e){if(e==null)super(0,0,!0);else if(typeof e=="bigint")super(e,!0);else if(f.isLong(e))super(e.low,e.high,!0);else if(typeof e=="object"&&"t"in e&&"i"in e){if(typeof e.t!="number"&&(typeof e.t!="object"||e.t._bsontype!=="Int32"))throw new R("Timestamp constructed from { t, i } must provide t as a number");if(typeof e.i!="number"&&(typeof e.i!="object"||e.i._bsontype!=="Int32"))throw new R("Timestamp constructed from { t, i } must provide i as a number");const n=Number(e.t),s=Number(e.i);if(n<0||Number.isNaN(n))throw new R("Timestamp constructed from { t, i } must provide a positive t");if(s<0||Number.isNaN(s))throw new R("Timestamp constructed from { t, i } must provide a positive i");if(n>4294967295)throw new R("Timestamp constructed from { t, i } must provide t equal or less than uint32 max");if(s>4294967295)throw new R("Timestamp constructed from { t, i } must provide i equal or less than uint32 max");super(s,n,!0)}else throw new R("A Timestamp can only be constructed with: bigint, Long, or { t: number; i: number }")}toJSON(){return{$timestamp:this.toString()}}static fromInt(e){return new Le(f.fromInt(e,!0))}static fromNumber(e){return new Le(f.fromNumber(e,!0))}static fromBits(e,n){return new Le({i:e,t:n})}static fromString(e,n){return new Le(f.fromString(e,!0,n))}toExtendedJSON(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}static fromExtendedJSON(e){const n=f.isLong(e.$timestamp.i)?e.$timestamp.i.getLowBitsUnsigned():e.$timestamp.i,s=f.isLong(e.$timestamp.t)?e.$timestamp.t.getLowBitsUnsigned():e.$timestamp.t;return new Le({t:s,i:n})}inspect(e,n,s){s??=ge;const i=s(this.high>>>0,n),r=s(this.low>>>0,n);return`new Timestamp({ t: ${i}, i: ${r} })`}}Le.MAX_VALUE=f.MAX_UNSIGNED_VALUE;f.fromNumber(bo);f.fromNumber(wo);const Ri=new DataView(new ArrayBuffer(8),0,8);new Uint8Array(Ri.buffer,0,4);new Uint8Array(Ri.buffer,0,8);function na(t){return t!=null&&typeof t=="object"&&"_bsontype"in t&&typeof t._bsontype=="string"}const sa={$oid:ne,$binary:X,$uuid:X,$symbol:hn,$numberInt:$t,$numberDecimal:pe,$numberDouble:Ct,$numberLong:f,$minKey:fn,$maxKey:un,$regex:Pe,$regularExpression:Pe,$timestamp:Le};function ji(t,e={}){if(typeof t=="number"){const s=t<=$i&&t>=Ii,i=t<=Bi&&t>=Li;if(e.relaxed||e.legacy)return t;if(Number.isInteger(t)&&!Object.is(t,-0)){if(s)return new $t(t);if(i)return e.useBigInt64?BigInt(t):f.fromNumber(t)}return new Ct(t)}if(t==null||typeof t!="object")return t;if(t.$undefined)return null;const n=Object.keys(t).filter(s=>s.startsWith("$")&&t[s]!=null);for(let s=0;s<n.length;s++){const i=sa[n[s]];if(i)return i.fromExtendedJSON(t,e)}if(t.$date!=null){const s=t.$date,i=new Date;if(e.legacy)if(typeof s=="number")i.setTime(s);else if(typeof s=="string")i.setTime(Date.parse(s));else if(typeof s=="bigint")i.setTime(Number(s));else throw new ws(`Unrecognized type for EJSON date: ${typeof s}`);else if(typeof s=="string")i.setTime(Date.parse(s));else if(f.isLong(s))i.setTime(s.toNumber());else if(typeof s=="number"&&e.relaxed)i.setTime(s);else if(typeof s=="bigint")i.setTime(Number(s));else throw new ws(`Unrecognized type for EJSON date: ${typeof s}`);return i}if(t.$code!=null){const s=Object.assign({},t);return t.$scope&&(s.$scope=ji(t.$scope)),_t.fromExtendedJSON(t)}if(Fo(t)||t.$dbPointer){const s=t.$ref?t:t.$dbPointer;if(s instanceof lt)return s;const i=Object.keys(s).filter(o=>o.startsWith("$"));let r=!0;if(i.forEach(o=>{["$ref","$id","$db"].indexOf(o)===-1&&(r=!1)}),r)return lt.fromExtendedJSON(s)}return t}function ia(t,e){return t.map((n,s)=>{e.seenObjects.push({propertyName:`index ${s}`,obj:null});try{return Be(n,e)}finally{e.seenObjects.pop()}})}function Is(t){const e=t.toISOString();return t.getUTCMilliseconds()!==0?e:e.slice(0,-5)+"Z"}function Be(t,e){if(t instanceof Map||Ci(t)){const n=Object.create(null);for(const[s,i]of t){if(typeof s!="string")throw new R("Can only serialize maps with string keys");n[s]=i}return Be(n,e)}if((typeof t=="object"||typeof t=="function")&&t!==null){const n=e.seenObjects.findIndex(s=>s.obj===t);if(n!==-1){const s=e.seenObjects.map(h=>h.propertyName),i=s.slice(0,n).map(h=>`${h} -> `).join(""),r=s[n],o=" -> "+s.slice(n+1,s.length-1).map(h=>`${h} -> `).join(""),a=s[s.length-1],l=" ".repeat(i.length+r.length/2),c="-".repeat(o.length+(r.length+a.length)/2-1);throw new R(`Converting circular structure to EJSON:
    ${i}${r}${o}${a}
    ${l}\\${c}/`)}e.seenObjects[e.seenObjects.length-1].obj=t}if(Array.isArray(t))return ia(t,e);if(t===void 0)return null;if(t instanceof Date||go(t)){const n=t.getTime(),s=n>-1&&n<2534023188e5;return e.legacy?e.relaxed&&s?{$date:t.getTime()}:{$date:Is(t)}:e.relaxed&&s?{$date:Is(t)}:{$date:{$numberLong:t.getTime().toString()}}}if(typeof t=="number"&&(!e.relaxed||!isFinite(t))){if(Number.isInteger(t)&&!Object.is(t,-0)){if(t>=Ii&&t<=$i)return{$numberInt:t.toString()};if(t>=Li&&t<=Bi)return{$numberLong:t.toString()}}return{$numberDouble:Object.is(t,-0)?"-0.0":t.toString()}}if(typeof t=="bigint")return e.relaxed?Number(BigInt.asIntN(64,t)):{$numberLong:BigInt.asIntN(64,t).toString()};if(t instanceof RegExp||mo(t)){let n=t.flags;if(n===void 0){const i=t.toString().match(/[gimuy]*$/);i&&(n=i[0])}return new Pe(t.source,n).toExtendedJSON(e)}return t!=null&&typeof t=="object"?oa(t,e):t}const ra={Binary:t=>new X(t.value(),t.sub_type),Code:t=>new _t(t.code,t.scope),DBRef:t=>new lt(t.collection||t.namespace,t.oid,t.db,t.fields),Decimal128:t=>new pe(t.bytes),Double:t=>new Ct(t.value),Int32:t=>new $t(t.value),Long:t=>f.fromBits(t.low!=null?t.low:t.low_,t.low!=null?t.high:t.high_,t.low!=null?t.unsigned:t.unsigned_),MaxKey:()=>new un,MinKey:()=>new fn,ObjectId:t=>new ne(t),BSONRegExp:t=>new Pe(t.pattern,t.options),BSONSymbol:t=>new hn(t.value),Timestamp:t=>Le.fromBits(t.low,t.high)};function oa(t,e){if(t==null||typeof t!="object")throw new R("not an object instance");const n=t._bsontype;if(typeof n>"u"){const s={};for(const i of Object.keys(t)){e.seenObjects.push({propertyName:i,obj:null});try{const r=Be(t[i],e);i==="__proto__"?Object.defineProperty(s,i,{value:r,writable:!0,enumerable:!0,configurable:!0}):s[i]=r}finally{e.seenObjects.pop()}}return s}else{if(t!=null&&typeof t=="object"&&typeof t._bsontype=="string"&&t[Symbol.for("@@mdb.bson.version")]!==Zn)throw new So;if(na(t)){let s=t;if(typeof s.toExtendedJSON!="function"){const i=ra[t._bsontype];if(!i)throw new R("Unrecognized or invalid _bsontype: "+t._bsontype);s=i(s)}return n==="Code"&&s.scope?s=new _t(s.code,Be(s.scope,e)):n==="DBRef"&&s.oid&&(s=new lt(Be(s.collection,e),Be(s.oid,e),Be(s.db,e),Be(s.fields,e))),s.toExtendedJSON(e)}else throw new R("_bsontype must be a string, but was: "+typeof n)}}function Fi(t,e){const n={useBigInt64:e?.useBigInt64??!1,relaxed:e?.relaxed??!0,legacy:e?.legacy??!1};return JSON.parse(t,(s,i)=>{if(s.indexOf("\0")!==-1)throw new R(`BSON Document field names cannot contain null bytes, found: ${JSON.stringify(s)}`);return ji(i,n)})}function Ui(t,e,n,s){n!=null&&typeof n=="object"&&(s=n,n=0),e!=null&&typeof e=="object"&&!Array.isArray(e)&&(s=e,e=void 0,n=0);const i=Object.assign({relaxed:!0,legacy:!1},s,{seenObjects:[{propertyName:"(root)",obj:null}]}),r=Be(t,i);return JSON.stringify(r,e,n)}function aa(t,e){return e=e||{},JSON.parse(Ui(t,e))}function la(t,e){return e=e||{},Fi(JSON.stringify(t),e)}const It=Object.create(null);It.parse=Fi;It.stringify=Ui;It.serialize=aa;It.deserialize=la;Object.freeze(It);const ca=1024*1024*17;D.allocate(ca);const du={description:{name:"New Creature",isProperNoun:!1,description:"",image:"",faction:"",environment:"",alignment:"Unaligned",cr:0,xp:0},core:{proficiencyBonus:2,race:"Humanoid",size:"Medium",speed:[{name:"Walk",value:30,unit:"ft",comment:""}],senses:[],languages:[]},abilities:{stats:{str:10,dex:10,con:10,wis:10,int:10,cha:10},saves:{str:{isProficient:!1,override:null},dex:{isProficient:!1,override:null},con:{isProficient:!1,override:null},wis:{isProficient:!1,override:null},int:{isProficient:!1,override:null},cha:{isProficient:!1,override:null}},skills:[]},defenses:{hp:{numOfHitDie:1,sizeOfHitDie:6,override:null},ac:{ac:10,acSource:"natural armor"},vulnerabilities:[],resistances:[],immunities:[],conditionImmunities:[]},features:{features:[],actions:[],bonus:[],reactions:[],legendary:[],lair:[],mythic:[],regional:[]},spellcasting:{innateSpells:{spellList:{0:[],1:[],2:[],3:[]},spellDcOverride:null,spellBonusOverride:null,spellCastingAbility:null,noComponentsOfType:["Material","Verbal","Somatic"],isPsionics:!1,displayAsAction:!1},casterSpells:{casterLevel:null,castingClass:null,spellCastingAbility:null,spellCastingAbilityOverride:null,spellList:[[],[],[],[],[],[],[],[],[],[]],spellSlotList:{},spellDcOverride:null,spellBonusOverride:null,displayAsAction:!1}},misc:{legActionsPerRound:3,telepathy:0,passivePerceptionOverride:null,featureHeaderTexts:{features:"",actions:"",bonus:"",reactions:"",legendary:"The creature can take $NUM$ legendary actions, choosing from the options below. Only one legendary action can be used at a time and only at the end of another creature's turn. The creature regains spent legendary actions at the start of its turn.",lair:"On initiative count 20 (losing initiative ties), the creature can take one of the following lair actions; it can't take the same lair action two rounds in a row",mythic:"If the creatures' Mythic trait is active, it can use the options below as legendary actions.",regional:"The region containing the creatures lair can be transformed by its presence, creating one or more of the following effects:"}}},ua=[0,200,450,700,1100,1800,2300,2900,3900,5e3,5900,7200,8400,1e4,11500,13e3,15e3,18e3,2e4,22e3,25e3,33e3,41e3,5e4,62e3,75e3,9e4,105e3,12e4,135e3,255e3];function pu(t){return t==.125?25:t==.25?50:t==.5?100:ua[t]??0}function mu(t,e){return!t||!e?{}:t=="Warlock"?{1:{1:1},2:{1:2},3:{2:2},4:{2:2},5:{3:2},6:{3:2},7:{4:2},8:{4:2},9:{5:2},10:{5:2},11:{5:3},12:{5:3},13:{5:3},14:{5:3},15:{5:3},16:{5:3},17:{5:4},18:{5:4},19:{5:4},20:{5:4}}[e]:["Ranger","Paladin","Artificer"].includes(t)?e==1&&t=="Artificer"?{1:2}:{1:{},2:{1:2},3:{1:3},4:{1:3},5:{1:4,2:2},6:{1:4,2:2},7:{1:4,2:3},8:{1:4,2:3},9:{1:4,2:3,3:2},10:{1:4,2:3,3:2},11:{1:4,2:3,3:3},12:{1:4,2:3,3:3},13:{1:4,2:3,3:3,4:1},14:{1:4,2:3,3:3,4:1},15:{1:4,2:3,3:3,4:2},16:{1:4,2:3,3:3,4:2},17:{1:4,2:3,3:3,4:3,5:1},18:{1:4,2:3,3:3,4:3,5:1},19:{1:4,2:3,3:3,4:3,5:2},20:{1:4,2:3,3:3,4:3,5:2}}[e]:{1:{1:2},2:{1:3},3:{1:4,2:2},4:{1:4,2:3},5:{1:4,2:3,3:2},6:{1:4,2:3,3:3},7:{1:4,2:3,3:3,4:1},8:{1:4,2:3,3:3,4:2},9:{1:4,2:3,3:3,4:3,5:1},10:{1:4,2:3,3:3,4:3,5:2},11:{1:4,2:3,3:3,4:3,5:2},12:{1:4,2:3,3:3,4:3,5:2,6:1},13:{1:4,2:3,3:3,4:3,5:2,6:1,7:1},14:{1:4,2:3,3:3,4:3,5:2,6:1,7:1},15:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1},16:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1},17:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1,9:1},18:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1,9:1},19:{1:4,2:3,3:3,4:3,5:2,6:2,7:1,8:1,9:1},20:{1:4,2:3,3:3,4:3,5:2,6:2,7:2,8:1,9:1}}[e]}const Bs={0:["Acid Splash","Blade Ward","Booming Blade","Chill Touch","Control Flames","Create Bonfire","Dancing Lights","Druidcraft","Eldritch Blast","Encode Thoughts","Fire Bolt","Friends","Frostbite","Green-Flame Blade","Guidance","Gust","Infestation","Light","Lightning Lure","Mage Hand","Magic Stone","Mending","Message","Mind Sliver","Minor Illusion","Mold Earth","Poison Spray","Prestidigitation","Primal Savagery","Produce Flame","Ray of Frost","Resistance","Sacred Flame","Sapping Sting","Shape Water","Shillelagh","Shocking Grasp","Spare the Dying","Sword Burst","Thaumaturgy","Thorn Whip","Thunderclap","Toll the Dead","True Strike","Vicious Mockery","Word of Radiance"],1:["Absorb Elements","Alarm","Animal Friendship","Armor of Agathys","Arms of Hadar","Bane","Beast Bond","Bless","Burning Hands","Catapult","Cause Fear","Ceremony","Chaos Bolt","Charm Person","Chromatic Orb","Color Spray","Command","Compelled Duel","Comprehend Languages","Create or Destroy Water","Cure Wounds","Detect Evil and Good","Detect Magic","Detect Poison and Disease","Disguise Self","Dissonant Whispers","Distort Value","Divine Favor","Earth Tremor","Ensnaring Strike","Entangle","Expeditious Retreat","Faerie Fire","False Life","Feather Fall","Find Familiar","Floating Disk","Fog Cloud","Frost Fingers","Gift of Alacrity","Goodberry","Grease","Guiding Bolt","Hail of Thorns","Healing Word","Hellish Rebuke","Heroism","Hex","Hideous Laughter","Hunter's Mark","Ice Knife","Identify","Illusory Script","Inflict Wounds","Jim's Magic Missile","Jump","Longstrider","Mage Armor","Magic Missile","Magnify Gravity","Protection from Evil and Good","Purify Food and Drink","Ray of Sickness","Sanctuary","Searing Smite","Shield","Shield of Faith","Silent Image","Silvery Barbs","Sleep","Snare","Speak with Animals","Tasha's Caustic Brew","Tasha's Hideous Laughter","Tenser's Floating Disk","Thunderous Smite","Thunderwave","Unseen Servant","Witch Bolt","Wrathful Smite","Zephyr Strike"],2:["Acid Arrow","Aganazzar's Scorcher","Aid","Air Bubble","Alter Self","Animal Messenger","Arcane Lock","Arcanist's Magic Aura","Augury","Barkskin","Beast Sense","Blindness/Deafness","Blur","Borrowed Knowledge","Branding Smite","Calm Emotions","Cloud of Daggers","Continual Flame","Cordon of Arrows","Crown of Madness","Darkness","Darkvision","Detect Thoughts","Dragon's Breath","Dust Devil","Earthbind","Enhance Ability","Enlarge/Reduce","Enthrall","Find Steed","Find Traps","Flame Blade","Flaming Sphere","Flock of Familiars","Fortune's Favor","Gentle Repose","Gift of Gab","Gust of Wind","Healing Spirit","Heat Metal","Hold Person","Immovable Object","Invisibility","Jim's Glowing Coin","Kinetic Jaunt","Knock","Lesser Restoration","Levitate","Locate Animals or Plants","Locate Object","Magic Mouth","Magic Weapon","Maximilian's Earthen Grasp","Melf's Acid Arrow","Mind Spike","Mirror Image","Misty Step","Moonbeam","Nathair's Mischief","Nystul's Magic Aura","Pass without Trace","Phantasmal Force","Prayer of Healing","Protection from Poison","Pyrotechnics","Ray of Enfeeblement","Rime's Binding Ice","Rope Trick","Scorching Ray","See Invisibility","Shadow Blade","Shatter","Silence","Skywrite","Snilloc's Snowball Swarm","Spider Climb","Spike Growth","Spiritual Weapon","Spray of Cards","Suggestion","Summon Beast","Tasha's Mind Whip","Vortex Warp","Warding Bond","Warding Wind","Warp Sense","Web","Wither and Bloom","Wristpocket","Zone of Truth"],3:["Animate Dead","Antagonize","Ashardalon's Stride","Aura of Vitality","Beacon of Hope","Bestow Curse","Blinding Smite","Blink","Call Lightning","Catnap","Clairvoyance","Conjure Animals","Conjure Barrage","Counterspell","Create Food and Water","Crusader's Mantle","Daylight","Dispel Magic","Elemental Weapon","Enemies Abound","Erupting Earth","Fast Friends","Fear","Feign Death","Fireball","Flame Arrows","Fly","Freedom of the Waves","Galder's Tower","Gaseous Form","Glyph of Warding","Haste","Hunger of Hadar","Hypnotic Pattern","Incite Greed","Intellect Fortress","Leomund's Tiny Hut","Life Transference","Lightning Arrow","Lightning Bolt","Magic Circle","Major Image","Mass Healing Word","Meld into Stone","Melf's Minute Meteors","Motivational Speech","Nondetection","Phantom Steed","Plant Growth","Protection from Energy","Pulse Wave","Remove Curse","Revivify","Sending","Sleet Storm","Slow","Speak with Dead","Speak with Plants","Spirit Guardians","Spirit Shroud","Stinking Cloud","Summon Fey","Summon Lesser Demons","Summon Shadowspawn","Summon Undead","Thunder Step","Tidal Wave","Tiny Hut","Tiny Servant","Tongues","Vampiric Touch","Wall of Sand","Wall of Water","Water Breathing","Water Walk","Wind Wall"],4:["Arcane Eye","Aura of Life","Aura of Purity","Banishment","Black Tentacles","Blight","Charm Monster","Compulsion","Confusion","Conjure Minor Elementals","Conjure Woodland Beings","Control Water","Death Ward","Dimension Door","Divination","Dominate Beast","Elemental Bane","Evard's Black Tentacles","Fabricate","Faithful Hound","Find Greater Steed","Fire Shield","Freedom of Movement","Galder's Speedy Courier","Gate Seal","Giant Insect","Grasping Vine","Gravity Sinkhole","Greater Invisibility","Guardian of Faith","Guardian of Nature","Hallucinatory Terrain","Ice Storm","Leomund's Secret Chest","Locate Creature","Mordenkainen's Faithful Hound","Mordenkainen's Private Sanctum","Otiluke's Resilient Sphere","Phantasmal Killer","Polymorph","Private Sanctum","Raulothim's Psychic Lance","Resilient Sphere","Secret Chest","Shadow of Moil","Sickening Radiance","Spirit of Death","Staggering Smite","Stone Shape","Stoneskin","Storm Sphere","Summon Aberration","Summon Construct","Summon Elemental","Summon Greater Demon","Vitriolic Sphere","Wall of Fire","Watery Sphere"],5:["Animate Objects","Antilife Shell","Arcane Hand","Awaken","Banishing Smite","Bigby's Hand","Circle of Power","Cloudkill","Commune","Commune with Nature","Cone of Cold","Conjure Elemental","Conjure Volley","Contact Other Plane","Contagion","Control Winds","Create Spelljamming Helm","Creation","Danse Macabre","Dawn","Destructive Wave","Dispel Evil and Good","Dominate Person","Dream","Enervation","Far Step","Flame Strike","Freedom of the Winds","Geas","Greater Restoration","Hallow","Hold Monster","Holy Weapon","Immolation","Infernal Calling","Insect Plague","Legend Lore","Maelstrom","Mass Cure Wounds","Mislead","Modify Memory","Negative Energy Flood","Passwall","Planar Binding","Raise Dead","Rary's Telepathic Bond","Reincarnate","Scrying","Seeming","Skill Empowerment","Steel Wind Strike","Summon Celestial","Summon Draconic Spirit","Swift Quiver","Synaptic Static","Telekinesis","Telepathic Bond","Teleportation Circle","Temporal Shunt","Transmute Rock","Tree Stride","Wall of Force","Wall of Light","Wall of Stone","Wrath of Nature"],6:["Arcane Gate","Blade Barrier","Bones of the Earth","Chain Lightning","Circle of Death","Conjure Fey","Contingency","Create Homunculus","Create Undead","Disintegrate","Drawmij's Instant Summons","Druid Grove","Eyebite","Find the Path","Fizban's Platinum Shield","Flesh to Stone","Forbiddance","Freezing Sphere","Globe of Invulnerability","Gravity Fissure","Guards and Wards","Harm","Heal","Heroes' Feast","Instant Summons","Investiture of Flame","Investiture of Ice","Investiture of Stone","Investiture of Wind","Magic Jar","Mass Suggestion","Mental Prison","Move Earth","Otiluke's Freezing Sphere","Otto's Irresistible Dance","Planar Ally","Primordial Ward","Programmed Illusion","Scatter","Soul Cage","Summon Fiend","Sunbeam","Tasha's Otherworldly Guise","Tenser's Transformation","Transport via Plants","True Seeing","Wall of Ice","Wall of Thorns","Wind Walk","Word of Recall"],7:["Conjure Celestial","Create Magen","Crown of Stars","Delayed Blast Fireball","Divine Word","Draconic Transformation","Dream of the Blue Veil","Etherealness","Finger of Death","Fire Storm","Forcecage","Magnificent Mansion","Mirage Arcane","Mordenkainen's Magnificent Mansion","Mordenkainen's Sword","Plane Shift","Power Word Pain","Prismatic Spray","Project Image","Regenerate","Resurrection","Reverse Gravity","Sequester","Simulacrum","Symbol","Teleport","Temple of the Gods","Tether Essence","Whirlwind"],8:["Abi-Dalzim's Horrid Wilting","Animal Shapes","Antimagic Field","Antipathy/Sympathy","Clone","Control Weather","Dark Star","Demiplane","Dominate Monster","Earthquake","Feeblemind","Glibness","Holy Aura","Illusory Dragon","Incendiary Cloud","Maddening Darkness","Maze","Mighty Fortress","Mind Blank","Power Word Stun","Reality Break","Sunburst","Telepathy","Tsunami"],9:["Astral Projection","Blade of Disaster","Foresight","Gate","Imprisonment","Invulnerability","Mass Heal","Mass Polymorph","Meteor Swarm","Power Word Heal","Power Word Kill","Prismatic Wall","Psychic Scream","Ravenous Void","Shapechange","Storm of Vengeance","Time Ravage","Time Stop","True Polymorph","True Resurrection","Weird","Wish"]};let Bn=[];for(let t in Bs)Bn=Bn.concat(Bs[t]);Bn.sort();var E={},Ln={},_e={},fa=Ue&&Ue.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,i){s.__proto__=i}||function(s,i){for(var r in i)i.hasOwnProperty(r)&&(s[r]=i[r])},t(e,n)};return function(e,n){t(e,n);function s(){this.constructor=e}e.prototype=n===null?Object.create(n):(s.prototype=n.prototype,new s)}}(),Ls=Ue&&Ue.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var s=Array(t),i=0,e=0;e<n;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,i++)s[i]=r[o];return s};Object.defineProperty(_e,"__esModule",{value:!0});_e.DetailContext=_e.NoopContext=_e.VError=void 0;var Hi=function(t){fa(e,t);function e(n,s){var i=t.call(this,s)||this;return i.path=n,Object.setPrototypeOf(i,e.prototype),i}return e}(Error);_e.VError=Hi;var ha=function(){function t(){this._failed=!1}return t.prototype.fail=function(e,n,s){return this._failed=!0,!1},t.prototype.fork=function(){return this},t.prototype.completeFork=function(){return!this._failed},t.prototype.failed=function(){return this._failed},t.prototype.unionResolver=function(){return this},t.prototype.createContext=function(){return this._failed=!1,this},t.prototype.resolveUnion=function(e){},t}();_e.NoopContext=ha;var Vi=function(){function t(){this._propNames=[],this._messages=[],this._failedForks=[],this._currentFork=null,this._score=0}return t.prototype.fail=function(e,n,s){return this._propNames.push(e),this._messages.push(n),this._score+=s,!1},t.prototype.unionResolver=function(){return new da},t.prototype.resolveUnion=function(e){for(var n,s,i,r=e,o=null,a=0,l=r.contexts;a<l.length;a++){var c=l[a];(!o||c._score>=o._score)&&(o=c)}o&&o._score>0&&((n=this._propNames).push.apply(n,o._propNames),(s=this._messages).push.apply(s,o._messages),(i=this._failedForks).push.apply(i,o._failedForks))},t.prototype.getError=function(e){var n=Mn(this.getErrorDetails(e).map(qi)).join(`
`);return new Hi(e,n)},t.prototype.getErrorDetails=function(e){for(var n=null,s,i=[],r=this._propNames.length-1;r>=0;r--){var o=this._propNames[r];e+=typeof o=="number"?"["+o+"]":o?"."+o:"";var a=this._messages[r];a&&(s={path:e,message:a},n?n.nested=[s]:i.push(s),n=s)}var l=Mn(this._failedForks.map(function(c){return c.getErrorDetails(e)}));return n?l.length&&(n.nested=l):i=l,i},t.prototype.fork=function(){return this._currentFork==null&&(this._currentFork=new t),this._currentFork},t.prototype.completeFork=function(){var e=this._currentFork;return e._failed()&&(this._failedForks.push(e),this._currentFork=null,this._failedForks.length===1&&(this._score=e._score)),this._failedForks.length<t.maxForks},t.prototype.failed=function(){return this._failed()},t.prototype._failed=function(){return this._propNames.length+this._failedForks.length>0},t.maxForks=3,t}();_e.DetailContext=Vi;var da=function(){function t(){this.contexts=[]}return t.prototype.createContext=function(){var e=new Vi;return this.contexts.push(e),e},t}(),qi=function(t){var e=t.path+" "+t.message,n=t.nested||[],s=Mn(n.map(qi));if(n.length==1){var i=s[0],r=s.slice(1);return Ls([e+"; "+i],r)}else return Ls([e],s.map(function(o){return"    "+o}))};function Mn(t){var e;return(e=[]).concat.apply(e,t)}(function(t){var e=Ue&&Ue.__extends||function(){var g=function(S,k){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,$){A.__proto__=$}||function(A,$){for(var M in $)$.hasOwnProperty(M)&&(A[M]=$[M])},g(S,k)};return function(S,k){g(S,k);function A(){this.constructor=S}S.prototype=k===null?Object.create(k):(A.prototype=k.prototype,new A)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.basicTypes=t.BasicType=t.TParamList=t.TParam=t.param=t.TFunc=t.func=t.TProp=t.TOptional=t.opt=t.TIface=t.iface=t.indexKey=t.TEnumLiteral=t.enumlit=t.TEnumType=t.enumtype=t.TIntersection=t.intersection=t.TUnion=t.union=t.TTuple=t.tuple=t.RestType=t.rest=t.TArray=t.array=t.TLiteral=t.lit=t.TName=t.name=t.TType=void 0;var n=_e,s=function(){function g(){}return g}();t.TType=s;function i(g){return typeof g=="string"?o(g):g}function r(g,S){var k=g[S];if(!k)throw new Error("Unknown type "+S);return k}function o(g){return new a(g)}t.name=o;var a=function(g){e(S,g);function S(k){var A=g.call(this)||this;return A.name=k,A._failMsg="is not a "+k,A}return S.prototype.getChecker=function(k,A,$){var M=this._checkerBeingBuilt;if(!M){this._checkerBeingBuilt=function(V,x){return M(V,x)};try{M=this._getChecker(k,A,$)}finally{this._checkerBeingBuilt=void 0}}return M},S.prototype._getChecker=function(k,A,$){var M=this,V=r(k,this.name),x=V.getChecker(k,A,$);return V instanceof re||V instanceof S?x:function(K,J){return x(K,J)?!0:J.fail(null,M._failMsg,0)}},S}(s);t.TName=a;function l(g){return new c(g)}t.lit=l;var c=function(g){e(S,g);function S(k){var A=g.call(this)||this;return A.value=k,A.name=JSON.stringify(k),A._failMsg="is not "+A.name,A}return S.prototype.getChecker=function(k,A){var $=this;return function(M,V){return M===$.value?!0:V.fail(null,$._failMsg,-1)}},S}(s);t.TLiteral=c;function h(g){return new u(i(g))}t.array=h;var u=function(g){e(S,g);function S(k){var A=g.call(this)||this;A.ttype=k;var $=is(k);return $&&(A.name=$+"[]"),A}return S.prototype.getChecker=function(k,A){var $=this.ttype.getChecker(k,A);return function(M,V){if(!Array.isArray(M))return V.fail(null,"is not an array",0);for(var x=0;x<M.length;x++){var K=$(M[x],V);if(!K)return V.fail(x,null,1)}return!0}},S}(s);t.TArray=u;function d(g){return new m(g)}t.rest=d;var m=function(g){e(S,g);function S(k){var A=g.call(this)||this;return A.typeSpec=k,A}return S.prototype.setStart=function(k){this._start=k},S.prototype.getChecker=function(k,A){var $=typeof this.typeSpec=="string"?r(k,this.typeSpec):this.typeSpec;if(!($ instanceof u))throw new Error("Rest type must be an array");var M=$.ttype.getChecker(k,A),V=this._start;return function(x,K){for(var J=V;J<x.length;J++)if(!M(x[J],K))return K.fail(J,null,1);return!0}},S}(s);t.RestType=m;function C(){for(var g=[],S=0;S<arguments.length;S++)g[S]=arguments[S];return new p(g.map(function(k){return i(k)}))}t.tuple=C;var p=function(g){e(S,g);function S(k){var A=g.call(this)||this;A.ttypes=k;var $=k[k.length-1];return $ instanceof m&&(k.pop(),A._restType=$,A._restType.setStart(k.length)),A}return S.prototype.getChecker=function(k,A){var $=this.ttypes.map(function(x){return x.getChecker(k,A)}),M=function(x,K){if(!Array.isArray(x))return K.fail(null,"is not an array",0);for(var J=0;J<$.length;J++){var oe=$[J](x[J],K);if(!oe)return K.fail(J,null,1)}return!0};if(this._restType){var V=this._restType.getChecker(k,A);return function(x,K){return M(x,K)&&V(x,K)}}return A?function(x,K){return M(x,K)?x.length<=$.length?!0:K.fail($.length,"is extraneous",2):!1}:M},S}(s);t.TTuple=p;function b(){for(var g=[],S=0;S<arguments.length;S++)g[S]=arguments[S];return new I(g.map(function(k){return i(k)}))}t.union=b;var I=function(g){e(S,g);function S(k){var A=g.call(this)||this;A.ttypes=k;var $=k.map(is).filter(function(V){return V}),M=k.length-$.length;return $.length?(M>0&&$.push(M+" more"),A._failMsg="is none of "+$.join(", ")):A._failMsg="is none of "+M+" types",A}return S.prototype.getChecker=function(k,A,$){var M=this,V=this.ttypes.map(function(x){return x.getChecker(k,A,$)});return function(x,K){for(var J=K.unionResolver(),oe=0;oe<V.length;oe++){var Ne=V[oe](x,J.createContext());if(Ne)return!0}return K.resolveUnion(J),K.fail(null,M._failMsg,0)}},S}(s);t.TUnion=I;function v(){for(var g=[],S=0;S<arguments.length;S++)g[S]=arguments[S];return new B(g.map(function(k){return i(k)}))}t.intersection=v;var B=function(g){e(S,g);function S(k){var A=g.call(this)||this;return A.ttypes=k,A}return S.prototype.getChecker=function(k,A,$){$===void 0&&($=new Set);var M=this.ttypes.map(function(V){return V.getChecker(k,A,$)});return function(V,x){return M.every(function(K){return K(V,x.fork()),x.completeFork()})&&!x.failed()}},S}(s);t.TIntersection=B;function w(g){return new L(g)}t.enumtype=w;var L=function(g){e(S,g);function S(k){var A=g.call(this)||this;return A.members=k,A.validValues=new Set,A._failMsg="is not a valid enum value",A.validValues=new Set(Object.keys(k).map(function($){return k[$]})),A}return S.prototype.getChecker=function(k,A){var $=this;return function(M,V){return $.validValues.has(M)?!0:V.fail(null,$._failMsg,0)}},S}(s);t.TEnumType=L;function _(g,S){return new G(g,S)}t.enumlit=_;var G=function(g){e(S,g);function S(k,A){var $=g.call(this)||this;return $.enumName=k,$.prop=A,$._failMsg="is not "+k+"."+A,$}return S.prototype.getChecker=function(k,A){var $=this,M=r(k,this.enumName);if(!(M instanceof L))throw new Error("Type "+this.enumName+" used in enumlit is not an enum type");var V=M.members[this.prop];if(!M.members.hasOwnProperty(this.prop))throw new Error("Unknown value "+this.enumName+"."+this.prop+" used in enumlit");return function(x,K){return x===V?!0:K.fail(null,$._failMsg,-1)}},S}(s);t.TEnumLiteral=G;function W(g){return Object.keys(g).filter(function(S){return S!==t.indexKey}).map(function(S){return j(S,g[S])})}function j(g,S){return S instanceof Ee?new ie(g,S.ttype,!0):new ie(g,i(S),!1)}t.indexKey=Symbol();function Y(g,S){return new q(g,W(S),S[t.indexKey])}t.iface=Y;var q=function(g){e(S,g);function S(k,A,$){var M=g.call(this)||this;return M.bases=k,M.props=A,M.indexType=$?i($):void 0,M.propSet=new Set(A.map(function(V){return V.name})),M}return S.prototype.getChecker=function(k,A,$){var M=this,V;$===void 0&&($=new Set),this.propSet.forEach(function(se){return $.add(se)});var x=this.bases.map(function(se){return r(k,se).getChecker(k,A,$)}),K=this.props.map(function(se){return se.ttype.getChecker(k,A)}),J=(V=this.indexType)===null||V===void 0?void 0:V.getChecker(k,A),oe=new n.NoopContext,Ne=this.props.map(function(se,ae){return!se.isOpt&&!K[ae](void 0,oe)});return function(se,ae){if(typeof se!="object"||se===null)return ae.fail(null,"is not an object",0);for(var Ce=0;Ce<x.length;Ce++)if(x[Ce](se,ae.fork()),!ae.completeFork())return!1;for(var Ce=0;Ce<K.length;Ce++){var pn=M.props[Ce].name,rs=se[pn];if(rs===void 0){if(Ne[Ce]&&(ae.fork().fail(pn,"is missing",1),!ae.completeFork()))return!1}else{var gt=ae.fork(),zi=K[Ce](rs,gt);if(zi||gt.fail(pn,null,1),!ae.completeFork())return!1}}if(J)for(var yt in se){var gt=ae.fork();if(J(se[yt],gt)||gt.fail(yt,null,1),!ae.completeFork())return!1}else if(A){for(var yt in se)if(!$.has(yt)&&(ae.fork().fail(yt,"is extraneous",2),!ae.completeFork()))return!1}return!ae.failed()}},S}(s);t.TIface=q;function z(g){return new Ee(i(g))}t.opt=z;var Ee=function(g){e(S,g);function S(k){var A=g.call(this)||this;return A.ttype=k,A}return S.prototype.getChecker=function(k,A){var $=this.ttype.getChecker(k,A);return function(M,V){return M===void 0||$(M,V)}},S}(s);t.TOptional=Ee;var ie=function(){function g(S,k,A){this.name=S,this.ttype=k,this.isOpt=A}return g}();t.TProp=ie;function Wi(g){for(var S=[],k=1;k<arguments.length;k++)S[k-1]=arguments[k];return new Qn(new ts(S),i(g))}t.func=Wi;var Qn=function(g){e(S,g);function S(k,A){var $=g.call(this)||this;return $.paramList=k,$.result=A,$}return S.prototype.getChecker=function(k,A){return function($,M){return typeof $=="function"?!0:M.fail(null,"is not a function",0)}},S}(s);t.TFunc=Qn;function Ki(g,S,k){return new es(g,i(S),!!k)}t.param=Ki;var es=function(){function g(S,k,A){this.name=S,this.ttype=k,this.isOpt=A}return g}();t.TParam=es;var ts=function(g){e(S,g);function S(k){var A=g.call(this)||this;return A.params=k,A}return S.prototype.getChecker=function(k,A){var $=this,M=this.params.map(function(J){return J.ttype.getChecker(k,A)}),V=new n.NoopContext,x=this.params.map(function(J,oe){return!J.isOpt&&!M[oe](void 0,V)}),K=function(J,oe){if(!Array.isArray(J))return oe.fail(null,"is not an array",0);for(var Ne=0;Ne<M.length;Ne++){var se=$.params[Ne];if(J[Ne]===void 0){if(x[Ne])return oe.fail(se.name,"is missing",1)}else{var ae=M[Ne](J[Ne],oe);if(!ae)return oe.fail(se.name,null,1)}}return!0};return A?function(J,oe){return K(J,oe)?J.length<=M.length?!0:oe.fail(M.length,"is extraneous",2):!1}:K},S}(s);t.TParamList=ts;var re=function(g){e(S,g);function S(k,A){var $=g.call(this)||this;return $.validator=k,$.message=A,$}return S.prototype.getChecker=function(k,A){var $=this;return function(M,V){return $.validator(M)?!0:V.fail(null,$.message,0)}},S}(s);t.BasicType=re,t.basicTypes={any:new re(function(g){return!0},"is invalid"),unknown:new re(function(g){return!0},"is invalid"),number:new re(function(g){return typeof g=="number"},"is not a number"),object:new re(function(g){return typeof g=="object"&&g},"is not an object"),boolean:new re(function(g){return typeof g=="boolean"},"is not a boolean"),string:new re(function(g){return typeof g=="string"},"is not a string"),symbol:new re(function(g){return typeof g=="symbol"},"is not a symbol"),void:new re(function(g){return g==null},"is not void"),undefined:new re(function(g){return g===void 0},"is not undefined"),null:new re(function(g){return g===null},"is not null"),never:new re(function(g){return!1},"is unexpected"),Date:new re(ns("[object Date]"),"is not a Date"),RegExp:new re(ns("[object RegExp]"),"is not a RegExp")};var Ji=Object.prototype.toString;function ns(g){return function(S){return typeof S=="object"&&S&&Ji.call(S)===g}}typeof Buffer<"u"&&(t.basicTypes.Buffer=new re(function(g){return Buffer.isBuffer(g)},"is not a Buffer"));for(var Gi=function(g){t.basicTypes[g.name]=new re(function(S){return S instanceof g},"is not a "+g.name)},dn=0,ss=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,ArrayBuffer];dn<ss.length;dn++){var Yi=ss[dn];Gi(Yi)}function is(g){if(g instanceof a||g instanceof c||g instanceof u)return g.name}})(Ln);(function(t){var e=Ue&&Ue.__spreadArrays||function(){for(var l=0,c=0,h=arguments.length;c<h;c++)l+=arguments[c].length;for(var u=Array(l),d=0,c=0;c<h;c++)for(var m=arguments[c],C=0,p=m.length;C<p;C++,d++)u[d]=m[C];return u};Object.defineProperty(t,"__esModule",{value:!0}),t.Checker=t.createCheckers=void 0;var n=Ln,s=_e,i=Ln;Object.defineProperty(t,"TArray",{enumerable:!0,get:function(){return i.TArray}}),Object.defineProperty(t,"TEnumType",{enumerable:!0,get:function(){return i.TEnumType}}),Object.defineProperty(t,"TEnumLiteral",{enumerable:!0,get:function(){return i.TEnumLiteral}}),Object.defineProperty(t,"TFunc",{enumerable:!0,get:function(){return i.TFunc}}),Object.defineProperty(t,"TIface",{enumerable:!0,get:function(){return i.TIface}}),Object.defineProperty(t,"TLiteral",{enumerable:!0,get:function(){return i.TLiteral}}),Object.defineProperty(t,"TName",{enumerable:!0,get:function(){return i.TName}}),Object.defineProperty(t,"TOptional",{enumerable:!0,get:function(){return i.TOptional}}),Object.defineProperty(t,"TParam",{enumerable:!0,get:function(){return i.TParam}}),Object.defineProperty(t,"TParamList",{enumerable:!0,get:function(){return i.TParamList}}),Object.defineProperty(t,"TProp",{enumerable:!0,get:function(){return i.TProp}}),Object.defineProperty(t,"TTuple",{enumerable:!0,get:function(){return i.TTuple}}),Object.defineProperty(t,"TType",{enumerable:!0,get:function(){return i.TType}}),Object.defineProperty(t,"TUnion",{enumerable:!0,get:function(){return i.TUnion}}),Object.defineProperty(t,"TIntersection",{enumerable:!0,get:function(){return i.TIntersection}}),Object.defineProperty(t,"array",{enumerable:!0,get:function(){return i.array}}),Object.defineProperty(t,"enumlit",{enumerable:!0,get:function(){return i.enumlit}}),Object.defineProperty(t,"enumtype",{enumerable:!0,get:function(){return i.enumtype}}),Object.defineProperty(t,"func",{enumerable:!0,get:function(){return i.func}}),Object.defineProperty(t,"iface",{enumerable:!0,get:function(){return i.iface}}),Object.defineProperty(t,"lit",{enumerable:!0,get:function(){return i.lit}}),Object.defineProperty(t,"name",{enumerable:!0,get:function(){return i.name}}),Object.defineProperty(t,"opt",{enumerable:!0,get:function(){return i.opt}}),Object.defineProperty(t,"param",{enumerable:!0,get:function(){return i.param}}),Object.defineProperty(t,"tuple",{enumerable:!0,get:function(){return i.tuple}}),Object.defineProperty(t,"union",{enumerable:!0,get:function(){return i.union}}),Object.defineProperty(t,"intersection",{enumerable:!0,get:function(){return i.intersection}}),Object.defineProperty(t,"rest",{enumerable:!0,get:function(){return i.rest}}),Object.defineProperty(t,"indexKey",{enumerable:!0,get:function(){return i.indexKey}}),Object.defineProperty(t,"BasicType",{enumerable:!0,get:function(){return i.BasicType}});var r=_e;Object.defineProperty(t,"VError",{enumerable:!0,get:function(){return r.VError}});function o(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];for(var h=Object.assign.apply(Object,e([{},n.basicTypes],l)),u={},d=0,m=l;d<m.length;d++)for(var C=m[d],p=0,b=Object.keys(C);p<b.length;p++){var I=b[p];u[I]=new a(h,C[I])}return u}t.createCheckers=o;var a=function(){function l(c,h,u){if(u===void 0&&(u="value"),this.suite=c,this.ttype=h,this._path=u,this.props=new Map,h instanceof n.TIface)for(var d=0,m=h.props;d<m.length;d++){var C=m[d];this.props.set(C.name,C.ttype)}this.checkerPlain=this.ttype.getChecker(c,!1),this.checkerStrict=this.ttype.getChecker(c,!0)}return l.prototype.setReportedPath=function(c){this._path=c},l.prototype.check=function(c){return this._doCheck(this.checkerPlain,c)},l.prototype.test=function(c){return this.checkerPlain(c,new s.NoopContext)},l.prototype.validate=function(c){return this._doValidate(this.checkerPlain,c)},l.prototype.strictCheck=function(c){return this._doCheck(this.checkerStrict,c)},l.prototype.strictTest=function(c){return this.checkerStrict(c,new s.NoopContext)},l.prototype.strictValidate=function(c){return this._doValidate(this.checkerStrict,c)},l.prototype.getProp=function(c){var h=this.props.get(c);if(!h)throw new Error("Type has no property "+c);return new l(this.suite,h,this._path+"."+c)},l.prototype.methodArgs=function(c){var h=this._getMethod(c);return new l(this.suite,h.paramList)},l.prototype.methodResult=function(c){var h=this._getMethod(c);return new l(this.suite,h.result)},l.prototype.getArgs=function(){if(!(this.ttype instanceof n.TFunc))throw new Error("getArgs() applied to non-function");return new l(this.suite,this.ttype.paramList)},l.prototype.getResult=function(){if(!(this.ttype instanceof n.TFunc))throw new Error("getResult() applied to non-function");return new l(this.suite,this.ttype.result)},l.prototype.getType=function(){return this.ttype},l.prototype._doCheck=function(c,h){var u=new s.NoopContext;if(!c(h,u)){var d=new s.DetailContext;throw c(h,d),d.getError(this._path)}},l.prototype._doValidate=function(c,h){var u=new s.NoopContext;if(c(h,u))return null;var d=new s.DetailContext;return c(h,d),d.getErrorDetails(this._path)},l.prototype._getMethod=function(c){var h=this.props.get(c);if(!h)throw new Error("Type has no property "+c);if(!(h instanceof n.TFunc))throw new Error("Property "+c+" is not a method");return h},l}();t.Checker=a})(E);E.iface([],{search:"string",page:"number",mode:E.union(E.lit("popular"),E.lit("recent")),tags:E.array("string")});E.union(E.lit("str"),E.lit("dex"),E.lit("con"),E.lit("int"),E.lit("cha"),E.lit("wis"));E.iface([],{description:"Description",core:"Core",abilities:"Abilities",defenses:"Defenses",features:"Features",spellcasting:"SpellCasting",misc:"Misc"});E.iface([],{legActionsPerRound:"number",telepathy:"number",passivePerceptionOverride:E.union("number","null"),featureHeaderTexts:"FeatureHeaderTexts"});E.iface([],{features:"string",actions:"string",bonus:"string",reactions:"string",legendary:"string",lair:"string",mythic:"string",regional:"string"});E.iface([],{name:"string",isProperNoun:"boolean",description:"string",image:"string",faction:"string",environment:"string",alignment:"string",cr:"number",xp:"number"});E.iface([],{proficiencyBonus:"number",race:"string",size:"string",speed:E.array("SpeedEntity"),senses:E.array("SenseEntity"),languages:E.union(E.array("string"),"null")});E.iface([],{walk:"number",fly:"number",isHover:"boolean",burrow:"number",swim:"number",climb:"number"});E.union(E.lit("ft"),E.lit("m"),E.lit("km"),E.lit("mi"),E.lit("none"));E.iface([],{name:"string",value:"number",unit:"Unit",comment:"string"});E.iface([],{name:"string",value:"number",unit:"Unit",comment:"string"});E.iface([],{stats:"Stats",saves:"Saves",skills:E.array("SkillsEntity")});E.iface([],{str:"number",dex:"number",con:"number",int:"number",cha:"number",wis:"number"});E.iface([],{str:"SaveEntity",dex:"SaveEntity",con:"SaveEntity",int:"SaveEntity",cha:"SaveEntity",wis:"SaveEntity"});E.iface([],{isProficient:"boolean",override:E.union("number","null")});E.iface([],{skillName:"string",isHalfProficient:"boolean",isProficient:"boolean",isExpertise:"boolean",override:E.union("number","null")});E.iface([],{hp:"Hp",ac:"Ac",vulnerabilities:E.array("string"),resistances:E.array("string"),immunities:E.array("string"),conditionImmunities:E.array("string")});E.iface([],{numOfHitDie:"number",sizeOfHitDie:"number",override:E.union("number","null")});E.iface([],{ac:"number",acSource:"string"});E.iface([],{features:E.array("FeatureEntity"),actions:E.array("FeatureEntity"),bonus:E.array("FeatureEntity"),reactions:E.array("FeatureEntity"),legendary:E.array("FeatureEntity"),mythic:E.array("FeatureEntity"),lair:E.array("FeatureEntity"),regional:E.array("FeatureEntity")});E.iface([],{name:"string",description:"string",automation:E.union("null","object",E.array("object"))});E.iface([],{innateSpells:"InnateSpells",casterSpells:"CasterSpells"});E.iface([],{spellList:"InnateSpellsList",spellDcOverride:E.union("null","number"),spellBonusOverride:E.union("null","number"),spellCastingAbility:E.union("Stat","null"),noComponentsOfType:E.array("string"),isPsionics:"boolean",displayAsAction:"boolean"});E.iface([],{casterLevel:E.union("number","null"),castingClass:E.union(E.lit("Wizard"),E.lit("Druid"),E.lit("Cleric"),E.lit("Bard"),E.lit("Sorcerer"),E.lit("Paladin"),E.lit("Ranger"),E.lit("Artificer"),E.lit("Warlock"),"null"),spellList:E.array(E.array("string")),spellSlotList:E.union("SpellSlotEntity","undefined"),spellDcOverride:E.union("null","number"),spellBonusOverride:E.union("null","number"),spellCastingAbility:E.union("Stat","null"),spellCastingAbilityOverride:E.union("Stat","null"),displayAsAction:"boolean"});E.iface([],{[E.indexKey]:E.array("InnateSpellsEntity")});E.iface([],{spell:"string",comment:"string"});E.iface([],{[E.indexKey]:"number"});const pa=Pn({props:{title:{type:String,required:!0},id:{type:Number,required:!1},takesCustomTextInput:{type:Boolean,required:!1,default:!1}},data(){return{elId:""}},mounted(){this.id?this.elId=this.title.toLowerCase().replaceAll(" ","")+this.id:this.elId=this.title.toLowerCase().replaceAll(" ","")}}),ma={class:"container"},ga=["for"],ya={key:0};function ba(t,e,n,s,i,r){const o=Ms("tooltip");return N(),T("div",ma,[y("label",{class:"editor-field__title",for:t.elId},[U(O(t.title),1),t.takesCustomTextInput?Ie((N(),T("span",ya,[U("*")])),[[o,"Supports custom text input"]]):P("",!0)],8,ga),Ps(t.$slots,"default",{},void 0,!0)])}const wa=Dn(pa,[["render",ba],["__scopeId","data-v-14f42cf2"]]);function gu(t,e){let n=[],s=[];for(let i of t??[]){let r=qt(i.name);if(i.description&&r.toLowerCase().includes("spellcasting"))continue;let o=Sa(i.entries||i.description.replaceAll("<i>","*").replaceAll("<b>","**").replaceAll("</i>","*").replaceAll("</b>","**")),[a,l]=Oa(o,r,e);l&&s.push(l),n.push({name:r,description:o.replace(/<avrae hidden>.*?<\/avrae>/gis,""),automation:a})}return[n,s]}function Sa(t){if(typeof t=="string")return t;let e=[];for(let n of t)if(typeof n=="string"&&e.push(qt(n)),typeof n=="object"&&n.type=="list")for(let s of n.items)e.push(`<br><b class="indent">${qt(s.name)}</b> ${qt(s.entry||s?.entries.join(`
`))}`);return e.join(`
`)}function qt(t){return t=t.replaceAll("{@atk mw}","*Melee Weapon Attack:*").replaceAll("{@atk rw}","*Ranged Weapon Attack:*").replaceAll("{@atk mw,rw}","*Melee or Ranged Weapon Attack:*").replaceAll("{@atk ms}","*Melee Spell Attack:*").replaceAll("{@atk rs}","*Ranged Spell Attack:*").replaceAll("{@atk ms,rs}","*Melee or Ranged Spell Attack:*").replaceAll("{@h}","*Hit:* ").replace(/\{@damage\s+([^}]+)\}/g,"$1").replace(/\{@dc\s+([^}]+)\}/g,"DC $1").replace(/\{@dice\s+([^}]+)\}/g,"$1").replace(/\{@spell\s+([^}]+)\}/g,"$1").replace(/\{@item\s+([^}]+)\}/g,"$1").replace(/\{@condition\s+([^}]+)\}/g,"<u>$1</u>").replace(/\{@recharge\s+(\d+)\}/g,"(Recharge $1-6)").replace(/\{@quickref\s+[a-z\s]+[|]+[0-9]+\}/,"$1".replace(/(^|\s)\S/g,function(e){return e.toUpperCase()})).replace("Recharge 6-6","Recharge 6").replace("{@recharge}","(Recharge 6)").replace(/\{@hit\s+(-?\d+)\}/g,(e,n)=>n>=0?`+${n}`:n).replaceAll("<u>","*").replaceAll("</u>","*"),t}const ka=new RegExp("<avrae hidden>(?:(?<simple>(.*?)\\|([+-]?\\d*)\\|(.*?))|(?<freeform>.*?))</avrae>","gsi"),Na=new RegExp(/[+-]?\d+ \((.+?)\) (\w+) damage/,"i"),Ta=new RegExp(/(?:\*)?(?:\w+ ){1,4}Attack:(?:\*)? (?<attackBonus>[+-]?\d+) to hit, .*?(?:\*)?Hit:(?:\*)? [+-]?(?:\d+ \((?<damageDiceBase>.+?)\)|(?<damageIntBase>\d+)) (?<damageTypeBase>[aA-zZ ]+) damage[., ]??(?: in melee[.,]?? or [+-]?(?:\d+ \((?<damageRangedDice>.+?)\)|(?<damageRangedInt>\d+)) (?<damageTypeRanged>[aA-zZ ]+) damage at range[,.]?)?(?:,? or [+-]?(?:\d+ \((?<damageDiceVers>.+?)\)|(?<damageIntVers>\d+)) (?<damageTypeVers>[aA-zZ ]+) damage if used with two hands(?: to make a melee attack)?)?(?:,? (?:plus|and) [+-]?(?:\d+ \((?<damageBonusDice>.+?)\)|(?<damageBonusInt>\d+)) (?<damageTypeBonus>[aA-zZ ]+) damage)?/,"i");function Oa(t,e="",n){n<1&&(n=1);const s=Array.from(t.matchAll(ka),o=>o.groups?.freeform),i=t.match(Ta),r=t.match(Na);if(s.length>0)for(let o of s)try{return[ho.parse(o??""),null]}catch{return[null,`${e}: Attempted to parse into Avrae Automation but an error occured.`]}else if(i?.groups){let o=[];const a=i.groups,l=a.attackBonus.replace("+","");let c="";if(a.damageTypeBonus&&(a.damageBonusInt||a.damageBonusDice)&&(c=` + ${a.damageBonusInt??a.damageBonusDice} [${a.damageTypeBonus}]`),a.damageTypeVers&&(a.damageIntVers||a.damageDiceVers)){let u=`${a.damageIntVers??a.damageDiceVers} [${a.damageTypeVers}]`+c;o.push({name:`2-Handed ${e}`,automation:[{type:"target",target:"each",effects:[{type:"attack",hit:[{type:"damage",damage:u,overheal:!1}],miss:[],attackBonus:l}]},{type:"text",text:t,title:"Effect"}],_v:2,activation_type:n})}if(a.damageTypeRanged&&(a.damageRangedInt||a.damageRangedDice)){let u=`${a.damageRangedInt??a.damageRangedDice} [${a.damageTypeRanged}]`+c;o.push({name:`Ranged ${e}`,automation:[{type:"target",target:"each",effects:[{type:"attack",hit:[{type:"damage",damage:u,overheal:!1}],miss:[],attackBonus:l}]},{type:"text",text:t,title:"Effect"}],_v:2,activation_type:n})}let h=`${a.damageIntBase??a.damageDiceBase} [${a.damageTypeBase}]`+c;return o.push({name:e,automation:[{type:"target",target:"each",effects:[{type:"attack",hit:[{type:"damage",damage:h,overheal:!1}],miss:[],attackBonus:l}]},{type:"text",text:t,title:"Effect"}],_v:2,activation_type:n}),o?o.length==1?[o[0],null]:[o,null]:[null,`${e}: Attempted to parse into Avrae Automation but an error occured.`]}else if(r)return t.includes(" DC ")?[null,`${e}: Cannot generate automation for save-based attacks.`]:[{name:e,automation:[{type:"target",target:"each",effects:[{type:"damage",damage:r[1]+`[${r[2]}]`,overheal:!1}]},{type:"text",text:t,title:"Effect"}],_v:2,activation_type:n},null];return[null,`${e}: Did not Generate Avrae Automation.`]}function yu(t){return t.charAt(0).toUpperCase()+t.slice(1)}function Aa(t){return t==.125?"1/8":t==.25?"1/4":t==.5?"1/2":t.toString()}function Ea(t,e=!1){let n="",s=t.filter(i=>i.name!=="New speed"&&i.name!=="New sense").length;for(let[i,r]of t.entries())r.name==="New speed"||r.name==="New sense"||(r.name!="Walk"&&(n+=r.name.toLowerCase()+" "),n+=r.value,r.unit!="none"&&(n+=r.unit+"."),r.comment&&(n+=` (${r.comment})`),(e||s!=1&&i!=s-1)&&(n+=", "));return n}function va(t){let e=t.spellcasting.innateSpells,n=t.description.name,s="";if(!e.spellCastingAbility)return s;!t.description.isProperNoun&&!e.displayAsAction?s+=`The ${n.toLowerCase()}'s spellcasting ability is ${Pt(e.spellCastingAbility)} (spell save DC ${Dt(t)}, ${Rt(t)} to hit with spell attacks). It can innately cast the following spells${jt(t)}:`:!t.description.isProperNoun&&e.displayAsAction?s+=`The ${n.toLowerCase()} casts one of the following spells${jt(t)} and using ${Pt(e.spellCastingAbility)} as the spellcasting ability (spell save DC ${Dt(t)}, ${Rt(t)} to hit with spell attacks).`:t.description.isProperNoun&&!e.displayAsAction?s+=`${n}'s spellcasting ability is ${Pt(e.spellCastingAbility)} (spell save DC ${Dt(t)}, ${Rt(t)} to hit with spell attacks). ${n} can innately cast the following spells${jt(t)}:`:t.description.isProperNoun&&e.displayAsAction&&(s+=`${n} casts one of the following spells${jt(t)} and using ${Pt(e.spellCastingAbility)} as the spellcasting ability (spell save DC ${Dt(t)}, ${Rt(t)} to hit with spell attacks).`);for(let i in e.spellList)e.spellList[i].length!=0&&(parseInt(i)==0?s+=`
At will: `:s+=`
${i}/day${e.spellList[i].length>1?" each":""}: `,s+=e.spellList[i].map(r=>r.comment.length>0?`*${r.spell.toLowerCase()} (${r.comment})*`:`*${r.spell.toLowerCase()}*`).sort().join(", "));return s}function Pt(t){return t=t.toLowerCase().trim(),t=="str"?"Strength":t=="dex"?"Dexterity":t=="con"?"Constitution":t=="wis"?"Wisdom":t=="int"?"Intelligence":t=="cha"?"Charisma":"Spellcasting Ability not found."}function xi(t,e){return Math.floor(t.abilities.stats[e]/2)-5}function Dt(t){let e=t.spellcasting.innateSpells;return e.spellCastingAbility?e.spellDcOverride?e.spellDcOverride:8+xi(t,e.spellCastingAbility)+t.core.proficiencyBonus:0}function Rt(t){let e=t.spellcasting.innateSpells;if(!e.spellCastingAbility)return"0";let n=0;return e.spellBonusOverride||e.spellBonusOverride===0?n=e.spellBonusOverride:n=xi(t,e.spellCastingAbility)+t.core.proficiencyBonus,n>=0?"+"+n:n.toString()}function jt(t){let e=t.spellcasting.innateSpells.noComponentsOfType.sort();if(e.length==0)return"";if(e.length==3)return", requiring no components";if(e.length==2){let n="material";return e.includes("Verbal")||(n="verbal"),e.includes("Somatic")||(n="somatic"),`, requiring only ${n} components`}return`, requiring no ${e[0].toLowerCase()} components`}const _a=sr(),Ca=Pn({props:{data:{type:Object,required:!0}},data(){return{displayCR:Aa,md:_a}},methods:{hpCalc(){return Math.floor(this.data.defenses.hp.numOfHitDie*((this.data.defenses.hp.sizeOfHitDie+1)/2+this.statCalc("con")))},statCalc(t){return Math.floor(this.data.abilities.stats[t]/2)-5},ppCalc(){if(this.data.misc.passivePerceptionOverride!==null)return this.data.misc.passivePerceptionOverride;{let t=this.data.abilities.skills;if(t){for(let e of t)if(e.skillName=="Perception"){if(e.override||e.override==0)return 10+e.override;if(e.isHalfProficient)return 10+this.statCalc("wis")+Math.floor(this.data.core.proficiencyBonus/2);if(e.isProficient)return 10+this.statCalc("wis")+this.data.core.proficiencyBonus;if(e.isExpertise)return 10+this.statCalc("wis")+this.data.core.proficiencyBonus*2;break}}}return 10+this.statCalc("wis")},statSign(t){return this.statCalc(t)>=0?"+":""},saveSign(t){return this.data.abilities.saves&&(this.statCalc(t)+this.data.core.proficiencyBonus>=0||this.data.abilities.saves[t]&&this.data.abilities.saves[t].override)?"+":""},hitDieBonus(){let t=this.data.defenses.hp.numOfHitDie*this.statCalc("con");return t!=0?t>0?"+"+t.toString():t.toString():""},skillOutput(){let t=Array.from(this.data.abilities.skills);t.sort((i,r)=>i.skillName.localeCompare(r.skillName));const e={str:["athletics"],dex:["acrobatics","sleightofhand","stealth"],con:[],int:["arcana","history","investigation","nature","religion"],wis:["animalhandling","insight","medicine","perception","survival"],cha:["deception","intimidation","performance","persuasion"]};let n=new Set;t=t.filter(i=>n.has(i.skillName)?!1:(n.add(i.skillName),!0));let s=[];for(let i of t){if(!i.isExpertise&&!i.isHalfProficient&&!i.isProficient&&!i.override)continue;let r=0;for(let o in e)if(e[o].includes(i.skillName.replaceAll(" ","").toLowerCase())){if(i.override&&i.override!==null){let a=i.override;s.push(`${i.skillName} ${a??0>=0?"+":""}${a}`)}else r=this.statCalc(o),i.isHalfProficient?r+=Math.floor(this.data.core.proficiencyBonus/2):i.isProficient?r+=this.data.core.proficiencyBonus:i.isExpertise&&(r+=this.data.core.proficiencyBonus*2),s.push(`${i.skillName} ${r>=0?"+":""}${r}`);break}else continue}return s.join(", ")},showSkills(){for(let t of this.data.abilities.skills)if(t.isProficient||t.isHalfProficient||t.isExpertise||t.override||t.override==0)return!0;return!1},showCasting(){return!!(this.data.spellcasting.casterSpells.casterLevel&&this.data.spellcasting.casterSpells.castingClass)},showInnateCasting(){return this.data.spellcasting.innateSpells.spellCastingAbility!=null&&(this.data.spellcasting.innateSpells.spellList[0].length>0||this.data.spellcasting.innateSpells.spellList[1].length>0||this.data.spellcasting.innateSpells.spellList[2].length>0||this.data.spellcasting.innateSpells.spellList[3].length>0)},showFeatures(){return Object.values(this.data.features).some(t=>t.length>0)},alphaSort(t){const e=(n,s)=>{const i=n.split(" ").pop(),r=s.split(" ").pop();return i.localeCompare(r)};return t.sort(e)},langSort(t){return t},yamlString(){return vi(this.data)},nthSuffix(t){switch(t){case 1:return"1st";case 2:return"2nd";case 3:return"3rd";default:return t.toString()+"th"}},fullSpellAbilityName(t=!1){let e;return t?e=this.data.spellcasting.innateSpells.spellCastingAbility:e=this.data.spellcasting.casterSpells.spellCastingAbilityOverride??this.data.spellcasting.casterSpells.spellCastingAbility,e=="str"?"Strength":e=="dex"?"Dexterity":e=="con"?"Constitution":e=="wis"?"Wisdom":e=="int"?"Intelligence":e=="cha"?"Charisma":"Spellcasting Ability not found."},spellDc(t=!1){let e;return t?e=this.data.spellcasting.innateSpells:e=this.data.spellcasting.casterSpells,e.spellDcOverride?e.spellDcOverride:t&&e.spellCastingAbility?8+this.statCalc(e.spellCastingAbility)+this.data.core.proficiencyBonus:8+this.statCalc(e.spellCastingAbilityOveride??e.spellCastingAbility)+this.data.core.proficiencyBonus},spellAttackBonus(t=!1){let e;t?e=this.data.spellcasting.innateSpells:e=this.data.spellcasting.casterSpells;let n=0;return e.spellBonusOverride||e.spellBonusOverride===0?n=e.spellBonusOverride:t&&e.spellCastingAbility?n=this.statCalc(e.spellCastingAbility)+this.data.core.proficiencyBonus:n=this.statCalc(e.spellCastingAbilityOveride??e.spellCastingAbility)+this.data.core.proficiencyBonus,n>=0?"+"+n:n.toString()},componentsString(t=!0){let e=this.data.spellcasting.innateSpells.noComponentsOfType.sort(),n=t?":":"";if(e.length==0)return"";if(e.length==3)return", requiring no components"+n;if(e.length==2){let s="material";return e.includes("Verbal")||(s="verbal"),e.includes("Somatic")||(s="somatic"),`, requiring only ${s} components`+n}return`, requiring no ${e[0].toLowerCase()} components`+n},displaySpeedOrSenses:Ea,displayInnateCasting:va}}),F=t=>(Zi("data-v-65925e1c"),t=t(),Qi(),t),$a={class:"stat-block"},Ia={class:"stat-block__row"},Ba={class:"stat-block__name-container"},La={class:"stat-block__core"},Ma=["src"],Pa={class:"stat-block__row"},Da=F(()=>y("b",null," Armor Class ",-1)),Ra={key:0},ja=F(()=>y("b",null," Hit Points ",-1)),Fa={key:0},Ua={key:1},Ha={class:"stat-block__speed-container"},Va=F(()=>y("b",null," Speed ",-1)),qa={class:"stat-block__row stat-block__abilities"},xa=F(()=>y("div",null,[y("b",null,"STR")],-1)),Wa=F(()=>y("div",null,[y("b",null,"DEX")],-1)),Ka=F(()=>y("div",null,[y("b",null,"CON")],-1)),Ja=F(()=>y("div",null,[y("b",null,"INT")],-1)),Ga=F(()=>y("div",null,[y("b",null,"WIS")],-1)),Ya=F(()=>y("div",null,[y("b",null,"CHA")],-1)),za={class:"stat-block__row"},Xa={key:0,class:"stat-block__save-container"},Za=F(()=>y("b",null," Saving Throws ",-1)),Qa={key:0},el=F(()=>y("span",{class:"ending-comma"},",",-1)),tl={key:1},nl=F(()=>y("span",{class:"ending-comma"},",",-1)),sl={key:2},il=F(()=>y("span",{class:"ending-comma"},",",-1)),rl={key:3},ol=F(()=>y("span",{class:"ending-comma"},",",-1)),al={key:4},ll=F(()=>y("span",{class:"ending-comma"},",",-1)),cl={key:5},ul=F(()=>y("span",{class:"ending-comma"},",",-1)),fl={key:6},hl=F(()=>y("span",{class:"ending-comma"},",",-1)),dl={key:7},pl=F(()=>y("span",{class:"ending-comma"},",",-1)),ml={key:8},gl=F(()=>y("span",{class:"ending-comma"},",",-1)),yl={key:9},bl=F(()=>y("span",{class:"ending-comma"},",",-1)),wl={key:10},Sl=F(()=>y("span",{class:"ending-comma"},",",-1)),kl={key:11},Nl=F(()=>y("span",{class:"ending-comma"},",",-1)),Tl={key:1,class:"stat-block__skills-container"},Ol=F(()=>y("b",null," Skills ",-1)),Al={key:2,class:"stat-block__vuln-container"},El=F(()=>y("b",null," Vulnerabilities ",-1)),vl=F(()=>y("span",{class:"ending-comma"},", ",-1)),_l={key:3,class:"stat-block__res-container"},Cl=F(()=>y("b",null," Resistances ",-1)),$l=F(()=>y("span",{class:"ending-comma"},", ",-1)),Il={key:4,class:"stat-block__imm-container"},Bl=F(()=>y("b",null," Immunities ",-1)),Ll=F(()=>y("span",{class:"ending-comma"},", ",-1)),Ml={key:5,class:"stat-block__imm-container"},Pl=F(()=>y("b",null," Condition Immunities ",-1)),Dl=F(()=>y("span",{class:"ending-comma"},", ",-1)),Rl={ckass:"stat-block__senses-container"},jl=F(()=>y("b",null," Senses ",-1)),Fl={class:"stat-block__language-container"},Ul=F(()=>y("b",null," Languages ",-1)),Hl={key:0},Vl=F(()=>y("span",{class:"ending-comma"},", ",-1)),ql={key:2},xl={class:"challenge-prof"},Wl=F(()=>y("b",null," Challenge ",-1)),Kl=F(()=>y("b",null," Proficiency Bonus ",-1)),Jl={key:0,class:"stat-block__row"},Gl={key:0,class:"feature-container"},Yl={key:0},zl={key:0,class:"feature-container__automation-icon"},Xl=["innerHTML"],Zl={key:1},Ql={key:0},ec=["innerHTML"],tc={key:2},nc=F(()=>y("b",null,[y("i",null,"Spellcasting")],-1)),sc={class:"feature-container__desc"},ic={key:0},rc={key:1},oc={key:2},ac={key:3},lc={key:4},cc={key:5},uc={key:6},fc={class:"spell-list"},hc={key:0},dc={key:0},pc={key:1},mc={key:1,class:"feature-container"},gc=F(()=>y("h3",{class:"feature-container__title"}," Actions ",-1)),yc={key:0},bc={key:0,class:"feature-container__automation-icon"},wc=["innerHTML"],Sc={key:1},kc={key:0},Nc=["innerHTML"],Tc={key:2,class:"feature-container"},Oc=F(()=>y("h3",{class:"feature-container__title"}," Bonus Actions ",-1)),Ac={key:0},Ec={key:0,class:"feature-container__automation-icon"},vc=["innerHTML"],_c={key:3,class:"feature-container"},Cc=F(()=>y("h3",{class:"feature-container__title"}," Reactions ",-1)),$c={key:0},Ic={key:0,class:"feature-container__automation-icon"},Bc=["innerHTML"],Lc={key:4,class:"feature-container"},Mc=F(()=>y("h3",{class:"feature-container__title"}," Legendary Actions ",-1)),Pc={key:0},Dc={key:0,class:"feature-container__automation-icon"},Rc=["innerHTML"],jc={key:5,class:"feature-container"},Fc=F(()=>y("h3",{class:"feature-container__title"}," Mythic Actions ",-1)),Uc={key:0},Hc={key:0,class:"feature-container__automation-icon"},Vc=["innerHTML"],qc={key:6,class:"feature-container"},xc=F(()=>y("h3",{class:"feature-container__title"}," Lair Actions ",-1)),Wc={key:0},Kc={key:0,class:"feature-container__automation-icon"},Jc=["innerHTML"],Gc={key:7,class:"feature-container"},Yc=F(()=>y("h3",{class:"feature-container__title"}," Regional Effects ",-1)),zc={key:0},Xc={key:0,class:"feature-container__automation-icon"},Zc=["innerHTML"],Qc={key:1,class:"description"},eu=F(()=>y("h2",{class:"feature-container__title"}," Description ",-1)),tu=["innerHTML"];function nu(t,e,n,s,i,r){const o=Ms("tooltip");return N(),T("div",$a,[y("div",Ia,[y("h1",Ba,O(t.data.description.name),1),y("span",La,O(t.data.core.size)+" "+O(t.data.core.race)+O(t.data.description.alignment?",":"")+" "+O(t.data.description.alignment),1),t.data.description.image?(N(),T("img",{key:0,class:"stat-block__image",src:t.data.description.image},null,8,Ma)):P("",!0)]),y("div",Pa,[y("div",null,[Da,U(" "+O(t.data.defenses.ac.ac)+" ",1),t.data.defenses.ac.acSource?(N(),T("span",Ra," ("+O(t.data.defenses.ac.acSource)+") ",1)):P("",!0)]),y("div",null,[ja,t.data.defenses.hp.override?(N(),T("span",Fa,O(t.data.defenses.hp.override),1)):(N(),T("span",Ua,O(t.hpCalc())+" ("+O(t.data.defenses.hp.numOfHitDie)+"d"+O(t.data.defenses.hp.sizeOfHitDie)+O(t.hitDieBonus())+")",1))]),y("div",Ha,[Va,U(" "+O(t.displaySpeedOrSenses(t.data.core.speed)),1)])]),y("div",qa,[y("div",null,[xa,y("span",null,O(t.data.abilities.stats.str)+" ("+O(t.statSign("str"))+O(t.statCalc("str"))+")",1)]),y("div",null,[Wa,y("span",null,O(t.data.abilities.stats.dex)+" ("+O(t.statSign("dex"))+O(t.statCalc("dex"))+")",1)]),y("div",null,[Ka,y("span",null,O(t.data.abilities.stats.con)+" ("+O(t.statSign("con"))+O(t.statCalc("con"))+")",1)]),y("div",null,[Ja,y("span",null,O(t.data.abilities.stats.int)+" ("+O(t.statSign("int"))+O(t.statCalc("int"))+")",1)]),y("div",null,[Ga,y("span",null,O(t.data.abilities.stats.wis)+" ("+O(t.statSign("wis"))+O(t.statCalc("wis"))+")",1)]),y("div",null,[Ya,y("span",null,O(t.data.abilities.stats.cha)+" ("+O(t.statSign("cha"))+O(t.statCalc("cha"))+")",1)])]),y("div",za,[Object.values(t.data.abilities.saves).some(a=>a.isProficient===!0||a.override!==null)?(N(),T("div",Xa,[Za,t.data.abilities.saves.str.override!==null?(N(),T("span",Qa,[U(" Str "+O(t.saveSign("str"))+O(t.data.abilities.saves.str.override),1),el])):t.data.abilities.saves.str.isProficient?(N(),T("span",tl,[U(" Str "+O(t.saveSign("str"))+O(t.statCalc("str")+t.data.core.proficiencyBonus),1),nl])):P("",!0),t.data.abilities.saves.dex.override!==null?(N(),T("span",sl,[U(" Dex "+O(t.saveSign("dex"))+O(t.data.abilities.saves.dex.override),1),il])):P("",!0),U(),t.data.abilities.saves.dex.isProficient?(N(),T("span",rl,[U(" Dex "+O(t.saveSign("dex"))+O(t.statCalc("dex")+t.data.core.proficiencyBonus),1),ol])):P("",!0),t.data.abilities.saves.con.override!==null?(N(),T("span",al,[U(" Con "+O(t.saveSign("con"))+O(t.data.abilities.saves.con.override),1),ll])):P("",!0),U(),t.data.abilities.saves.con.isProficient?(N(),T("span",cl,[U(" Con "+O(t.saveSign("con"))+O(t.statCalc("con")+t.data.core.proficiencyBonus),1),ul])):P("",!0),t.data.abilities.saves.int.override!==null?(N(),T("span",fl,[U(" Int "+O(t.saveSign("int"))+O(t.data.abilities.saves.int.override),1),hl])):P("",!0),U(),t.data.abilities.saves.int.isProficient?(N(),T("span",dl,[U(" Int "+O(t.saveSign("int"))+O(t.statCalc("int")+t.data.core.proficiencyBonus),1),pl])):P("",!0),t.data.abilities.saves.wis.override!==null?(N(),T("span",ml,[U(" Wis "+O(t.saveSign("wis"))+O(t.data.abilities.saves.wis.override),1),gl])):P("",!0),U(),t.data.abilities.saves.wis.isProficient?(N(),T("span",yl,[U(" Wis "+O(t.saveSign("wis"))+O(t.statCalc("wis")+t.data.core.proficiencyBonus),1),bl])):P("",!0),t.data.abilities.saves.cha.override!==null?(N(),T("span",wl,[U(" Cha "+O(t.saveSign("cha"))+O(t.data.abilities.saves.cha.override),1),Sl])):P("",!0),U(),t.data.abilities.saves.cha.isProficient?(N(),T("span",kl,[U(" Cha "+O(t.saveSign("cha"))+O(t.statCalc("cha")+t.data.core.proficiencyBonus),1),Nl])):P("",!0)])):P("",!0),t.showSkills()?(N(),T("div",Tl,[Ol,U(" "+O(t.skillOutput()),1)])):P("",!0),t.data.defenses.vulnerabilities&&t.data.defenses.vulnerabilities.length>0?(N(),T("div",Al,[El,(N(!0),T(ue,null,fe(t.alphaSort(t.data.defenses.vulnerabilities),a=>(N(),T("span",null,[y("span",null,[U(O(a.toLowerCase()),1),vl])]))),256))])):P("",!0),t.data.defenses.resistances&&t.data.defenses.resistances.length>0?(N(),T("div",_l,[Cl,(N(!0),T(ue,null,fe(t.alphaSort(t.data.defenses.resistances),a=>(N(),T("span",null,[y("span",null,[U(O(a.toLowerCase()),1),$l])]))),256))])):P("",!0),t.data.defenses.immunities&&t.data.defenses.immunities.length>0?(N(),T("div",Il,[Bl,(N(!0),T(ue,null,fe(t.alphaSort(t.data.defenses.immunities),a=>(N(),T("span",null,[y("span",null,[U(O(a.toLowerCase()),1),Ll])]))),256))])):P("",!0),t.data.defenses.conditionImmunities&&t.data.defenses.conditionImmunities.length>0?(N(),T("div",Ml,[Pl,(N(!0),T(ue,null,fe(t.alphaSort(t.data.defenses.conditionImmunities),a=>(N(),T("span",null,[y("span",null,[U(O(a.toLowerCase()),1),Dl])]))),256))])):P("",!0),y("div",Rl,[jl,U(" "+O(t.displaySpeedOrSenses(t.data.core.senses,!0))+" ",1),y("span",null," passive Perception "+O(t.ppCalc()),1)]),y("div",Fl,[Ul,t.data.core.languages&&t.data.core.languages.length==0&&!t.data.misc.telepathy?(N(),T("span",Hl," — ")):(N(!0),T(ue,{key:1},fe(t.data.core.languages?.sort(),a=>(N(),T("span",null,[y("span",null,[U(O(a),1),Vl])]))),256)),t.data.misc.telepathy?(N(),T("span",ql," telepathy "+O(t.data.misc.telepathy)+"ft.",1)):P("",!0)]),y("div",xl,[y("span",null,[Wl,U(" "+O(t.displayCR(t.data.description.cr))+" ("+O(t.data.description.xp)+" xp) ",1)]),y("span",null,[Kl,U(" +"+O(t.data.core.proficiencyBonus),1)])])]),t.showFeatures()||t.showCasting()||t.showInnateCasting()?(N(),T("div",Jl,[t.data.features.features.length>0||t.showCasting()||t.showInnateCasting()?(N(),T("div",Gl,[t.data.misc.featureHeaderTexts.features?(N(),T("p",Yl,O(t.data.misc.featureHeaderTexts.features),1)):P("",!0),(N(!0),T(ue,null,fe(t.data.features.features,a=>(N(),T("p",null,[y("b",null,[y("i",null,O(a.name)+".",1),a.automation?Ie((N(),T("sup",zl,[U("†")])),[[o,"Has Automation"]]):P("",!0)]),y("span",{class:"feature-container__desc",innerHTML:t.md.render(a.description)},null,8,Xl)]))),256)),t.showInnateCasting()&&!t.data.spellcasting.innateSpells.displayAsAction?(N(),T("p",Zl,[y("b",null,[y("i",null,[U("Innate Spellcasting"),t.data.spellcasting.innateSpells.isPsionics?(N(),T("span",Ql," (Psionics)")):P("",!0),U(".")])]),y("span",{class:"feature-container__desc",innerHTML:t.md.render(t.displayInnateCasting(t.data))},null,8,ec)])):P("",!0),t.showCasting()&&t.data.spellcasting.casterSpells.castingClass&&t.data.spellcasting.casterSpells.casterLevel&&t.data.spellcasting.casterSpells.spellSlotList?(N(),T("p",tc,[nc,y("span",sc,[t.data.description.isProperNoun?P("",!0):(N(),T("span",ic," The ")),U(" "+O(t.data.description.isProperNoun?t.data.description.name:t.data.description.name.toLowerCase())+" is a "+O(t.nthSuffix(t.data.spellcasting.casterSpells.casterLevel))+"-level spellcaster. ",1),t.data.description.isProperNoun?(N(),T("span",rc," Their ")):(N(),T("span",oc," Its ")),U(" spellcasting ability is "+O(t.fullSpellAbilityName())+" (spell save DC "+O(t.spellDc())+", "+O(t.spellAttackBonus())+" to hit with spell attacks). ",1),t.data.description.isProperNoun?(N(),T("span",lc,O(t.data.description.name),1)):(N(),T("span",ac," It ")),["Sorcerer","Bard","Ranger","Warlock"].includes(t.data.spellcasting.casterSpells.castingClass)?(N(),T("span",cc," knows the following "+O(t.data.spellcasting.casterSpells.castingClass.toLowerCase())+" spells: ",1)):(N(),T("span",uc," has the following "+O(t.data.spellcasting.casterSpells.castingClass.toLowerCase())+" spells prepared: ",1)),y("div",fc,[(N(!0),T(ue,null,fe(t.data.spellcasting.casterSpells.spellList,(a,l)=>(N(),T("p",null,[l==0&&!["Ranger","Paladin"].includes(t.data.spellcasting.casterSpells.castingClass)||Object.keys(t.data.spellcasting.casterSpells.spellSlotList).includes(l.toString())?(N(),T("div",hc,[l==0&&a.length>0?(N(),T("span",dc," Cantrips (at will): ")):a.length>0?(N(),T("span",pc,O(t.nthSuffix(l))+" level ("+O(t.data.spellcasting.casterSpells.spellSlotList[l])+" slots): ",1)):P("",!0),y("i",null,O(a.sort().join(", ")),1)])):P("",!0)]))),256))])])])):P("",!0)])):P("",!0),t.data.features.actions.length>0||t.showInnateCasting()&&t.data.spellcasting.innateSpells.displayAsAction?(N(),T("div",mc,[gc,t.data.misc.featureHeaderTexts.actions?(N(),T("p",yc,O(t.data.misc.featureHeaderTexts.actions),1)):P("",!0),(N(!0),T(ue,null,fe(t.data.features.actions,a=>(N(),T("p",null,[y("b",null,[y("i",null,O(a.name)+".",1),a.automation?Ie((N(),T("sup",bc,[U("†")])),[[o,"Has Automation"]]):P("",!0)]),y("span",{class:"feature-container__desc",innerHTML:t.md.render(a.description)},null,8,wc)]))),256)),t.showInnateCasting()&&t.data.spellcasting.innateSpells.displayAsAction?(N(),T("p",Sc,[y("b",null,[y("i",null,[U("Spellcasting"),t.data.spellcasting.innateSpells.isPsionics?(N(),T("span",kc," (Psionics)")):P("",!0),U(".")])]),y("span",{class:"feature-container__desc",innerHTML:t.md.render(t.displayInnateCasting(t.data))},null,8,Nc)])):P("",!0)])):P("",!0),t.data.features.bonus.length>0?(N(),T("div",Tc,[Oc,t.data.misc.featureHeaderTexts.bonus?(N(),T("p",Ac,O(t.data.misc.featureHeaderTexts.bonus),1)):P("",!0),(N(!0),T(ue,null,fe(t.data.features.bonus,a=>(N(),T("p",null,[y("b",null,[y("i",null,O(a.name)+".",1),a.automation?Ie((N(),T("sup",Ec,[U("†")])),[[o,"Has Automation"]]):P("",!0)]),y("span",{class:"feature-container__desc",innerHTML:t.md.render(a.description)},null,8,vc)]))),256))])):P("",!0),t.data.features.reactions.length>0?(N(),T("div",_c,[Cc,t.data.misc.featureHeaderTexts.reactions?(N(),T("p",$c,O(t.data.misc.featureHeaderTexts.reactions),1)):P("",!0),(N(!0),T(ue,null,fe(t.data.features.reactions,a=>(N(),T("p",null,[y("b",null,[y("i",null,O(a.name)+".",1),a.automation?Ie((N(),T("sup",Ic,[U("†")])),[[o,"Has Automation"]]):P("",!0)]),y("span",{class:"feature-container__desc",innerHTML:t.md.render(a.description)},null,8,Bc)]))),256))])):P("",!0),t.data.features.legendary.length>0?(N(),T("div",Lc,[Mc,t.data.misc.featureHeaderTexts.legendary?(N(),T("p",Pc,O(t.data.misc.featureHeaderTexts.legendary.replace("$NUM$",t.data.misc.legActionsPerRound.toString())),1)):P("",!0),(N(!0),T(ue,null,fe(t.data.features.legendary,a=>(N(),T("p",null,[y("b",null,[y("i",null,O(a.name)+".",1),a.automation?Ie((N(),T("sup",Dc,[U("†")])),[[o,"Has Automation"]]):P("",!0)]),y("span",{class:"feature-container__desc",innerHTML:t.md.render(a.description)},null,8,Rc)]))),256))])):P("",!0),t.data.features.mythic.length>0?(N(),T("div",jc,[Fc,t.data.misc.featureHeaderTexts.mythic?(N(),T("p",Uc,O(t.data.misc.featureHeaderTexts.mythic),1)):P("",!0),(N(!0),T(ue,null,fe(t.data.features.mythic,a=>(N(),T("p",null,[y("b",null,[y("i",null,O(a.name)+".",1),a.automation?Ie((N(),T("sup",Hc,[U("†")])),[[o,"Has Automation"]]):P("",!0)]),y("span",{class:"feature-container__desc",innerHTML:t.md.render(a.description)},null,8,Vc)]))),256))])):P("",!0),t.data.features.lair.length>0?(N(),T("div",qc,[xc,t.data.misc.featureHeaderTexts.lair?(N(),T("p",Wc,O(t.data.misc.featureHeaderTexts.lair),1)):P("",!0),(N(!0),T(ue,null,fe(t.data.features.lair,a=>(N(),T("p",null,[y("b",null,[y("i",null,O(a.name)+".",1),a.automation?Ie((N(),T("sup",Kc,[U("†")])),[[o,"Has Automation"]]):P("",!0)]),y("span",{class:"feature-container__desc",innerHTML:t.md.render(a.description)},null,8,Jc)]))),256))])):P("",!0),t.data.features.regional.length>0?(N(),T("div",Gc,[Yc,t.data.misc.featureHeaderTexts.regional?(N(),T("p",zc,O(t.data.misc.featureHeaderTexts.regional),1)):P("",!0),(N(!0),T(ue,null,fe(t.data.features.regional,a=>(N(),T("p",null,[y("b",null,[y("i",null,O(a.name)+".",1),a.automation?Ie((N(),T("sup",Xc,[U("†")])),[[o,"Has Automation"]]):P("",!0)]),y("span",{class:"feature-container__desc",innerHTML:t.md.render(a.description)},null,8,Zc)]))),256))])):P("",!0)])):P("",!0),t.data.description.description?(N(),T("div",Qc,[eu,y("div",{innerHTML:t.md.render(t.data.description.description)},null,8,tu)])):P("",!0)])}const bu=Dn(Ca,[["render",nu],["__scopeId","data-v-65925e1c"]]),xe=Number.isNaN||window.isNaN,su=Pn({components:{LabelledComponent:wa},props:{isClearable:{type:Boolean,required:!1,default:!1},min:{type:Number,default:0},max:{type:Number,default:1/0},step:{type:Number,required:!1,default:5},title:{type:String,required:!0},modelValue:{type:Number,default:NaN}},emits:["update:modelValue"],data(){return{value:NaN,id:this.$.uid}},methods:{isNaN:xe,change(t){this.setValue(t?.target.value)},decrease(){if(this.decreasable){let{value:t}=this;if(t==null){this.setValue(0);return}xe(t)&&(t=0),this.setValue(t-this.step)}},increase(){if(this.increasable){let{value:t}=this;if(t==null){this.setValue(0);return}xe(t)&&(t=0),this.setValue(t+this.step)}},setValue(t){if(t==null){const s=this.value;let i=null;this.value=i,this.$emit("update:modelValue",i,s);return}const e=this.value;let n=typeof t!="number"?parseFloat(t):t;xe(n)||this.min<=this.max&&(n=Math.min(this.max,Math.max(this.min,n))),this.value=n,n===e&&(this.$refs.input.value=String(n)),this.$emit("update:modelValue",n,e)},clear(){this.setValue(null)}},computed:{increasable(){return this.value==null?!0:xe(this.value)||this.value<this.max},decreasable(){return this.value==null?!0:xe(this.value)||this.value>this.min},placeholder(){return this.isClearable?"Override":""}},watch:{modelValue:{immediate:!0,handler(t,e){!(xe(t)&&typeof e>"u")&&t!==this.value&&this.setValue(t)}}}}),iu={class:"quantity"},ru=["name","value","min","max","step","id","placeholder"],ou={class:"quantity-nav"},au=["aria-label"],lu=["aria-label"],cu=["aria-label"];function uu(t,e,n,s,i,r){const o=os("font-awesome-icon"),a=os("LabelledComponent");return N(),er(a,{title:t.title,id:t.id},{default:tr(()=>[Ps(t.$slots,"default",{},void 0,!0),y("div",iu,[y("input",{ref:"input",type:"number",name:t.title,value:isNaN(t.value)?"":t.value,min:t.min,max:t.max,step:t.step,inputmode:"numeric",id:t.title.toLowerCase().replaceAll(" ","")+t.id,onChange:e[0]||(e[0]=(...l)=>t.change&&t.change(...l)),placeholder:t.placeholder},null,40,ru),y("div",ou,[y("div",{class:"quantity-button quantity-up",onClick:e[1]||(e[1]=as((...l)=>t.increase&&t.increase(...l),["prevent"])),"aria-label":`Increase ${t.title} by ${t.step}`},"+",8,au),y("div",{class:"quantity-button quantity-down",onClick:e[2]||(e[2]=as((...l)=>t.decrease&&t.decrease(...l),["prevent"])),"aria-label":`Decrease ${t.title} by ${t.step}`},"-",8,lu)]),t.isClearable?(N(),T("span",{key:0,class:"delete-button",onClick:e[3]||(e[3]=(...l)=>t.clear&&t.clear(...l)),"aria-label":`Clear override of ${t.title}`},[nr(o,{icon:["fas","trash"]})],8,cu)):P("",!0)])]),_:3},8,["title","id"])}const wu=Dn(su,[["render",uu],["__scopeId","data-v-4b09a917"]]);export{wa as L,bu as S,ho as Y,gu as a,wu as b,yu as c,du as d,mu as e,Bs as f,pu as g,Aa as h,Oa as p,Bn as s};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}