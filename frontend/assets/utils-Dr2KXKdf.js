import{a1 as Fs,v as ve,d as Us,_ as Vs,y as Ks,o as zn,c as Zn,b as qs,e as Xn,f as Hs,A as Ws,i as Js,a0 as Gs}from"./index-CCTs9utp.js";const Tn=Symbol.for("yaml.alias"),mn=Symbol.for("yaml.document"),Ce=Symbol.for("yaml.map"),Bi=Symbol.for("yaml.pair"),Ie=Symbol.for("yaml.scalar"),nt=Symbol.for("yaml.seq"),he=Symbol.for("yaml.node.type"),Fe=t=>!!t&&typeof t=="object"&&t[he]===Tn,it=t=>!!t&&typeof t=="object"&&t[he]===mn,st=t=>!!t&&typeof t=="object"&&t[he]===Ce,J=t=>!!t&&typeof t=="object"&&t[he]===Bi,W=t=>!!t&&typeof t=="object"&&t[he]===Ie,rt=t=>!!t&&typeof t=="object"&&t[he]===nt;function G(t){if(t&&typeof t=="object")switch(t[he]){case Ce:case nt:return!0}return!1}function Y(t){if(t&&typeof t=="object")switch(t[he]){case Tn:case Ce:case Ie:case nt:return!0}return!1}const Ys=t=>(W(t)||G(t))&&!!t.anchor,re=Symbol("break visit"),$i=Symbol("skip children"),we=Symbol("remove node");function _e(t,e){const n=Ci(e);it(t)?qe(null,t.contents,n,Object.freeze([t]))===we&&(t.contents=null):qe(null,t,n,Object.freeze([]))}_e.BREAK=re;_e.SKIP=$i;_e.REMOVE=we;function qe(t,e,n,i){const s=vi(t,e,n,i);if(Y(s)||J(s))return _i(t,i,s),qe(t,s,n,i);if(typeof s!="symbol"){if(G(e)){i=Object.freeze(i.concat(e));for(let r=0;r<e.items.length;++r){const o=qe(r,e.items[r],n,i);if(typeof o=="number")r=o-1;else{if(o===re)return re;o===we&&(e.items.splice(r,1),r-=1)}}}else if(J(e)){i=Object.freeze(i.concat(e));const r=qe("key",e.key,n,i);if(r===re)return re;r===we&&(e.key=null);const o=qe("value",e.value,n,i);if(o===re)return re;o===we&&(e.value=null)}}return s}async function Dt(t,e){const n=Ci(e);it(t)?await He(null,t.contents,n,Object.freeze([t]))===we&&(t.contents=null):await He(null,t,n,Object.freeze([]))}Dt.BREAK=re;Dt.SKIP=$i;Dt.REMOVE=we;async function He(t,e,n,i){const s=await vi(t,e,n,i);if(Y(s)||J(s))return _i(t,i,s),He(t,s,n,i);if(typeof s!="symbol"){if(G(e)){i=Object.freeze(i.concat(e));for(let r=0;r<e.items.length;++r){const o=await He(r,e.items[r],n,i);if(typeof o=="number")r=o-1;else{if(o===re)return re;o===we&&(e.items.splice(r,1),r-=1)}}}else if(J(e)){i=Object.freeze(i.concat(e));const r=await He("key",e.key,n,i);if(r===re)return re;r===we&&(e.key=null);const o=await He("value",e.value,n,i);if(o===re)return re;o===we&&(e.value=null)}}return s}function Ci(t){return typeof t=="object"&&(t.Collection||t.Node||t.Value)?Object.assign({Alias:t.Node,Map:t.Node,Scalar:t.Node,Seq:t.Node},t.Value&&{Map:t.Value,Scalar:t.Value,Seq:t.Value},t.Collection&&{Map:t.Collection,Seq:t.Collection},t):t}function vi(t,e,n,i){if(typeof n=="function")return n(t,e,i);if(st(e))return n.Map?.(t,e,i);if(rt(e))return n.Seq?.(t,e,i);if(J(e))return n.Pair?.(t,e,i);if(W(e))return n.Scalar?.(t,e,i);if(Fe(e))return n.Alias?.(t,e,i)}function _i(t,e,n){const i=e[e.length-1];if(G(i))i.items[t]=n;else if(J(i))t==="key"?i.key=n:i.value=n;else if(it(i))i.contents=n;else{const s=Fe(i)?"alias":"scalar";throw new Error(`Cannot replace node with ${s} parent`)}}const zs={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},Zs=t=>t.replace(/[!,[\]{}]/g,e=>zs[e]);class ie{constructor(e,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},ie.defaultYaml,e),this.tags=Object.assign({},ie.defaultTags,n)}clone(){const e=new ie(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new ie(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:ie.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},ie.defaultTags);break}return e}add(e,n){this.atNextDocument&&(this.yaml={explicit:ie.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},ie.defaultTags),this.atNextDocument=!1);const i=e.trim().split(/[ \t]+/),s=i.shift();switch(s){case"%TAG":{if(i.length!==2&&(n(0,"%TAG directive should contain exactly two parts"),i.length<2))return!1;const[r,o]=i;return this.tags[r]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,i.length!==1)return n(0,"%YAML directive should contain exactly one part"),!1;const[r]=i;if(r==="1.1"||r==="1.2")return this.yaml.version=r,!0;{const o=/^\d+\.\d+$/.test(r);return n(6,`Unsupported YAML version ${r}`,o),!1}}default:return n(0,`Unknown directive ${s}`,!0),!1}}tagName(e,n){if(e==="!")return"!";if(e[0]!=="!")return n(`Not a valid tag: ${e}`),null;if(e[1]==="<"){const o=e.slice(2,-1);return o==="!"||o==="!!"?(n(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(e[e.length-1]!==">"&&n("Verbatim tags must end with a >"),o)}const[,i,s]=e.match(/^(.*!)([^!]*)$/s);s||n(`The ${e} tag has no suffix`);const r=this.tags[i];if(r)try{return r+decodeURIComponent(s)}catch(o){return n(String(o)),null}return i==="!"?e:(n(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[n,i]of Object.entries(this.tags))if(e.startsWith(i))return n+Zs(e.substring(i.length));return e[0]==="!"?e:`!<${e}>`}toString(e){const n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],i=Object.entries(this.tags);let s;if(e&&i.length>0&&Y(e.contents)){const r={};_e(e.contents,(o,a)=>{Y(a)&&a.tag&&(r[a.tag]=!0)}),s=Object.keys(r)}else s=[];for(const[r,o]of i)r==="!!"&&o==="tag:yaml.org,2002:"||(!e||s.some(a=>a.startsWith(o)))&&n.push(`%TAG ${r} ${o}`);return n.join(`
`)}}ie.defaultYaml={explicit:!1,version:"1.2"};ie.defaultTags={"!!":"tag:yaml.org,2002:"};function Li(t){if(/[\x00-\x19\s,[\]{}]/.test(t)){const n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(t)}`;throw new Error(n)}return!0}function Pi(t){const e=new Set;return _e(t,{Value(n,i){i.anchor&&e.add(i.anchor)}}),e}function Mi(t,e){for(let n=1;;++n){const i=`${t}${n}`;if(!e.has(i))return i}}function Xs(t,e){const n=[],i=new Map;let s=null;return{onAnchor:r=>{n.push(r),s||(s=Pi(t));const o=Mi(e,s);return s.add(o),o},setAnchors:()=>{for(const r of n){const o=i.get(r);if(typeof o=="object"&&o.anchor&&(W(o.node)||G(o.node)))o.node.anchor=o.anchor;else{const a=new Error("Failed to resolve repeated object (this should not happen)");throw a.source=r,a}}},sourceObjects:i}}function We(t,e,n,i){if(i&&typeof i=="object")if(Array.isArray(i))for(let s=0,r=i.length;s<r;++s){const o=i[s],a=We(t,i,String(s),o);a===void 0?delete i[s]:a!==o&&(i[s]=a)}else if(i instanceof Map)for(const s of Array.from(i.keys())){const r=i.get(s),o=We(t,i,s,r);o===void 0?i.delete(s):o!==r&&i.set(s,o)}else if(i instanceof Set)for(const s of Array.from(i)){const r=We(t,i,s,s);r===void 0?i.delete(s):r!==s&&(i.delete(s),i.add(r))}else for(const[s,r]of Object.entries(i)){const o=We(t,i,s,r);o===void 0?delete i[s]:o!==r&&(i[s]=o)}return t.call(e,n,i)}function ue(t,e,n){if(Array.isArray(t))return t.map((i,s)=>ue(i,String(s),n));if(t&&typeof t.toJSON=="function"){if(!n||!Ys(t))return t.toJSON(e,n);const i={aliasCount:0,count:1,res:void 0};n.anchors.set(t,i),n.onCreate=r=>{i.res=r,delete n.onCreate};const s=t.toJSON(e,n);return n.onCreate&&n.onCreate(s),s}return typeof t=="bigint"&&!n?.keep?Number(t):t}class On{constructor(e){Object.defineProperty(this,he,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:n,maxAliasCount:i,onAnchor:s,reviver:r}={}){if(!it(e))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:e,keep:!0,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},a=ue(this,"",o);if(typeof s=="function")for(const{count:l,res:f}of o.anchors.values())s(f,l);return typeof r=="function"?We(r,{"":a},"",a):a}}class xt extends On{constructor(e){super(Tn),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let n;return _e(e,{Node:(i,s)=>{if(s===this)return _e.BREAK;s.anchor===this.source&&(n=s)}}),n}toJSON(e,n){if(!n)return{source:this.source};const{anchors:i,doc:s,maxAliasCount:r}=n,o=this.resolve(s);if(!o){const l=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(l)}let a=i.get(o);if(a||(ue(o,null,n),a=i.get(o)),!a||a.res===void 0){const l="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(l)}if(r>=0&&(a.count+=1,a.aliasCount===0&&(a.aliasCount=It(s,o,i)),a.count*a.aliasCount>r)){const l="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(l)}return a.res}toString(e,n,i){const s=`*${this.source}`;if(e){if(Li(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const r=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(r)}if(e.implicitKey)return`${s} `}return s}}function It(t,e,n){if(Fe(e)){const i=e.resolve(t),s=n&&i&&n.get(i);return s?s.count*s.aliasCount:0}else if(G(e)){let i=0;for(const s of e.items){const r=It(t,s,n);r>i&&(i=r)}return i}else if(J(e)){const i=It(t,e.key,n),s=It(t,e.value,n);return Math.max(i,s)}return 1}const Di=t=>!t||typeof t!="function"&&typeof t!="object";class P extends On{constructor(e){super(Ie),this.value=e}toJSON(e,n){return n?.keep?this.value:ue(this.value,e,n)}toString(){return String(this.value)}}P.BLOCK_FOLDED="BLOCK_FOLDED";P.BLOCK_LITERAL="BLOCK_LITERAL";P.PLAIN="PLAIN";P.QUOTE_DOUBLE="QUOTE_DOUBLE";P.QUOTE_SINGLE="QUOTE_SINGLE";const Qs="tag:yaml.org,2002:";function er(t,e,n){if(e){const i=n.filter(r=>r.tag===e),s=i.find(r=>!r.format)??i[0];if(!s)throw new Error(`Tag ${e} not found`);return s}return n.find(i=>i.identify?.(t)&&!i.format)}function mt(t,e,n){if(it(t)&&(t=t.contents),Y(t))return t;if(J(t)){const c=n.schema[Ce].createNode?.(n.schema,null,n);return c.items.push(t),c}(t instanceof String||t instanceof Number||t instanceof Boolean||typeof BigInt<"u"&&t instanceof BigInt)&&(t=t.valueOf());const{aliasDuplicateObjects:i,onAnchor:s,onTagObj:r,schema:o,sourceObjects:a}=n;let l;if(i&&t&&typeof t=="object"){if(l=a.get(t),l)return l.anchor||(l.anchor=s(t)),new xt(l.anchor);l={anchor:null,node:null},a.set(t,l)}e?.startsWith("!!")&&(e=Qs+e.slice(2));let f=er(t,e,o.tags);if(!f){if(t&&typeof t.toJSON=="function"&&(t=t.toJSON()),!t||typeof t!="object"){const c=new P(t);return l&&(l.node=c),c}f=t instanceof Map?o[Ce]:Symbol.iterator in Object(t)?o[nt]:o[Ce]}r&&(r(f),delete n.onTagObj);const h=f?.createNode?f.createNode(n.schema,t,n):typeof f?.nodeClass?.from=="function"?f.nodeClass.from(n.schema,t,n):new P(t);return e?h.tag=e:f.default||(h.tag=f.tag),l&&(l.node=h),h}function _t(t,e,n){let i=n;for(let s=e.length-1;s>=0;--s){const r=e[s];if(typeof r=="number"&&Number.isInteger(r)&&r>=0){const o=[];o[r]=i,i=o}else i=new Map([[r,i]])}return mt(i,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:t,sourceObjects:new Map})}const dt=t=>t==null||typeof t=="object"&&!!t[Symbol.iterator]().next().done;class An extends On{constructor(e,n){super(e),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(e){const n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(n.schema=e),n.items=n.items.map(i=>Y(i)||J(i)?i.clone(e):i),this.range&&(n.range=this.range.slice()),n}addIn(e,n){if(dt(e))this.add(n);else{const[i,...s]=e,r=this.get(i,!0);if(G(r))r.addIn(s,n);else if(r===void 0&&this.schema)this.set(i,_t(this.schema,s,n));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${s}`)}}deleteIn(e){const[n,...i]=e;if(i.length===0)return this.delete(n);const s=this.get(n,!0);if(G(s))return s.deleteIn(i);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${i}`)}getIn(e,n){const[i,...s]=e,r=this.get(i,!0);return s.length===0?!n&&W(r)?r.value:r:G(r)?r.getIn(s,n):void 0}hasAllNullValues(e){return this.items.every(n=>{if(!J(n))return!1;const i=n.value;return i==null||e&&W(i)&&i.value==null&&!i.commentBefore&&!i.comment&&!i.tag})}hasIn(e){const[n,...i]=e;if(i.length===0)return this.has(n);const s=this.get(n,!0);return G(s)?s.hasIn(i):!1}setIn(e,n){const[i,...s]=e;if(s.length===0)this.set(i,n);else{const r=this.get(i,!0);if(G(r))r.setIn(s,n);else if(r===void 0&&this.schema)this.set(i,_t(this.schema,s,n));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${s}`)}}}An.maxFlowStringSingleLineLength=60;const tr=t=>t.replace(/^(?!$)(?: $)?/gm,"#");function Oe(t,e){return/^\n+$/.test(t)?t.substring(1):e?t.replace(/^(?! *$)/gm,e):t}const Me=(t,e,n)=>t.endsWith(`
`)?Oe(n,e):n.includes(`
`)?`
`+Oe(n,e):(t.endsWith(" ")?"":" ")+n,xi="flow",gn="block",Bt="quoted";function jt(t,e,n="flow",{indentAtStart:i,lineWidth:s=80,minContentWidth:r=20,onFold:o,onOverflow:a}={}){if(!s||s<0)return t;const l=Math.max(1+r,1+s-e.length);if(t.length<=l)return t;const f=[],h={};let c=s-e.length;typeof i=="number"&&(i>s-Math.max(2,r)?f.push(0):c=s-i);let d,g,T=!1,p=-1,m=-1,I=-1;n===gn&&(p=Qn(t,p,e.length),p!==-1&&(c=p+l));for(let $;$=t[p+=1];){if(n===Bt&&$==="\\"){switch(m=p,t[p+1]){case"x":p+=3;break;case"u":p+=5;break;case"U":p+=9;break;default:p+=1}I=p}if($===`
`)n===gn&&(p=Qn(t,p,e.length)),c=p+e.length+l,d=void 0;else{if($===" "&&g&&g!==" "&&g!==`
`&&g!=="	"){const w=t[p+1];w&&w!==" "&&w!==`
`&&w!=="	"&&(d=p)}if(p>=c)if(d)f.push(d),c=d+l,d=void 0;else if(n===Bt){for(;g===" "||g==="	";)g=$,$=t[p+=1],T=!0;const w=p>I+1?p-2:m-1;if(h[w])return t;f.push(w),h[w]=!0,c=w+l,d=void 0}else T=!0}g=$}if(T&&a&&a(),f.length===0)return t;o&&o();let k=t.slice(0,f[0]);for(let $=0;$<f.length;++$){const w=f[$],v=f[$+1]||t.length;w===0?k=`
${e}${t.slice(0,v)}`:(n===Bt&&h[w]&&(k+=`${t[w]}\\`),k+=`
${e}${t.slice(w+1,v)}`)}return k}function Qn(t,e,n){let i=e,s=e+1,r=t[s];for(;r===" "||r==="	";)if(e<s+n)r=t[++e];else{do r=t[++e];while(r&&r!==`
`);i=e,s=e+1,r=t[s]}return i}const Rt=(t,e)=>({indentAtStart:e?t.indent.length:t.indentAtStart,lineWidth:t.options.lineWidth,minContentWidth:t.options.minContentWidth}),Ft=t=>/^(%|---|\.\.\.)/m.test(t);function nr(t,e,n){if(!e||e<0)return!1;const i=e-n,s=t.length;if(s<=i)return!1;for(let r=0,o=0;r<s;++r)if(t[r]===`
`){if(r-o>i)return!0;if(o=r+1,s-o<=i)return!1}return!0}function pt(t,e){const n=JSON.stringify(t);if(e.options.doubleQuotedAsJSON)return n;const{implicitKey:i}=e,s=e.options.doubleQuotedMinMultiLineLength,r=e.indent||(Ft(t)?"  ":"");let o="",a=0;for(let l=0,f=n[l];f;f=n[++l])if(f===" "&&n[l+1]==="\\"&&n[l+2]==="n"&&(o+=n.slice(a,l)+"\\ ",l+=1,a=l,f="\\"),f==="\\")switch(n[l+1]){case"u":{o+=n.slice(a,l);const h=n.substr(l+2,4);switch(h){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:h.substr(0,2)==="00"?o+="\\x"+h.substr(2):o+=n.substr(l,6)}l+=5,a=l+1}break;case"n":if(i||n[l+2]==='"'||n.length<s)l+=1;else{for(o+=n.slice(a,l)+`

`;n[l+2]==="\\"&&n[l+3]==="n"&&n[l+4]!=='"';)o+=`
`,l+=2;o+=r,n[l+2]===" "&&(o+="\\"),l+=1,a=l+1}break;default:l+=1}return o=a?o+n.slice(a):n,i?o:jt(o,r,Bt,Rt(e,!1))}function yn(t,e){if(e.options.singleQuote===!1||e.implicitKey&&t.includes(`
`)||/[ \t]\n|\n[ \t]/.test(t))return pt(t,e);const n=e.indent||(Ft(t)?"  ":""),i="'"+t.replace(/'/g,"''").replace(/\n+/g,`$&
${n}`)+"'";return e.implicitKey?i:jt(i,n,xi,Rt(e,!1))}function Je(t,e){const{singleQuote:n}=e.options;let i;if(n===!1)i=pt;else{const s=t.includes('"'),r=t.includes("'");s&&!r?i=yn:r&&!s?i=pt:i=n?yn:pt}return i(t,e)}let bn;try{bn=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{bn=/\n+(?!\n|$)/g}function $t({comment:t,type:e,value:n},i,s,r){const{blockQuote:o,commentString:a,lineWidth:l}=i.options;if(!o||/\n[\t ]+$/.test(n)||/^\s*$/.test(n))return Je(n,i);const f=i.indent||(i.forceBlockIndent||Ft(n)?"  ":""),h=o==="literal"?!0:o==="folded"||e===P.BLOCK_FOLDED?!1:e===P.BLOCK_LITERAL?!0:!nr(n,l,f.length);if(!n)return h?`|
`:`>
`;let c,d;for(d=n.length;d>0;--d){const A=n[d-1];if(A!==`
`&&A!=="	"&&A!==" ")break}let g=n.substring(d);const T=g.indexOf(`
`);T===-1?c="-":n===g||T!==g.length-1?(c="+",r&&r()):c="",g&&(n=n.slice(0,-g.length),g[g.length-1]===`
`&&(g=g.slice(0,-1)),g=g.replace(bn,`$&${f}`));let p=!1,m,I=-1;for(m=0;m<n.length;++m){const A=n[m];if(A===" ")p=!0;else if(A===`
`)I=m;else break}let k=n.substring(0,I<m?I+1:m);k&&(n=n.substring(k.length),k=k.replace(/\n+/g,`$&${f}`));let w=(h?"|":">")+(p?f?"2":"1":"")+c;if(t&&(w+=" "+a(t.replace(/ ?[\r\n]+/g," ")),s&&s()),h)return n=n.replace(/\n+/g,`$&${f}`),`${w}
${f}${k}${n}${g}`;n=n.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${f}`);const v=jt(`${k}${n}${g}`,f,gn,Rt(i,!0));return`${w}
${f}${v}`}function ir(t,e,n,i){const{type:s,value:r}=t,{actualString:o,implicitKey:a,indent:l,indentStep:f,inFlow:h}=e;if(a&&r.includes(`
`)||h&&/[[\]{},]/.test(r))return Je(r,e);if(!r||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(r))return a||h||!r.includes(`
`)?Je(r,e):$t(t,e,n,i);if(!a&&!h&&s!==P.PLAIN&&r.includes(`
`))return $t(t,e,n,i);if(Ft(r)){if(l==="")return e.forceBlockIndent=!0,$t(t,e,n,i);if(a&&l===f)return Je(r,e)}const c=r.replace(/\n+/g,`$&
${l}`);if(o){const d=p=>p.default&&p.tag!=="tag:yaml.org,2002:str"&&p.test?.test(c),{compat:g,tags:T}=e.doc.schema;if(T.some(d)||g?.some(d))return Je(r,e)}return a?c:jt(c,l,xi,Rt(e,!1))}function wt(t,e,n,i){const{implicitKey:s,inFlow:r}=e,o=typeof t.value=="string"?t:Object.assign({},t,{value:String(t.value)});let{type:a}=t;a!==P.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(a=P.QUOTE_DOUBLE);const l=h=>{switch(h){case P.BLOCK_FOLDED:case P.BLOCK_LITERAL:return s||r?Je(o.value,e):$t(o,e,n,i);case P.QUOTE_DOUBLE:return pt(o.value,e);case P.QUOTE_SINGLE:return yn(o.value,e);case P.PLAIN:return ir(o,e,n,i);default:return null}};let f=l(a);if(f===null){const{defaultKeyType:h,defaultStringType:c}=e.options,d=s&&h||c;if(f=l(d),f===null)throw new Error(`Unsupported default string type ${d}`)}return f}function ji(t,e){const n=Object.assign({blockQuote:!0,commentString:tr,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},t.schema.toStringOptions,e);let i;switch(n.collectionStyle){case"block":i=!1;break;case"flow":i=!0;break;default:i=null}return{anchors:new Set,doc:t,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:typeof n.indent=="number"?" ".repeat(n.indent):"  ",inFlow:i,options:n}}function sr(t,e){if(e.tag){const s=t.filter(r=>r.tag===e.tag);if(s.length>0)return s.find(r=>r.format===e.format)??s[0]}let n,i;if(W(e)){i=e.value;const s=t.filter(r=>r.identify?.(i));n=s.find(r=>r.format===e.format)??s.find(r=>!r.format)}else i=e,n=t.find(s=>s.nodeClass&&i instanceof s.nodeClass);if(!n){const s=i?.constructor?.name??typeof i;throw new Error(`Tag not resolved for ${s} value`)}return n}function rr(t,e,{anchors:n,doc:i}){if(!i.directives)return"";const s=[],r=(W(t)||G(t))&&t.anchor;r&&Li(r)&&(n.add(r),s.push(`&${r}`));const o=t.tag?t.tag:e.default?null:e.tag;return o&&s.push(i.directives.tagString(o)),s.join(" ")}function Xe(t,e,n,i){if(J(t))return t.toString(e,n,i);if(Fe(t)){if(e.doc.directives)return t.toString(e);if(e.resolvedAliases?.has(t))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(t):e.resolvedAliases=new Set([t]),t=t.resolve(e.doc)}let s;const r=Y(t)?t:e.doc.createNode(t,{onTagObj:l=>s=l});s||(s=sr(e.doc.schema.tags,r));const o=rr(r,s,e);o.length>0&&(e.indentAtStart=(e.indentAtStart??0)+o.length+1);const a=typeof s.stringify=="function"?s.stringify(r,e,n,i):W(r)?wt(r,e,n,i):r.toString(e,n,i);return o?W(r)||a[0]==="{"||a[0]==="["?`${o} ${a}`:`${o}
${e.indent}${a}`:a}function or({key:t,value:e},n,i,s){const{allNullValues:r,doc:o,indent:a,indentStep:l,options:{commentString:f,indentSeq:h,simpleKeys:c}}=n;let d=Y(t)&&t.comment||null;if(c){if(d)throw new Error("With simple keys, key nodes cannot have comments");if(G(t)){const V="With simple keys, collection cannot be used as a key value";throw new Error(V)}}let g=!c&&(!t||d&&e==null&&!n.inFlow||G(t)||(W(t)?t.type===P.BLOCK_FOLDED||t.type===P.BLOCK_LITERAL:typeof t=="object"));n=Object.assign({},n,{allNullValues:!1,implicitKey:!g&&(c||!r),indent:a+l});let T=!1,p=!1,m=Xe(t,n,()=>T=!0,()=>p=!0);if(!g&&!n.inFlow&&m.length>1024){if(c)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");g=!0}if(n.inFlow){if(r||e==null)return T&&i&&i(),m===""?"?":g?`? ${m}`:m}else if(r&&!c||e==null&&g)return m=`? ${m}`,d&&!T?m+=Me(m,n.indent,f(d)):p&&s&&s(),m;T&&(d=null),g?(d&&(m+=Me(m,n.indent,f(d))),m=`? ${m}
${a}:`):(m=`${m}:`,d&&(m+=Me(m,n.indent,f(d))));let I,k,$;Y(e)?(I=!!e.spaceBefore,k=e.commentBefore,$=e.comment):(I=!1,k=null,$=null,e&&typeof e=="object"&&(e=o.createNode(e))),n.implicitKey=!1,!g&&!d&&W(e)&&(n.indentAtStart=m.length+1),p=!1,!h&&l.length>=2&&!n.inFlow&&!g&&rt(e)&&!e.flow&&!e.tag&&!e.anchor&&(n.indent=n.indent.substring(2));let w=!1;const v=Xe(e,n,()=>w=!0,()=>p=!0);let A=" ";if(d||I||k){if(A=I?`
`:"",k){const V=f(k);A+=`
${Oe(V,n.indent)}`}v===""&&!n.inFlow?A===`
`&&(A=`

`):A+=`
${n.indent}`}else if(!g&&G(e)){const V=v[0],j=v.indexOf(`
`),L=j!==-1,K=n.inFlow??e.flow??e.items.length===0;if(L||!K){let D=!1;if(L&&(V==="&"||V==="!")){let q=v.indexOf(" ");V==="&"&&q!==-1&&q<j&&v[q+1]==="!"&&(q=v.indexOf(" ",q+1)),(q===-1||j<q)&&(D=!0)}D||(A=`
${n.indent}`)}}else(v===""||v[0]===`
`)&&(A="");return m+=A+v,n.inFlow?w&&i&&i():$&&!w?m+=Me(m,n.indent,f($)):p&&s&&s(),m}function Ri(t,e){(t==="debug"||t==="warn")&&(typeof process<"u"&&process.emitWarning?process.emitWarning(e):console.warn(e))}const ei="<<";function Fi(t,e,{key:n,value:i}){if(t?.doc.schema.merge&&ar(n))if(i=Fe(i)?i.resolve(t.doc):i,rt(i))for(const s of i.items)nn(t,e,s);else if(Array.isArray(i))for(const s of i)nn(t,e,s);else nn(t,e,i);else{const s=ue(n,"",t);if(e instanceof Map)e.set(s,ue(i,s,t));else if(e instanceof Set)e.add(s);else{const r=lr(n,s,t),o=ue(i,r,t);r in e?Object.defineProperty(e,r,{value:o,writable:!0,enumerable:!0,configurable:!0}):e[r]=o}}return e}const ar=t=>t===ei||W(t)&&t.value===ei&&(!t.type||t.type===P.PLAIN);function nn(t,e,n){const i=t&&Fe(n)?n.resolve(t.doc):n;if(!st(i))throw new Error("Merge sources must be maps or map aliases");const s=i.toJSON(null,t,Map);for(const[r,o]of s)e instanceof Map?e.has(r)||e.set(r,o):e instanceof Set?e.add(r):Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(e,r,{value:o,writable:!0,enumerable:!0,configurable:!0});return e}function lr(t,e,n){if(e===null)return"";if(typeof e!="object")return String(e);if(Y(t)&&n?.doc){const i=ji(n.doc,{});i.anchors=new Set;for(const r of n.anchors.keys())i.anchors.add(r.anchor);i.inFlow=!0,i.inStringifyKey=!0;const s=t.toString(i);if(!n.mapKeyWarned){let r=JSON.stringify(s);r.length>40&&(r=r.substring(0,36)+'..."'),Ri(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${r}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return s}return JSON.stringify(e)}function In(t,e,n){const i=mt(t,void 0,n),s=mt(e,void 0,n);return new ne(i,s)}class ne{constructor(e,n=null){Object.defineProperty(this,he,{value:Bi}),this.key=e,this.value=n}clone(e){let{key:n,value:i}=this;return Y(n)&&(n=n.clone(e)),Y(i)&&(i=i.clone(e)),new ne(n,i)}toJSON(e,n){const i=n?.mapAsMap?new Map:{};return Fi(n,i,this)}toString(e,n,i){return e?.doc?or(this,e,n,i):JSON.stringify(this)}}function Ui(t,e,n){return(e.inFlow??t.flow?cr:fr)(t,e,n)}function fr({comment:t,items:e},n,{blockItemPrefix:i,flowChars:s,itemIndent:r,onChompKeep:o,onComment:a}){const{indent:l,options:{commentString:f}}=n,h=Object.assign({},n,{indent:r,type:null});let c=!1;const d=[];for(let T=0;T<e.length;++T){const p=e[T];let m=null;if(Y(p))!c&&p.spaceBefore&&d.push(""),Lt(n,d,p.commentBefore,c),p.comment&&(m=p.comment);else if(J(p)){const k=Y(p.key)?p.key:null;k&&(!c&&k.spaceBefore&&d.push(""),Lt(n,d,k.commentBefore,c))}c=!1;let I=Xe(p,h,()=>m=null,()=>c=!0);m&&(I+=Me(I,r,f(m))),c&&m&&(c=!1),d.push(i+I)}let g;if(d.length===0)g=s.start+s.end;else{g=d[0];for(let T=1;T<d.length;++T){const p=d[T];g+=p?`
${l}${p}`:`
`}}return t?(g+=`
`+Oe(f(t),l),a&&a()):c&&o&&o(),g}function cr({items:t},e,{flowChars:n,itemIndent:i}){const{indent:s,indentStep:r,flowCollectionPadding:o,options:{commentString:a}}=e;i+=r;const l=Object.assign({},e,{indent:i,inFlow:!0,type:null});let f=!1,h=0;const c=[];for(let T=0;T<t.length;++T){const p=t[T];let m=null;if(Y(p))p.spaceBefore&&c.push(""),Lt(e,c,p.commentBefore,!1),p.comment&&(m=p.comment);else if(J(p)){const k=Y(p.key)?p.key:null;k&&(k.spaceBefore&&c.push(""),Lt(e,c,k.commentBefore,!1),k.comment&&(f=!0));const $=Y(p.value)?p.value:null;$?($.comment&&(m=$.comment),$.commentBefore&&(f=!0)):p.value==null&&k?.comment&&(m=k.comment)}m&&(f=!0);let I=Xe(p,l,()=>m=null);T<t.length-1&&(I+=","),m&&(I+=Me(I,i,a(m))),!f&&(c.length>h||I.includes(`
`))&&(f=!0),c.push(I),h=c.length}const{start:d,end:g}=n;if(c.length===0)return d+g;if(!f){const T=c.reduce((p,m)=>p+m.length+2,2);f=e.options.lineWidth>0&&T>e.options.lineWidth}if(f){let T=d;for(const p of c)T+=p?`
${r}${s}${p}`:`
`;return`${T}
${s}${g}`}else return`${d}${o}${c.join(" ")}${o}${g}`}function Lt({indent:t,options:{commentString:e}},n,i,s){if(i&&s&&(i=i.replace(/^\n+/,"")),i){const r=Oe(e(i),t);n.push(r.trimStart())}}function De(t,e){const n=W(e)?e.value:e;for(const i of t)if(J(i)&&(i.key===e||i.key===n||W(i.key)&&i.key.value===n))return i}class ae extends An{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(Ce,e),this.items=[]}static from(e,n,i){const{keepUndefined:s,replacer:r}=i,o=new this(e),a=(l,f)=>{if(typeof r=="function")f=r.call(n,l,f);else if(Array.isArray(r)&&!r.includes(l))return;(f!==void 0||s)&&o.items.push(In(l,f,i))};if(n instanceof Map)for(const[l,f]of n)a(l,f);else if(n&&typeof n=="object")for(const l of Object.keys(n))a(l,n[l]);return typeof e.sortMapEntries=="function"&&o.items.sort(e.sortMapEntries),o}add(e,n){let i;J(e)?i=e:!e||typeof e!="object"||!("key"in e)?i=new ne(e,e?.value):i=new ne(e.key,e.value);const s=De(this.items,i.key),r=this.schema?.sortMapEntries;if(s){if(!n)throw new Error(`Key ${i.key} already set`);W(s.value)&&Di(i.value)?s.value.value=i.value:s.value=i.value}else if(r){const o=this.items.findIndex(a=>r(i,a)<0);o===-1?this.items.push(i):this.items.splice(o,0,i)}else this.items.push(i)}delete(e){const n=De(this.items,e);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(e,n){const s=De(this.items,e)?.value;return(!n&&W(s)?s.value:s)??void 0}has(e){return!!De(this.items,e)}set(e,n){this.add(new ne(e,n),!0)}toJSON(e,n,i){const s=i?new i:n?.mapAsMap?new Map:{};n?.onCreate&&n.onCreate(s);for(const r of this.items)Fi(n,s,r);return s}toString(e,n,i){if(!e)return JSON.stringify(this);for(const s of this.items)if(!J(s))throw new Error(`Map items must all be pairs; found ${JSON.stringify(s)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),Ui(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:i,onComment:n})}}const ot={collection:"map",default:!0,nodeClass:ae,tag:"tag:yaml.org,2002:map",resolve(t,e){return st(t)||e("Expected a mapping for this tag"),t},createNode:(t,e,n)=>ae.from(t,e,n)};class Le extends An{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(nt,e),this.items=[]}add(e){this.items.push(e)}delete(e){const n=Tt(e);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(e,n){const i=Tt(e);if(typeof i!="number")return;const s=this.items[i];return!n&&W(s)?s.value:s}has(e){const n=Tt(e);return typeof n=="number"&&n<this.items.length}set(e,n){const i=Tt(e);if(typeof i!="number")throw new Error(`Expected a valid index, not ${e}.`);const s=this.items[i];W(s)&&Di(n)?s.value=n:this.items[i]=n}toJSON(e,n){const i=[];n?.onCreate&&n.onCreate(i);let s=0;for(const r of this.items)i.push(ue(r,String(s++),n));return i}toString(e,n,i){return e?Ui(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:i,onComment:n}):JSON.stringify(this)}static from(e,n,i){const{replacer:s}=i,r=new this(e);if(n&&Symbol.iterator in Object(n)){let o=0;for(let a of n){if(typeof s=="function"){const l=n instanceof Set?a:String(o++);a=s.call(n,l,a)}r.items.push(mt(a,void 0,i))}}return r}}function Tt(t){let e=W(t)?t.value:t;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}const at={collection:"seq",default:!0,nodeClass:Le,tag:"tag:yaml.org,2002:seq",resolve(t,e){return rt(t)||e("Expected a sequence for this tag"),t},createNode:(t,e,n)=>Le.from(t,e,n)},Ut={identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify(t,e,n,i){return e=Object.assign({actualString:!0},e),wt(t,e,n,i)}},Vt={identify:t=>t==null,createNode:()=>new P(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new P(null),stringify:({source:t},e)=>typeof t=="string"&&Vt.test.test(t)?t:e.options.nullStr},Bn={identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:t=>new P(t[0]==="t"||t[0]==="T"),stringify({source:t,value:e},n){if(t&&Bn.test.test(t)){const i=t[0]==="t"||t[0]==="T";if(e===i)return t}return e?n.options.trueStr:n.options.falseStr}};function ye({format:t,minFractionDigits:e,tag:n,value:i}){if(typeof i=="bigint")return String(i);const s=typeof i=="number"?i:Number(i);if(!isFinite(s))return isNaN(s)?".nan":s<0?"-.inf":".inf";let r=JSON.stringify(i);if(!t&&e&&(!n||n==="tag:yaml.org,2002:float")&&/^\d/.test(r)){let o=r.indexOf(".");o<0&&(o=r.length,r+=".");let a=e-(r.length-o-1);for(;a-- >0;)r+="0"}return r}const Vi={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN))$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ye},Ki={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t),stringify(t){const e=Number(t.value);return isFinite(e)?e.toExponential():ye(t)}},qi={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(t){const e=new P(parseFloat(t)),n=t.indexOf(".");return n!==-1&&t[t.length-1]==="0"&&(e.minFractionDigits=t.length-n-1),e},stringify:ye},Kt=t=>typeof t=="bigint"||Number.isInteger(t),$n=(t,e,n,{intAsBigInt:i})=>i?BigInt(t):parseInt(t.substring(e),n);function Hi(t,e,n){const{value:i}=t;return Kt(i)&&i>=0?n+i.toString(e):ye(t)}const Wi={identify:t=>Kt(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(t,e,n)=>$n(t,2,8,n),stringify:t=>Hi(t,8,"0o")},Ji={identify:Kt,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(t,e,n)=>$n(t,0,10,n),stringify:ye},Gi={identify:t=>Kt(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(t,e,n)=>$n(t,2,16,n),stringify:t=>Hi(t,16,"0x")},ur=[ot,at,Ut,Vt,Bn,Wi,Ji,Gi,Vi,Ki,qi];function ti(t){return typeof t=="bigint"||Number.isInteger(t)}const Ot=({value:t})=>JSON.stringify(t),hr=[{identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify:Ot},{identify:t=>t==null,createNode:()=>new P(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:Ot},{identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:t=>t==="true",stringify:Ot},{identify:ti,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(t,e,{intAsBigInt:n})=>n?BigInt(t):parseInt(t,10),stringify:({value:t})=>ti(t)?t.toString():JSON.stringify(t)},{identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:t=>parseFloat(t),stringify:Ot}],dr={default:!0,tag:"",test:/^/,resolve(t,e){return e(`Unresolved plain scalar ${JSON.stringify(t)}`),t}},pr=[ot,at].concat(hr,dr),Cn={identify:t=>t instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(t,e){if(typeof Buffer=="function")return Buffer.from(t,"base64");if(typeof atob=="function"){const n=atob(t.replace(/[\n\r]/g,"")),i=new Uint8Array(n.length);for(let s=0;s<n.length;++s)i[s]=n.charCodeAt(s);return i}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),t},stringify({comment:t,type:e,value:n},i,s,r){const o=n;let a;if(typeof Buffer=="function")a=o instanceof Buffer?o.toString("base64"):Buffer.from(o.buffer).toString("base64");else if(typeof btoa=="function"){let l="";for(let f=0;f<o.length;++f)l+=String.fromCharCode(o[f]);a=btoa(l)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e||(e=P.BLOCK_LITERAL),e!==P.QUOTE_DOUBLE){const l=Math.max(i.options.lineWidth-i.indent.length,i.options.minContentWidth),f=Math.ceil(a.length/l),h=new Array(f);for(let c=0,d=0;c<f;++c,d+=l)h[c]=a.substr(d,l);a=h.join(e===P.BLOCK_LITERAL?`
`:" ")}return wt({comment:t,type:e,value:a},i,s,r)}};function Yi(t,e){if(rt(t))for(let n=0;n<t.items.length;++n){let i=t.items[n];if(!J(i)){if(st(i)){i.items.length>1&&e("Each pair must have its own sequence indicator");const s=i.items[0]||new ne(new P(null));if(i.commentBefore&&(s.key.commentBefore=s.key.commentBefore?`${i.commentBefore}
${s.key.commentBefore}`:i.commentBefore),i.comment){const r=s.value??s.key;r.comment=r.comment?`${i.comment}
${r.comment}`:i.comment}i=s}t.items[n]=J(i)?i:new ne(i)}}else e("Expected a sequence for this tag");return t}function zi(t,e,n){const{replacer:i}=n,s=new Le(t);s.tag="tag:yaml.org,2002:pairs";let r=0;if(e&&Symbol.iterator in Object(e))for(let o of e){typeof i=="function"&&(o=i.call(e,String(r++),o));let a,l;if(Array.isArray(o))if(o.length===2)a=o[0],l=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const f=Object.keys(o);if(f.length===1)a=f[0],l=o[a];else throw new TypeError(`Expected tuple with one key, not ${f.length} keys`)}else a=o;s.items.push(In(a,l,n))}return s}const vn={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:Yi,createNode:zi};class ze extends Le{constructor(){super(),this.add=ae.prototype.add.bind(this),this.delete=ae.prototype.delete.bind(this),this.get=ae.prototype.get.bind(this),this.has=ae.prototype.has.bind(this),this.set=ae.prototype.set.bind(this),this.tag=ze.tag}toJSON(e,n){if(!n)return super.toJSON(e);const i=new Map;n?.onCreate&&n.onCreate(i);for(const s of this.items){let r,o;if(J(s)?(r=ue(s.key,"",n),o=ue(s.value,r,n)):r=ue(s,"",n),i.has(r))throw new Error("Ordered maps must not include duplicate keys");i.set(r,o)}return i}static from(e,n,i){const s=zi(e,n,i),r=new this;return r.items=s.items,r}}ze.tag="tag:yaml.org,2002:omap";const _n={collection:"seq",identify:t=>t instanceof Map,nodeClass:ze,default:!1,tag:"tag:yaml.org,2002:omap",resolve(t,e){const n=Yi(t,e),i=[];for(const{key:s}of n.items)W(s)&&(i.includes(s.value)?e(`Ordered maps must not include duplicate keys: ${s.value}`):i.push(s.value));return Object.assign(new ze,n)},createNode:(t,e,n)=>ze.from(t,e,n)};function Zi({value:t,source:e},n){return e&&(t?Xi:Qi).test.test(e)?e:t?n.options.trueStr:n.options.falseStr}const Xi={identify:t=>t===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new P(!0),stringify:Zi},Qi={identify:t=>t===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new P(!1),stringify:Zi},mr={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ye},gr={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t.replace(/_/g,"")),stringify(t){const e=Number(t.value);return isFinite(e)?e.toExponential():ye(t)}},yr={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(t){const e=new P(parseFloat(t.replace(/_/g,""))),n=t.indexOf(".");if(n!==-1){const i=t.substring(n+1).replace(/_/g,"");i[i.length-1]==="0"&&(e.minFractionDigits=i.length)}return e},stringify:ye},St=t=>typeof t=="bigint"||Number.isInteger(t);function qt(t,e,n,{intAsBigInt:i}){const s=t[0];if((s==="-"||s==="+")&&(e+=1),t=t.substring(e).replace(/_/g,""),i){switch(n){case 2:t=`0b${t}`;break;case 8:t=`0o${t}`;break;case 16:t=`0x${t}`;break}const o=BigInt(t);return s==="-"?BigInt(-1)*o:o}const r=parseInt(t,n);return s==="-"?-1*r:r}function Ln(t,e,n){const{value:i}=t;if(St(i)){const s=i.toString(e);return i<0?"-"+n+s.substr(1):n+s}return ye(t)}const br={identify:St,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(t,e,n)=>qt(t,2,2,n),stringify:t=>Ln(t,2,"0b")},wr={identify:St,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(t,e,n)=>qt(t,1,8,n),stringify:t=>Ln(t,8,"0")},Sr={identify:St,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(t,e,n)=>qt(t,0,10,n),stringify:ye},Nr={identify:St,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(t,e,n)=>qt(t,2,16,n),stringify:t=>Ln(t,16,"0x")};class Ze extends ae{constructor(e){super(e),this.tag=Ze.tag}add(e){let n;J(e)?n=e:e&&typeof e=="object"&&"key"in e&&"value"in e&&e.value===null?n=new ne(e.key,null):n=new ne(e,null),De(this.items,n.key)||this.items.push(n)}get(e,n){const i=De(this.items,e);return!n&&J(i)?W(i.key)?i.key.value:i.key:i}set(e,n){if(typeof n!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);const i=De(this.items,e);i&&!n?this.items.splice(this.items.indexOf(i),1):!i&&n&&this.items.push(new ne(e))}toJSON(e,n){return super.toJSON(e,n,Set)}toString(e,n,i){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),n,i);throw new Error("Set items must all have null values")}static from(e,n,i){const{replacer:s}=i,r=new this(e);if(n&&Symbol.iterator in Object(n))for(let o of n)typeof s=="function"&&(o=s.call(n,o,o)),r.items.push(In(o,null,i));return r}}Ze.tag="tag:yaml.org,2002:set";const Pn={collection:"map",identify:t=>t instanceof Set,nodeClass:Ze,default:!1,tag:"tag:yaml.org,2002:set",createNode:(t,e,n)=>Ze.from(t,e,n),resolve(t,e){if(st(t)){if(t.hasAllNullValues(!0))return Object.assign(new Ze,t);e("Set items must all have null values")}else e("Expected a mapping for this tag");return t}};function Mn(t,e){const n=t[0],i=n==="-"||n==="+"?t.substring(1):t,s=o=>e?BigInt(o):Number(o),r=i.replace(/_/g,"").split(":").reduce((o,a)=>o*s(60)+s(a),s(0));return n==="-"?s(-1)*r:r}function es(t){let{value:e}=t,n=o=>o;if(typeof e=="bigint")n=o=>BigInt(o);else if(isNaN(e)||!isFinite(e))return ye(t);let i="";e<0&&(i="-",e*=n(-1));const s=n(60),r=[e%s];return e<60?r.unshift(0):(e=(e-r[0])/s,r.unshift(e%s),e>=60&&(e=(e-r[0])/s,r.unshift(e))),i+r.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const ts={identify:t=>typeof t=="bigint"||Number.isInteger(t),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(t,e,{intAsBigInt:n})=>Mn(t,n),stringify:es},ns={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:t=>Mn(t,!1),stringify:es},Ht={identify:t=>t instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(t){const e=t.match(Ht.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,i,s,r,o,a]=e.map(Number),l=e[7]?Number((e[7]+"00").substr(1,3)):0;let f=Date.UTC(n,i-1,s,r||0,o||0,a||0,l);const h=e[8];if(h&&h!=="Z"){let c=Mn(h,!1);Math.abs(c)<30&&(c*=60),f-=6e4*c}return new Date(f)},stringify:({value:t})=>t.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")},ni=[ot,at,Ut,Vt,Xi,Qi,br,wr,Sr,Nr,mr,gr,yr,Cn,_n,vn,Pn,ts,ns,Ht],ii=new Map([["core",ur],["failsafe",[ot,at,Ut]],["json",pr],["yaml11",ni],["yaml-1.1",ni]]),si={binary:Cn,bool:Bn,float:qi,floatExp:Ki,floatNaN:Vi,floatTime:ns,int:Ji,intHex:Gi,intOct:Wi,intTime:ts,map:ot,null:Vt,omap:_n,pairs:vn,seq:at,set:Pn,timestamp:Ht},Er={"tag:yaml.org,2002:binary":Cn,"tag:yaml.org,2002:omap":_n,"tag:yaml.org,2002:pairs":vn,"tag:yaml.org,2002:set":Pn,"tag:yaml.org,2002:timestamp":Ht};function sn(t,e){let n=ii.get(e);if(!n)if(Array.isArray(t))n=[];else{const i=Array.from(ii.keys()).filter(s=>s!=="yaml11").map(s=>JSON.stringify(s)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${i} or define customTags array`)}if(Array.isArray(t))for(const i of t)n=n.concat(i);else typeof t=="function"&&(n=t(n.slice()));return n.map(i=>{if(typeof i!="string")return i;const s=si[i];if(s)return s;const r=Object.keys(si).map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown custom tag "${i}"; use one of ${r}`)})}const kr=(t,e)=>t.key<e.key?-1:t.key>e.key?1:0;class Wt{constructor({compat:e,customTags:n,merge:i,resolveKnownTags:s,schema:r,sortMapEntries:o,toStringDefaults:a}){this.compat=Array.isArray(e)?sn(e,"compat"):e?sn(null,e):null,this.merge=!!i,this.name=typeof r=="string"&&r||"core",this.knownTags=s?Er:{},this.tags=sn(n,this.name),this.toStringOptions=a??null,Object.defineProperty(this,Ce,{value:ot}),Object.defineProperty(this,Ie,{value:Ut}),Object.defineProperty(this,nt,{value:at}),this.sortMapEntries=typeof o=="function"?o:o===!0?kr:null}clone(){const e=Object.create(Wt.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}function Tr(t,e){const n=[];let i=e.directives===!0;if(e.directives!==!1&&t.directives){const l=t.directives.toString(t);l?(n.push(l),i=!0):t.directives.docStart&&(i=!0)}i&&n.push("---");const s=ji(t,e),{commentString:r}=s.options;if(t.commentBefore){n.length!==1&&n.unshift("");const l=r(t.commentBefore);n.unshift(Oe(l,""))}let o=!1,a=null;if(t.contents){if(Y(t.contents)){if(t.contents.spaceBefore&&i&&n.push(""),t.contents.commentBefore){const h=r(t.contents.commentBefore);n.push(Oe(h,""))}s.forceBlockIndent=!!t.comment,a=t.contents.comment}const l=a?void 0:()=>o=!0;let f=Xe(t.contents,s,()=>a=null,l);a&&(f+=Me(f,"",r(a))),(f[0]==="|"||f[0]===">")&&n[n.length-1]==="---"?n[n.length-1]=`--- ${f}`:n.push(f)}else n.push(Xe(t.contents,s));if(t.directives?.docEnd)if(t.comment){const l=r(t.comment);l.includes(`
`)?(n.push("..."),n.push(Oe(l,""))):n.push(`... ${l}`)}else n.push("...");else{let l=t.comment;l&&o&&(l=l.replace(/^\n+/,"")),l&&((!o||a)&&n[n.length-1]!==""&&n.push(""),n.push(Oe(r(l),"")))}return n.join(`
`)+`
`}class lt{constructor(e,n,i){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,he,{value:mn});let s=null;typeof n=="function"||Array.isArray(n)?s=n:i===void 0&&n&&(i=n,n=void 0);const r=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},i);this.options=r;let{version:o}=r;i?._directives?(this.directives=i._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new ie({version:o}),this.setSchema(o,i),this.contents=e===void 0?null:this.createNode(e,s,i)}clone(){const e=Object.create(lt.prototype,{[he]:{value:mn}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=Y(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){Ue(this.contents)&&this.contents.add(e)}addIn(e,n){Ue(this.contents)&&this.contents.addIn(e,n)}createAlias(e,n){if(!e.anchor){const i=Pi(this);e.anchor=!n||i.has(n)?Mi(n||"a",i):n}return new xt(e.anchor)}createNode(e,n,i){let s;if(typeof n=="function")e=n.call({"":e},"",e),s=n;else if(Array.isArray(n)){const m=k=>typeof k=="number"||k instanceof String||k instanceof Number,I=n.filter(m).map(String);I.length>0&&(n=n.concat(I)),s=n}else i===void 0&&n&&(i=n,n=void 0);const{aliasDuplicateObjects:r,anchorPrefix:o,flow:a,keepUndefined:l,onTagObj:f,tag:h}=i??{},{onAnchor:c,setAnchors:d,sourceObjects:g}=Xs(this,o||"a"),T={aliasDuplicateObjects:r??!0,keepUndefined:l??!1,onAnchor:c,onTagObj:f,replacer:s,schema:this.schema,sourceObjects:g},p=mt(e,h,T);return a&&G(p)&&(p.flow=!0),d(),p}createPair(e,n,i={}){const s=this.createNode(e,null,i),r=this.createNode(n,null,i);return new ne(s,r)}delete(e){return Ue(this.contents)?this.contents.delete(e):!1}deleteIn(e){return dt(e)?this.contents==null?!1:(this.contents=null,!0):Ue(this.contents)?this.contents.deleteIn(e):!1}get(e,n){return G(this.contents)?this.contents.get(e,n):void 0}getIn(e,n){return dt(e)?!n&&W(this.contents)?this.contents.value:this.contents:G(this.contents)?this.contents.getIn(e,n):void 0}has(e){return G(this.contents)?this.contents.has(e):!1}hasIn(e){return dt(e)?this.contents!==void 0:G(this.contents)?this.contents.hasIn(e):!1}set(e,n){this.contents==null?this.contents=_t(this.schema,[e],n):Ue(this.contents)&&this.contents.set(e,n)}setIn(e,n){dt(e)?this.contents=n:this.contents==null?this.contents=_t(this.schema,Array.from(e),n):Ue(this.contents)&&this.contents.setIn(e,n)}setSchema(e,n={}){typeof e=="number"&&(e=String(e));let i;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new ie({version:"1.1"}),i={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new ie({version:e}),i={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,i=null;break;default:{const s=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${s}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(i)this.schema=new Wt(Object.assign(i,n));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:n,mapAsMap:i,maxAliasCount:s,onAnchor:r,reviver:o}={}){const a={anchors:new Map,doc:this,keep:!e,mapAsMap:i===!0,mapKeyWarned:!1,maxAliasCount:typeof s=="number"?s:100},l=ue(this.contents,n??"",a);if(typeof r=="function")for(const{count:f,res:h}of a.anchors.values())r(h,f);return typeof o=="function"?We(o,{"":l},"",l):l}toJSON(e,n){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:n})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const n=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${n}`)}return Tr(this,e)}}function Ue(t){if(G(t))return!0;throw new Error("Expected a YAML collection as document contents")}class Dn extends Error{constructor(e,n,i,s){super(),this.name=e,this.code=i,this.message=s,this.pos=n}}class xe extends Dn{constructor(e,n,i){super("YAMLParseError",e,n,i)}}class is extends Dn{constructor(e,n,i){super("YAMLWarning",e,n,i)}}const Pt=(t,e)=>n=>{if(n.pos[0]===-1)return;n.linePos=n.pos.map(a=>e.linePos(a));const{line:i,col:s}=n.linePos[0];n.message+=` at line ${i}, column ${s}`;let r=s-1,o=t.substring(e.lineStarts[i-1],e.lineStarts[i]).replace(/[\n\r]+$/,"");if(r>=60&&o.length>80){const a=Math.min(r-39,o.length-79);o="…"+o.substring(a),r-=a-1}if(o.length>80&&(o=o.substring(0,79)+"…"),i>1&&/^ *$/.test(o.substring(0,r))){let a=t.substring(e.lineStarts[i-2],e.lineStarts[i-1]);a.length>80&&(a=a.substring(0,79)+`…
`),o=a+o}if(/[^ ]/.test(o)){let a=1;const l=n.linePos[1];l&&l.line===i&&l.col>s&&(a=Math.max(1,Math.min(l.col-s,80-r)));const f=" ".repeat(r)+"^".repeat(a);n.message+=`:

${o}
${f}
`}};function Qe(t,{flow:e,indicator:n,next:i,offset:s,onError:r,startOnNewline:o}){let a=!1,l=o,f=o,h="",c="",d=!1,g=!1,T=!1,p=null,m=null,I=null,k=null,$=null;for(const A of t)switch(T&&(A.type!=="space"&&A.type!=="newline"&&A.type!=="comma"&&r(A.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),T=!1),A.type){case"space":!e&&l&&n!=="doc-start"&&A.source[0]==="	"&&r(A,"TAB_AS_INDENT","Tabs are not allowed as indentation"),f=!0;break;case"comment":{f||r(A,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const V=A.source.substring(1)||" ";h?h+=c+V:h=V,c="",l=!1;break}case"newline":l?h?h+=A.source:a=!0:c+=A.source,l=!0,d=!0,(p||m)&&(g=!0),f=!0;break;case"anchor":p&&r(A,"MULTIPLE_ANCHORS","A node can have at most one anchor"),A.source.endsWith(":")&&r(A.offset+A.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),p=A,$===null&&($=A.offset),l=!1,f=!1,T=!0;break;case"tag":{m&&r(A,"MULTIPLE_TAGS","A node can have at most one tag"),m=A,$===null&&($=A.offset),l=!1,f=!1,T=!0;break}case n:(p||m)&&r(A,"BAD_PROP_ORDER",`Anchors and tags must be after the ${A.source} indicator`),k&&r(A,"UNEXPECTED_TOKEN",`Unexpected ${A.source} in ${e??"collection"}`),k=A,l=!1,f=!1;break;case"comma":if(e){I&&r(A,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),I=A,l=!1,f=!1;break}default:r(A,"UNEXPECTED_TOKEN",`Unexpected ${A.type} token`),l=!1,f=!1}const w=t[t.length-1],v=w?w.offset+w.source.length:s;return T&&i&&i.type!=="space"&&i.type!=="newline"&&i.type!=="comma"&&(i.type!=="scalar"||i.source!=="")&&r(i.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),{comma:I,found:k,spaceBefore:a,comment:h,hasNewline:d,hasNewlineAfterProp:g,anchor:p,tag:m,end:v,start:$??v}}function gt(t){if(!t)return null;switch(t.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(t.source.includes(`
`))return!0;if(t.end){for(const e of t.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(const e of t.items){for(const n of e.start)if(n.type==="newline")return!0;if(e.sep){for(const n of e.sep)if(n.type==="newline")return!0}if(gt(e.key)||gt(e.value))return!0}return!1;default:return!0}}function wn(t,e,n){if(e?.type==="flow-collection"){const i=e.end[0];i.indent===t&&(i.source==="]"||i.source==="}")&&gt(e)&&n(i,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function ss(t,e,n){const{uniqueKeys:i}=t.options;if(i===!1)return!1;const s=typeof i=="function"?i:(r,o)=>r===o||W(r)&&W(o)&&r.value===o.value&&!(r.value==="<<"&&t.schema.merge);return e.some(r=>s(r.key,n))}const ri="All mapping items must start at the same column";function Or({composeNode:t,composeEmptyNode:e},n,i,s,r){const o=r?.nodeClass??ae,a=new o(n.schema);n.atRoot&&(n.atRoot=!1);let l=i.offset,f=null;for(const h of i.items){const{start:c,key:d,sep:g,value:T}=h,p=Qe(c,{indicator:"explicit-key-ind",next:d??g?.[0],offset:l,onError:s,startOnNewline:!0}),m=!p.found;if(m){if(d&&(d.type==="block-seq"?s(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in d&&d.indent!==i.indent&&s(l,"BAD_INDENT",ri)),!p.anchor&&!p.tag&&!g){f=p.end,p.comment&&(a.comment?a.comment+=`
`+p.comment:a.comment=p.comment);continue}(p.hasNewlineAfterProp||gt(d))&&s(d??c[c.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else p.found?.indent!==i.indent&&s(l,"BAD_INDENT",ri);const I=p.end,k=d?t(n,d,p,s):e(n,I,c,null,p,s);n.schema.compat&&wn(i.indent,d,s),ss(n,a.items,k)&&s(I,"DUPLICATE_KEY","Map keys must be unique");const $=Qe(g??[],{indicator:"map-value-ind",next:T,offset:k.range[2],onError:s,startOnNewline:!d||d.type==="block-scalar"});if(l=$.end,$.found){m&&(T?.type==="block-map"&&!$.hasNewline&&s(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&p.start<$.found.offset-1024&&s(k.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const w=T?t(n,T,$,s):e(n,l,g,null,$,s);n.schema.compat&&wn(i.indent,T,s),l=w.range[2];const v=new ne(k,w);n.options.keepSourceTokens&&(v.srcToken=h),a.items.push(v)}else{m&&s(k.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),$.comment&&(k.comment?k.comment+=`
`+$.comment:k.comment=$.comment);const w=new ne(k);n.options.keepSourceTokens&&(w.srcToken=h),a.items.push(w)}}return f&&f<l&&s(f,"IMPOSSIBLE","Map comment with trailing content"),a.range=[i.offset,l,f??l],a}function Ar({composeNode:t,composeEmptyNode:e},n,i,s,r){const o=r?.nodeClass??Le,a=new o(n.schema);n.atRoot&&(n.atRoot=!1);let l=i.offset,f=null;for(const{start:h,value:c}of i.items){const d=Qe(h,{indicator:"seq-item-ind",next:c,offset:l,onError:s,startOnNewline:!0});if(!d.found)if(d.anchor||d.tag||c)c&&c.type==="block-seq"?s(d.end,"BAD_INDENT","All sequence items must start at the same column"):s(l,"MISSING_CHAR","Sequence item without - indicator");else{f=d.end,d.comment&&(a.comment=d.comment);continue}const g=c?t(n,c,d,s):e(n,d.end,h,null,d,s);n.schema.compat&&wn(i.indent,c,s),l=g.range[2],a.items.push(g)}return a.range=[i.offset,l,f??l],a}function Nt(t,e,n,i){let s="";if(t){let r=!1,o="";for(const a of t){const{source:l,type:f}=a;switch(f){case"space":r=!0;break;case"comment":{n&&!r&&i(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const h=l.substring(1)||" ";s?s+=o+h:s=h,o="";break}case"newline":s&&(o+=l),r=!0;break;default:i(a,"UNEXPECTED_TOKEN",`Unexpected ${f} at node end`)}e+=l.length}}return{comment:s,offset:e}}const rn="Block collections are not allowed within flow collections",on=t=>t&&(t.type==="block-map"||t.type==="block-seq");function Ir({composeNode:t,composeEmptyNode:e},n,i,s,r){const o=i.start.source==="{",a=o?"flow map":"flow sequence",l=r?.nodeClass??(o?ae:Le),f=new l(n.schema);f.flow=!0;const h=n.atRoot;h&&(n.atRoot=!1);let c=i.offset+i.start.source.length;for(let m=0;m<i.items.length;++m){const I=i.items[m],{start:k,key:$,sep:w,value:v}=I,A=Qe(k,{flow:a,indicator:"explicit-key-ind",next:$??w?.[0],offset:c,onError:s,startOnNewline:!1});if(!A.found){if(!A.anchor&&!A.tag&&!w&&!v){m===0&&A.comma?s(A.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):m<i.items.length-1&&s(A.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),A.comment&&(f.comment?f.comment+=`
`+A.comment:f.comment=A.comment),c=A.end;continue}!o&&n.options.strict&&gt($)&&s($,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(m===0)A.comma&&s(A.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(A.comma||s(A.start,"MISSING_CHAR",`Missing , between ${a} items`),A.comment){let V="";e:for(const j of k)switch(j.type){case"comma":case"space":break;case"comment":V=j.source.substring(1);break e;default:break e}if(V){let j=f.items[f.items.length-1];J(j)&&(j=j.value??j.key),j.comment?j.comment+=`
`+V:j.comment=V,A.comment=A.comment.substring(V.length+1)}}if(!o&&!w&&!A.found){const V=v?t(n,v,A,s):e(n,A.end,w,null,A,s);f.items.push(V),c=V.range[2],on(v)&&s(V.range,"BLOCK_IN_FLOW",rn)}else{const V=A.end,j=$?t(n,$,A,s):e(n,V,k,null,A,s);on($)&&s(j.range,"BLOCK_IN_FLOW",rn);const L=Qe(w??[],{flow:a,indicator:"map-value-ind",next:v,offset:j.range[2],onError:s,startOnNewline:!1});if(L.found){if(!o&&!A.found&&n.options.strict){if(w)for(const q of w){if(q===L.found)break;if(q.type==="newline"){s(q,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}A.start<L.found.offset-1024&&s(L.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else v&&("source"in v&&v.source&&v.source[0]===":"?s(v,"MISSING_CHAR",`Missing space after : in ${a}`):s(L.start,"MISSING_CHAR",`Missing , or : between ${a} items`));const K=v?t(n,v,L,s):L.found?e(n,L.end,w,null,L,s):null;K?on(v)&&s(K.range,"BLOCK_IN_FLOW",rn):L.comment&&(j.comment?j.comment+=`
`+L.comment:j.comment=L.comment);const D=new ne(j,K);if(n.options.keepSourceTokens&&(D.srcToken=I),o){const q=f;ss(n,q.items,j)&&s(V,"DUPLICATE_KEY","Map keys must be unique"),q.items.push(D)}else{const q=new ae(n.schema);q.flow=!0,q.items.push(D),f.items.push(q)}c=K?K.range[2]:L.end}}const d=o?"}":"]",[g,...T]=i.end;let p=c;if(g&&g.source===d)p=g.offset+g.source.length;else{const m=a[0].toUpperCase()+a.substring(1),I=h?`${m} must end with a ${d}`:`${m} in block collection must be sufficiently indented and end with a ${d}`;s(c,h?"MISSING_CHAR":"BAD_INDENT",I),g&&g.source.length!==1&&T.unshift(g)}if(T.length>0){const m=Nt(T,p,n.options.strict,s);m.comment&&(f.comment?f.comment+=`
`+m.comment:f.comment=m.comment),f.range=[i.offset,p,m.offset]}else f.range=[i.offset,p,p];return f}function an(t,e,n,i,s,r){const o=n.type==="block-map"?Or(t,e,n,i,r):n.type==="block-seq"?Ar(t,e,n,i,r):Ir(t,e,n,i,r),a=o.constructor;return s==="!"||s===a.tagName?(o.tag=a.tagName,o):(s&&(o.tag=s),o)}function Br(t,e,n,i,s){const r=i?e.directives.tagName(i.source,c=>s(i,"TAG_RESOLVE_FAILED",c)):null,o=n.type==="block-map"?"map":n.type==="block-seq"?"seq":n.start.source==="{"?"map":"seq";if(!i||!r||r==="!"||r===ae.tagName&&o==="map"||r===Le.tagName&&o==="seq"||!o)return an(t,e,n,s,r);let a=e.schema.tags.find(c=>c.tag===r&&c.collection===o);if(!a){const c=e.schema.knownTags[r];if(c&&c.collection===o)e.schema.tags.push(Object.assign({},c,{default:!1})),a=c;else return c?.collection?s(i,"BAD_COLLECTION_TYPE",`${c.tag} used for ${o} collection, but expects ${c.collection}`,!0):s(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${r}`,!0),an(t,e,n,s,r)}const l=an(t,e,n,s,r,a),f=a.resolve?.(l,c=>s(i,"TAG_RESOLVE_FAILED",c),e.options)??l,h=Y(f)?f:new P(f);return h.range=l.range,h.tag=r,a?.format&&(h.format=a.format),h}function rs(t,e,n){const i=t.offset,s=$r(t,e,n);if(!s)return{value:"",type:null,comment:"",range:[i,i,i]};const r=s.mode===">"?P.BLOCK_FOLDED:P.BLOCK_LITERAL,o=t.source?Cr(t.source):[];let a=o.length;for(let p=o.length-1;p>=0;--p){const m=o[p][1];if(m===""||m==="\r")a=p;else break}if(a===0){const p=s.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let m=i+s.length;return t.source&&(m+=t.source.length),{value:p,type:r,comment:s.comment,range:[i,m,m]}}let l=t.indent+s.indent,f=t.offset+s.length,h=0;for(let p=0;p<a;++p){const[m,I]=o[p];if(I===""||I==="\r")s.indent===0&&m.length>l&&(l=m.length);else{m.length<l&&n(f+m.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),s.indent===0&&(l=m.length),h=p;break}f+=m.length+I.length+1}for(let p=o.length-1;p>=a;--p)o[p][0].length>l&&(a=p+1);let c="",d="",g=!1;for(let p=0;p<h;++p)c+=o[p][0].slice(l)+`
`;for(let p=h;p<a;++p){let[m,I]=o[p];f+=m.length+I.length+1;const k=I[I.length-1]==="\r";if(k&&(I=I.slice(0,-1)),I&&m.length<l){const w=`Block scalar lines must not be less indented than their ${s.indent?"explicit indentation indicator":"first line"}`;n(f-I.length-(k?2:1),"BAD_INDENT",w),m=""}r===P.BLOCK_LITERAL?(c+=d+m.slice(l)+I,d=`
`):m.length>l||I[0]==="	"?(d===" "?d=`
`:!g&&d===`
`&&(d=`

`),c+=d+m.slice(l)+I,d=`
`,g=!0):I===""?d===`
`?c+=`
`:d=`
`:(c+=d+I,d=" ",g=!1)}switch(s.chomp){case"-":break;case"+":for(let p=a;p<o.length;++p)c+=`
`+o[p][0].slice(l);c[c.length-1]!==`
`&&(c+=`
`);break;default:c+=`
`}const T=i+s.length+t.source.length;return{value:c,type:r,comment:s.comment,range:[i,T,T]}}function $r({offset:t,props:e},n,i){if(e[0].type!=="block-scalar-header")return i(e[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:s}=e[0],r=s[0];let o=0,a="",l=-1;for(let d=1;d<s.length;++d){const g=s[d];if(!a&&(g==="-"||g==="+"))a=g;else{const T=Number(g);!o&&T?o=T:l===-1&&(l=t+d)}}l!==-1&&i(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${s}`);let f=!1,h="",c=s.length;for(let d=1;d<e.length;++d){const g=e[d];switch(g.type){case"space":f=!0;case"newline":c+=g.source.length;break;case"comment":n&&!f&&i(g,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),c+=g.source.length,h=g.source.substring(1);break;case"error":i(g,"UNEXPECTED_TOKEN",g.message),c+=g.source.length;break;default:{const T=`Unexpected token in block scalar header: ${g.type}`;i(g,"UNEXPECTED_TOKEN",T);const p=g.source;p&&typeof p=="string"&&(c+=p.length)}}}return{mode:r,indent:o,chomp:a,comment:h,length:c}}function Cr(t){const e=t.split(/\n( *)/),n=e[0],i=n.match(/^( *)/),r=[i?.[1]?[i[1],n.slice(i[1].length)]:["",n]];for(let o=1;o<e.length;o+=2)r.push([e[o],e[o+1]]);return r}function os(t,e,n){const{offset:i,type:s,source:r,end:o}=t;let a,l;const f=(d,g,T)=>n(i+d,g,T);switch(s){case"scalar":a=P.PLAIN,l=vr(r,f);break;case"single-quoted-scalar":a=P.QUOTE_SINGLE,l=_r(r,f);break;case"double-quoted-scalar":a=P.QUOTE_DOUBLE,l=Lr(r,f);break;default:return n(t,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${s}`),{value:"",type:null,comment:"",range:[i,i+r.length,i+r.length]}}const h=i+r.length,c=Nt(o,h,e,n);return{value:l,type:a,comment:c.comment,range:[i,h,c.offset]}}function vr(t,e){let n="";switch(t[0]){case"	":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":{n=`block scalar indicator ${t[0]}`;break}case"@":case"`":{n=`reserved character ${t[0]}`;break}}return n&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),as(t)}function _r(t,e){return(t[t.length-1]!=="'"||t.length===1)&&e(t.length,"MISSING_CHAR","Missing closing 'quote"),as(t.slice(1,-1)).replace(/''/g,"'")}function as(t){let e,n;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),n=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let i=e.exec(t);if(!i)return t;let s=i[1],r=" ",o=e.lastIndex;for(n.lastIndex=o;i=n.exec(t);)i[1]===""?r===`
`?s+=r:r=`
`:(s+=r+i[1],r=" "),o=n.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=o,i=a.exec(t),s+r+(i?.[1]??"")}function Lr(t,e){let n="";for(let i=1;i<t.length-1;++i){const s=t[i];if(!(s==="\r"&&t[i+1]===`
`))if(s===`
`){const{fold:r,offset:o}=Pr(t,i);n+=r,i=o}else if(s==="\\"){let r=t[++i];const o=Mr[r];if(o)n+=o;else if(r===`
`)for(r=t[i+1];r===" "||r==="	";)r=t[++i+1];else if(r==="\r"&&t[i+1]===`
`)for(r=t[++i+1];r===" "||r==="	";)r=t[++i+1];else if(r==="x"||r==="u"||r==="U"){const a={x:2,u:4,U:8}[r];n+=Dr(t,i+1,a,e),i+=a}else{const a=t.substr(i-1,2);e(i-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),n+=a}}else if(s===" "||s==="	"){const r=i;let o=t[i+1];for(;o===" "||o==="	";)o=t[++i+1];o!==`
`&&!(o==="\r"&&t[i+2]===`
`)&&(n+=i>r?t.slice(r,i+1):s)}else n+=s}return(t[t.length-1]!=='"'||t.length===1)&&e(t.length,"MISSING_CHAR",'Missing closing "quote'),n}function Pr(t,e){let n="",i=t[e+1];for(;(i===" "||i==="	"||i===`
`||i==="\r")&&!(i==="\r"&&t[e+2]!==`
`);)i===`
`&&(n+=`
`),e+=1,i=t[e+1];return n||(n=" "),{fold:n,offset:e}}const Mr={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function Dr(t,e,n,i){const s=t.substr(e,n),o=s.length===n&&/^[0-9a-fA-F]+$/.test(s)?parseInt(s,16):NaN;if(isNaN(o)){const a=t.substr(e-2,n+2);return i(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),a}return String.fromCodePoint(o)}function ls(t,e,n,i){const{value:s,type:r,comment:o,range:a}=e.type==="block-scalar"?rs(e,t.options.strict,i):os(e,t.options.strict,i),l=n?t.directives.tagName(n.source,c=>i(n,"TAG_RESOLVE_FAILED",c)):null,f=n&&l?xr(t.schema,s,l,n,i):e.type==="scalar"?jr(t,s,e,i):t.schema[Ie];let h;try{const c=f.resolve(s,d=>i(n??e,"TAG_RESOLVE_FAILED",d),t.options);h=W(c)?c:new P(c)}catch(c){const d=c instanceof Error?c.message:String(c);i(n??e,"TAG_RESOLVE_FAILED",d),h=new P(s)}return h.range=a,h.source=s,r&&(h.type=r),l&&(h.tag=l),f.format&&(h.format=f.format),o&&(h.comment=o),h}function xr(t,e,n,i,s){if(n==="!")return t[Ie];const r=[];for(const a of t.tags)if(!a.collection&&a.tag===n)if(a.default&&a.test)r.push(a);else return a;for(const a of r)if(a.test?.test(e))return a;const o=t.knownTags[n];return o&&!o.collection?(t.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(s(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,n!=="tag:yaml.org,2002:str"),t[Ie])}function jr({directives:t,schema:e},n,i,s){const r=e.tags.find(o=>o.default&&o.test?.test(n))||e[Ie];if(e.compat){const o=e.compat.find(a=>a.default&&a.test?.test(n))??e[Ie];if(r.tag!==o.tag){const a=t.tagString(r.tag),l=t.tagString(o.tag),f=`Value may be parsed as either ${a} or ${l}`;s(i,"TAG_RESOLVE_FAILED",f,!0)}}return r}function Rr(t,e,n){if(e){n===null&&(n=e.length);for(let i=n-1;i>=0;--i){let s=e[i];switch(s.type){case"space":case"comment":case"newline":t-=s.source.length;continue}for(s=e[++i];s?.type==="space";)t+=s.source.length,s=e[++i];break}}return t}const Fr={composeNode:fs,composeEmptyNode:xn};function fs(t,e,n,i){const{spaceBefore:s,comment:r,anchor:o,tag:a}=n;let l,f=!0;switch(e.type){case"alias":l=Ur(t,e,i),(o||a)&&i(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":l=ls(t,e,a,i),o&&(l.anchor=o.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":l=Br(Fr,t,e,a,i),o&&(l.anchor=o.source.substring(1));break;default:{const h=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;i(e,"UNEXPECTED_TOKEN",h),l=xn(t,e.offset,void 0,null,n,i),f=!1}}return o&&l.anchor===""&&i(o,"BAD_ALIAS","Anchor cannot be an empty string"),s&&(l.spaceBefore=!0),r&&(e.type==="scalar"&&e.source===""?l.comment=r:l.commentBefore=r),t.options.keepSourceTokens&&f&&(l.srcToken=e),l}function xn(t,e,n,i,{spaceBefore:s,comment:r,anchor:o,tag:a,end:l},f){const h={type:"scalar",offset:Rr(e,n,i),indent:-1,source:""},c=ls(t,h,a,f);return o&&(c.anchor=o.source.substring(1),c.anchor===""&&f(o,"BAD_ALIAS","Anchor cannot be an empty string")),s&&(c.spaceBefore=!0),r&&(c.comment=r,c.range[2]=l),c}function Ur({options:t},{offset:e,source:n,end:i},s){const r=new xt(n.substring(1));r.source===""&&s(e,"BAD_ALIAS","Alias cannot be an empty string"),r.source.endsWith(":")&&s(e+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=e+n.length,a=Nt(i,o,t.strict,s);return r.range=[e,o,a.offset],a.comment&&(r.comment=a.comment),r}function Vr(t,e,{offset:n,start:i,value:s,end:r},o){const a=Object.assign({_directives:e},t),l=new lt(void 0,a),f={atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},h=Qe(i,{indicator:"doc-start",next:s??r?.[0],offset:n,onError:o,startOnNewline:!0});h.found&&(l.directives.docStart=!0,s&&(s.type==="block-map"||s.type==="block-seq")&&!h.hasNewline&&o(h.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=s?fs(f,s,h,o):xn(f,h.end,i,null,h,o);const c=l.contents.range[2],d=Nt(r,c,!1,o);return d.comment&&(l.comment=d.comment),l.range=[n,c,d.offset],l}function ut(t){if(typeof t=="number")return[t,t+1];if(Array.isArray(t))return t.length===2?t:[t[0],t[1]];const{offset:e,source:n}=t;return[e,e+(typeof n=="string"?n.length:1)]}function oi(t){let e="",n=!1,i=!1;for(let s=0;s<t.length;++s){const r=t[s];switch(r[0]){case"#":e+=(e===""?"":i?`

`:`
`)+(r.substring(1)||" "),n=!0,i=!1;break;case"%":t[s+1]?.[0]!=="#"&&(s+=1),n=!1;break;default:n||(i=!0),n=!1}}return{comment:e,afterEmptyLine:i}}class jn{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(n,i,s,r)=>{const o=ut(n);r?this.warnings.push(new is(o,i,s)):this.errors.push(new xe(o,i,s))},this.directives=new ie({version:e.version||"1.2"}),this.options=e}decorate(e,n){const{comment:i,afterEmptyLine:s}=oi(this.prelude);if(i){const r=e.contents;if(n)e.comment=e.comment?`${e.comment}
${i}`:i;else if(s||e.directives.docStart||!r)e.commentBefore=i;else if(G(r)&&!r.flow&&r.items.length>0){let o=r.items[0];J(o)&&(o=o.key);const a=o.commentBefore;o.commentBefore=a?`${i}
${a}`:i}else{const o=r.commentBefore;r.commentBefore=o?`${i}
${o}`:i}}n?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:oi(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,n=!1,i=-1){for(const s of e)yield*this.next(s);yield*this.end(n,i)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(n,i,s)=>{const r=ut(e);r[0]+=n,this.onError(r,"BAD_DIRECTIVE",i,s)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const n=Vr(this.options,this.directives,e,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const n=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,i=new xe(ut(e),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(i):this.doc.errors.push(i);break}case"doc-end":{if(!this.doc){const i="Unexpected doc-end without preceding document";this.errors.push(new xe(ut(e),"UNEXPECTED_TOKEN",i));break}this.doc.directives.docEnd=!0;const n=Nt(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){const i=this.doc.comment;this.doc.comment=i?`${i}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new xe(ut(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const i=Object.assign({_directives:this.directives},this.options),s=new lt(void 0,i);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),s.range=[0,n,n],this.decorate(s,!1),yield s}}}function Kr(t,e=!0,n){if(t){const i=(s,r,o)=>{const a=typeof s=="number"?s:Array.isArray(s)?s[0]:s.offset;if(n)n(a,r,o);else throw new xe([a,a+1],r,o)};switch(t.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return os(t,e,i);case"block-scalar":return rs(t,e,i)}}return null}function qr(t,e){const{implicitKey:n=!1,indent:i,inFlow:s=!1,offset:r=-1,type:o="PLAIN"}=e,a=wt({type:o,value:t},{implicitKey:n,indent:i>0?" ".repeat(i):"",inFlow:s,options:{blockQuote:!0,lineWidth:-1}}),l=e.end??[{type:"newline",offset:-1,indent:i,source:`
`}];switch(a[0]){case"|":case">":{const f=a.indexOf(`
`),h=a.substring(0,f),c=a.substring(f+1)+`
`,d=[{type:"block-scalar-header",offset:r,indent:i,source:h}];return cs(d,l)||d.push({type:"newline",offset:-1,indent:i,source:`
`}),{type:"block-scalar",offset:r,indent:i,props:d,source:c}}case'"':return{type:"double-quoted-scalar",offset:r,indent:i,source:a,end:l};case"'":return{type:"single-quoted-scalar",offset:r,indent:i,source:a,end:l};default:return{type:"scalar",offset:r,indent:i,source:a,end:l}}}function Hr(t,e,n={}){let{afterKey:i=!1,implicitKey:s=!1,inFlow:r=!1,type:o}=n,a="indent"in t?t.indent:null;if(i&&typeof a=="number"&&(a+=2),!o)switch(t.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{const f=t.props[0];if(f.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=f.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}const l=wt({type:o,value:e},{implicitKey:s||a===null,indent:a!==null&&a>0?" ".repeat(a):"",inFlow:r,options:{blockQuote:!0,lineWidth:-1}});switch(l[0]){case"|":case">":Wr(t,l);break;case'"':ln(t,l,"double-quoted-scalar");break;case"'":ln(t,l,"single-quoted-scalar");break;default:ln(t,l,"scalar")}}function Wr(t,e){const n=e.indexOf(`
`),i=e.substring(0,n),s=e.substring(n+1)+`
`;if(t.type==="block-scalar"){const r=t.props[0];if(r.type!=="block-scalar-header")throw new Error("Invalid block scalar header");r.source=i,t.source=s}else{const{offset:r}=t,o="indent"in t?t.indent:-1,a=[{type:"block-scalar-header",offset:r,indent:o,source:i}];cs(a,"end"in t?t.end:void 0)||a.push({type:"newline",offset:-1,indent:o,source:`
`});for(const l of Object.keys(t))l!=="type"&&l!=="offset"&&delete t[l];Object.assign(t,{type:"block-scalar",indent:o,props:a,source:s})}}function cs(t,e){if(e)for(const n of e)switch(n.type){case"space":case"comment":t.push(n);break;case"newline":return t.push(n),!0}return!1}function ln(t,e,n){switch(t.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":t.type=n,t.source=e;break;case"block-scalar":{const i=t.props.slice(1);let s=e.length;t.props[0].type==="block-scalar-header"&&(s-=t.props[0].source.length);for(const r of i)r.offset+=s;delete t.props,Object.assign(t,{type:n,source:e,end:i});break}case"block-map":case"block-seq":{const s={type:"newline",offset:t.offset+e.length,indent:t.indent,source:`
`};delete t.items,Object.assign(t,{type:n,source:e,end:[s]});break}default:{const i="indent"in t?t.indent:-1,s="end"in t&&Array.isArray(t.end)?t.end.filter(r=>r.type==="space"||r.type==="comment"||r.type==="newline"):[];for(const r of Object.keys(t))r!=="type"&&r!=="offset"&&delete t[r];Object.assign(t,{type:n,indent:i,source:e,end:s})}}}const Jr=t=>"type"in t?Mt(t):Ct(t);function Mt(t){switch(t.type){case"block-scalar":{let e="";for(const n of t.props)e+=Mt(n);return e+t.source}case"block-map":case"block-seq":{let e="";for(const n of t.items)e+=Ct(n);return e}case"flow-collection":{let e=t.start.source;for(const n of t.items)e+=Ct(n);for(const n of t.end)e+=n.source;return e}case"document":{let e=Ct(t);if(t.end)for(const n of t.end)e+=n.source;return e}default:{let e=t.source;if("end"in t&&t.end)for(const n of t.end)e+=n.source;return e}}}function Ct({start:t,key:e,sep:n,value:i}){let s="";for(const r of t)s+=r.source;if(e&&(s+=Mt(e)),n)for(const r of n)s+=r.source;return i&&(s+=Mt(i)),s}const Sn=Symbol("break visit"),Gr=Symbol("skip children"),us=Symbol("remove item");function Re(t,e){"type"in t&&t.type==="document"&&(t={start:t.start,value:t.value}),hs(Object.freeze([]),t,e)}Re.BREAK=Sn;Re.SKIP=Gr;Re.REMOVE=us;Re.itemAtPath=(t,e)=>{let n=t;for(const[i,s]of e){const r=n?.[i];if(r&&"items"in r)n=r.items[s];else return}return n};Re.parentCollection=(t,e)=>{const n=Re.itemAtPath(t,e.slice(0,-1)),i=e[e.length-1][0],s=n?.[i];if(s&&"items"in s)return s;throw new Error("Parent collection not found")};function hs(t,e,n){let i=n(e,t);if(typeof i=="symbol")return i;for(const s of["key","value"]){const r=e[s];if(r&&"items"in r){for(let o=0;o<r.items.length;++o){const a=hs(Object.freeze(t.concat([[s,o]])),r.items[o],n);if(typeof a=="number")o=a-1;else{if(a===Sn)return Sn;a===us&&(r.items.splice(o,1),o-=1)}}typeof i=="function"&&s==="key"&&(i=i(e,t))}}return typeof i=="function"?i(e,t):i}const Jt="\uFEFF",Gt="",Yt="",yt="",Yr=t=>!!t&&"items"in t,zr=t=>!!t&&(t.type==="scalar"||t.type==="single-quoted-scalar"||t.type==="double-quoted-scalar"||t.type==="block-scalar");function Zr(t){switch(t){case Jt:return"<BOM>";case Gt:return"<DOC>";case Yt:return"<FLOW_END>";case yt:return"<SCALAR>";default:return JSON.stringify(t)}}function ds(t){switch(t){case Jt:return"byte-order-mark";case Gt:return"doc-mode";case Yt:return"flow-error-end";case yt:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(t[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const Xr=Object.freeze(Object.defineProperty({__proto__:null,BOM:Jt,DOCUMENT:Gt,FLOW_END:Yt,SCALAR:yt,createScalarToken:qr,isCollection:Yr,isScalar:zr,prettyToken:Zr,resolveAsScalar:Kr,setScalarValue:Hr,stringify:Jr,tokenType:ds,visit:Re},Symbol.toStringTag,{value:"Module"}));function fe(t){switch(t){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const ai="0123456789ABCDEFabcdef".split(""),Qr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()".split(""),fn=",[]{}".split(""),eo=` ,[]{}
\r	`.split(""),cn=t=>!t||eo.includes(t);class ps{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,n=!1){e&&(this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null),this.atEnd=!n;let i=this.next??"stream";for(;i&&(n||this.hasChars(1));)i=yield*this.parseNext(i)}atLineEnd(){let e=this.pos,n=this.buffer[e];for(;n===" "||n==="	";)n=this.buffer[++e];return!n||n==="#"||n===`
`?!0:n==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let n=this.buffer[e];if(this.indentNext>0){let i=0;for(;n===" ";)n=this.buffer[++i+e];if(n==="\r"){const s=this.buffer[i+e+1];if(s===`
`||!s&&!this.atEnd)return e+i+1}return n===`
`||i>=this.indentNext||!n&&!this.atEnd?e+i:-1}if(n==="-"||n==="."){const i=this.buffer.substr(e,3);if((i==="---"||i==="...")&&fe(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===Jt&&(yield*this.pushCount(1),e=e.substring(1)),e[0]==="%"){let n=e.length;const i=e.indexOf("#");if(i!==-1){const r=e[i-1];(r===" "||r==="	")&&(n=i-1)}for(;;){const r=e[n-1];if(r===" "||r==="	")n-=1;else break}const s=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-s),this.pushNewline(),"stream"}if(this.atLineEnd()){const n=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-n),yield*this.pushNewline(),"stream"}return yield Gt,yield*this.parseLineStart()}*parseLineStart(){const e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const n=this.peek(3);if(n==="---"&&fe(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"doc";if(n==="..."&&fe(this.charAt(3)))return yield*this.pushCount(3),"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!fe(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[e,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&fe(n)){const i=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=i,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const e=this.getLine();if(e===null)return this.setNext("doc");let n=yield*this.pushIndicators();switch(e[n]){case"#":yield*this.pushCount(e.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(cn),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=yield*this.parseBlockScalarHeader(),n+=yield*this.pushSpaces(!0),yield*this.pushCount(e.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,n,i=-1;do e=yield*this.pushNewline(),e>0?(n=yield*this.pushSpaces(!1),this.indentValue=i=n):n=0,n+=yield*this.pushSpaces(!0);while(e+n>0);const s=this.getLine();if(s===null)return this.setNext("flow");if((i!==-1&&i<this.indentNext&&s[0]!=="#"||i===0&&(s.startsWith("---")||s.startsWith("..."))&&fe(s[3]))&&!(i===this.indentNext-1&&this.flowLevel===1&&(s[0]==="]"||s[0]==="}")))return this.flowLevel=0,yield Yt,yield*this.parseLineStart();let r=0;for(;s[r]===",";)r+=yield*this.pushCount(1),r+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(r+=yield*this.pushIndicators(),s[r]){case void 0:return"flow";case"#":return yield*this.pushCount(s.length-r),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(cn),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||fe(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const e=this.charAt(0);let n=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;n!==-1&&this.buffer[n+1]==="'";)n=this.buffer.indexOf("'",n+2);else for(;n!==-1;){let r=0;for(;this.buffer[n-1-r]==="\\";)r+=1;if(r%2===0)break;n=this.buffer.indexOf('"',n+1)}const i=this.buffer.substring(0,n);let s=i.indexOf(`
`,this.pos);if(s!==-1){for(;s!==-1;){const r=this.continueScalar(s+1);if(r===-1)break;s=i.indexOf(`
`,r)}s!==-1&&(n=s-(i[s-1]==="\r"?2:1))}if(n===-1){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){const n=this.buffer[++e];if(n==="+")this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if(n!=="-")break}return yield*this.pushUntil(n=>fe(n)||n==="#")}*parseBlockScalar(){let e=this.pos-1,n=0,i;e:for(let s=this.pos;i=this.buffer[s];++s)switch(i){case" ":n+=1;break;case`
`:e=s,n=0;break;case"\r":{const r=this.buffer[s+1];if(!r&&!this.atEnd)return this.setNext("block-scalar");if(r===`
`)break}default:break e}if(!i&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=n:this.indentNext+=this.blockScalarIndent;do{const s=this.continueScalar(e+1);if(s===-1)break;e=this.buffer.indexOf(`
`,s)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}if(!this.blockScalarKeep)do{let s=e-1,r=this.buffer[s];r==="\r"&&(r=this.buffer[--s]);const o=s;for(;r===" "||r==="	";)r=this.buffer[--s];if(r===`
`&&s>=this.pos&&s+1+n>o)e=s;else break}while(!0);return yield yt,yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const e=this.flowLevel>0;let n=this.pos-1,i=this.pos-1,s;for(;s=this.buffer[++i];)if(s===":"){const r=this.buffer[i+1];if(fe(r)||e&&r===",")break;n=i}else if(fe(s)){let r=this.buffer[i+1];if(s==="\r"&&(r===`
`?(i+=1,s=`
`,r=this.buffer[i+1]):n=i),r==="#"||e&&fn.includes(r))break;if(s===`
`){const o=this.continueScalar(i+1);if(o===-1)break;i=Math.max(i,o-2)}}else{if(e&&fn.includes(s))break;n=i}return!s&&!this.atEnd?this.setNext("plain-scalar"):(yield yt,yield*this.pushToIndex(n+1,!0),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,n){const i=this.buffer.slice(this.pos,e);return i?(yield i,this.pos+=i.length,i.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(cn))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const e=this.flowLevel>0,n=this.charAt(1);if(fe(n)||e&&fn.includes(n))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,n=this.buffer[e];for(;!fe(n)&&n!==">";)n=this.buffer[++e];return yield*this.pushToIndex(n===">"?e+1:e,!1)}else{let e=this.pos+1,n=this.buffer[e];for(;n;)if(Qr.includes(n))n=this.buffer[++e];else if(n==="%"&&ai.includes(this.buffer[e+1])&&ai.includes(this.buffer[e+2]))n=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){const e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):e==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let n=this.pos-1,i;do i=this.buffer[++n];while(i===" "||e&&i==="	");const s=n-this.pos;return s>0&&(yield this.buffer.substr(this.pos,s),this.pos=n),s}*pushUntil(e){let n=this.pos,i=this.buffer[n];for(;!e(i);)i=this.buffer[++n];return yield*this.pushToIndex(n,!1)}}class ms{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let n=0,i=this.lineStarts.length;for(;n<i;){const r=n+i>>1;this.lineStarts[r]<e?n=r+1:i=r}if(this.lineStarts[n]===e)return{line:n+1,col:1};if(n===0)return{line:0,col:e};const s=this.lineStarts[n-1];return{line:n,col:e-s+1}}}}function ge(t,e){for(let n=0;n<t.length;++n)if(t[n].type===e)return!0;return!1}function li(t){for(let e=0;e<t.length;++e)switch(t[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function gs(t){switch(t?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function At(t){switch(t.type){case"document":return t.start;case"block-map":{const e=t.items[t.items.length-1];return e.sep??e.start}case"block-seq":return t.items[t.items.length-1].start;default:return[]}}function Ve(t){if(t.length===0)return[];let e=t.length;e:for(;--e>=0;)switch(t[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;t[++e]?.type==="space";);return t.splice(e,t.length)}function fi(t){if(t.start.type==="flow-seq-start")for(const e of t.items)e.sep&&!e.value&&!ge(e.start,"explicit-key-ind")&&!ge(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,gs(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}class Rn{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new ps,this.onNewLine=e}*parse(e,n=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const i of this.lexer.lex(e,n))yield*this.next(i);n||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}const n=ds(e);if(n)if(n==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const i=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:i,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){const n=e??this.stack.pop();if(!n)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield n;else{const i=this.peek(1);switch(n.type==="block-scalar"?n.indent="indent"in i?i.indent:0:n.type==="flow-collection"&&i.type==="document"&&(n.indent=0),n.type==="flow-collection"&&fi(n),i.type){case"document":i.value=n;break;case"block-scalar":i.props.push(n);break;case"block-map":{const s=i.items[i.items.length-1];if(s.value){i.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}else if(s.sep)s.value=n;else{Object.assign(s,{key:n,sep:[]}),this.onKeyLine=!ge(s.start,"explicit-key-ind");return}break}case"block-seq":{const s=i.items[i.items.length-1];s.value?i.items.push({start:[],value:n}):s.value=n;break}case"flow-collection":{const s=i.items[i.items.length-1];!s||s.value?i.items.push({start:[],key:n,sep:[]}):s.sep?s.value=n:Object.assign(s,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if((i.type==="document"||i.type==="block-map"||i.type==="block-seq")&&(n.type==="block-map"||n.type==="block-seq")){const s=n.items[n.items.length-1];s&&!s.sep&&!s.value&&s.start.length>0&&li(s.start)===-1&&(n.indent===0||s.start.every(r=>r.type!=="comment"||r.indent<n.indent))&&(i.type==="document"?i.end=s.start:i.items.push({start:s.start}),n.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{li(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}const n=this.startBlockValue(e);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){const n=At(this.peek(2)),i=Ve(n);let s;e.end?(s=e.end,s.push(this.sourceToken),delete e.end):s=[this.sourceToken];const r={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:i,key:e,sep:s}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=r}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){const n=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,n.value){const i="end"in n.value?n.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)e.items.push({start:[this.sourceToken]});else if(n.sep)n.sep.push(this.sourceToken);else{if(this.atIndentedComment(n.start,e.indent)){const s=e.items[e.items.length-2]?.value?.end;if(Array.isArray(s)){Array.prototype.push.apply(s,n.start),s.push(this.sourceToken),e.items.pop();return}}n.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const i=!this.onKeyLine&&this.indent===e.indent&&n.sep&&this.type!=="seq-item-ind";let s=[];if(i&&n.sep&&!n.value){const r=[];for(let o=0;o<n.sep.length;++o){const a=n.sep[o];switch(a.type){case"newline":r.push(o);break;case"space":break;case"comment":a.indent>e.indent&&(r.length=0);break;default:r.length=0}}r.length>=2&&(s=n.sep.splice(r[1]))}switch(this.type){case"anchor":case"tag":i||n.value?(s.push(this.sourceToken),e.items.push({start:s}),this.onKeyLine=!0):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"explicit-key-ind":!n.sep&&!ge(n.start,"explicit-key-ind")?n.start.push(this.sourceToken):i||n.value?(s.push(this.sourceToken),e.items.push({start:s})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]}),this.onKeyLine=!0;return;case"map-value-ind":if(ge(n.start,"explicit-key-ind"))if(n.sep)if(n.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(ge(n.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]});else if(gs(n.key)&&!ge(n.sep,"newline")){const r=Ve(n.start),o=n.key,a=n.sep;a.push(this.sourceToken),delete n.key,delete n.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:o,sep:a}]})}else s.length>0?n.sep=n.sep.concat(s,this.sourceToken):n.sep.push(this.sourceToken);else if(ge(n.start,"newline"))Object.assign(n,{key:null,sep:[this.sourceToken]});else{const r=Ve(n.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]})}else n.sep?n.value||i?e.items.push({start:s,key:null,sep:[this.sourceToken]}):ge(n.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);i||n.value?(e.items.push({start:s,key:r,sep:[]}),this.onKeyLine=!0):n.sep?this.stack.push(r):(Object.assign(n,{key:r,sep:[]}),this.onKeyLine=!0);return}default:{const r=this.startBlockValue(e);if(r){i&&r.type!=="block-seq"&&ge(n.start,"explicit-key-ind")&&e.items.push({start:s}),this.stack.push(r);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){const n=e.items[e.items.length-1];switch(this.type){case"newline":if(n.value){const i="end"in n.value?n.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(n.start,e.indent)){const s=e.items[e.items.length-2]?.value?.end;if(Array.isArray(s)){Array.prototype.push.apply(s,n.start),s.push(this.sourceToken),e.items.pop();return}}n.start.push(this.sourceToken)}return;case"anchor":case"tag":if(n.value||this.indent<=e.indent)break;n.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;n.value||ge(n.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return}if(this.indent>e.indent){const i=this.startBlockValue(e);if(i){this.stack.push(i);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){const n=e.items[e.items.length-1];if(this.type==="flow-error-end"){let i;do yield*this.pop(),i=this.peek(1);while(i&&i.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?e.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?e.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const s=this.flowScalar(this.type);!n||n.value?e.items.push({start:[],key:s,sep:[]}):n.sep?this.stack.push(s):Object.assign(n,{key:s,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}const i=this.startBlockValue(e);i?this.stack.push(i):(yield*this.pop(),yield*this.step())}else{const i=this.peek(2);if(i.type==="block-map"&&(this.type==="map-value-ind"&&i.indent===e.indent||this.type==="newline"&&!i.items[i.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&i.type!=="flow-collection"){const s=At(i),r=Ve(s);fi(e);const o=e.end.splice(1,e.end.length);o.push(this.sourceToken);const a={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:r,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const n=At(e),i=Ve(n);return i.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i}]}}case"map-value-ind":{this.onKeyLine=!0;const n=At(e),i=Ve(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,n){return this.type!=="comment"||this.indent<=n?!1:e.every(i=>i.type==="newline"||i.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function ys(t){const e=t.prettyErrors!==!1;return{lineCounter:t.lineCounter||e&&new ms||null,prettyErrors:e}}function to(t,e={}){const{lineCounter:n,prettyErrors:i}=ys(e),s=new Rn(n?.addNewLine),r=new jn(e),o=Array.from(r.compose(s.parse(t)));if(i&&n)for(const a of o)a.errors.forEach(Pt(t,n)),a.warnings.forEach(Pt(t,n));return o.length>0?o:Object.assign([],{empty:!0},r.streamInfo())}function bs(t,e={}){const{lineCounter:n,prettyErrors:i}=ys(e),s=new Rn(n?.addNewLine),r=new jn(e);let o=null;for(const a of r.compose(s.parse(t),!0,t.length))if(!o)o=a;else if(o.options.logLevel!=="silent"){o.errors.push(new xe(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return i&&n&&(o.errors.forEach(Pt(t,n)),o.warnings.forEach(Pt(t,n))),o}function no(t,e,n){let i;typeof e=="function"?i=e:n===void 0&&e&&typeof e=="object"&&(n=e);const s=bs(t,n);if(!s)return null;if(s.warnings.forEach(r=>Ri(s.options.logLevel,r)),s.errors.length>0){if(s.options.logLevel!=="silent")throw s.errors[0];s.errors=[]}return s.toJS(Object.assign({reviver:i},n))}function io(t,e,n){let i=null;if(typeof e=="function"||Array.isArray(e)?i=e:n===void 0&&e&&(n=e),typeof n=="string"&&(n=n.length),typeof n=="number"){const s=Math.round(n);n=s<1?void 0:s>8?{indent:8}:{indent:s}}if(t===void 0){const{keepUndefined:s}=n??e??{};if(!s)return}return new lt(t,i,n).toString(n)}const so=Object.freeze(Object.defineProperty({__proto__:null,Alias:xt,CST:Xr,Composer:jn,Document:lt,Lexer:ps,LineCounter:ms,Pair:ne,Parser:Rn,Scalar:P,Schema:Wt,YAMLError:Dn,YAMLMap:ae,YAMLParseError:xe,YAMLSeq:Le,YAMLWarning:is,isAlias:Fe,isCollection:G,isDocument:it,isMap:st,isNode:Y,isPair:J,isScalar:W,isSeq:rt,parse:no,parseAllDocuments:to,parseDocument:bs,stringify:io,visit:_e,visitAsync:Dt},Symbol.toStringTag,{value:"Module"}));function ro(t){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(t))}function ws(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}function oo(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Ss(t){return Object.prototype.toString.call(t)==="[object Map]"}function ao(t){return Object.prototype.toString.call(t)==="[object Date]"}function le(t,e){return JSON.stringify(t,(n,i)=>typeof i=="bigint"?{$numberLong:`${i}`}:Ss(i)?Object.fromEntries(i):i)}function lo(t){if(t!=null&&typeof t=="object"&&"stylize"in t&&typeof t.stylize=="function")return t.stylize}const Fn=6,Un=2147483647,Vn=-2147483648,Ns=Math.pow(2,63)-1,Es=-Math.pow(2,63),fo=Math.pow(2,53),co=-Math.pow(2,53),ks=4;class B extends Error{get bsonError(){return!0}get name(){return"BSONError"}constructor(e,n){super(e,n)}static isBSONError(e){return e!=null&&typeof e=="object"&&"bsonError"in e&&e.bsonError===!0&&"name"in e&&"message"in e&&"stack"in e}}class uo extends B{get name(){return"BSONVersionError"}constructor(){super(`Unsupported BSON version, bson types must be from bson ${Fn}.x.x`)}}class ci extends B{get name(){return"BSONRuntimeError"}constructor(e){super(e)}}class Be extends B{get name(){return"BSONOffsetError"}constructor(e,n,i){super(`${e}. offset: ${n}`,i),this.offset=n}}let ui,hi;function Ts(t,e,n,i){if(i){ui??=new TextDecoder("utf8",{fatal:!0});try{return ui.decode(t.subarray(e,n))}catch(s){throw new B("Invalid UTF-8 string in BSON document",{cause:s})}}return hi??=new TextDecoder("utf8",{fatal:!1}),hi.decode(t.subarray(e,n))}function Os(t,e,n){if(t.length===0)return"";const i=n-e;if(i===0)return"";if(i>20)return null;if(i===1&&t[e]<128)return String.fromCharCode(t[e]);if(i===2&&t[e]<128&&t[e+1]<128)return String.fromCharCode(t[e])+String.fromCharCode(t[e+1]);if(i===3&&t[e]<128&&t[e+1]<128&&t[e+2]<128)return String.fromCharCode(t[e])+String.fromCharCode(t[e+1])+String.fromCharCode(t[e+2]);const s=[];for(let r=e;r<n;r++){const o=t[r];if(o>127)return null;s.push(o)}return String.fromCharCode(...s)}function ho(t,e,n){if(e.length===0)return 0;if(e.length>25||t.length-n<e.length)return null;for(let i=0,s=n;i<e.length;i++,s++){const r=e.charCodeAt(i);if(r>127)return null;t[s]=r}return e.length}function po(t){return $e.fromNumberArray(Array.from({length:t},()=>Math.floor(Math.random()*256)))}const mo=await(async()=>{try{return(await Fs(()=>import("./__vite-browser-external-BIHI7g3E.js"),[])).randomBytes}catch{return po}})(),$e={toLocalBufferType(t){if(Buffer.isBuffer(t))return t;if(ArrayBuffer.isView(t))return Buffer.from(t.buffer,t.byteOffset,t.byteLength);const e=t?.[Symbol.toStringTag]??Object.prototype.toString.call(t);if(e==="ArrayBuffer"||e==="SharedArrayBuffer"||e==="[object ArrayBuffer]"||e==="[object SharedArrayBuffer]")return Buffer.from(t);throw new B(`Cannot create Buffer from ${String(t)}`)},allocate(t){return Buffer.alloc(t)},allocateUnsafe(t){return Buffer.allocUnsafe(t)},equals(t,e){return $e.toLocalBufferType(t).equals(e)},fromNumberArray(t){return Buffer.from(t)},fromBase64(t){return Buffer.from(t,"base64")},toBase64(t){return $e.toLocalBufferType(t).toString("base64")},fromISO88591(t){return Buffer.from(t,"binary")},toISO88591(t){return $e.toLocalBufferType(t).toString("binary")},fromHex(t){return Buffer.from(t,"hex")},toHex(t){return $e.toLocalBufferType(t).toString("hex")},toUTF8(t,e,n,i){const s=n-e<=20?Os(t,e,n):null;if(s!=null)return s;const r=$e.toLocalBufferType(t).toString("utf8",e,n);if(i){for(let o=0;o<r.length;o++)if(r.charCodeAt(o)===65533){Ts(t,e,n,!0);break}}return r},utf8ByteLength(t){return Buffer.byteLength(t,"utf8")},encodeUTF8Into(t,e,n){const i=ho(t,e,n);return i??$e.toLocalBufferType(t).write(e,n,void 0,"utf8")},randomBytes:mo};function go(){const{navigator:t}=globalThis;return typeof t=="object"&&t.product==="ReactNative"}function yo(t){if(t<0)throw new RangeError(`The argument 'byteLength' is invalid. Received ${t}`);return bt.fromNumberArray(Array.from({length:t},()=>Math.floor(Math.random()*256)))}const bo=(()=>{const{crypto:t}=globalThis;if(t!=null&&typeof t.getRandomValues=="function")return e=>t.getRandomValues(bt.allocate(e));if(go()){const{console:e}=globalThis;e?.warn?.("BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.")}return yo})(),di=/(\d|[a-f])/i,bt={toLocalBufferType(t){const e=t?.[Symbol.toStringTag]??Object.prototype.toString.call(t);if(e==="Uint8Array")return t;if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength));if(e==="ArrayBuffer"||e==="SharedArrayBuffer"||e==="[object ArrayBuffer]"||e==="[object SharedArrayBuffer]")return new Uint8Array(t);throw new B(`Cannot make a Uint8Array from ${String(t)}`)},allocate(t){if(typeof t!="number")throw new TypeError(`The "size" argument must be of type number. Received ${String(t)}`);return new Uint8Array(t)},allocateUnsafe(t){return bt.allocate(t)},equals(t,e){if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.byteLength;n++)if(t[n]!==e[n])return!1;return!0},fromNumberArray(t){return Uint8Array.from(t)},fromBase64(t){return Uint8Array.from(atob(t),e=>e.charCodeAt(0))},toBase64(t){return btoa(bt.toISO88591(t))},fromISO88591(t){return Uint8Array.from(t,e=>e.charCodeAt(0)&255)},toISO88591(t){return Array.from(Uint16Array.from(t),e=>String.fromCharCode(e)).join("")},fromHex(t){const e=t.length%2===0?t:t.slice(0,t.length-1),n=[];for(let i=0;i<e.length;i+=2){const s=e[i],r=e[i+1];if(!di.test(s)||!di.test(r))break;const o=Number.parseInt(`${s}${r}`,16);n.push(o)}return Uint8Array.from(n)},toHex(t){return Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")},toUTF8(t,e,n,i){const s=n-e<=20?Os(t,e,n):null;return s??Ts(t,e,n,i)},utf8ByteLength(t){return new TextEncoder().encode(t).byteLength},encodeUTF8Into(t,e,n){const i=new TextEncoder().encode(e);return t.set(i,n),i.byteLength},randomBytes:bo},wo=typeof Buffer=="function"&&Buffer.prototype?._isBuffer!==!0,_=wo?$e:bt;class de{get[Symbol.for("@@mdb.bson.version")](){return Fn}[Symbol.for("nodejs.util.inspect.custom")](e,n,i){return this.inspect(e,n,i)}}class H extends de{get _bsontype(){return"Binary"}constructor(e,n){if(super(),e!=null&&typeof e=="string"&&!ArrayBuffer.isView(e)&&!ro(e)&&!Array.isArray(e))throw new B("Binary can only be constructed from Uint8Array or number[]");this.sub_type=n??H.BSON_BINARY_SUBTYPE_DEFAULT,e==null?(this.buffer=_.allocate(H.BUFFER_SIZE),this.position=0):(this.buffer=Array.isArray(e)?_.fromNumberArray(e):_.toLocalBufferType(e),this.position=this.buffer.byteLength)}put(e){if(typeof e=="string"&&e.length!==1)throw new B("only accepts single character String");if(typeof e!="number"&&e.length!==1)throw new B("only accepts single character Uint8Array or Array");let n;if(typeof e=="string"?n=e.charCodeAt(0):typeof e=="number"?n=e:n=e[0],n<0||n>255)throw new B("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.byteLength>this.position)this.buffer[this.position++]=n;else{const i=_.allocate(H.BUFFER_SIZE+this.buffer.length);i.set(this.buffer,0),this.buffer=i,this.buffer[this.position++]=n}}write(e,n){if(n=typeof n=="number"?n:this.position,this.buffer.byteLength<n+e.length){const i=_.allocate(this.buffer.byteLength+e.length);i.set(this.buffer,0),this.buffer=i}if(ArrayBuffer.isView(e))this.buffer.set(_.toLocalBufferType(e),n),this.position=n+e.byteLength>this.position?n+e.length:this.position;else if(typeof e=="string")throw new B("input cannot be string")}read(e,n){return n=n&&n>0?n:this.position,this.buffer.slice(e,e+n)}value(){return this.buffer.length===this.position?this.buffer:this.buffer.subarray(0,this.position)}length(){return this.position}toJSON(){return _.toBase64(this.buffer.subarray(0,this.position))}toString(e){return e==="hex"?_.toHex(this.buffer.subarray(0,this.position)):e==="base64"?_.toBase64(this.buffer.subarray(0,this.position)):e==="utf8"||e==="utf-8"?_.toUTF8(this.buffer,0,this.position,!1):_.toUTF8(this.buffer,0,this.position,!1)}toExtendedJSON(e){e=e||{};const n=_.toBase64(this.buffer),i=Number(this.sub_type).toString(16);return e.legacy?{$binary:n,$type:i.length===1?"0"+i:i}:{$binary:{base64:n,subType:i.length===1?"0"+i:i}}}toUUID(){if(this.sub_type===H.SUBTYPE_UUID)return new se(this.buffer.slice(0,this.position));throw new B(`Binary sub_type "${this.sub_type}" is not supported for converting to UUID. Only "${H.SUBTYPE_UUID}" is currently supported.`)}static createFromHexString(e,n){return new H(_.fromHex(e),n)}static createFromBase64(e,n){return new H(_.fromBase64(e),n)}static fromExtendedJSON(e,n){n=n||{};let i,s;if("$binary"in e?n.legacy&&typeof e.$binary=="string"&&"$type"in e?(s=e.$type?parseInt(e.$type,16):0,i=_.fromBase64(e.$binary)):typeof e.$binary!="string"&&(s=e.$binary.subType?parseInt(e.$binary.subType,16):0,i=_.fromBase64(e.$binary.base64)):"$uuid"in e&&(s=4,i=se.bytesFromString(e.$uuid)),!i)throw new B(`Unexpected Binary Extended JSON format ${JSON.stringify(e)}`);return s===ks?new se(i):new H(i,s)}inspect(e,n,i){i??=le;const s=_.toBase64(this.buffer.subarray(0,this.position)),r=i(s,n),o=i(this.sub_type,n);return`Binary.createFromBase64(${r}, ${o})`}}H.BSON_BINARY_SUBTYPE_DEFAULT=0;H.BUFFER_SIZE=256;H.SUBTYPE_DEFAULT=0;H.SUBTYPE_FUNCTION=1;H.SUBTYPE_BYTE_ARRAY=2;H.SUBTYPE_UUID_OLD=3;H.SUBTYPE_UUID=4;H.SUBTYPE_MD5=5;H.SUBTYPE_ENCRYPTED=6;H.SUBTYPE_COLUMN=7;H.SUBTYPE_SENSITIVE=8;H.SUBTYPE_USER_DEFINED=128;const un=16,So=/^[0-9A-F]{32}$/i,No=/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i;class se extends H{constructor(e){let n;if(e==null)n=se.generate();else if(e instanceof se)n=_.toLocalBufferType(new Uint8Array(e.buffer));else if(ArrayBuffer.isView(e)&&e.byteLength===un)n=_.toLocalBufferType(e);else if(typeof e=="string")n=se.bytesFromString(e);else throw new B("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");super(n,ks)}get id(){return this.buffer}set id(e){this.buffer=e}toHexString(e=!0){return e?[_.toHex(this.buffer.subarray(0,4)),_.toHex(this.buffer.subarray(4,6)),_.toHex(this.buffer.subarray(6,8)),_.toHex(this.buffer.subarray(8,10)),_.toHex(this.buffer.subarray(10,16))].join("-"):_.toHex(this.buffer)}toString(e){return e==="hex"?_.toHex(this.id):e==="base64"?_.toBase64(this.id):this.toHexString()}toJSON(){return this.toHexString()}equals(e){if(!e)return!1;if(e instanceof se)return _.equals(e.id,this.id);try{return _.equals(new se(e).id,this.id)}catch{return!1}}toBinary(){return new H(this.id,H.SUBTYPE_UUID)}static generate(){const e=_.randomBytes(un);return e[6]=e[6]&15|64,e[8]=e[8]&63|128,e}static isValid(e){return e?typeof e=="string"?se.isValidUUIDString(e):ws(e)?e.byteLength===un:e._bsontype==="Binary"&&e.sub_type===this.SUBTYPE_UUID&&e.buffer.byteLength===16:!1}static createFromHexString(e){const n=se.bytesFromString(e);return new se(n)}static createFromBase64(e){return new se(_.fromBase64(e))}static bytesFromString(e){if(!se.isValidUUIDString(e))throw new B("UUID string representation must be 32 hex digits or canonical hyphenated representation");return _.fromHex(e.replace(/-/g,""))}static isValidUUIDString(e){return So.test(e)||No.test(e)}inspect(e,n,i){return i??=le,`new UUID(${i(this.toHexString(),n)})`}}class Et extends de{get _bsontype(){return"Code"}constructor(e,n){super(),this.code=e.toString(),this.scope=n??null}toJSON(){return this.scope!=null?{code:this.code,scope:this.scope}:{code:this.code}}toExtendedJSON(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}static fromExtendedJSON(e){return new Et(e.$code,e.$scope)}inspect(e,n,i){i??=le;let s=i(this.code,n);const r=s.includes(`
`);this.scope!=null&&(s+=`,${r?`
`:" "}${i(this.scope,n)}`);const o=r&&this.scope===null;return`new Code(${r?`
`:""}${s}${o?`
`:""})`}}function Eo(t){return t!=null&&typeof t=="object"&&"$id"in t&&t.$id!=null&&"$ref"in t&&typeof t.$ref=="string"&&(!("$db"in t)||"$db"in t&&typeof t.$db=="string")}class et extends de{get _bsontype(){return"DBRef"}constructor(e,n,i,s){super();const r=e.split(".");r.length===2&&(i=r.shift(),e=r.shift()),this.collection=e,this.oid=n,this.db=i,this.fields=s||{}}get namespace(){return this.collection}set namespace(e){this.collection=e}toJSON(){const e=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(e.$db=this.db),e}toExtendedJSON(e){e=e||{};let n={$ref:this.collection,$id:this.oid};return e.legacy||(this.db&&(n.$db=this.db),n=Object.assign(n,this.fields)),n}static fromExtendedJSON(e){const n=Object.assign({},e);return delete n.$ref,delete n.$id,delete n.$db,new et(e.$ref,e.$id,e.$db,n)}inspect(e,n,i){i??=le;const s=[i(this.namespace,n),i(this.oid,n),...this.db?[i(this.db,n)]:[],...Object.keys(this.fields).length>0?[i(this.fields,n)]:[]];return s[1]=i===le?`new ObjectId(${s[1]})`:s[1],`new DBRef(${s.join(", ")})`}}function As(t){if(t==="")return t;let e=0;const n=t[e]==="-",i=t[e]==="+";(i||n)&&(e+=1);let s=!1;for(;e<t.length&&t[e]==="0";++e)s=!0;return s?`${n?"-":""}${t.length===e?"0":t.slice(e)}`:i?t.slice(1):t}function ko(t,e){e=e??10;const n="0123456789abcdefghijklmnopqrstuvwxyz".slice(0,e);return new RegExp(`[^-+${n}]`,"i").test(t)?!1:t}let ce;try{ce=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}const pi=65536,To=1<<24,Ge=pi*pi,Is=Ge*Ge,mi=Is/2,gi={},yi={},Oo=20,Ao=/^(\+?0|(\+|-)?[1-9][0-9]*)$/;class u extends de{get _bsontype(){return"Long"}get __isLong__(){return!0}constructor(e=0,n,i){super(),typeof e=="bigint"?Object.assign(this,u.fromBigInt(e,!!n)):typeof e=="string"?Object.assign(this,u.fromString(e,!!n)):(this.low=e|0,this.high=n|0,this.unsigned=!!i)}static fromBits(e,n,i){return new u(e,n,i)}static fromInt(e,n){let i,s,r;return n?(e>>>=0,(r=0<=e&&e<256)&&(s=yi[e],s)?s:(i=u.fromBits(e,(e|0)<0?-1:0,!0),r&&(yi[e]=i),i)):(e|=0,(r=-128<=e&&e<128)&&(s=gi[e],s)?s:(i=u.fromBits(e,e<0?-1:0,!1),r&&(gi[e]=i),i))}static fromNumber(e,n){if(isNaN(e))return n?u.UZERO:u.ZERO;if(n){if(e<0)return u.UZERO;if(e>=Is)return u.MAX_UNSIGNED_VALUE}else{if(e<=-mi)return u.MIN_VALUE;if(e+1>=mi)return u.MAX_VALUE}return e<0?u.fromNumber(-e,n).neg():u.fromBits(e%Ge|0,e/Ge|0,n)}static fromBigInt(e,n){return u.fromString(e.toString(),n)}static _fromString(e,n,i){if(e.length===0)throw new B("empty string");if(i<2||36<i)throw new B("radix");let s;if((s=e.indexOf("-"))>0)throw new B("interior hyphen");if(s===0)return u._fromString(e.substring(1),n,i).neg();const r=u.fromNumber(Math.pow(i,8));let o=u.ZERO;for(let a=0;a<e.length;a+=8){const l=Math.min(8,e.length-a),f=parseInt(e.substring(a,a+l),i);if(l<8){const h=u.fromNumber(Math.pow(i,l));o=o.mul(h).add(u.fromNumber(f))}else o=o.mul(r),o=o.add(u.fromNumber(f))}return o.unsigned=n,o}static fromStringStrict(e,n,i){let s=!1;if(typeof n=="number"?(i=n,n=!1):s=!!n,i??=10,e.trim()!==e)throw new B(`Input: '${e}' contains leading and/or trailing whitespace`);if(!ko(e,i))throw new B(`Input: '${e}' contains invalid characters for radix: ${i}`);const r=As(e),o=u._fromString(r,s,i);if(o.toString(i).toLowerCase()!==r.toLowerCase())throw new B(`Input: ${e} is not representable as ${o.unsigned?"an unsigned":"a signed"} 64-bit Long ${i!=null?`with radix: ${i}`:""}`);return o}static fromString(e,n,i){let s=!1;return typeof n=="number"?(i=n,n=!1):s=!!n,i??=10,e==="NaN"&&i<24||(e==="Infinity"||e==="+Infinity"||e==="-Infinity")&&i<35?u.ZERO:u._fromString(e,s,i)}static fromBytes(e,n,i){return i?u.fromBytesLE(e,n):u.fromBytesBE(e,n)}static fromBytesLE(e,n){return new u(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)}static fromBytesBE(e,n){return new u(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)}static isLong(e){return e!=null&&typeof e=="object"&&"__isLong__"in e&&e.__isLong__===!0}static fromValue(e,n){return typeof e=="number"?u.fromNumber(e,n):typeof e=="string"?u.fromString(e,n):u.fromBits(e.low,e.high,typeof n=="boolean"?n:e.unsigned)}add(e){u.isLong(e)||(e=u.fromValue(e));const n=this.high>>>16,i=this.high&65535,s=this.low>>>16,r=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,f=e.low&65535;let h=0,c=0,d=0,g=0;return g+=r+f,d+=g>>>16,g&=65535,d+=s+l,c+=d>>>16,d&=65535,c+=i+a,h+=c>>>16,c&=65535,h+=n+o,h&=65535,u.fromBits(d<<16|g,h<<16|c,this.unsigned)}and(e){return u.isLong(e)||(e=u.fromValue(e)),u.fromBits(this.low&e.low,this.high&e.high,this.unsigned)}compare(e){if(u.isLong(e)||(e=u.fromValue(e)),this.eq(e))return 0;const n=this.isNegative(),i=e.isNegative();return n&&!i?-1:!n&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1}comp(e){return this.compare(e)}divide(e){if(u.isLong(e)||(e=u.fromValue(e)),e.isZero())throw new B("division by zero");if(ce){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;const r=(this.unsigned?ce.div_u:ce.div_s)(this.low,this.high,e.low,e.high);return u.fromBits(r,ce.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?u.UZERO:u.ZERO;let n,i,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return u.UZERO;if(e.gt(this.shru(1)))return u.UONE;s=u.UZERO}else{if(this.eq(u.MIN_VALUE))return e.eq(u.ONE)||e.eq(u.NEG_ONE)?u.MIN_VALUE:e.eq(u.MIN_VALUE)?u.ONE:(n=this.shr(1).div(e).shl(1),n.eq(u.ZERO)?e.isNegative()?u.ONE:u.NEG_ONE:(i=this.sub(e.mul(n)),s=n.add(i.div(e)),s));if(e.eq(u.MIN_VALUE))return this.unsigned?u.UZERO:u.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=u.ZERO}for(i=this;i.gte(e);){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));const r=Math.ceil(Math.log(n)/Math.LN2),o=r<=48?1:Math.pow(2,r-48);let a=u.fromNumber(n),l=a.mul(e);for(;l.isNegative()||l.gt(i);)n-=o,a=u.fromNumber(n,this.unsigned),l=a.mul(e);a.isZero()&&(a=u.ONE),s=s.add(a),i=i.sub(l)}return s}div(e){return this.divide(e)}equals(e){return u.isLong(e)||(e=u.fromValue(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low}eq(e){return this.equals(e)}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative())return this.eq(u.MIN_VALUE)?64:this.neg().getNumBitsAbs();const e=this.high!==0?this.high:this.low;let n;for(n=31;n>0&&!(e&1<<n);n--);return this.high!==0?n+33:n+1}greaterThan(e){return this.comp(e)>0}gt(e){return this.greaterThan(e)}greaterThanOrEqual(e){return this.comp(e)>=0}gte(e){return this.greaterThanOrEqual(e)}ge(e){return this.greaterThanOrEqual(e)}isEven(){return(this.low&1)===0}isNegative(){return!this.unsigned&&this.high<0}isOdd(){return(this.low&1)===1}isPositive(){return this.unsigned||this.high>=0}isZero(){return this.high===0&&this.low===0}lessThan(e){return this.comp(e)<0}lt(e){return this.lessThan(e)}lessThanOrEqual(e){return this.comp(e)<=0}lte(e){return this.lessThanOrEqual(e)}modulo(e){if(u.isLong(e)||(e=u.fromValue(e)),ce){const n=(this.unsigned?ce.rem_u:ce.rem_s)(this.low,this.high,e.low,e.high);return u.fromBits(n,ce.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))}mod(e){return this.modulo(e)}rem(e){return this.modulo(e)}multiply(e){if(this.isZero())return u.ZERO;if(u.isLong(e)||(e=u.fromValue(e)),ce){const T=ce.mul(this.low,this.high,e.low,e.high);return u.fromBits(T,ce.get_high(),this.unsigned)}if(e.isZero())return u.ZERO;if(this.eq(u.MIN_VALUE))return e.isOdd()?u.MIN_VALUE:u.ZERO;if(e.eq(u.MIN_VALUE))return this.isOdd()?u.MIN_VALUE:u.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(u.TWO_PWR_24)&&e.lt(u.TWO_PWR_24))return u.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);const n=this.high>>>16,i=this.high&65535,s=this.low>>>16,r=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,f=e.low&65535;let h=0,c=0,d=0,g=0;return g+=r*f,d+=g>>>16,g&=65535,d+=s*f,c+=d>>>16,d&=65535,d+=r*l,c+=d>>>16,d&=65535,c+=i*f,h+=c>>>16,c&=65535,c+=s*l,h+=c>>>16,c&=65535,c+=r*a,h+=c>>>16,c&=65535,h+=n*f+i*l+s*a+r*o,h&=65535,u.fromBits(d<<16|g,h<<16|c,this.unsigned)}mul(e){return this.multiply(e)}negate(){return!this.unsigned&&this.eq(u.MIN_VALUE)?u.MIN_VALUE:this.not().add(u.ONE)}neg(){return this.negate()}not(){return u.fromBits(~this.low,~this.high,this.unsigned)}notEquals(e){return!this.equals(e)}neq(e){return this.notEquals(e)}ne(e){return this.notEquals(e)}or(e){return u.isLong(e)||(e=u.fromValue(e)),u.fromBits(this.low|e.low,this.high|e.high,this.unsigned)}shiftLeft(e){return u.isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?u.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u.fromBits(0,this.low<<e-32,this.unsigned)}shl(e){return this.shiftLeft(e)}shiftRight(e){return u.isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?u.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)}shr(e){return this.shiftRight(e)}shiftRightUnsigned(e){if(u.isLong(e)&&(e=e.toInt()),e&=63,e===0)return this;{const n=this.high;if(e<32){const i=this.low;return u.fromBits(i>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?u.fromBits(n,0,this.unsigned):u.fromBits(n>>>e-32,0,this.unsigned)}}shr_u(e){return this.shiftRightUnsigned(e)}shru(e){return this.shiftRightUnsigned(e)}subtract(e){return u.isLong(e)||(e=u.fromValue(e)),this.add(e.neg())}sub(e){return this.subtract(e)}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){return this.unsigned?(this.high>>>0)*Ge+(this.low>>>0):this.high*Ge+(this.low>>>0)}toBigInt(){return BigInt(this.toString())}toBytes(e){return e?this.toBytesLE():this.toBytesBE()}toBytesLE(){const e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]}toBytesBE(){const e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]}toSigned(){return this.unsigned?u.fromBits(this.low,this.high,!1):this}toString(e){if(e=e||10,e<2||36<e)throw new B("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(u.MIN_VALUE)){const r=u.fromNumber(e),o=this.div(r),a=o.mul(r).sub(this);return o.toString(e)+a.toInt().toString(e)}else return"-"+this.neg().toString(e);const n=u.fromNumber(Math.pow(e,6),this.unsigned);let i=this,s="";for(;;){const r=i.div(n);let a=(i.sub(r.mul(n)).toInt()>>>0).toString(e);if(i=r,i.isZero())return a+s;for(;a.length<6;)a="0"+a;s=""+a+s}}toUnsigned(){return this.unsigned?this:u.fromBits(this.low,this.high,!0)}xor(e){return u.isLong(e)||(e=u.fromValue(e)),u.fromBits(this.low^e.low,this.high^e.high,this.unsigned)}eqz(){return this.isZero()}le(e){return this.lessThanOrEqual(e)}toExtendedJSON(e){return e&&e.relaxed?this.toNumber():{$numberLong:this.toString()}}static fromExtendedJSON(e,n){const{useBigInt64:i=!1,relaxed:s=!0}={...n};if(e.$numberLong.length>Oo)throw new B("$numberLong string is too long");if(!Ao.test(e.$numberLong))throw new B(`$numberLong string "${e.$numberLong}" is in an invalid format`);if(i){const o=BigInt(e.$numberLong);return BigInt.asIntN(64,o)}const r=u.fromString(e.$numberLong);return s?r.toNumber():r}inspect(e,n,i){i??=le;const s=i(this.toString(),n),r=this.unsigned?`, ${i(this.unsigned,n)}`:"";return`new Long(${s}${r})`}}u.TWO_PWR_24=u.fromInt(To);u.MAX_UNSIGNED_VALUE=u.fromBits(-1,-1,!0);u.ZERO=u.fromInt(0);u.UZERO=u.fromInt(0,!0);u.ONE=u.fromInt(1);u.UONE=u.fromInt(1,!0);u.NEG_ONE=u.fromInt(-1);u.MAX_VALUE=u.fromBits(-1,2147483647,!1);u.MIN_VALUE=u.fromBits(0,-2147483648,!1);const Io=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,Bo=/^(\+|-)?(Infinity|inf)$/i,$o=/^(\+|-)?NaN$/i,Ke=6111,ht=-6176,bi=6176,wi=34,hn=_.fromNumberArray([124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),Si=_.fromNumberArray([248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),Ni=_.fromNumberArray([120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),Co=/^([-+])?(\d+)?$/,vo=31,Ei=16383,_o=30,Lo=31;function ki(t){return!isNaN(parseInt(t,10))}function Po(t){const e=u.fromNumber(1e9);let n=u.fromNumber(0);if(!t.parts[0]&&!t.parts[1]&&!t.parts[2]&&!t.parts[3])return{quotient:t,rem:n};for(let i=0;i<=3;i++)n=n.shiftLeft(32),n=n.add(new u(t.parts[i],0)),t.parts[i]=n.div(e).low,n=n.modulo(e);return{quotient:t,rem:n}}function Mo(t,e){if(!t&&!e)return{high:u.fromNumber(0),low:u.fromNumber(0)};const n=t.shiftRightUnsigned(32),i=new u(t.getLowBits(),0),s=e.shiftRightUnsigned(32),r=new u(e.getLowBits(),0);let o=n.multiply(s),a=n.multiply(r);const l=i.multiply(s);let f=i.multiply(r);return o=o.add(a.shiftRightUnsigned(32)),a=new u(a.getLowBits(),0).add(l).add(f.shiftRightUnsigned(32)),o=o.add(a.shiftRightUnsigned(32)),f=a.shiftLeft(32).add(new u(f.getLowBits(),0)),{high:o,low:f}}function Do(t,e){const n=t.high>>>0,i=e.high>>>0;if(n<i)return!0;if(n===i){const s=t.low>>>0,r=e.low>>>0;if(s<r)return!0}return!1}function me(t,e){throw new B(`"${t}" is not a valid Decimal128 string - ${e}`)}class oe extends de{get _bsontype(){return"Decimal128"}constructor(e){if(super(),typeof e=="string")this.bytes=oe.fromString(e).bytes;else if(ws(e)){if(e.byteLength!==16)throw new B("Decimal128 must take a Buffer of 16 bytes");this.bytes=e}else throw new B("Decimal128 must take a Buffer or string")}static fromString(e){return oe._fromString(e,{allowRounding:!1})}static fromStringWithRounding(e){return oe._fromString(e,{allowRounding:!0})}static _fromString(e,n){let i=!1,s=!1,r=!1,o=!1,a=0,l=0,f=0,h=0,c=0;const d=[0];let g=0,T=0,p=0,m=0,I=new u(0,0),k=new u(0,0),$=0,w=0;if(e.length>=7e3)throw new B(""+e+" not a valid Decimal128 string");const v=e.match(Io),A=e.match(Bo),V=e.match($o);if(!v&&!A&&!V||e.length===0)throw new B(""+e+" not a valid Decimal128 string");if(v){const D=v[2],q=v[4],be=v[5],X=v[6];q&&X===void 0&&me(e,"missing exponent power"),q&&D===void 0&&me(e,"missing exponent base"),q===void 0&&(be||X)&&me(e,"missing e before exponent")}if((e[w]==="+"||e[w]==="-")&&(s=!0,i=e[w++]==="-"),!ki(e[w])&&e[w]!=="."){if(e[w]==="i"||e[w]==="I")return new oe(i?Si:Ni);if(e[w]==="N")return new oe(hn)}for(;ki(e[w])||e[w]===".";){if(e[w]==="."){r&&me(e,"contains multiple periods"),r=!0,w=w+1;continue}g<wi&&(e[w]!=="0"||o)&&(o||(c=l),o=!0,d[T++]=parseInt(e[w],10),g=g+1),o&&(f=f+1),r&&(h=h+1),l=l+1,w=w+1}if(r&&!l)throw new B(""+e+" not a valid Decimal128 string");if(e[w]==="e"||e[w]==="E"){const D=e.substr(++w).match(Co);if(!D||!D[2])return new oe(hn);m=parseInt(D[0],10),w=w+D[0].length}if(e[w])return new oe(hn);if(!g)d[0]=0,f=1,g=1,a=0;else if(p=g-1,a=f,a!==1)for(;e[c+a-1+Number(s)+Number(r)]==="0";)a=a-1;for(m<=h&&h>m+16384?m=ht:m=m-h;m>Ke;){if(p=p+1,p>=wi){if(a===0){m=Ke;break}me(e,"overflow")}m=m-1}if(n.allowRounding){for(;m<ht||g<f;){if(p===0&&a<g){m=ht,a=0;break}if(g<f?f=f-1:p=p-1,m<Ke)m=m+1;else{if(d.join("").match(/^0+$/)){m=Ke;break}me(e,"overflow")}}if(p+1<a){let D=l;r&&(c=c+1,D=D+1),s&&(c=c+1,D=D+1);const q=parseInt(e[c+p+1],10);let be=0;if(q>=5&&(be=1,q===5)){be=d[p]%2===1?1:0;for(let X=c+p+2;X<D;X++)if(parseInt(e[X],10)){be=1;break}}if(be){let X=p;for(;X>=0&&++d[X]>9;X--)if(d[X]=0,X===0)if(m<Ke)m=m+1,d[X]=1;else return new oe(i?Si:Ni)}}}else{for(;m<ht||g<f;){if(p===0){if(a===0){m=ht;break}me(e,"exponent underflow")}g<f?(e[f-1+Number(s)+Number(r)]!=="0"&&a!==0&&me(e,"inexact rounding"),f=f-1):(d[p]!==0&&me(e,"inexact rounding"),p=p-1),m<Ke?m=m+1:me(e,"overflow")}p+1<a&&(r&&(c=c+1),s&&(c=c+1),parseInt(e[c+p+1],10)!==0&&me(e,"inexact rounding"))}if(I=u.fromNumber(0),k=u.fromNumber(0),a===0)I=u.fromNumber(0),k=u.fromNumber(0);else if(p<17){let D=0;for(k=u.fromNumber(d[D++]),I=new u(0,0);D<=p;D++)k=k.multiply(u.fromNumber(10)),k=k.add(u.fromNumber(d[D]))}else{let D=0;for(I=u.fromNumber(d[D++]);D<=p-17;D++)I=I.multiply(u.fromNumber(10)),I=I.add(u.fromNumber(d[D]));for(k=u.fromNumber(d[D++]);D<=p;D++)k=k.multiply(u.fromNumber(10)),k=k.add(u.fromNumber(d[D]))}const j=Mo(I,u.fromString("100000000000000000"));j.low=j.low.add(k),Do(j.low,k)&&(j.high=j.high.add(u.fromNumber(1))),$=m+bi;const L={low:u.fromNumber(0),high:u.fromNumber(0)};j.high.shiftRightUnsigned(49).and(u.fromNumber(1)).equals(u.fromNumber(1))?(L.high=L.high.or(u.fromNumber(3).shiftLeft(61)),L.high=L.high.or(u.fromNumber($).and(u.fromNumber(16383).shiftLeft(47))),L.high=L.high.or(j.high.and(u.fromNumber(0x7fffffffffff)))):(L.high=L.high.or(u.fromNumber($&16383).shiftLeft(49)),L.high=L.high.or(j.high.and(u.fromNumber(562949953421311)))),L.low=j.low,i&&(L.high=L.high.or(u.fromString("9223372036854775808")));const K=_.allocateUnsafe(16);return w=0,K[w++]=L.low.low&255,K[w++]=L.low.low>>8&255,K[w++]=L.low.low>>16&255,K[w++]=L.low.low>>24&255,K[w++]=L.low.high&255,K[w++]=L.low.high>>8&255,K[w++]=L.low.high>>16&255,K[w++]=L.low.high>>24&255,K[w++]=L.high.low&255,K[w++]=L.high.low>>8&255,K[w++]=L.high.low>>16&255,K[w++]=L.high.low>>24&255,K[w++]=L.high.high&255,K[w++]=L.high.high>>8&255,K[w++]=L.high.high>>16&255,K[w++]=L.high.high>>24&255,new oe(K)}toString(){let e,n=0;const i=new Array(36);for(let w=0;w<i.length;w++)i[w]=0;let s=0,r=!1,o,a={parts:[0,0,0,0]},l,f;const h=[];s=0;const c=this.bytes,d=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24,g=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24,T=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24,p=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24;s=0,{low:new u(d,g),high:new u(T,p)}.high.lessThan(u.ZERO)&&h.push("-");const I=p>>26&vo;if(I>>3===3){if(I===_o)return h.join("")+"Infinity";if(I===Lo)return"NaN";e=p>>15&Ei,o=8+(p>>14&1)}else o=p>>14&7,e=p>>17&Ei;const k=e-bi;if(a.parts[0]=(p&16383)+((o&15)<<14),a.parts[1]=T,a.parts[2]=g,a.parts[3]=d,a.parts[0]===0&&a.parts[1]===0&&a.parts[2]===0&&a.parts[3]===0)r=!0;else for(f=3;f>=0;f--){let w=0;const v=Po(a);if(a=v.quotient,w=v.rem.low,!!w)for(l=8;l>=0;l--)i[f*9+l]=w%10,w=Math.floor(w/10)}if(r)n=1,i[s]=0;else for(n=36;!i[s];)n=n-1,s=s+1;const $=n-1+k;if($>=34||$<=-7||k>0){if(n>34)return h.push("0"),k>0?h.push(`E+${k}`):k<0&&h.push(`E${k}`),h.join("");h.push(`${i[s++]}`),n=n-1,n&&h.push(".");for(let w=0;w<n;w++)h.push(`${i[s++]}`);h.push("E"),$>0?h.push(`+${$}`):h.push(`${$}`)}else if(k>=0)for(let w=0;w<n;w++)h.push(`${i[s++]}`);else{let w=n+k;if(w>0)for(let v=0;v<w;v++)h.push(`${i[s++]}`);else h.push("0");for(h.push(".");w++<0;)h.push("0");for(let v=0;v<n-Math.max(w-1,0);v++)h.push(`${i[s++]}`)}return h.join("")}toJSON(){return{$numberDecimal:this.toString()}}toExtendedJSON(){return{$numberDecimal:this.toString()}}static fromExtendedJSON(e){return oe.fromString(e.$numberDecimal)}inspect(e,n,i){return i??=le,`new Decimal128(${i(this.toString(),n)})`}}class ke extends de{get _bsontype(){return"Double"}constructor(e){super(),e instanceof Number&&(e=e.valueOf()),this.value=+e}static fromString(e){const n=Number(e);if(e==="NaN")return new ke(NaN);if(e==="Infinity")return new ke(1/0);if(e==="-Infinity")return new ke(-1/0);if(!Number.isFinite(n))throw new B(`Input: ${e} is not representable as a Double`);if(e.trim()!==e)throw new B(`Input: '${e}' contains whitespace`);if(e==="")throw new B("Input is an empty string");if(/[^-0-9.+eE]/.test(e))throw new B(`Input: '${e}' is not in decimal or exponential notation`);return new ke(n)}valueOf(){return this.value}toJSON(){return this.value}toString(e){return this.value.toString(e)}toExtendedJSON(e){return e&&(e.legacy||e.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-0.0"}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}}static fromExtendedJSON(e,n){const i=parseFloat(e.$numberDouble);return n&&n.relaxed?i:new ke(i)}inspect(e,n,i){return i??=le,`new Double(${i(this.value,n)})`}}class tt extends de{get _bsontype(){return"Int32"}constructor(e){super(),e instanceof Number&&(e=e.valueOf()),this.value=+e|0}static fromString(e){const n=As(e),i=Number(e);if(Un<i)throw new B(`Input: '${e}' is larger than the maximum value for Int32`);if(Vn>i)throw new B(`Input: '${e}' is smaller than the minimum value for Int32`);if(Number.isSafeInteger(i)){if(i.toString()!==n)throw new B(`Input: '${e}' is not a valid Int32 string`)}else throw new B(`Input: '${e}' is not a safe integer`);return new tt(i)}valueOf(){return this.value}toString(e){return this.value.toString(e)}toJSON(){return this.value}toExtendedJSON(e){return e&&(e.relaxed||e.legacy)?this.value:{$numberInt:this.value.toString()}}static fromExtendedJSON(e,n){return n&&n.relaxed?parseInt(e.$numberInt,10):new tt(e.$numberInt)}inspect(e,n,i){return i??=le,`new Int32(${i(this.value,n)})`}}class zt extends de{get _bsontype(){return"MaxKey"}toExtendedJSON(){return{$maxKey:1}}static fromExtendedJSON(){return new zt}inspect(){return"new MaxKey()"}}class Zt extends de{get _bsontype(){return"MinKey"}toExtendedJSON(){return{$minKey:1}}static fromExtendedJSON(){return new Zt}inspect(){return"new MinKey()"}}const Ye=new Float64Array(1),R=new Uint8Array(Ye.buffer,0,8);Ye[0]=-1;const Ti=R[7]===0,je={getNonnegativeInt32LE(t,e){if(t[e+3]>127)throw new RangeError(`Size cannot be negative at offset: ${e}`);return t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24},getInt32LE(t,e){return t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24},getUint32LE(t,e){return t[e]+t[e+1]*256+t[e+2]*65536+t[e+3]*16777216},getUint32BE(t,e){return t[e+3]+t[e+2]*256+t[e+1]*65536+t[e]*16777216},getBigInt64LE(t,e){const n=je.getUint32LE(t,e),i=je.getUint32LE(t,e+4);return(BigInt(i)<<BigInt(32))+BigInt(n)},getFloat64LE:Ti?(t,e)=>(R[7]=t[e],R[6]=t[e+1],R[5]=t[e+2],R[4]=t[e+3],R[3]=t[e+4],R[2]=t[e+5],R[1]=t[e+6],R[0]=t[e+7],Ye[0]):(t,e)=>(R[0]=t[e],R[1]=t[e+1],R[2]=t[e+2],R[3]=t[e+3],R[4]=t[e+4],R[5]=t[e+5],R[6]=t[e+6],R[7]=t[e+7],Ye[0]),setInt32BE(t,e,n){return t[e+3]=n,n>>>=8,t[e+2]=n,n>>>=8,t[e+1]=n,n>>>=8,t[e]=n,4},setInt32LE(t,e,n){return t[e]=n,n>>>=8,t[e+1]=n,n>>>=8,t[e+2]=n,n>>>=8,t[e+3]=n,4},setBigInt64LE(t,e,n){const i=BigInt(4294967295);let s=Number(n&i);t[e]=s,s>>=8,t[e+1]=s,s>>=8,t[e+2]=s,s>>=8,t[e+3]=s;let r=Number(n>>BigInt(32)&i);return t[e+4]=r,r>>=8,t[e+5]=r,r>>=8,t[e+6]=r,r>>=8,t[e+7]=r,8},setFloat64LE:Ti?(t,e,n)=>(Ye[0]=n,t[e]=R[7],t[e+1]=R[6],t[e+2]=R[5],t[e+3]=R[4],t[e+4]=R[3],t[e+5]=R[2],t[e+6]=R[1],t[e+7]=R[0],8):(t,e,n)=>(Ye[0]=n,t[e]=R[0],t[e+1]=R[1],t[e+2]=R[2],t[e+3]=R[3],t[e+4]=R[4],t[e+5]=R[5],t[e+6]=R[6],t[e+7]=R[7],8)},xo=new RegExp("^[0-9a-fA-F]{24}$");let Pe=null;class z extends de{get _bsontype(){return"ObjectId"}constructor(e){super();let n;if(typeof e=="object"&&e&&"id"in e){if(typeof e.id!="string"&&!ArrayBuffer.isView(e.id))throw new B("Argument passed in must have an id that is of type string or Buffer");"toHexString"in e&&typeof e.toHexString=="function"?n=_.fromHex(e.toHexString()):n=e.id}else n=e;if(n==null||typeof n=="number")this.buffer=z.generate(typeof n=="number"?n:void 0);else if(ArrayBuffer.isView(n)&&n.byteLength===12)this.buffer=_.toLocalBufferType(n);else if(typeof n=="string")if(n.length===24&&xo.test(n))this.buffer=_.fromHex(n);else throw new B("input must be a 24 character hex string, 12 byte Uint8Array, or an integer");else throw new B("Argument passed in does not match the accepted types");z.cacheHexString&&(this.__id=_.toHex(this.id))}get id(){return this.buffer}set id(e){this.buffer=e,z.cacheHexString&&(this.__id=_.toHex(e))}toHexString(){if(z.cacheHexString&&this.__id)return this.__id;const e=_.toHex(this.id);return z.cacheHexString&&!this.__id&&(this.__id=e),e}static getInc(){return z.index=(z.index+1)%16777215}static generate(e){typeof e!="number"&&(e=Math.floor(Date.now()/1e3));const n=z.getInc(),i=_.allocateUnsafe(12);return je.setInt32BE(i,0,e),Pe===null&&(Pe=_.randomBytes(5)),i[4]=Pe[0],i[5]=Pe[1],i[6]=Pe[2],i[7]=Pe[3],i[8]=Pe[4],i[11]=n&255,i[10]=n>>8&255,i[9]=n>>16&255,i}toString(e){return e==="base64"?_.toBase64(this.id):e==="hex"?this.toHexString():this.toHexString()}toJSON(){return this.toHexString()}static is(e){return e!=null&&typeof e=="object"&&"_bsontype"in e&&e._bsontype==="ObjectId"}equals(e){if(e==null)return!1;if(z.is(e))return this.buffer[11]===e.buffer[11]&&_.equals(this.buffer,e.buffer);if(typeof e=="string")return e.toLowerCase()===this.toHexString();if(typeof e=="object"&&typeof e.toHexString=="function"){const n=e.toHexString(),i=this.toHexString();return typeof n=="string"&&n.toLowerCase()===i}return!1}getTimestamp(){const e=new Date,n=je.getUint32BE(this.buffer,0);return e.setTime(Math.floor(n)*1e3),e}static createPk(){return new z}serializeInto(e,n){return e[n]=this.buffer[0],e[n+1]=this.buffer[1],e[n+2]=this.buffer[2],e[n+3]=this.buffer[3],e[n+4]=this.buffer[4],e[n+5]=this.buffer[5],e[n+6]=this.buffer[6],e[n+7]=this.buffer[7],e[n+8]=this.buffer[8],e[n+9]=this.buffer[9],e[n+10]=this.buffer[10],e[n+11]=this.buffer[11],12}static createFromTime(e){const n=_.allocate(12);for(let i=11;i>=4;i--)n[i]=0;return je.setInt32BE(n,0,e),new z(n)}static createFromHexString(e){if(e?.length!==24)throw new B("hex string must be 24 characters");return new z(_.fromHex(e))}static createFromBase64(e){if(e?.length!==16)throw new B("base64 string must be 16 characters");return new z(_.fromBase64(e))}static isValid(e){if(e==null)return!1;try{return new z(e),!0}catch{return!1}}toExtendedJSON(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}static fromExtendedJSON(e){return new z(e.$oid)}inspect(e,n,i){return i??=le,`new ObjectId(${i(this.toHexString(),n)})`}}z.index=Math.floor(Math.random()*16777215);function jo(t){return t.split("").sort().join("")}class Ae extends de{get _bsontype(){return"BSONRegExp"}constructor(e,n){if(super(),this.pattern=e,this.options=jo(n??""),this.pattern.indexOf("\0")!==-1)throw new B(`BSON Regex patterns cannot contain null bytes, found: ${JSON.stringify(this.pattern)}`);if(this.options.indexOf("\0")!==-1)throw new B(`BSON Regex options cannot contain null bytes, found: ${JSON.stringify(this.options)}`);for(let i=0;i<this.options.length;i++)if(!(this.options[i]==="i"||this.options[i]==="m"||this.options[i]==="x"||this.options[i]==="l"||this.options[i]==="s"||this.options[i]==="u"))throw new B(`The regular expression option [${this.options[i]}] is not supported`)}static parseOptions(e){return e?e.split("").sort().join(""):""}toExtendedJSON(e){return e=e||{},e.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}}static fromExtendedJSON(e){if("$regex"in e)if(typeof e.$regex!="string"){if(e.$regex._bsontype==="BSONRegExp")return e}else return new Ae(e.$regex,Ae.parseOptions(e.$options));if("$regularExpression"in e)return new Ae(e.$regularExpression.pattern,Ae.parseOptions(e.$regularExpression.options));throw new B(`Unexpected BSONRegExp EJSON object form: ${JSON.stringify(e)}`)}inspect(e,n,i){const s=lo(n)??(a=>a);i??=le;const r=s(i(this.pattern),"regexp"),o=s(i(this.options),"regexp");return`new BSONRegExp(${r}, ${o})`}}class Xt extends de{get _bsontype(){return"BSONSymbol"}constructor(e){super(),this.value=e}valueOf(){return this.value}toString(){return this.value}toJSON(){return this.value}toExtendedJSON(){return{$symbol:this.value}}static fromExtendedJSON(e){return new Xt(e.$symbol)}inspect(e,n,i){return i??=le,`new BSONSymbol(${i(this.value,n)})`}}const Ro=u;class Te extends Ro{get _bsontype(){return"Timestamp"}constructor(e){if(e==null)super(0,0,!0);else if(typeof e=="bigint")super(e,!0);else if(u.isLong(e))super(e.low,e.high,!0);else if(typeof e=="object"&&"t"in e&&"i"in e){if(typeof e.t!="number"&&(typeof e.t!="object"||e.t._bsontype!=="Int32"))throw new B("Timestamp constructed from { t, i } must provide t as a number");if(typeof e.i!="number"&&(typeof e.i!="object"||e.i._bsontype!=="Int32"))throw new B("Timestamp constructed from { t, i } must provide i as a number");const n=Number(e.t),i=Number(e.i);if(n<0||Number.isNaN(n))throw new B("Timestamp constructed from { t, i } must provide a positive t");if(i<0||Number.isNaN(i))throw new B("Timestamp constructed from { t, i } must provide a positive i");if(n>4294967295)throw new B("Timestamp constructed from { t, i } must provide t equal or less than uint32 max");if(i>4294967295)throw new B("Timestamp constructed from { t, i } must provide i equal or less than uint32 max");super(i,n,!0)}else throw new B("A Timestamp can only be constructed with: bigint, Long, or { t: number; i: number }")}toJSON(){return{$timestamp:this.toString()}}static fromInt(e){return new Te(u.fromInt(e,!0))}static fromNumber(e){return new Te(u.fromNumber(e,!0))}static fromBits(e,n){return new Te({i:e,t:n})}static fromString(e,n){return new Te(u.fromString(e,!0,n))}toExtendedJSON(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}static fromExtendedJSON(e){const n=u.isLong(e.$timestamp.i)?e.$timestamp.i.getLowBitsUnsigned():e.$timestamp.i,i=u.isLong(e.$timestamp.t)?e.$timestamp.t.getLowBitsUnsigned():e.$timestamp.t;return new Te({t:i,i:n})}inspect(e,n,i){i??=le;const s=i(this.high>>>0,n),r=i(this.low>>>0,n);return`new Timestamp({ t: ${s}, i: ${r} })`}}Te.MAX_VALUE=u.MAX_UNSIGNED_VALUE;u.fromNumber(fo);u.fromNumber(co);function Fo(t){return t!=null&&typeof t=="object"&&"_bsontype"in t&&typeof t._bsontype=="string"}const Uo={$oid:z,$binary:H,$uuid:H,$symbol:Xt,$numberInt:tt,$numberDecimal:oe,$numberDouble:ke,$numberLong:u,$minKey:Zt,$maxKey:zt,$regex:Ae,$regularExpression:Ae,$timestamp:Te};function Bs(t,e={}){if(typeof t=="number"){const i=t<=Un&&t>=Vn,s=t<=Ns&&t>=Es;if(e.relaxed||e.legacy)return t;if(Number.isInteger(t)&&!Object.is(t,-0)){if(i)return new tt(t);if(s)return e.useBigInt64?BigInt(t):u.fromNumber(t)}return new ke(t)}if(t==null||typeof t!="object")return t;if(t.$undefined)return null;const n=Object.keys(t).filter(i=>i.startsWith("$")&&t[i]!=null);for(let i=0;i<n.length;i++){const s=Uo[n[i]];if(s)return s.fromExtendedJSON(t,e)}if(t.$date!=null){const i=t.$date,s=new Date;if(e.legacy)if(typeof i=="number")s.setTime(i);else if(typeof i=="string")s.setTime(Date.parse(i));else if(typeof i=="bigint")s.setTime(Number(i));else throw new ci(`Unrecognized type for EJSON date: ${typeof i}`);else if(typeof i=="string")s.setTime(Date.parse(i));else if(u.isLong(i))s.setTime(i.toNumber());else if(typeof i=="number"&&e.relaxed)s.setTime(i);else if(typeof i=="bigint")s.setTime(Number(i));else throw new ci(`Unrecognized type for EJSON date: ${typeof i}`);return s}if(t.$code!=null){const i=Object.assign({},t);return t.$scope&&(i.$scope=Bs(t.$scope)),Et.fromExtendedJSON(t)}if(Eo(t)||t.$dbPointer){const i=t.$ref?t:t.$dbPointer;if(i instanceof et)return i;const s=Object.keys(i).filter(o=>o.startsWith("$"));let r=!0;if(s.forEach(o=>{["$ref","$id","$db"].indexOf(o)===-1&&(r=!1)}),r)return et.fromExtendedJSON(i)}return t}function Vo(t,e){return t.map((n,i)=>{e.seenObjects.push({propertyName:`index ${i}`,obj:null});try{return Ee(n,e)}finally{e.seenObjects.pop()}})}function Oi(t){const e=t.toISOString();return t.getUTCMilliseconds()!==0?e:e.slice(0,-5)+"Z"}function Ee(t,e){if(t instanceof Map||Ss(t)){const n=Object.create(null);for(const[i,s]of t){if(typeof i!="string")throw new B("Can only serialize maps with string keys");n[i]=s}return Ee(n,e)}if((typeof t=="object"||typeof t=="function")&&t!==null){const n=e.seenObjects.findIndex(i=>i.obj===t);if(n!==-1){const i=e.seenObjects.map(h=>h.propertyName),s=i.slice(0,n).map(h=>`${h} -> `).join(""),r=i[n],o=" -> "+i.slice(n+1,i.length-1).map(h=>`${h} -> `).join(""),a=i[i.length-1],l=" ".repeat(s.length+r.length/2),f="-".repeat(o.length+(r.length+a.length)/2-1);throw new B(`Converting circular structure to EJSON:
    ${s}${r}${o}${a}
    ${l}\\${f}/`)}e.seenObjects[e.seenObjects.length-1].obj=t}if(Array.isArray(t))return Vo(t,e);if(t===void 0)return null;if(t instanceof Date||ao(t)){const n=t.getTime(),i=n>-1&&n<2534023188e5;return e.legacy?e.relaxed&&i?{$date:t.getTime()}:{$date:Oi(t)}:e.relaxed&&i?{$date:Oi(t)}:{$date:{$numberLong:t.getTime().toString()}}}if(typeof t=="number"&&(!e.relaxed||!isFinite(t))){if(Number.isInteger(t)&&!Object.is(t,-0)){if(t>=Vn&&t<=Un)return{$numberInt:t.toString()};if(t>=Es&&t<=Ns)return{$numberLong:t.toString()}}return{$numberDouble:Object.is(t,-0)?"-0.0":t.toString()}}if(typeof t=="bigint")return e.relaxed?Number(BigInt.asIntN(64,t)):{$numberLong:BigInt.asIntN(64,t).toString()};if(t instanceof RegExp||oo(t)){let n=t.flags;if(n===void 0){const s=t.toString().match(/[gimuy]*$/);s&&(n=s[0])}return new Ae(t.source,n).toExtendedJSON(e)}return t!=null&&typeof t=="object"?qo(t,e):t}const Ko={Binary:t=>new H(t.value(),t.sub_type),Code:t=>new Et(t.code,t.scope),DBRef:t=>new et(t.collection||t.namespace,t.oid,t.db,t.fields),Decimal128:t=>new oe(t.bytes),Double:t=>new ke(t.value),Int32:t=>new tt(t.value),Long:t=>u.fromBits(t.low!=null?t.low:t.low_,t.low!=null?t.high:t.high_,t.low!=null?t.unsigned:t.unsigned_),MaxKey:()=>new zt,MinKey:()=>new Zt,ObjectId:t=>new z(t),BSONRegExp:t=>new Ae(t.pattern,t.options),BSONSymbol:t=>new Xt(t.value),Timestamp:t=>Te.fromBits(t.low,t.high)};function qo(t,e){if(t==null||typeof t!="object")throw new B("not an object instance");const n=t._bsontype;if(typeof n>"u"){const i={};for(const s of Object.keys(t)){e.seenObjects.push({propertyName:s,obj:null});try{const r=Ee(t[s],e);s==="__proto__"?Object.defineProperty(i,s,{value:r,writable:!0,enumerable:!0,configurable:!0}):i[s]=r}finally{e.seenObjects.pop()}}return i}else{if(t!=null&&typeof t=="object"&&typeof t._bsontype=="string"&&t[Symbol.for("@@mdb.bson.version")]!==Fn)throw new uo;if(Fo(t)){let i=t;if(typeof i.toExtendedJSON!="function"){const s=Ko[t._bsontype];if(!s)throw new B("Unrecognized or invalid _bsontype: "+t._bsontype);i=s(i)}return n==="Code"&&i.scope?i=new Et(i.code,Ee(i.scope,e)):n==="DBRef"&&i.oid&&(i=new et(Ee(i.collection,e),Ee(i.oid,e),Ee(i.db,e),Ee(i.fields,e))),i.toExtendedJSON(e)}else throw new B("_bsontype must be a string, but was: "+typeof n)}}function $s(t,e){const n={useBigInt64:e?.useBigInt64??!1,relaxed:e?.relaxed??!0,legacy:e?.legacy??!1};return JSON.parse(t,(i,s)=>{if(i.indexOf("\0")!==-1)throw new B(`BSON Document field names cannot contain null bytes, found: ${JSON.stringify(i)}`);return Bs(s,n)})}function Cs(t,e,n,i){n!=null&&typeof n=="object"&&(i=n,n=0),e!=null&&typeof e=="object"&&!Array.isArray(e)&&(i=e,e=void 0,n=0);const s=Object.assign({relaxed:!0,legacy:!1},i,{seenObjects:[{propertyName:"(root)",obj:null}]}),r=Ee(t,s);return JSON.stringify(r,e,n)}function Ho(t,e){return e=e||{},JSON.parse(Cs(t,e))}function Wo(t,e){return e=e||{},$s(JSON.stringify(t),e)}const kt=Object.create(null);kt.parse=$s;kt.stringify=Cs;kt.serialize=Ho;kt.deserialize=Wo;Object.freeze(kt);function dn(t,e){try{return je.getNonnegativeInt32LE(t,e)}catch(n){throw new Be("BSON size cannot be negative",e,{cause:n})}}function pn(t,e){let n=e;for(;t[n]!==0;n++);if(n===t.length-1)throw new Be("Null terminator not found",e);return n}function Jo(t,e=0){if(e??=0,t.length<5)throw new Be(`Input must be at least 5 bytes, got ${t.length} bytes`,e);const n=dn(t,e);if(n>t.length-e)throw new Be(`Parsed documentSize (${n} bytes) does not match input length (${t.length} bytes)`,e);if(t[e+n-1]!==0)throw new Be("BSON documents must end in 0x00",e+n);const i=[];let s=e+4;for(;s<=n+e;){const r=t[s];if(s+=1,r===0){if(s-e!==n)throw new Be("Invalid 0x00 type byte",s);break}const o=s,a=pn(t,s)-o;s+=a+1;let l;if(r===1||r===18||r===9||r===17)l=8;else if(r===16)l=4;else if(r===7)l=12;else if(r===19)l=16;else if(r===8)l=1;else if(r===10||r===6||r===127||r===255)l=0;else if(r===11)l=pn(t,pn(t,s)+1)+1-s;else if(r===3||r===4||r===15)l=dn(t,s);else if(r===2||r===5||r===12||r===13||r===14)l=dn(t,s)+4,r===5&&(l+=1),r===12&&(l+=12);else throw new Be(`Invalid 0x${r.toString(16).padStart(2,"0")} type byte`,s);if(l>n)throw new Be("value reports length larger than document",s);i.push([r,o,a,s,l]),s+=l}return i}const Qt=Object.create(null);Qt.parseToElements=Jo;Qt.ByteUtils=_;Qt.NumberUtils=je;Object.freeze(Qt);const Go=1024*1024*17;_.allocate(Go);const ca={description:{name:"New Creature",isProperNoun:!1,description:"",image:"",faction:"",environment:"",alignment:"Unaligned",cr:0,xp:0},core:{proficiencyBonus:2,race:"Humanoid",size:"Medium",speed:[{name:"Walk",value:30,unit:"ft",comment:""}],senses:[],languages:[]},abilities:{stats:{str:10,dex:10,con:10,wis:10,int:10,cha:10},saves:{str:{isProficient:!1,override:null},dex:{isProficient:!1,override:null},con:{isProficient:!1,override:null},wis:{isProficient:!1,override:null},int:{isProficient:!1,override:null},cha:{isProficient:!1,override:null}},skills:[]},defenses:{hp:{numOfHitDie:1,sizeOfHitDie:6,override:null},ac:{ac:10,acSource:"natural armor"},vulnerabilities:[],resistances:[],immunities:[],conditionImmunities:[]},features:{features:[],actions:[],bonus:[],reactions:[],legendary:[],lair:[],mythic:[],regional:[]},spellcasting:{innateSpells:{spellList:{0:[],1:[],2:[],3:[]},spellDcOverride:null,spellBonusOverride:null,spellCastingAbility:null,noComponentsOfType:["Material","Verbal","Somatic"],isPsionics:!1,displayAsAction:!1},casterSpells:{casterLevel:null,castingClass:null,spellCastingAbility:null,spellCastingAbilityOverride:null,spellList:[[],[],[],[],[],[],[],[],[],[]],spellSlotList:{},spellDcOverride:null,spellBonusOverride:null,displayAsAction:!1}},misc:{legActionsPerRound:3,telepathy:0,passivePerceptionOverride:null,featureHeaderTexts:{features:"",actions:"",bonus:"",reactions:"",legendary:"The creature can take $NUM$ legendary actions, choosing from the options below. Only one legendary action can be used at a time and only at the end of another creature's turn. The creature regains spent legendary actions at the start of its turn.",lair:"On initiative count 20 (losing initiative ties), the creature can take one of the following lair actions; it can't take the same lair action two rounds in a row",mythic:"If the creatures' Mythic trait is active, it can use the options below as legendary actions.",regional:"The region containing the creatures lair can be transformed by its presence, creating one or more of the following effects:"}}},Yo=[0,200,450,700,1100,1800,2300,2900,3900,5e3,5900,7200,8400,1e4,11500,13e3,15e3,18e3,2e4,22e3,25e3,33e3,41e3,5e4,62e3,75e3,9e4,105e3,12e4,135e3,255e3];function ua(t){return t==.125?25:t==.25?50:t==.5?100:Yo[t]??0}function ha(t,e){return!t||!e?{}:t=="Warlock"?{1:{1:1},2:{1:2},3:{2:2},4:{2:2},5:{3:2},6:{3:2},7:{4:2},8:{4:2},9:{5:2},10:{5:2},11:{5:3},12:{5:3},13:{5:3},14:{5:3},15:{5:3},16:{5:3},17:{5:4},18:{5:4},19:{5:4},20:{5:4}}[e]:["Ranger","Paladin","Artificer"].includes(t)?e==1&&t=="Artificer"?{1:2}:{1:{},2:{1:2},3:{1:3},4:{1:3},5:{1:4,2:2},6:{1:4,2:2},7:{1:4,2:3},8:{1:4,2:3},9:{1:4,2:3,3:2},10:{1:4,2:3,3:2},11:{1:4,2:3,3:3},12:{1:4,2:3,3:3},13:{1:4,2:3,3:3,4:1},14:{1:4,2:3,3:3,4:1},15:{1:4,2:3,3:3,4:2},16:{1:4,2:3,3:3,4:2},17:{1:4,2:3,3:3,4:3,5:1},18:{1:4,2:3,3:3,4:3,5:1},19:{1:4,2:3,3:3,4:3,5:2},20:{1:4,2:3,3:3,4:3,5:2}}[e]:{1:{1:2},2:{1:3},3:{1:4,2:2},4:{1:4,2:3},5:{1:4,2:3,3:2},6:{1:4,2:3,3:3},7:{1:4,2:3,3:3,4:1},8:{1:4,2:3,3:3,4:2},9:{1:4,2:3,3:3,4:3,5:1},10:{1:4,2:3,3:3,4:3,5:2},11:{1:4,2:3,3:3,4:3,5:2},12:{1:4,2:3,3:3,4:3,5:2,6:1},13:{1:4,2:3,3:3,4:3,5:2,6:1,7:1},14:{1:4,2:3,3:3,4:3,5:2,6:1,7:1},15:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1},16:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1},17:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1,9:1},18:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1,9:1},19:{1:4,2:3,3:3,4:3,5:2,6:2,7:1,8:1,9:1},20:{1:4,2:3,3:3,4:3,5:2,6:2,7:2,8:1,9:1}}[e]}const Ai={0:["Acid Splash","Blade Ward","Booming Blade","Chill Touch","Control Flames","Create Bonfire","Dancing Lights","Druidcraft","Eldritch Blast","Encode Thoughts","Fire Bolt","Friends","Frostbite","Green-Flame Blade","Guidance","Gust","Infestation","Light","Lightning Lure","Mage Hand","Magic Stone","Mending","Message","Mind Sliver","Minor Illusion","Mold Earth","Poison Spray","Prestidigitation","Primal Savagery","Produce Flame","Ray of Frost","Resistance","Sacred Flame","Sapping Sting","Shape Water","Shillelagh","Shocking Grasp","Spare the Dying","Sword Burst","Thaumaturgy","Thorn Whip","Thunderclap","Toll the Dead","True Strike","Vicious Mockery","Word of Radiance"],1:["Absorb Elements","Alarm","Animal Friendship","Armor of Agathys","Arms of Hadar","Bane","Beast Bond","Bless","Burning Hands","Catapult","Cause Fear","Ceremony","Chaos Bolt","Charm Person","Chromatic Orb","Color Spray","Command","Compelled Duel","Comprehend Languages","Create or Destroy Water","Cure Wounds","Detect Evil and Good","Detect Magic","Detect Poison and Disease","Disguise Self","Dissonant Whispers","Distort Value","Divine Favor","Earth Tremor","Ensnaring Strike","Entangle","Expeditious Retreat","Faerie Fire","False Life","Feather Fall","Find Familiar","Floating Disk","Fog Cloud","Frost Fingers","Gift of Alacrity","Goodberry","Grease","Guiding Bolt","Hail of Thorns","Healing Word","Hellish Rebuke","Heroism","Hex","Hideous Laughter","Hunter's Mark","Ice Knife","Identify","Illusory Script","Inflict Wounds","Jim's Magic Missile","Jump","Longstrider","Mage Armor","Magic Missile","Magnify Gravity","Protection from Evil and Good","Purify Food and Drink","Ray of Sickness","Sanctuary","Searing Smite","Shield","Shield of Faith","Silent Image","Silvery Barbs","Sleep","Snare","Speak with Animals","Tasha's Caustic Brew","Tasha's Hideous Laughter","Tenser's Floating Disk","Thunderous Smite","Thunderwave","Unseen Servant","Witch Bolt","Wrathful Smite","Zephyr Strike"],2:["Acid Arrow","Aganazzar's Scorcher","Aid","Air Bubble","Alter Self","Animal Messenger","Arcane Lock","Arcanist's Magic Aura","Augury","Barkskin","Beast Sense","Blindness/Deafness","Blur","Borrowed Knowledge","Branding Smite","Calm Emotions","Cloud of Daggers","Continual Flame","Cordon of Arrows","Crown of Madness","Darkness","Darkvision","Detect Thoughts","Dragon's Breath","Dust Devil","Earthbind","Enhance Ability","Enlarge/Reduce","Enthrall","Find Steed","Find Traps","Flame Blade","Flaming Sphere","Flock of Familiars","Fortune's Favor","Gentle Repose","Gift of Gab","Gust of Wind","Healing Spirit","Heat Metal","Hold Person","Immovable Object","Invisibility","Jim's Glowing Coin","Kinetic Jaunt","Knock","Lesser Restoration","Levitate","Locate Animals or Plants","Locate Object","Magic Mouth","Magic Weapon","Maximilian's Earthen Grasp","Melf's Acid Arrow","Mind Spike","Mirror Image","Misty Step","Moonbeam","Nathair's Mischief","Nystul's Magic Aura","Pass without Trace","Phantasmal Force","Prayer of Healing","Protection from Poison","Pyrotechnics","Ray of Enfeeblement","Rime's Binding Ice","Rope Trick","Scorching Ray","See Invisibility","Shadow Blade","Shatter","Silence","Skywrite","Snilloc's Snowball Swarm","Spider Climb","Spike Growth","Spiritual Weapon","Spray of Cards","Suggestion","Summon Beast","Tasha's Mind Whip","Vortex Warp","Warding Bond","Warding Wind","Warp Sense","Web","Wither and Bloom","Wristpocket","Zone of Truth"],3:["Animate Dead","Antagonize","Ashardalon's Stride","Aura of Vitality","Beacon of Hope","Bestow Curse","Blinding Smite","Blink","Call Lightning","Catnap","Clairvoyance","Conjure Animals","Conjure Barrage","Counterspell","Create Food and Water","Crusader's Mantle","Daylight","Dispel Magic","Elemental Weapon","Enemies Abound","Erupting Earth","Fast Friends","Fear","Feign Death","Fireball","Flame Arrows","Fly","Freedom of the Waves","Galder's Tower","Gaseous Form","Glyph of Warding","Haste","Hunger of Hadar","Hypnotic Pattern","Incite Greed","Intellect Fortress","Leomund's Tiny Hut","Life Transference","Lightning Arrow","Lightning Bolt","Magic Circle","Major Image","Mass Healing Word","Meld into Stone","Melf's Minute Meteors","Motivational Speech","Nondetection","Phantom Steed","Plant Growth","Protection from Energy","Pulse Wave","Remove Curse","Revivify","Sending","Sleet Storm","Slow","Speak with Dead","Speak with Plants","Spirit Guardians","Spirit Shroud","Stinking Cloud","Summon Fey","Summon Lesser Demons","Summon Shadowspawn","Summon Undead","Thunder Step","Tidal Wave","Tiny Hut","Tiny Servant","Tongues","Vampiric Touch","Wall of Sand","Wall of Water","Water Breathing","Water Walk","Wind Wall"],4:["Arcane Eye","Aura of Life","Aura of Purity","Banishment","Black Tentacles","Blight","Charm Monster","Compulsion","Confusion","Conjure Minor Elementals","Conjure Woodland Beings","Control Water","Death Ward","Dimension Door","Divination","Dominate Beast","Elemental Bane","Evard's Black Tentacles","Fabricate","Faithful Hound","Find Greater Steed","Fire Shield","Freedom of Movement","Galder's Speedy Courier","Gate Seal","Giant Insect","Grasping Vine","Gravity Sinkhole","Greater Invisibility","Guardian of Faith","Guardian of Nature","Hallucinatory Terrain","Ice Storm","Leomund's Secret Chest","Locate Creature","Mordenkainen's Faithful Hound","Mordenkainen's Private Sanctum","Otiluke's Resilient Sphere","Phantasmal Killer","Polymorph","Private Sanctum","Raulothim's Psychic Lance","Resilient Sphere","Secret Chest","Shadow of Moil","Sickening Radiance","Spirit of Death","Staggering Smite","Stone Shape","Stoneskin","Storm Sphere","Summon Aberration","Summon Construct","Summon Elemental","Summon Greater Demon","Vitriolic Sphere","Wall of Fire","Watery Sphere"],5:["Animate Objects","Antilife Shell","Arcane Hand","Awaken","Banishing Smite","Bigby's Hand","Circle of Power","Cloudkill","Commune","Commune with Nature","Cone of Cold","Conjure Elemental","Conjure Volley","Contact Other Plane","Contagion","Control Winds","Create Spelljamming Helm","Creation","Danse Macabre","Dawn","Destructive Wave","Dispel Evil and Good","Dominate Person","Dream","Enervation","Far Step","Flame Strike","Freedom of the Winds","Geas","Greater Restoration","Hallow","Hold Monster","Holy Weapon","Immolation","Infernal Calling","Insect Plague","Legend Lore","Maelstrom","Mass Cure Wounds","Mislead","Modify Memory","Negative Energy Flood","Passwall","Planar Binding","Raise Dead","Rary's Telepathic Bond","Reincarnate","Scrying","Seeming","Skill Empowerment","Steel Wind Strike","Summon Celestial","Summon Draconic Spirit","Swift Quiver","Synaptic Static","Telekinesis","Telepathic Bond","Teleportation Circle","Temporal Shunt","Transmute Rock","Tree Stride","Wall of Force","Wall of Light","Wall of Stone","Wrath of Nature"],6:["Arcane Gate","Blade Barrier","Bones of the Earth","Chain Lightning","Circle of Death","Conjure Fey","Contingency","Create Homunculus","Create Undead","Disintegrate","Drawmij's Instant Summons","Druid Grove","Eyebite","Find the Path","Fizban's Platinum Shield","Flesh to Stone","Forbiddance","Freezing Sphere","Globe of Invulnerability","Gravity Fissure","Guards and Wards","Harm","Heal","Heroes' Feast","Instant Summons","Investiture of Flame","Investiture of Ice","Investiture of Stone","Investiture of Wind","Magic Jar","Mass Suggestion","Mental Prison","Move Earth","Otiluke's Freezing Sphere","Otto's Irresistible Dance","Planar Ally","Primordial Ward","Programmed Illusion","Scatter","Soul Cage","Summon Fiend","Sunbeam","Tasha's Otherworldly Guise","Tenser's Transformation","Transport via Plants","True Seeing","Wall of Ice","Wall of Thorns","Wind Walk","Word of Recall"],7:["Conjure Celestial","Create Magen","Crown of Stars","Delayed Blast Fireball","Divine Word","Draconic Transformation","Dream of the Blue Veil","Etherealness","Finger of Death","Fire Storm","Forcecage","Magnificent Mansion","Mirage Arcane","Mordenkainen's Magnificent Mansion","Mordenkainen's Sword","Plane Shift","Power Word Pain","Prismatic Spray","Project Image","Regenerate","Resurrection","Reverse Gravity","Sequester","Simulacrum","Symbol","Teleport","Temple of the Gods","Tether Essence","Whirlwind"],8:["Abi-Dalzim's Horrid Wilting","Animal Shapes","Antimagic Field","Antipathy/Sympathy","Clone","Control Weather","Dark Star","Demiplane","Dominate Monster","Earthquake","Feeblemind","Glibness","Holy Aura","Illusory Dragon","Incendiary Cloud","Maddening Darkness","Maze","Mighty Fortress","Mind Blank","Power Word Stun","Reality Break","Sunburst","Telepathy","Tsunami"],9:["Astral Projection","Blade of Disaster","Foresight","Gate","Imprisonment","Invulnerability","Mass Heal","Mass Polymorph","Meteor Swarm","Power Word Heal","Power Word Kill","Prismatic Wall","Psychic Scream","Ravenous Void","Shapechange","Storm of Vengeance","Time Ravage","Time Stop","True Polymorph","True Resurrection","Weird","Wish"]};let Nn=[];for(let t in Ai)Nn=Nn.concat(Ai[t]);Nn.sort();var E={},En={},Se={},zo=ve&&ve.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var r in s)s.hasOwnProperty(r)&&(i[r]=s[r])},t(e,n)};return function(e,n){t(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ii=ve&&ve.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),s=0,e=0;e<n;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,s++)i[s]=r[o];return i};Object.defineProperty(Se,"__esModule",{value:!0});Se.DetailContext=Se.NoopContext=Se.VError=void 0;var vs=function(t){zo(e,t);function e(n,i){var s=t.call(this,i)||this;return s.path=n,Object.setPrototypeOf(s,e.prototype),s}return e}(Error);Se.VError=vs;var Zo=function(){function t(){this._failed=!1}return t.prototype.fail=function(e,n,i){return this._failed=!0,!1},t.prototype.fork=function(){return this},t.prototype.completeFork=function(){return!this._failed},t.prototype.failed=function(){return this._failed},t.prototype.unionResolver=function(){return this},t.prototype.createContext=function(){return this._failed=!1,this},t.prototype.resolveUnion=function(e){},t}();Se.NoopContext=Zo;var _s=function(){function t(){this._propNames=[],this._messages=[],this._failedForks=[],this._currentFork=null,this._score=0}return t.prototype.fail=function(e,n,i){return this._propNames.push(e),this._messages.push(n),this._score+=i,!1},t.prototype.unionResolver=function(){return new Xo},t.prototype.resolveUnion=function(e){for(var n,i,s,r=e,o=null,a=0,l=r.contexts;a<l.length;a++){var f=l[a];(!o||f._score>=o._score)&&(o=f)}o&&o._score>0&&((n=this._propNames).push.apply(n,o._propNames),(i=this._messages).push.apply(i,o._messages),(s=this._failedForks).push.apply(s,o._failedForks))},t.prototype.getError=function(e){var n=kn(this.getErrorDetails(e).map(Ls)).join(`
`);return new vs(e,n)},t.prototype.getErrorDetails=function(e){for(var n=null,i,s=[],r=this._propNames.length-1;r>=0;r--){var o=this._propNames[r];e+=typeof o=="number"?"["+o+"]":o?"."+o:"";var a=this._messages[r];a&&(i={path:e,message:a},n?n.nested=[i]:s.push(i),n=i)}var l=kn(this._failedForks.map(function(f){return f.getErrorDetails(e)}));return n?l.length&&(n.nested=l):s=l,s},t.prototype.fork=function(){return this._currentFork==null&&(this._currentFork=new t),this._currentFork},t.prototype.completeFork=function(){var e=this._currentFork;return e._failed()&&(this._failedForks.push(e),this._currentFork=null,this._failedForks.length===1&&(this._score=e._score)),this._failedForks.length<t.maxForks},t.prototype.failed=function(){return this._failed()},t.prototype._failed=function(){return this._propNames.length+this._failedForks.length>0},t.maxForks=3,t}();Se.DetailContext=_s;var Xo=function(){function t(){this.contexts=[]}return t.prototype.createContext=function(){var e=new _s;return this.contexts.push(e),e},t}(),Ls=function(t){var e=t.path+" "+t.message,n=t.nested||[],i=kn(n.map(Ls));if(n.length==1){var s=i[0],r=i.slice(1);return Ii([e+"; "+s],r)}else return Ii([e],i.map(function(o){return"    "+o}))};function kn(t){var e;return(e=[]).concat.apply(e,t)}(function(t){var e=ve&&ve.__extends||function(){var y=function(b,S){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,O){N.__proto__=O}||function(N,O){for(var C in O)O.hasOwnProperty(C)&&(N[C]=O[C])},y(b,S)};return function(b,S){y(b,S);function N(){this.constructor=b}b.prototype=S===null?Object.create(S):(N.prototype=S.prototype,new N)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.basicTypes=t.BasicType=t.TParamList=t.TParam=t.param=t.TFunc=t.func=t.TProp=t.TOptional=t.opt=t.TIface=t.iface=t.indexKey=t.TEnumLiteral=t.enumlit=t.TEnumType=t.enumtype=t.TIntersection=t.intersection=t.TUnion=t.union=t.TTuple=t.tuple=t.RestType=t.rest=t.TArray=t.array=t.TLiteral=t.lit=t.TName=t.name=t.TType=void 0;var n=Se,i=function(){function y(){}return y}();t.TType=i;function s(y){return typeof y=="string"?o(y):y}function r(y,b){var S=y[b];if(!S)throw new Error("Unknown type "+b);return S}function o(y){return new a(y)}t.name=o;var a=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.name=S,N._failMsg="is not a "+S,N}return b.prototype.getChecker=function(S,N,O){var C=this._checkerBeingBuilt;if(!C){this._checkerBeingBuilt=function(M,x){return C(M,x)};try{C=this._getChecker(S,N,O)}finally{this._checkerBeingBuilt=void 0}}return C},b.prototype._getChecker=function(S,N,O){var C=this,M=r(S,this.name),x=M.getChecker(S,N,O);return M instanceof Q||M instanceof b?x:function(F,U){return x(F,U)?!0:U.fail(null,C._failMsg,0)}},b}(i);t.TName=a;function l(y){return new f(y)}t.lit=l;var f=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.value=S,N.name=JSON.stringify(S),N._failMsg="is not "+N.name,N}return b.prototype.getChecker=function(S,N){var O=this;return function(C,M){return C===O.value?!0:M.fail(null,O._failMsg,-1)}},b}(i);t.TLiteral=f;function h(y){return new c(s(y))}t.array=h;var c=function(y){e(b,y);function b(S){var N=y.call(this)||this;N.ttype=S;var O=Gn(S);return O&&(N.name=O+"[]"),N}return b.prototype.getChecker=function(S,N){var O=this.ttype.getChecker(S,N);return function(C,M){if(!Array.isArray(C))return M.fail(null,"is not an array",0);for(var x=0;x<C.length;x++){var F=O(C[x],M);if(!F)return M.fail(x,null,1)}return!0}},b}(i);t.TArray=c;function d(y){return new g(y)}t.rest=d;var g=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.typeSpec=S,N}return b.prototype.setStart=function(S){this._start=S},b.prototype.getChecker=function(S,N){var O=typeof this.typeSpec=="string"?r(S,this.typeSpec):this.typeSpec;if(!(O instanceof c))throw new Error("Rest type must be an array");var C=O.ttype.getChecker(S,N),M=this._start;return function(x,F){for(var U=M;U<x.length;U++)if(!C(x[U],F))return F.fail(U,null,1);return!0}},b}(i);t.RestType=g;function T(){for(var y=[],b=0;b<arguments.length;b++)y[b]=arguments[b];return new p(y.map(function(S){return s(S)}))}t.tuple=T;var p=function(y){e(b,y);function b(S){var N=y.call(this)||this;N.ttypes=S;var O=S[S.length-1];return O instanceof g&&(S.pop(),N._restType=O,N._restType.setStart(S.length)),N}return b.prototype.getChecker=function(S,N){var O=this.ttypes.map(function(x){return x.getChecker(S,N)}),C=function(x,F){if(!Array.isArray(x))return F.fail(null,"is not an array",0);for(var U=0;U<O.length;U++){var ee=O[U](x[U],F);if(!ee)return F.fail(U,null,1)}return!0};if(this._restType){var M=this._restType.getChecker(S,N);return function(x,F){return C(x,F)&&M(x,F)}}return N?function(x,F){return C(x,F)?x.length<=O.length?!0:F.fail(O.length,"is extraneous",2):!1}:C},b}(i);t.TTuple=p;function m(){for(var y=[],b=0;b<arguments.length;b++)y[b]=arguments[b];return new I(y.map(function(S){return s(S)}))}t.union=m;var I=function(y){e(b,y);function b(S){var N=y.call(this)||this;N.ttypes=S;var O=S.map(Gn).filter(function(M){return M}),C=S.length-O.length;return O.length?(C>0&&O.push(C+" more"),N._failMsg="is none of "+O.join(", ")):N._failMsg="is none of "+C+" types",N}return b.prototype.getChecker=function(S,N,O){var C=this,M=this.ttypes.map(function(x){return x.getChecker(S,N,O)});return function(x,F){for(var U=F.unionResolver(),ee=0;ee<M.length;ee++){var pe=M[ee](x,U.createContext());if(pe)return!0}return F.resolveUnion(U),F.fail(null,C._failMsg,0)}},b}(i);t.TUnion=I;function k(){for(var y=[],b=0;b<arguments.length;b++)y[b]=arguments[b];return new $(y.map(function(S){return s(S)}))}t.intersection=k;var $=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.ttypes=S,N}return b.prototype.getChecker=function(S,N,O){O===void 0&&(O=new Set);var C=this.ttypes.map(function(M){return M.getChecker(S,N,O)});return function(M,x){return C.every(function(F){return F(M,x.fork()),x.completeFork()})&&!x.failed()}},b}(i);t.TIntersection=$;function w(y){return new v(y)}t.enumtype=w;var v=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.members=S,N.validValues=new Set,N._failMsg="is not a valid enum value",N.validValues=new Set(Object.keys(S).map(function(O){return S[O]})),N}return b.prototype.getChecker=function(S,N){var O=this;return function(C,M){return O.validValues.has(C)?!0:M.fail(null,O._failMsg,0)}},b}(i);t.TEnumType=v;function A(y,b){return new V(y,b)}t.enumlit=A;var V=function(y){e(b,y);function b(S,N){var O=y.call(this)||this;return O.enumName=S,O.prop=N,O._failMsg="is not "+S+"."+N,O}return b.prototype.getChecker=function(S,N){var O=this,C=r(S,this.enumName);if(!(C instanceof v))throw new Error("Type "+this.enumName+" used in enumlit is not an enum type");var M=C.members[this.prop];if(!C.members.hasOwnProperty(this.prop))throw new Error("Unknown value "+this.enumName+"."+this.prop+" used in enumlit");return function(x,F){return x===M?!0:F.fail(null,O._failMsg,-1)}},b}(i);t.TEnumLiteral=V;function j(y){return Object.keys(y).filter(function(b){return b!==t.indexKey}).map(function(b){return L(b,y[b])})}function L(y,b){return b instanceof be?new X(y,b.ttype,!0):new X(y,s(b),!1)}t.indexKey=Symbol();function K(y,b){return new D(y,j(b),b[t.indexKey])}t.iface=K;var D=function(y){e(b,y);function b(S,N,O){var C=y.call(this)||this;return C.bases=S,C.props=N,C.indexType=O?s(O):void 0,C.propSet=new Set(N.map(function(M){return M.name})),C}return b.prototype.getChecker=function(S,N,O){var C=this,M;O===void 0&&(O=new Set),this.propSet.forEach(function(Z){return O.add(Z)});var x=this.bases.map(function(Z){return r(S,Z).getChecker(S,N,O)}),F=this.props.map(function(Z){return Z.ttype.getChecker(S,N)}),U=(M=this.indexType)===null||M===void 0?void 0:M.getChecker(S,N),ee=new n.NoopContext,pe=this.props.map(function(Z,te){return!Z.isOpt&&!F[te](void 0,ee)});return function(Z,te){if(typeof Z!="object"||Z===null)return te.fail(null,"is not an object",0);for(var Ne=0;Ne<x.length;Ne++)if(x[Ne](Z,te.fork()),!te.completeFork())return!1;for(var Ne=0;Ne<F.length;Ne++){var tn=C.props[Ne].name,Yn=Z[tn];if(Yn===void 0){if(pe[Ne]&&(te.fork().fail(tn,"is missing",1),!te.completeFork()))return!1}else{var ft=te.fork(),Rs=F[Ne](Yn,ft);if(Rs||ft.fail(tn,null,1),!te.completeFork())return!1}}if(U)for(var ct in Z){var ft=te.fork();if(U(Z[ct],ft)||ft.fail(ct,null,1),!te.completeFork())return!1}else if(N){for(var ct in Z)if(!O.has(ct)&&(te.fork().fail(ct,"is extraneous",2),!te.completeFork()))return!1}return!te.failed()}},b}(i);t.TIface=D;function q(y){return new be(s(y))}t.opt=q;var be=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.ttype=S,N}return b.prototype.getChecker=function(S,N){var O=this.ttype.getChecker(S,N);return function(C,M){return C===void 0||O(C,M)}},b}(i);t.TOptional=be;var X=function(){function y(b,S,N){this.name=b,this.ttype=S,this.isOpt=N}return y}();t.TProp=X;function Ps(y){for(var b=[],S=1;S<arguments.length;S++)b[S-1]=arguments[S];return new Kn(new Hn(b),s(y))}t.func=Ps;var Kn=function(y){e(b,y);function b(S,N){var O=y.call(this)||this;return O.paramList=S,O.result=N,O}return b.prototype.getChecker=function(S,N){return function(O,C){return typeof O=="function"?!0:C.fail(null,"is not a function",0)}},b}(i);t.TFunc=Kn;function Ms(y,b,S){return new qn(y,s(b),!!S)}t.param=Ms;var qn=function(){function y(b,S,N){this.name=b,this.ttype=S,this.isOpt=N}return y}();t.TParam=qn;var Hn=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.params=S,N}return b.prototype.getChecker=function(S,N){var O=this,C=this.params.map(function(U){return U.ttype.getChecker(S,N)}),M=new n.NoopContext,x=this.params.map(function(U,ee){return!U.isOpt&&!C[ee](void 0,M)}),F=function(U,ee){if(!Array.isArray(U))return ee.fail(null,"is not an array",0);for(var pe=0;pe<C.length;pe++){var Z=O.params[pe];if(U[pe]===void 0){if(x[pe])return ee.fail(Z.name,"is missing",1)}else{var te=C[pe](U[pe],ee);if(!te)return ee.fail(Z.name,null,1)}}return!0};return N?function(U,ee){return F(U,ee)?U.length<=C.length?!0:ee.fail(C.length,"is extraneous",2):!1}:F},b}(i);t.TParamList=Hn;var Q=function(y){e(b,y);function b(S,N){var O=y.call(this)||this;return O.validator=S,O.message=N,O}return b.prototype.getChecker=function(S,N){var O=this;return function(C,M){return O.validator(C)?!0:M.fail(null,O.message,0)}},b}(i);t.BasicType=Q,t.basicTypes={any:new Q(function(y){return!0},"is invalid"),unknown:new Q(function(y){return!0},"is invalid"),number:new Q(function(y){return typeof y=="number"},"is not a number"),object:new Q(function(y){return typeof y=="object"&&y},"is not an object"),boolean:new Q(function(y){return typeof y=="boolean"},"is not a boolean"),string:new Q(function(y){return typeof y=="string"},"is not a string"),symbol:new Q(function(y){return typeof y=="symbol"},"is not a symbol"),void:new Q(function(y){return y==null},"is not void"),undefined:new Q(function(y){return y===void 0},"is not undefined"),null:new Q(function(y){return y===null},"is not null"),never:new Q(function(y){return!1},"is unexpected"),Date:new Q(Wn("[object Date]"),"is not a Date"),RegExp:new Q(Wn("[object RegExp]"),"is not a RegExp")};var Ds=Object.prototype.toString;function Wn(y){return function(b){return typeof b=="object"&&b&&Ds.call(b)===y}}typeof Buffer<"u"&&(t.basicTypes.Buffer=new Q(function(y){return Buffer.isBuffer(y)},"is not a Buffer"));for(var xs=function(y){t.basicTypes[y.name]=new Q(function(b){return b instanceof y},"is not a "+y.name)},en=0,Jn=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,ArrayBuffer];en<Jn.length;en++){var js=Jn[en];xs(js)}function Gn(y){if(y instanceof a||y instanceof f||y instanceof c)return y.name}})(En);(function(t){var e=ve&&ve.__spreadArrays||function(){for(var l=0,f=0,h=arguments.length;f<h;f++)l+=arguments[f].length;for(var c=Array(l),d=0,f=0;f<h;f++)for(var g=arguments[f],T=0,p=g.length;T<p;T++,d++)c[d]=g[T];return c};Object.defineProperty(t,"__esModule",{value:!0}),t.Checker=t.createCheckers=void 0;var n=En,i=Se,s=En;Object.defineProperty(t,"TArray",{enumerable:!0,get:function(){return s.TArray}}),Object.defineProperty(t,"TEnumType",{enumerable:!0,get:function(){return s.TEnumType}}),Object.defineProperty(t,"TEnumLiteral",{enumerable:!0,get:function(){return s.TEnumLiteral}}),Object.defineProperty(t,"TFunc",{enumerable:!0,get:function(){return s.TFunc}}),Object.defineProperty(t,"TIface",{enumerable:!0,get:function(){return s.TIface}}),Object.defineProperty(t,"TLiteral",{enumerable:!0,get:function(){return s.TLiteral}}),Object.defineProperty(t,"TName",{enumerable:!0,get:function(){return s.TName}}),Object.defineProperty(t,"TOptional",{enumerable:!0,get:function(){return s.TOptional}}),Object.defineProperty(t,"TParam",{enumerable:!0,get:function(){return s.TParam}}),Object.defineProperty(t,"TParamList",{enumerable:!0,get:function(){return s.TParamList}}),Object.defineProperty(t,"TProp",{enumerable:!0,get:function(){return s.TProp}}),Object.defineProperty(t,"TTuple",{enumerable:!0,get:function(){return s.TTuple}}),Object.defineProperty(t,"TType",{enumerable:!0,get:function(){return s.TType}}),Object.defineProperty(t,"TUnion",{enumerable:!0,get:function(){return s.TUnion}}),Object.defineProperty(t,"TIntersection",{enumerable:!0,get:function(){return s.TIntersection}}),Object.defineProperty(t,"array",{enumerable:!0,get:function(){return s.array}}),Object.defineProperty(t,"enumlit",{enumerable:!0,get:function(){return s.enumlit}}),Object.defineProperty(t,"enumtype",{enumerable:!0,get:function(){return s.enumtype}}),Object.defineProperty(t,"func",{enumerable:!0,get:function(){return s.func}}),Object.defineProperty(t,"iface",{enumerable:!0,get:function(){return s.iface}}),Object.defineProperty(t,"lit",{enumerable:!0,get:function(){return s.lit}}),Object.defineProperty(t,"name",{enumerable:!0,get:function(){return s.name}}),Object.defineProperty(t,"opt",{enumerable:!0,get:function(){return s.opt}}),Object.defineProperty(t,"param",{enumerable:!0,get:function(){return s.param}}),Object.defineProperty(t,"tuple",{enumerable:!0,get:function(){return s.tuple}}),Object.defineProperty(t,"union",{enumerable:!0,get:function(){return s.union}}),Object.defineProperty(t,"intersection",{enumerable:!0,get:function(){return s.intersection}}),Object.defineProperty(t,"rest",{enumerable:!0,get:function(){return s.rest}}),Object.defineProperty(t,"indexKey",{enumerable:!0,get:function(){return s.indexKey}}),Object.defineProperty(t,"BasicType",{enumerable:!0,get:function(){return s.BasicType}});var r=Se;Object.defineProperty(t,"VError",{enumerable:!0,get:function(){return r.VError}});function o(){for(var l=[],f=0;f<arguments.length;f++)l[f]=arguments[f];for(var h=Object.assign.apply(Object,e([{},n.basicTypes],l)),c={},d=0,g=l;d<g.length;d++)for(var T=g[d],p=0,m=Object.keys(T);p<m.length;p++){var I=m[p];c[I]=new a(h,T[I])}return c}t.createCheckers=o;var a=function(){function l(f,h,c){if(c===void 0&&(c="value"),this.suite=f,this.ttype=h,this._path=c,this.props=new Map,h instanceof n.TIface)for(var d=0,g=h.props;d<g.length;d++){var T=g[d];this.props.set(T.name,T.ttype)}this.checkerPlain=this.ttype.getChecker(f,!1),this.checkerStrict=this.ttype.getChecker(f,!0)}return l.prototype.setReportedPath=function(f){this._path=f},l.prototype.check=function(f){return this._doCheck(this.checkerPlain,f)},l.prototype.test=function(f){return this.checkerPlain(f,new i.NoopContext)},l.prototype.validate=function(f){return this._doValidate(this.checkerPlain,f)},l.prototype.strictCheck=function(f){return this._doCheck(this.checkerStrict,f)},l.prototype.strictTest=function(f){return this.checkerStrict(f,new i.NoopContext)},l.prototype.strictValidate=function(f){return this._doValidate(this.checkerStrict,f)},l.prototype.getProp=function(f){var h=this.props.get(f);if(!h)throw new Error("Type has no property "+f);return new l(this.suite,h,this._path+"."+f)},l.prototype.methodArgs=function(f){var h=this._getMethod(f);return new l(this.suite,h.paramList)},l.prototype.methodResult=function(f){var h=this._getMethod(f);return new l(this.suite,h.result)},l.prototype.getArgs=function(){if(!(this.ttype instanceof n.TFunc))throw new Error("getArgs() applied to non-function");return new l(this.suite,this.ttype.paramList)},l.prototype.getResult=function(){if(!(this.ttype instanceof n.TFunc))throw new Error("getResult() applied to non-function");return new l(this.suite,this.ttype.result)},l.prototype.getType=function(){return this.ttype},l.prototype._doCheck=function(f,h){var c=new i.NoopContext;if(!f(h,c)){var d=new i.DetailContext;throw f(h,d),d.getError(this._path)}},l.prototype._doValidate=function(f,h){var c=new i.NoopContext;if(f(h,c))return null;var d=new i.DetailContext;return f(h,d),d.getErrorDetails(this._path)},l.prototype._getMethod=function(f){var h=this.props.get(f);if(!h)throw new Error("Type has no property "+f);if(!(h instanceof n.TFunc))throw new Error("Property "+f+" is not a method");return h},l}();t.Checker=a})(E);E.iface([],{search:"string",page:"number",mode:E.union(E.lit("popular"),E.lit("recent")),tags:E.array("string")});E.union(E.lit("str"),E.lit("dex"),E.lit("con"),E.lit("int"),E.lit("cha"),E.lit("wis"));E.iface([],{description:"Description",core:"Core",abilities:"Abilities",defenses:"Defenses",features:"Features",spellcasting:"SpellCasting",misc:"Misc"});E.iface([],{legActionsPerRound:"number",telepathy:"number",passivePerceptionOverride:E.union("number","null"),featureHeaderTexts:"FeatureHeaderTexts"});E.iface([],{features:"string",actions:"string",bonus:"string",reactions:"string",legendary:"string",lair:"string",mythic:"string",regional:"string"});E.iface([],{name:"string",isProperNoun:"boolean",description:"string",image:"string",faction:"string",environment:"string",alignment:"string",cr:"number",xp:"number"});E.iface([],{proficiencyBonus:"number",race:"string",size:"string",speed:E.array("SpeedEntity"),senses:E.array("SenseEntity"),languages:E.union(E.array("string"),"null")});E.iface([],{walk:"number",fly:"number",isHover:"boolean",burrow:"number",swim:"number",climb:"number"});E.union(E.lit("ft"),E.lit("m"),E.lit("km"),E.lit("mi"),E.lit("none"));E.iface([],{name:"string",value:"number",unit:"Unit",comment:"string"});E.iface([],{name:"string",value:"number",unit:"Unit",comment:"string"});E.iface([],{stats:"Stats",saves:"Saves",skills:E.array("SkillsEntity")});E.iface([],{str:"number",dex:"number",con:"number",int:"number",cha:"number",wis:"number"});E.iface([],{str:"SaveEntity",dex:"SaveEntity",con:"SaveEntity",int:"SaveEntity",cha:"SaveEntity",wis:"SaveEntity"});E.iface([],{isProficient:"boolean",override:E.union("number","null")});E.iface([],{skillName:"string",isHalfProficient:"boolean",isProficient:"boolean",isExpertise:"boolean",override:E.union("number","null")});E.iface([],{hp:"Hp",ac:"Ac",vulnerabilities:E.array("string"),resistances:E.array("string"),immunities:E.array("string"),conditionImmunities:E.array("string")});E.iface([],{numOfHitDie:"number",sizeOfHitDie:"number",override:E.union("number","null")});E.iface([],{ac:"number",acSource:"string"});E.iface([],{features:E.array("FeatureEntity"),actions:E.array("FeatureEntity"),bonus:E.array("FeatureEntity"),reactions:E.array("FeatureEntity"),legendary:E.array("FeatureEntity"),mythic:E.array("FeatureEntity"),lair:E.array("FeatureEntity"),regional:E.array("FeatureEntity")});E.iface([],{name:"string",description:"string",automation:E.union("null","object",E.array("object"))});E.iface([],{innateSpells:"InnateSpells",casterSpells:"CasterSpells"});E.iface([],{spellList:"InnateSpellsList",spellDcOverride:E.union("null","number"),spellBonusOverride:E.union("null","number"),spellCastingAbility:E.union("Stat","null"),noComponentsOfType:E.array("string"),isPsionics:"boolean",displayAsAction:"boolean"});E.iface([],{casterLevel:E.union("number","null"),castingClass:E.union(E.lit("Wizard"),E.lit("Druid"),E.lit("Cleric"),E.lit("Bard"),E.lit("Sorcerer"),E.lit("Paladin"),E.lit("Ranger"),E.lit("Artificer"),E.lit("Warlock"),"null"),spellList:E.array(E.array("string")),spellSlotList:E.union("SpellSlotEntity","undefined"),spellDcOverride:E.union("null","number"),spellBonusOverride:E.union("null","number"),spellCastingAbility:E.union("Stat","null"),spellCastingAbilityOverride:E.union("Stat","null"),displayAsAction:"boolean"});E.iface([],{[E.indexKey]:E.array("InnateSpellsEntity")});E.iface([],{spell:"string",comment:"string"});E.iface([],{[E.indexKey]:"number"});const Qo=Us({props:{title:{type:String,required:!0},id:{type:Number,required:!1},takesCustomTextInput:{type:Boolean,required:!1,default:!1}},data(){return{elId:""}},mounted(){this.id?this.elId=this.title.toLowerCase().replaceAll(" ","")+this.id:this.elId=this.title.toLowerCase().replaceAll(" ","")}}),ea={class:"container"},ta=["for"],na={key:0};function ia(t,e,n,i,s,r){const o=Ks("tooltip");return zn(),Zn("div",ea,[qs("label",{class:"editor-field__title",for:t.elId},[Xn(Hs(t.title),1),t.takesCustomTextInput?Ws((zn(),Zn("span",na,[Xn("*")])),[[o,"Supports custom text input"]]):Js("",!0)],8,ta),Gs(t.$slots,"default",{},void 0,!0)])}const da=Vs(Qo,[["render",ia],["__scopeId","data-v-14f42cf2"]]);function pa(t,e){let n=[],i=[];for(let s of t??[]){let r=vt(s.name);if(s.description&&r.toLowerCase().includes("spellcasting"))continue;let o=sa(s.entries||s.description.replaceAll("<i>","*").replaceAll("<b>","**").replaceAll("</i>","*").replaceAll("</b>","**")),[a,l]=la(o,r,e);l&&i.push(l),n.push({name:r,description:o.replace(/<avrae hidden>.*?<\/avrae>/gis,""),automation:a})}return[n,i]}function sa(t){if(typeof t=="string")return t;let e=[];for(let n of t)if(typeof n=="string"&&e.push(vt(n)),typeof n=="object"&&n.type=="list")for(let i of n.items)e.push(`<br><b class="indent">${vt(i.name)}</b> ${vt(i.entry||i?.entries.join(`
`))}`);return e.join(`
`)}function vt(t){return t=t.replaceAll("{@atk mw}","*Melee Weapon Attack:*").replaceAll("{@atk rw}","*Ranged Weapon Attack:*").replaceAll("{@atk mw,rw}","*Melee or Ranged Weapon Attack:*").replaceAll("{@atk ms}","*Melee Spell Attack:*").replaceAll("{@atk rs}","*Ranged Spell Attack:*").replaceAll("{@atk ms,rs}","*Melee or Ranged Spell Attack:*").replaceAll("{@h}","*Hit:* ").replace(/\{@damage\s+([^}]+)\}/g,"$1").replace(/\{@dc\s+([^}]+)\}/g,"DC $1").replace(/\{@dice\s+([^}]+)\}/g,"$1").replace(/\{@spell\s+([^}]+)\}/g,"$1").replace(/\{@item\s+([^}]+)\}/g,"$1").replace(/\{@condition\s+([^}]+)\}/g,"<u>$1</u>").replace(/\{@recharge\s+(\d+)\}/g,"(Recharge $1-6)").replace(/\{@quickref\s+[a-z\s]+[|]+[0-9]+\}/,"$1".replace(/(^|\s)\S/g,function(e){return e.toUpperCase()})).replace("Recharge 6-6","Recharge 6").replace("{@recharge}","(Recharge 6)").replace(/\{@hit\s+(-?\d+)\}/g,(e,n)=>n>=0?`+${n}`:n).replaceAll("<u>","*").replaceAll("</u>","*"),t}const ra=new RegExp("<avrae hidden>(?:(?<simple>(.*?)\\|([+-]?\\d*)\\|(.*?))|(?<freeform>.*?))</avrae>","gsi"),oa=new RegExp(/[+-]?\d+ \((.+?)\) (\w+) damage/,"i"),aa=new RegExp(/(?:\*)?(?:\w+ ){1,4}Attack:(?:\*)? (?<attackBonus>[+-]?\d+) to hit, .*?(?:\*)?Hit:(?:\*)? [+-]?(?:\d+ \((?<damageDiceBase>.+?)\)|(?<damageIntBase>\d+)) (?<damageTypeBase>[aA-zZ ]+) damage[., ]??(?: in melee[.,]?? or [+-]?(?:\d+ \((?<damageRangedDice>.+?)\)|(?<damageRangedInt>\d+)) (?<damageTypeRanged>[aA-zZ ]+) damage at range[,.]?)?(?:,? or [+-]?(?:\d+ \((?<damageDiceVers>.+?)\)|(?<damageIntVers>\d+)) (?<damageTypeVers>[aA-zZ ]+) damage if used with two hands(?: to make a melee attack)?)?(?:,? (?:plus|and) [+-]?(?:\d+ \((?<damageBonusDice>.+?)\)|(?<damageBonusInt>\d+)) (?<damageTypeBonus>[aA-zZ ]+) damage)?/,"i");function la(t,e="",n){n<1&&(n=1);const i=Array.from(t.matchAll(ra),o=>o.groups?.freeform),s=t.match(aa),r=t.match(oa);if(i.length>0)for(let o of i)try{return[so.parse(o??""),null]}catch{return[null,`${e}: Attempted to parse into Avrae Automation but an error occured.`]}else if(s?.groups){let o=[];const a=s.groups,l=a.attackBonus.replace("+","");let f="";if(a.damageTypeBonus&&(a.damageBonusInt||a.damageBonusDice)&&(f=` + ${a.damageBonusInt??a.damageBonusDice} [${a.damageTypeBonus}]`),a.damageTypeVers&&(a.damageIntVers||a.damageDiceVers)){let c=`${a.damageIntVers??a.damageDiceVers} [${a.damageTypeVers}]`+f;o.push({name:`2-Handed ${e}`,automation:[{type:"target",target:"each",effects:[{type:"attack",hit:[{type:"damage",damage:c,overheal:!1}],miss:[],attackBonus:l}]},{type:"text",text:t,title:"Effect"}],_v:2,activation_type:n})}if(a.damageTypeRanged&&(a.damageRangedInt||a.damageRangedDice)){let c=`${a.damageRangedInt??a.damageRangedDice} [${a.damageTypeRanged}]`+f;o.push({name:`Ranged ${e}`,automation:[{type:"target",target:"each",effects:[{type:"attack",hit:[{type:"damage",damage:c,overheal:!1}],miss:[],attackBonus:l}]},{type:"text",text:t,title:"Effect"}],_v:2,activation_type:n})}let h=`${a.damageIntBase??a.damageDiceBase} [${a.damageTypeBase}]`+f;return o.push({name:e,automation:[{type:"target",target:"each",effects:[{type:"attack",hit:[{type:"damage",damage:h,overheal:!1}],miss:[],attackBonus:l}]},{type:"text",text:t,title:"Effect"}],_v:2,activation_type:n}),o?o.length==1?[o[0],null]:[o,null]:[null,`${e}: Attempted to parse into Avrae Automation but an error occured.`]}else if(r)return t.includes(" DC ")?[null,`${e}: Cannot generate automation for save-based attacks.`]:[{name:e,automation:[{type:"target",target:"each",effects:[{type:"damage",damage:r[1]+`[${r[2]}]`,overheal:!1}]},{type:"text",text:t,title:"Effect"}],_v:2,activation_type:n},null];return[null,`${e}: Did not Generate Avrae Automation.`]}function ma(t){return t.charAt(0).toUpperCase()+t.slice(1)}export{da as L,so as Y,pa as a,ha as b,ma as c,ca as d,Ai as e,io as f,ua as g,la as p,Nn as s};
