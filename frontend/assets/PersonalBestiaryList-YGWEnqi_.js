import{d as h,b as k,e as g,f,g as p,K as r,h as $,i as D,o as n,j as y,k as m,w as l,l as a,c as x,F as M,m as S,n as N,t as F,p as P}from"./index-BmrAt_SM.js";import{_ as T}from"./Modal.vue_vue_type_style_index_0_lang-DUBcQvNs.js";import{B as V}from"./BestiaryList-D-0djXZa.js";import{_ as K}from"./Breadcrumbs.vue_vue_type_style_index_0_lang-CzlSYNm2.js";import{$ as b}from"./loading-BEyGLxdN.js";import"./StatusIcon-B2Swfu6e.js";const L={class:"content"},j={key:1,class:"zero-found"},G=h({__name:"PersonalBestiaryList",setup(z){const w=k();g(async()=>{const s=b.show();await c(),s.hide()});const i=f([]),c=async()=>{const{success:s,data:e,error:t}=await p("/api/my-bestiaries");s?i.value=e:(i.value=[],r.error(t))},v=async()=>{const{success:s,data:e,error:t}=await p("/api/bestiary/add","POST",{name:"New bestiary",description:"",status:"private",creatures:[]});s?(r.success("Successfully created bestiary."),await w.push(`/bestiary-viewer/${e._id?.toString()}`)):r.error(t),await c()},_=async s=>{if(!s)return;const e=b.show(),{success:t,error:d}=await p(`/api/bestiary/${s._id?.toString()}/delete`);t?(r.success("Deleted the bestiary succesfully."),o.value=!1):r.error(d),e.hide(),await c()},o=f(!1),u=f(null),C=s=>{u.value=s,o.value=!0};return(s,e)=>{const t=$("font-awesome-icon"),d=D("tooltip");return n(),y(M,null,[m(K,{routes:[{path:"",text:"My Bestiaries",isCurrent:!0}]},{default:l(()=>[S((n(),y("button",{class:"inverted","aria-label":"Create bestiary",onClick:v},[m(t,{icon:["fas","plus"]})])),[[d,"Create bestiary!"]])]),_:1}),a("div",L,[i.value?(n(),x(V,{key:0,personal:!0,bestiaries:i.value,onDeleteBestiary:C},null,8,["bestiaries"])):(n(),y("div",j,[e[3]||(e[3]=a("span",null," You do not have any bestiaries. ",-1)),a("button",{class:"btn confirm",onClick:v}," Create a bestiary ")]))]),m(T,{show:o.value,onClose:e[2]||(e[2]=B=>o.value=!1)},{header:l(()=>[N(" Are you sure you want to delete "+F(u.value?.name),1)]),body:l(()=>e[4]||(e[4]=[a("p",{class:"modal-desc"}," Please confirm you want to permanently delete this bestiary. This action is not reversible. ",-1)])),footer:l(()=>[a("button",{class:"btn",onClick:e[0]||(e[0]=B=>o.value=!1)}," Cancel "),a("button",{class:"btn danger",onClick:e[1]||(e[1]=P(()=>_(u.value),["prevent"]))}," Confirm ")]),_:1},8,["show"])],64)}}});export{G as default};
