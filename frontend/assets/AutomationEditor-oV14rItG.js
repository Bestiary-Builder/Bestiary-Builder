import{c$ as fe,d0 as Ut,d1 as ke,d2 as Dt,d3 as Mt,d4 as F,d5 as we,d6 as lt,d7 as rt,d8 as ut,d9 as cn,da as pe,db as fn,dc as pn,dd as Le,de as Re,df as _t,dg as mn,dh as St,di as Nt,dj as qe,dk as hn,dl as vn,dm as dt,dn as gn,dp as re,dq as Ee,dr as Be,ds as _e,dt as At,du as yn,dv as bn,dw as wn,dx as ct,dy as je,dz as kn,dA as _n,dB as Pt,dC as be,dD as qt,dE as Sn,dF as Ke,dG as Nn,dH as Kt,dI as An,dJ as In,dK as Tn,dL as $n,dM as Cn,d as P,I as ae,h as J,i as Fe,u,o as m,c as q,w as g,G as le,B as T,l,n as $,j as w,x as se,m as k,k as d,t as Z,F as L,_ as D,aS as V,f as j,p as Se,b4 as ye,X as En,e as Ne,g as ie,bh as xe,z as me,D as Y,H as x,E as Q,b1 as Rt,bM as jt,b6 as He,y as xn,L as On,bS as H,r as Vn,N as Ln,K as te}from"./index-Eo6WqVUZ.js";import{L as y,v as Bn,w as Un}from"./constants-D5I_1ZIC.js";import"./markdownItAnchor-VSsJ9PWr.js";const Ie={collection:"map",default:!0,nodeClass:fe,tag:"tag:yaml.org,2002:map",resolve(n,e){return Ut(n)||e("Expected a mapping for this tag"),n},createNode:(n,e,t)=>fe.from(n,e,t)},Te={collection:"seq",default:!0,nodeClass:ke,tag:"tag:yaml.org,2002:seq",resolve(n,e){return Dt(n)||e("Expected a sequence for this tag"),n},createNode:(n,e,t)=>ke.from(n,e,t)},Ge={identify:n=>typeof n=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:n=>n,stringify(n,e,t,s){return e=Object.assign({actualString:!0},e),Mt(n,e,t,s)}},Ye={identify:n=>n==null,createNode:()=>new F(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new F(null),stringify:({source:n},e)=>typeof n=="string"&&Ye.test.test(n)?n:e.options.nullStr},ft={identify:n=>typeof n=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:n=>new F(n[0]==="t"||n[0]==="T"),stringify({source:n,value:e},t){if(n&&ft.test.test(n)){const s=n[0]==="t"||n[0]==="T";if(e===s)return n}return e?t.options.trueStr:t.options.falseStr}};function ee({format:n,minFractionDigits:e,tag:t,value:s}){if(typeof s=="bigint")return String(s);const i=typeof s=="number"?s:Number(s);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let a=JSON.stringify(s);if(!n&&e&&(!t||t==="tag:yaml.org,2002:float")&&/^\d/.test(a)){let o=a.indexOf(".");o<0&&(o=a.length,a+=".");let r=e-(a.length-o-1);for(;r-- >0;)a+="0"}return a}const Ft={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:n=>n.slice(-3).toLowerCase()==="nan"?NaN:n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ee},Ht={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:n=>parseFloat(n),stringify(n){const e=Number(n.value);return isFinite(e)?e.toExponential():ee(n)}},Gt={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(n){const e=new F(parseFloat(n)),t=n.indexOf(".");return t!==-1&&n[n.length-1]==="0"&&(e.minFractionDigits=n.length-t-1),e},stringify:ee},We=n=>typeof n=="bigint"||Number.isInteger(n),pt=(n,e,t,{intAsBigInt:s})=>s?BigInt(n):parseInt(n.substring(e),t);function Yt(n,e,t){const{value:s}=n;return We(s)&&s>=0?t+s.toString(e):ee(n)}const Wt={identify:n=>We(n)&&n>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(n,e,t)=>pt(n,2,8,t),stringify:n=>Yt(n,8,"0o")},Jt={identify:We,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(n,e,t)=>pt(n,0,10,t),stringify:ee},Xt={identify:n=>We(n)&&n>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(n,e,t)=>pt(n,2,16,t),stringify:n=>Yt(n,16,"0x")},Dn=[Ie,Te,Ge,Ye,ft,Wt,Jt,Xt,Ft,Ht,Gt];function It(n){return typeof n=="bigint"||Number.isInteger(n)}const Ue=({value:n})=>JSON.stringify(n),Mn=[{identify:n=>typeof n=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:n=>n,stringify:Ue},{identify:n=>n==null,createNode:()=>new F(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:Ue},{identify:n=>typeof n=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:n=>n==="true",stringify:Ue},{identify:It,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(n,e,{intAsBigInt:t})=>t?BigInt(n):parseInt(n,10),stringify:({value:n})=>It(n)?n.toString():JSON.stringify(n)},{identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:n=>parseFloat(n),stringify:Ue}],Pn={default:!0,tag:"",test:/^/,resolve(n,e){return e(`Unresolved plain scalar ${JSON.stringify(n)}`),n}},qn=[Ie,Te].concat(Mn,Pn),mt={identify:n=>n instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(n,e){if(typeof atob=="function"){const t=atob(n.replace(/[\n\r]/g,"")),s=new Uint8Array(t.length);for(let i=0;i<t.length;++i)s[i]=t.charCodeAt(i);return s}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),n},stringify({comment:n,type:e,value:t},s,i,a){const o=t;let r;if(typeof btoa=="function"){let c="";for(let f=0;f<o.length;++f)c+=String.fromCharCode(o[f]);r=btoa(c)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e||(e=F.BLOCK_LITERAL),e!==F.QUOTE_DOUBLE){const c=Math.max(s.options.lineWidth-s.indent.length,s.options.minContentWidth),f=Math.ceil(r.length/c),p=new Array(f);for(let h=0,b=0;h<f;++h,b+=c)p[h]=r.substr(b,c);r=p.join(e===F.BLOCK_LITERAL?`
`:" ")}return Mt({comment:n,type:e,value:r},s,i,a)}};function zt({value:n,source:e},t){return e&&(n?Zt:Qt).test.test(e)?e:n?t.options.trueStr:t.options.falseStr}const Zt={identify:n=>n===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new F(!0),stringify:zt},Qt={identify:n=>n===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new F(!1),stringify:zt},Kn={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:n=>n.slice(-3).toLowerCase()==="nan"?NaN:n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ee},Rn={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:n=>parseFloat(n.replace(/_/g,"")),stringify(n){const e=Number(n.value);return isFinite(e)?e.toExponential():ee(n)}},jn={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(n){const e=new F(parseFloat(n.replace(/_/g,""))),t=n.indexOf(".");if(t!==-1){const s=n.substring(t+1).replace(/_/g,"");s[s.length-1]==="0"&&(e.minFractionDigits=s.length)}return e},stringify:ee},Ve=n=>typeof n=="bigint"||Number.isInteger(n);function Je(n,e,t,{intAsBigInt:s}){const i=n[0];if((i==="-"||i==="+")&&(e+=1),n=n.substring(e).replace(/_/g,""),s){switch(t){case 2:n=`0b${n}`;break;case 8:n=`0o${n}`;break;case 16:n=`0x${n}`;break}const o=BigInt(n);return i==="-"?BigInt(-1)*o:o}const a=parseInt(n,t);return i==="-"?-1*a:a}function ht(n,e,t){const{value:s}=n;if(Ve(s)){const i=s.toString(e);return s<0?"-"+t+i.substr(1):t+i}return ee(n)}const Fn={identify:Ve,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(n,e,t)=>Je(n,2,2,t),stringify:n=>ht(n,2,"0b")},Hn={identify:Ve,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(n,e,t)=>Je(n,1,8,t),stringify:n=>ht(n,8,"0")},Gn={identify:Ve,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(n,e,t)=>Je(n,0,10,t),stringify:ee},Yn={identify:Ve,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(n,e,t)=>Je(n,2,16,t),stringify:n=>ht(n,16,"0x")};function vt(n,e){const t=n[0],s=t==="-"||t==="+"?n.substring(1):n,i=o=>e?BigInt(o):Number(o),a=s.replace(/_/g,"").split(":").reduce((o,r)=>o*i(60)+i(r),i(0));return t==="-"?i(-1)*a:a}function en(n){let{value:e}=n,t=o=>o;if(typeof e=="bigint")t=o=>BigInt(o);else if(isNaN(e)||!isFinite(e))return ee(n);let s="";e<0&&(s="-",e*=t(-1));const i=t(60),a=[e%i];return e<60?a.unshift(0):(e=(e-a[0])/i,a.unshift(e%i),e>=60&&(e=(e-a[0])/i,a.unshift(e))),s+a.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const tn={identify:n=>typeof n=="bigint"||Number.isInteger(n),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(n,e,{intAsBigInt:t})=>vt(n,t),stringify:en},nn={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:n=>vt(n,!1),stringify:en},Xe={identify:n=>n instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(n){const e=n.match(Xe.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,t,s,i,a,o,r]=e.map(Number),c=e[7]?Number((e[7]+"00").substr(1,3)):0;let f=Date.UTC(t,s-1,i,a||0,o||0,r||0,c);const p=e[8];if(p&&p!=="Z"){let h=vt(p,!1);Math.abs(h)<30&&(h*=60),f-=6e4*h}return new Date(f)},stringify:({value:n})=>n.toISOString().replace(/(T00:00:00)?\.000Z$/,"")},Tt=[Ie,Te,Ge,Ye,Zt,Qt,Fn,Hn,Gn,Yn,Kn,Rn,jn,mt,we,lt,rt,ut,tn,nn,Xe],$t=new Map([["core",Dn],["failsafe",[Ie,Te,Ge]],["json",qn],["yaml11",Tt],["yaml-1.1",Tt]]),Ct={binary:mt,bool:ft,float:Gt,floatExp:Ht,floatNaN:Ft,floatTime:nn,int:Jt,intHex:Xt,intOct:Wt,intTime:tn,map:Ie,merge:we,null:Ye,omap:lt,pairs:rt,seq:Te,set:ut,timestamp:Xe},Wn={"tag:yaml.org,2002:binary":mt,"tag:yaml.org,2002:merge":we,"tag:yaml.org,2002:omap":lt,"tag:yaml.org,2002:pairs":rt,"tag:yaml.org,2002:set":ut,"tag:yaml.org,2002:timestamp":Xe};function et(n,e,t){const s=$t.get(e);if(s&&!n)return t&&!s.includes(we)?s.concat(we):s.slice();let i=s;if(!i)if(Array.isArray(n))i=[];else{const a=Array.from($t.keys()).filter(o=>o!=="yaml11").map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${a} or define customTags array`)}if(Array.isArray(n))for(const a of n)i=i.concat(a);else typeof n=="function"&&(i=n(i.slice()));return t&&(i=i.concat(we)),i.reduce((a,o)=>{const r=typeof o=="string"?Ct[o]:o;if(!r){const c=JSON.stringify(o),f=Object.keys(Ct).map(p=>JSON.stringify(p)).join(", ");throw new Error(`Unknown custom tag ${c}; use one of ${f}`)}return a.includes(r)||a.push(r),a},[])}const Jn=(n,e)=>n.key<e.key?-1:n.key>e.key?1:0;class ze{constructor({compat:e,customTags:t,merge:s,resolveKnownTags:i,schema:a,sortMapEntries:o,toStringDefaults:r}){this.compat=Array.isArray(e)?et(e,"compat"):e?et(null,e):null,this.name=typeof a=="string"&&a||"core",this.knownTags=i?Wn:{},this.tags=et(t,this.name,s),this.toStringOptions=r??null,Object.defineProperty(this,cn,{value:Ie}),Object.defineProperty(this,pe,{value:Ge}),Object.defineProperty(this,fn,{value:Te}),this.sortMapEntries=typeof o=="function"?o:o===!0?Jn:null}clone(){const e=Object.create(ze.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}function Xn(n,e){const t=[];let s=e.directives===!0;if(e.directives!==!1&&n.directives){const c=n.directives.toString(n);c?(t.push(c),s=!0):n.directives.docStart&&(s=!0)}s&&t.push("---");const i=pn(n,e),{commentString:a}=i.options;if(n.commentBefore){t.length!==1&&t.unshift("");const c=a(n.commentBefore);t.unshift(Le(c,""))}let o=!1,r=null;if(n.contents){if(Re(n.contents)){if(n.contents.spaceBefore&&s&&t.push(""),n.contents.commentBefore){const p=a(n.contents.commentBefore);t.push(Le(p,""))}i.forceBlockIndent=!!n.comment,r=n.contents.comment}const c=r?void 0:()=>o=!0;let f=_t(n.contents,i,()=>r=null,c);r&&(f+=mn(f,"",a(r))),(f[0]==="|"||f[0]===">")&&t[t.length-1]==="---"?t[t.length-1]=`--- ${f}`:t.push(f)}else t.push(_t(n.contents,i));if(n.directives?.docEnd)if(n.comment){const c=a(n.comment);c.includes(`
`)?(t.push("..."),t.push(Le(c,""))):t.push(`... ${c}`)}else t.push("...");else{let c=n.comment;c&&o&&(c=c.replace(/^\n+/,"")),c&&((!o||r)&&t[t.length-1]!==""&&t.push(""),t.push(Le(a(c),"")))}return t.join(`
`)+`
`}class $e{constructor(e,t,s){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,St,{value:Nt});let i=null;typeof t=="function"||Array.isArray(t)?i=t:s===void 0&&t&&(s=t,t=void 0);const a=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},s);this.options=a;let{version:o}=a;s?._directives?(this.directives=s._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new qe({version:o}),this.setSchema(o,s),this.contents=e===void 0?null:this.createNode(e,i,s)}clone(){const e=Object.create($e.prototype,{[St]:{value:Nt}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=Re(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){ve(this.contents)&&this.contents.add(e)}addIn(e,t){ve(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){const s=hn(this);e.anchor=!t||s.has(t)?vn(t||"a",s):t}return new dt(e.anchor)}createNode(e,t,s){let i;if(typeof t=="function")e=t.call({"":e},"",e),i=t;else if(Array.isArray(t)){const N=S=>typeof S=="number"||S instanceof String||S instanceof Number,C=t.filter(N).map(String);C.length>0&&(t=t.concat(C)),i=t}else s===void 0&&t&&(s=t,t=void 0);const{aliasDuplicateObjects:a,anchorPrefix:o,flow:r,keepUndefined:c,onTagObj:f,tag:p}=s??{},{onAnchor:h,setAnchors:b,sourceObjects:_}=wn(this,o||"a"),v={aliasDuplicateObjects:a??!0,keepUndefined:c??!1,onAnchor:h,onTagObj:f,replacer:i,schema:this.schema,sourceObjects:_},I=gn(e,p,v);return r&&re(I)&&(I.flow=!0),b(),I}createPair(e,t,s={}){const i=this.createNode(e,null,s),a=this.createNode(t,null,s);return new Ee(i,a)}delete(e){return ve(this.contents)?this.contents.delete(e):!1}deleteIn(e){return Be(e)?this.contents==null?!1:(this.contents=null,!0):ve(this.contents)?this.contents.deleteIn(e):!1}get(e,t){return re(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return Be(e)?!t&&_e(this.contents)?this.contents.value:this.contents:re(this.contents)?this.contents.getIn(e,t):void 0}has(e){return re(this.contents)?this.contents.has(e):!1}hasIn(e){return Be(e)?this.contents!==void 0:re(this.contents)?this.contents.hasIn(e):!1}set(e,t){this.contents==null?this.contents=At(this.schema,[e],t):ve(this.contents)&&this.contents.set(e,t)}setIn(e,t){Be(e)?this.contents=t:this.contents==null?this.contents=At(this.schema,Array.from(e),t):ve(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){typeof e=="number"&&(e=String(e));let s;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new qe({version:"1.1"}),s={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new qe({version:e}),s={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,s=null;break;default:{const i=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${i}`)}}if(t.schema instanceof Object)this.schema=t.schema;else if(s)this.schema=new ze(Object.assign(s,t));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:t,mapAsMap:s,maxAliasCount:i,onAnchor:a,reviver:o}={}){const r={anchors:new Map,doc:this,keep:!e,mapAsMap:s===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},c=yn(this.contents,t??"",r);if(typeof a=="function")for(const{count:f,res:p}of r.anchors.values())a(p,f);return typeof o=="function"?bn(o,{"":c},"",c):c}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return Xn(this,e)}}function ve(n){if(re(n))return!0;throw new Error("Expected a YAML collection as document contents")}function Ae(n,{flow:e,indicator:t,next:s,offset:i,onError:a,parentIndent:o,startOnNewline:r}){let c=!1,f=r,p=r,h="",b="",_=!1,v=!1,I=null,N=null,C=null,S=null,E=null,U=null,M=null;for(const A of n)switch(v&&(A.type!=="space"&&A.type!=="newline"&&A.type!=="comma"&&a(A.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),v=!1),I&&(f&&A.type!=="comment"&&A.type!=="newline"&&a(I,"TAB_AS_INDENT","Tabs are not allowed as indentation"),I=null),A.type){case"space":!e&&(t!=="doc-start"||s?.type!=="flow-collection")&&A.source.includes("	")&&(I=A),p=!0;break;case"comment":{p||a(A,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const K=A.source.substring(1)||" ";h?h+=b+K:h=K,b="",f=!1;break}case"newline":f?h?h+=A.source:(!U||t!=="seq-item-ind")&&(c=!0):b+=A.source,f=!0,_=!0,(N||C)&&(S=A),p=!0;break;case"anchor":N&&a(A,"MULTIPLE_ANCHORS","A node can have at most one anchor"),A.source.endsWith(":")&&a(A.offset+A.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),N=A,M===null&&(M=A.offset),f=!1,p=!1,v=!0;break;case"tag":{C&&a(A,"MULTIPLE_TAGS","A node can have at most one tag"),C=A,M===null&&(M=A.offset),f=!1,p=!1,v=!0;break}case t:(N||C)&&a(A,"BAD_PROP_ORDER",`Anchors and tags must be after the ${A.source} indicator`),U&&a(A,"UNEXPECTED_TOKEN",`Unexpected ${A.source} in ${e??"collection"}`),U=A,f=t==="seq-item-ind"||t==="explicit-key-ind",p=!1;break;case"comma":if(e){E&&a(A,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),E=A,f=!1,p=!1;break}default:a(A,"UNEXPECTED_TOKEN",`Unexpected ${A.type} token`),f=!1,p=!1}const O=n[n.length-1],R=O?O.offset+O.source.length:i;return v&&s&&s.type!=="space"&&s.type!=="newline"&&s.type!=="comma"&&(s.type!=="scalar"||s.source!=="")&&a(s.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),I&&(f&&I.indent<=o||s?.type==="block-map"||s?.type==="block-seq")&&a(I,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:E,found:U,spaceBefore:c,comment:h,hasNewline:_,anchor:N,tag:C,newlineAfterProp:S,end:R,start:M??R}}function Oe(n){if(!n)return null;switch(n.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(n.source.includes(`
`))return!0;if(n.end){for(const e of n.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(const e of n.items){for(const t of e.start)if(t.type==="newline")return!0;if(e.sep){for(const t of e.sep)if(t.type==="newline")return!0}if(Oe(e.key)||Oe(e.value))return!0}return!1;default:return!0}}function it(n,e,t){if(e?.type==="flow-collection"){const s=e.end[0];s.indent===n&&(s.source==="]"||s.source==="}")&&Oe(e)&&t(s,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function sn(n,e,t){const{uniqueKeys:s}=n.options;if(s===!1)return!1;const i=typeof s=="function"?s:(a,o)=>a===o||_e(a)&&_e(o)&&a.value===o.value;return e.some(a=>i(a.key,t))}const Et="All mapping items must start at the same column";function zn({composeNode:n,composeEmptyNode:e},t,s,i,a){const o=a?.nodeClass??fe,r=new o(t.schema);t.atRoot&&(t.atRoot=!1);let c=s.offset,f=null;for(const p of s.items){const{start:h,key:b,sep:_,value:v}=p,I=Ae(h,{indicator:"explicit-key-ind",next:b??_?.[0],offset:c,onError:i,parentIndent:s.indent,startOnNewline:!0}),N=!I.found;if(N){if(b&&(b.type==="block-seq"?i(c,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in b&&b.indent!==s.indent&&i(c,"BAD_INDENT",Et)),!I.anchor&&!I.tag&&!_){f=I.end,I.comment&&(r.comment?r.comment+=`
`+I.comment:r.comment=I.comment);continue}(I.newlineAfterProp||Oe(b))&&i(b??h[h.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else I.found?.indent!==s.indent&&i(c,"BAD_INDENT",Et);t.atKey=!0;const C=I.end,S=b?n(t,b,I,i):e(t,C,h,null,I,i);t.schema.compat&&it(s.indent,b,i),t.atKey=!1,sn(t,r.items,S)&&i(C,"DUPLICATE_KEY","Map keys must be unique");const E=Ae(_??[],{indicator:"map-value-ind",next:v,offset:S.range[2],onError:i,parentIndent:s.indent,startOnNewline:!b||b.type==="block-scalar"});if(c=E.end,E.found){N&&(v?.type==="block-map"&&!E.hasNewline&&i(c,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),t.options.strict&&I.start<E.found.offset-1024&&i(S.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const U=v?n(t,v,E,i):e(t,c,_,null,E,i);t.schema.compat&&it(s.indent,v,i),c=U.range[2];const M=new Ee(S,U);t.options.keepSourceTokens&&(M.srcToken=p),r.items.push(M)}else{N&&i(S.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),E.comment&&(S.comment?S.comment+=`
`+E.comment:S.comment=E.comment);const U=new Ee(S);t.options.keepSourceTokens&&(U.srcToken=p),r.items.push(U)}}return f&&f<c&&i(f,"IMPOSSIBLE","Map comment with trailing content"),r.range=[s.offset,c,f??c],r}function Zn({composeNode:n,composeEmptyNode:e},t,s,i,a){const o=a?.nodeClass??ke,r=new o(t.schema);t.atRoot&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let c=s.offset,f=null;for(const{start:p,value:h}of s.items){const b=Ae(p,{indicator:"seq-item-ind",next:h,offset:c,onError:i,parentIndent:s.indent,startOnNewline:!0});if(!b.found)if(b.anchor||b.tag||h)h&&h.type==="block-seq"?i(b.end,"BAD_INDENT","All sequence items must start at the same column"):i(c,"MISSING_CHAR","Sequence item without - indicator");else{f=b.end,b.comment&&(r.comment=b.comment);continue}const _=h?n(t,h,b,i):e(t,b.end,p,null,b,i);t.schema.compat&&it(s.indent,h,i),c=_.range[2],r.items.push(_)}return r.range=[s.offset,c,f??c],r}const tt="Block collections are not allowed within flow collections",nt=n=>n&&(n.type==="block-map"||n.type==="block-seq");function Qn({composeNode:n,composeEmptyNode:e},t,s,i,a){const o=s.start.source==="{",r=o?"flow map":"flow sequence",c=a?.nodeClass??(o?fe:ke),f=new c(t.schema);f.flow=!0;const p=t.atRoot;p&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let h=s.offset+s.start.source.length;for(let N=0;N<s.items.length;++N){const C=s.items[N],{start:S,key:E,sep:U,value:M}=C,O=Ae(S,{flow:r,indicator:"explicit-key-ind",next:E??U?.[0],offset:h,onError:i,parentIndent:s.indent,startOnNewline:!1});if(!O.found){if(!O.anchor&&!O.tag&&!U&&!M){N===0&&O.comma?i(O.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${r}`):N<s.items.length-1&&i(O.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${r}`),O.comment&&(f.comment?f.comment+=`
`+O.comment:f.comment=O.comment),h=O.end;continue}!o&&t.options.strict&&Oe(E)&&i(E,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(N===0)O.comma&&i(O.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${r}`);else if(O.comma||i(O.start,"MISSING_CHAR",`Missing , between ${r} items`),O.comment){let R="";e:for(const A of S)switch(A.type){case"comma":case"space":break;case"comment":R=A.source.substring(1);break e;default:break e}if(R){let A=f.items[f.items.length-1];ct(A)&&(A=A.value??A.key),A.comment?A.comment+=`
`+R:A.comment=R,O.comment=O.comment.substring(R.length+1)}}if(!o&&!U&&!O.found){const R=M?n(t,M,O,i):e(t,O.end,U,null,O,i);f.items.push(R),h=R.range[2],nt(M)&&i(R.range,"BLOCK_IN_FLOW",tt)}else{t.atKey=!0;const R=O.end,A=E?n(t,E,O,i):e(t,R,S,null,O,i);nt(E)&&i(A.range,"BLOCK_IN_FLOW",tt),t.atKey=!1;const K=Ae(U??[],{flow:r,indicator:"map-value-ind",next:M,offset:A.range[2],onError:i,parentIndent:s.indent,startOnNewline:!1});if(K.found){if(!o&&!O.found&&t.options.strict){if(U)for(const z of U){if(z===K.found)break;if(z.type==="newline"){i(z,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}O.start<K.found.offset-1024&&i(K.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else M&&("source"in M&&M.source&&M.source[0]===":"?i(M,"MISSING_CHAR",`Missing space after : in ${r}`):i(K.start,"MISSING_CHAR",`Missing , or : between ${r} items`));const he=M?n(t,M,K,i):K.found?e(t,K.end,U,null,K,i):null;he?nt(M)&&i(he.range,"BLOCK_IN_FLOW",tt):K.comment&&(A.comment?A.comment+=`
`+K.comment:A.comment=K.comment);const Qe=new Ee(A,he);if(t.options.keepSourceTokens&&(Qe.srcToken=C),o){const z=f;sn(t,z.items,A)&&i(R,"DUPLICATE_KEY","Map keys must be unique"),z.items.push(Qe)}else{const z=new fe(t.schema);z.flow=!0,z.items.push(Qe);const kt=(he??A).range;z.range=[A.range[0],kt[1],kt[2]],f.items.push(z)}h=he?he.range[2]:K.end}}const b=o?"}":"]",[_,...v]=s.end;let I=h;if(_&&_.source===b)I=_.offset+_.source.length;else{const N=r[0].toUpperCase()+r.substring(1),C=p?`${N} must end with a ${b}`:`${N} in block collection must be sufficiently indented and end with a ${b}`;i(h,p?"MISSING_CHAR":"BAD_INDENT",C),_&&_.source.length!==1&&v.unshift(_)}if(v.length>0){const N=je(v,I,t.options.strict,i);N.comment&&(f.comment?f.comment+=`
`+N.comment:f.comment=N.comment),f.range=[s.offset,I,N.offset]}else f.range=[s.offset,I,I];return f}function st(n,e,t,s,i,a){const o=t.type==="block-map"?zn(n,e,t,s,a):t.type==="block-seq"?Zn(n,e,t,s,a):Qn(n,e,t,s,a),r=o.constructor;return i==="!"||i===r.tagName?(o.tag=r.tagName,o):(i&&(o.tag=i),o)}function es(n,e,t,s,i){const a=s.tag,o=a?e.directives.tagName(a.source,b=>i(a,"TAG_RESOLVE_FAILED",b)):null;if(t.type==="block-seq"){const{anchor:b,newlineAfterProp:_}=s,v=b&&a?b.offset>a.offset?b:a:b??a;v&&(!_||_.offset<v.offset)&&i(v,"MISSING_CHAR","Missing newline after block sequence props")}const r=t.type==="block-map"?"map":t.type==="block-seq"?"seq":t.start.source==="{"?"map":"seq";if(!a||!o||o==="!"||o===fe.tagName&&r==="map"||o===ke.tagName&&r==="seq")return st(n,e,t,i,o);let c=e.schema.tags.find(b=>b.tag===o&&b.collection===r);if(!c){const b=e.schema.knownTags[o];if(b&&b.collection===r)e.schema.tags.push(Object.assign({},b,{default:!1})),c=b;else return b?.collection?i(a,"BAD_COLLECTION_TYPE",`${b.tag} used for ${r} collection, but expects ${b.collection}`,!0):i(a,"TAG_RESOLVE_FAILED",`Unresolved tag: ${o}`,!0),st(n,e,t,i,o)}const f=st(n,e,t,i,o,c),p=c.resolve?.(f,b=>i(a,"TAG_RESOLVE_FAILED",b),e.options)??f,h=Re(p)?p:new F(p);return h.range=f.range,h.tag=o,c?.format&&(h.format=c.format),h}function an(n,e,t,s){const{value:i,type:a,comment:o,range:r}=e.type==="block-scalar"?kn(n,e,s):_n(e,n.options.strict,s),c=t?n.directives.tagName(t.source,h=>s(t,"TAG_RESOLVE_FAILED",h)):null;let f;n.options.stringKeys&&n.atKey?f=n.schema[pe]:c?f=ts(n.schema,i,c,t,s):e.type==="scalar"?f=ns(n,i,e,s):f=n.schema[pe];let p;try{const h=f.resolve(i,b=>s(t??e,"TAG_RESOLVE_FAILED",b),n.options);p=_e(h)?h:new F(h)}catch(h){const b=h instanceof Error?h.message:String(h);s(t??e,"TAG_RESOLVE_FAILED",b),p=new F(i)}return p.range=r,p.source=i,a&&(p.type=a),c&&(p.tag=c),f.format&&(p.format=f.format),o&&(p.comment=o),p}function ts(n,e,t,s,i){if(t==="!")return n[pe];const a=[];for(const r of n.tags)if(!r.collection&&r.tag===t)if(r.default&&r.test)a.push(r);else return r;for(const r of a)if(r.test?.test(e))return r;const o=n.knownTags[t];return o&&!o.collection?(n.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(i(s,"TAG_RESOLVE_FAILED",`Unresolved tag: ${t}`,t!=="tag:yaml.org,2002:str"),n[pe])}function ns({atKey:n,directives:e,schema:t},s,i,a){const o=t.tags.find(r=>(r.default===!0||n&&r.default==="key")&&r.test?.test(s))||t[pe];if(t.compat){const r=t.compat.find(c=>c.default&&c.test?.test(s))??t[pe];if(o.tag!==r.tag){const c=e.tagString(o.tag),f=e.tagString(r.tag),p=`Value may be parsed as either ${c} or ${f}`;a(i,"TAG_RESOLVE_FAILED",p,!0)}}return o}function ss(n,e,t){if(e){t===null&&(t=e.length);for(let s=t-1;s>=0;--s){let i=e[s];switch(i.type){case"space":case"comment":case"newline":n-=i.source.length;continue}for(i=e[++s];i?.type==="space";)n+=i.source.length,i=e[++s];break}}return n}const is={composeNode:on,composeEmptyNode:gt};function on(n,e,t,s){const i=n.atKey,{spaceBefore:a,comment:o,anchor:r,tag:c}=t;let f,p=!0;switch(e.type){case"alias":f=as(n,e,s),(r||c)&&s(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":f=an(n,e,c,s),r&&(f.anchor=r.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":f=es(is,n,e,t,s),r&&(f.anchor=r.source.substring(1));break;default:{const h=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;s(e,"UNEXPECTED_TOKEN",h),f=gt(n,e.offset,void 0,null,t,s),p=!1}}return r&&f.anchor===""&&s(r,"BAD_ALIAS","Anchor cannot be an empty string"),i&&n.options.stringKeys&&(!_e(f)||typeof f.value!="string"||f.tag&&f.tag!=="tag:yaml.org,2002:str")&&s(c??e,"NON_STRING_KEY","With stringKeys, all keys must be strings"),a&&(f.spaceBefore=!0),o&&(e.type==="scalar"&&e.source===""?f.comment=o:f.commentBefore=o),n.options.keepSourceTokens&&p&&(f.srcToken=e),f}function gt(n,e,t,s,{spaceBefore:i,comment:a,anchor:o,tag:r,end:c},f){const p={type:"scalar",offset:ss(e,t,s),indent:-1,source:""},h=an(n,p,r,f);return o&&(h.anchor=o.source.substring(1),h.anchor===""&&f(o,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(h.spaceBefore=!0),a&&(h.comment=a,h.range[2]=c),h}function as({options:n},{offset:e,source:t,end:s},i){const a=new dt(t.substring(1));a.source===""&&i(e,"BAD_ALIAS","Alias cannot be an empty string"),a.source.endsWith(":")&&i(e+t.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=e+t.length,r=je(s,o,n.strict,i);return a.range=[e,o,r.offset],r.comment&&(a.comment=r.comment),a}function os(n,e,{offset:t,start:s,value:i,end:a},o){const r=Object.assign({_directives:e},n),c=new $e(void 0,r),f={atKey:!1,atRoot:!0,directives:c.directives,options:c.options,schema:c.schema},p=Ae(s,{indicator:"doc-start",next:i??a?.[0],offset:t,onError:o,parentIndent:0,startOnNewline:!0});p.found&&(c.directives.docStart=!0,i&&(i.type==="block-map"||i.type==="block-seq")&&!p.hasNewline&&o(p.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),c.contents=i?on(f,i,p,o):gt(f,p.end,s,null,p,o);const h=c.contents.range[2],b=je(a,h,!1,o);return b.comment&&(c.comment=b.comment),c.range=[t,h,b.offset],c}function Ce(n){if(typeof n=="number")return[n,n+1];if(Array.isArray(n))return n.length===2?n:[n[0],n[1]];const{offset:e,source:t}=n;return[e,e+(typeof t=="string"?t.length:1)]}function xt(n){let e="",t=!1,s=!1;for(let i=0;i<n.length;++i){const a=n[i];switch(a[0]){case"#":e+=(e===""?"":s?`

`:`
`)+(a.substring(1)||" "),t=!0,s=!1;break;case"%":n[i+1]?.[0]!=="#"&&(i+=1),t=!1;break;default:t||(s=!0),t=!1}}return{comment:e,afterEmptyLine:s}}class yt{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(t,s,i,a)=>{const o=Ce(t);a?this.warnings.push(new Pt(o,s,i)):this.errors.push(new be(o,s,i))},this.directives=new qe({version:e.version||"1.2"}),this.options=e}decorate(e,t){const{comment:s,afterEmptyLine:i}=xt(this.prelude);if(s){const a=e.contents;if(t)e.comment=e.comment?`${e.comment}
${s}`:s;else if(i||e.directives.docStart||!a)e.commentBefore=s;else if(re(a)&&!a.flow&&a.items.length>0){let o=a.items[0];ct(o)&&(o=o.key);const r=o.commentBefore;o.commentBefore=r?`${s}
${r}`:s}else{const o=a.commentBefore;a.commentBefore=o?`${s}
${o}`:s}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:xt(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,s=-1){for(const i of e)yield*this.next(i);yield*this.end(t,s)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(t,s,i)=>{const a=Ce(e);a[0]+=t,this.onError(a,"BAD_DIRECTIVE",s,i)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const t=os(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,s=new be(Ce(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(s):this.doc.errors.push(s);break}case"doc-end":{if(!this.doc){const s="Unexpected doc-end without preceding document";this.errors.push(new be(Ce(e),"UNEXPECTED_TOKEN",s));break}this.doc.directives.docEnd=!0;const t=je(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){const s=this.doc.comment;this.doc.comment=s?`${s}
${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new be(Ce(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const s=Object.assign({_directives:this.directives},this.options),i=new $e(void 0,s);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),i.range=[0,t,t],this.decorate(i,!1),yield i}}}class ln{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,s=this.lineStarts.length;for(;t<s;){const a=t+s>>1;this.lineStarts[a]<e?t=a+1:s=a}if(this.lineStarts[t]===e)return{line:t+1,col:1};if(t===0)return{line:0,col:e};const i=this.lineStarts[t-1];return{line:t,col:e-i+1}}}}function de(n,e){for(let t=0;t<n.length;++t)if(n[t].type===e)return!0;return!1}function Ot(n){for(let e=0;e<n.length;++e)switch(n[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function rn(n){switch(n?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function De(n){switch(n.type){case"document":return n.start;case"block-map":{const e=n.items[n.items.length-1];return e.sep??e.start}case"block-seq":return n.items[n.items.length-1].start;default:return[]}}function ge(n){if(n.length===0)return[];let e=n.length;e:for(;--e>=0;)switch(n[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;n[++e]?.type==="space";);return n.splice(e,n.length)}function Vt(n){if(n.start.type==="flow-seq-start")for(const e of n.items)e.sep&&!e.value&&!de(e.start,"explicit-key-ind")&&!de(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,rn(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}class bt{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new qt,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const s of this.lexer.lex(e,t))yield*this.next(s);t||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}const t=Sn(e);if(t)if(t==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*this.step(),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const s=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:s,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){const t=e??this.stack.pop();if(!t)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield t;else{const s=this.peek(1);switch(t.type==="block-scalar"?t.indent="indent"in s?s.indent:0:t.type==="flow-collection"&&s.type==="document"&&(t.indent=0),t.type==="flow-collection"&&Vt(t),s.type){case"document":s.value=t;break;case"block-scalar":s.props.push(t);break;case"block-map":{const i=s.items[s.items.length-1];if(i.value){s.items.push({start:[],key:t,sep:[]}),this.onKeyLine=!0;return}else if(i.sep)i.value=t;else{Object.assign(i,{key:t,sep:[]}),this.onKeyLine=!i.explicitKey;return}break}case"block-seq":{const i=s.items[s.items.length-1];i.value?s.items.push({start:[],value:t}):i.value=t;break}case"flow-collection":{const i=s.items[s.items.length-1];!i||i.value?s.items.push({start:[],key:t,sep:[]}):i.sep?i.value=t:Object.assign(i,{key:t,sep:[]});return}default:yield*this.pop(),yield*this.pop(t)}if((s.type==="document"||s.type==="block-map"||s.type==="block-seq")&&(t.type==="block-map"||t.type==="block-seq")){const i=t.items[t.items.length-1];i&&!i.sep&&!i.value&&i.start.length>0&&Ot(i.start)===-1&&(t.indent===0||i.start.every(a=>a.type!=="comment"||a.indent<t.indent))&&(s.type==="document"?s.end=i.start:s.items.push({start:i.start}),t.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{Ot(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}const t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){const t=De(this.peek(2)),s=ge(t);let i;e.end?(i=e.end,i.push(this.sourceToken),delete e.end):i=[this.sourceToken];const a={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:s,key:e,sep:i}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){const t=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,t.value){const s="end"in t.value?t.value.end:void 0;(Array.isArray(s)?s[s.length-1]:void 0)?.type==="comment"?s?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else if(t.sep)t.sep.push(this.sourceToken);else{if(this.atIndentedComment(t.start,e.indent)){const i=e.items[e.items.length-2]?.value?.end;if(Array.isArray(i)){Array.prototype.push.apply(i,t.start),i.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const s=!this.onKeyLine&&this.indent===e.indent,i=s&&(t.sep||t.explicitKey)&&this.type!=="seq-item-ind";let a=[];if(i&&t.sep&&!t.value){const o=[];for(let r=0;r<t.sep.length;++r){const c=t.sep[r];switch(c.type){case"newline":o.push(r);break;case"space":break;case"comment":c.indent>e.indent&&(o.length=0);break;default:o.length=0}}o.length>=2&&(a=t.sep.splice(o[1]))}switch(this.type){case"anchor":case"tag":i||t.value?(a.push(this.sourceToken),e.items.push({start:a}),this.onKeyLine=!0):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"explicit-key-ind":!t.sep&&!t.explicitKey?(t.start.push(this.sourceToken),t.explicitKey=!0):i||t.value?(a.push(this.sourceToken),e.items.push({start:a,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(t.explicitKey)if(t.sep)if(t.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(de(t.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]});else if(rn(t.key)&&!de(t.sep,"newline")){const o=ge(t.start),r=t.key,c=t.sep;c.push(this.sourceToken),delete t.key,delete t.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:r,sep:c}]})}else a.length>0?t.sep=t.sep.concat(a,this.sourceToken):t.sep.push(this.sourceToken);else if(de(t.start,"newline"))Object.assign(t,{key:null,sep:[this.sourceToken]});else{const o=ge(t.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]})}else t.sep?t.value||i?e.items.push({start:a,key:null,sep:[this.sourceToken]}):de(t.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const o=this.flowScalar(this.type);i||t.value?(e.items.push({start:a,key:o,sep:[]}),this.onKeyLine=!0):t.sep?this.stack.push(o):(Object.assign(t,{key:o,sep:[]}),this.onKeyLine=!0);return}default:{const o=this.startBlockValue(e);if(o){s&&o.type!=="block-seq"&&e.items.push({start:a}),this.stack.push(o);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){const t=e.items[e.items.length-1];switch(this.type){case"newline":if(t.value){const s="end"in t.value?t.value.end:void 0;(Array.isArray(s)?s[s.length-1]:void 0)?.type==="comment"?s?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(t.start,e.indent)){const i=e.items[e.items.length-2]?.value?.end;if(Array.isArray(i)){Array.prototype.push.apply(i,t.start),i.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return;case"anchor":case"tag":if(t.value||this.indent<=e.indent)break;t.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;t.value||de(t.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return}if(this.indent>e.indent){const s=this.startBlockValue(e);if(s){this.stack.push(s);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){const t=e.items[e.items.length-1];if(this.type==="flow-error-end"){let s;do yield*this.pop(),s=this.peek(1);while(s&&s.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return;case"map-value-ind":!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const i=this.flowScalar(this.type);!t||t.value?e.items.push({start:[],key:i,sep:[]}):t.sep?this.stack.push(i):Object.assign(t,{key:i,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}const s=this.startBlockValue(e);s?this.stack.push(s):(yield*this.pop(),yield*this.step())}else{const s=this.peek(2);if(s.type==="block-map"&&(this.type==="map-value-ind"&&s.indent===e.indent||this.type==="newline"&&!s.items[s.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&s.type!=="flow-collection"){const i=De(s),a=ge(i);Vt(e);const o=e.end.splice(1,e.end.length);o.push(this.sourceToken);const r={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:a,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=r}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const t=De(e),s=ge(t);return s.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const t=De(e),s=ge(t);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return this.type!=="comment"||this.indent<=t?!1:e.every(s=>s.type==="newline"||s.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function un(n){const e=n.prettyErrors!==!1;return{lineCounter:n.lineCounter||e&&new ln||null,prettyErrors:e}}function ls(n,e={}){const{lineCounter:t,prettyErrors:s}=un(e),i=new bt(t?.addNewLine),a=new yt(e),o=Array.from(a.compose(i.parse(n)));if(s&&t)for(const r of o)r.errors.forEach(Ke(n,t)),r.warnings.forEach(Ke(n,t));return o.length>0?o:Object.assign([],{empty:!0},a.streamInfo())}function dn(n,e={}){const{lineCounter:t,prettyErrors:s}=un(e),i=new bt(t?.addNewLine),a=new yt(e);let o=null;for(const r of a.compose(i.parse(n),!0,n.length))if(!o)o=r;else if(o.options.logLevel!=="silent"){o.errors.push(new be(r.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return s&&t&&(o.errors.forEach(Ke(n,t)),o.warnings.forEach(Ke(n,t))),o}function rs(n,e,t){let s;typeof e=="function"?s=e:t===void 0&&e&&typeof e=="object"&&(t=e);const i=dn(n,t);if(!i)return null;if(i.warnings.forEach(a=>Nn(i.options.logLevel,a)),i.errors.length>0){if(i.options.logLevel!=="silent")throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:s},t))}function us(n,e,t){let s=null;if(typeof e=="function"||Array.isArray(e)?s=e:t===void 0&&e&&(t=e),typeof t=="string"&&(t=t.length),typeof t=="number"){const i=Math.round(t);t=i<1?void 0:i>8?{indent:8}:{indent:i}}if(n===void 0){const{keepUndefined:i}=t??e??{};if(!i)return}return Kt(n)&&!s?n.toString(t):new $e(n,s,t).toString(t)}const ds=Object.freeze(Object.defineProperty({__proto__:null,Alias:dt,CST:An,Composer:yt,Document:$e,Lexer:qt,LineCounter:ln,Pair:Ee,Parser:bt,Scalar:F,Schema:ze,YAMLError:In,YAMLMap:fe,YAMLParseError:be,YAMLSeq:ke,YAMLWarning:Pt,isAlias:Tn,isCollection:re,isDocument:Kt,isMap:Ut,isNode:Re,isPair:ct,isScalar:_e,isSeq:Dt,parse:rs,parseAllDocuments:ls,parseDocument:dn,stringify:us,visit:$n,visitAsync:Cn},Symbol.toStringTag,{value:"Module"})),ne={variable:{label:"Set Variable",icon:"fluent:braces-variable-24-filled"},target:{label:"Target",icon:"fluent:target-arrow-24-filled"},onFalse:{label:"On False",icon:"emojione:cross-mark"},onTrue:{label:"On True",icon:"emojione:white-heavy-check-mark"},fail:{label:"Fail",icon:""},success:{label:"Success",icon:""},text:{label:"Text",icon:"emojione-monotone:speech-balloon"},damage:{label:"Damage",icon:"emojione:anger-symbol"},condition:{label:"Branch",icon:"f7:arrow-branch"},hit:{label:"Hit",icon:""},miss:{label:"Miss",icon:""},attack:{label:"Attack Roll",icon:"twemoji:crossed-swords"},roll:{label:"Roll",icon:"twemoji:game-die"},spell:{label:"Spell",icon:"twemoji:crystal-ball"},ieffect2:{label:"Initiative Effect",icon:"twemoji:sparkles"},counter:{label:"Use Counter",icon:"twemoji:input-numbers"},remove_ieffect:{label:"Remove Initiative Effect",icon:"material-symbols:delete-forever"},attacks:{label:"Action",icon:""},buttons:{label:"Button",icon:""},save:{label:"Saving Throw",icon:"fa6-solid:recycle"},temphp:{label:"Temp HP",icon:"twemoji:shield"},check:{label:"Ability Check",icon:"twemoji:man-cartwheeling"}},at={target:{type:"target",target:"each",effects:[]},attack:{type:"attack",hit:[],miss:[]},damage:{type:"damage",damage:""},save:{type:"save",stat:"dex",dc:"10",fail:[],success:[]},temphp:{type:"temphp",amount:""},ieffect2:{type:"ieffect2",name:""},roll:{type:"roll",dice:"",name:""},text:{type:"text",text:"",title:""},variable:{type:"variable",name:"",value:""},condition:{type:"condition",condition:"",onTrue:[],onFalse:[]},counter:{type:"counter",counter:"",amount:""},check:{type:"check",ability:["athletics"]},remove_ieffect:{type:"remove_ieffect"},spell:{type:"spell",id:2102}},cs={class:"v-popper__custom-menu"},fs=["onClick"],ps=P({__name:"NodeAdder",props:{context:{}},emits:["add"],setup(n){const e=n,t=ae(()=>{const i=[...e.context].reverse();let a=!1,o="root";for(const r of i){if(r==="target"&&(a=!0),r==="buttons"){o="buttons";break}if(r==="attacks"){o="attacks";break}}return{isTargetContext:a,contextLevel:o}}),s=ae(()=>{const i=t.value;return!i.isTargetContext&&i.contextLevel==="root"?["target","roll","text","variable","condition","counter","spell"]:i.isTargetContext&&i.contextLevel==="root"?["attack","save","damage","temphp","ieffect2","roll","text","variable","condition","counter","check"]:!i.isTargetContext&&(i.contextLevel==="attacks"||i.contextLevel==="buttons")?["target","remove_ieffect","roll","text","variable","condition","counter","spell"]:i.isTargetContext&&(i.contextLevel==="attacks"||i.contextLevel==="buttons")?["attack","save","damage","temphp","ieffect2","remove_ieffect","roll","text","variable","condition","counter","check"]:[]});return(i,a)=>{const o=J("Icon"),r=J("VDropdown"),c=Fe("close-popper");return u(ne)?(m(),q(r,{key:0,distance:6,"positioning-disabled":u(le).isMobile,placement:"left"},{popper:g(()=>[l("div",cs,[a[0]||(a[0]=$(" Choose a Node to add: ")),(m(!0),w(L,null,se(s.value,f=>(m(),w("div",{key:f},[k((m(),w("button",{class:"btn",onClick:p=>i.$emit("add",f)},[d(o,{icon:u(ne)[f]?.icon,inline:!0,width:"1em",color:"rgb(128,128,128)"},null,8,["icon"]),$(" "+Z(u(ne)[f]?.label),1)],8,fs)),[[c]])]))),128))])]),default:g(()=>[a[1]||(a[1]=l("div",{role:"button",class:"container"},[l("span",{class:"icon"},"➕"),l("span",null,"Add Effect")],-1))]),_:1},8,["positioning-disabled"])):T("",!0)}}}),wt=D(ps,[["__scopeId","data-v-758cf389"]]),ms=["onClick"],hs=P({__name:"TreeNode",props:{data:{},depth:{},parentType:{},context:{}},setup(n){const e=n,t=V("metaData"),s=ae(()=>e.data.type),i=V("defaultNodes"),a=V("currentEffect"),o=V("currentContext"),r=j(!1),c=j([]),f=p=>{c.value.includes(p)?c.value=c.value.filter(h=>h!==p):c.value.push(p)};return(p,h)=>{const b=J("Icon"),_=J("font-awesome-icon"),v=J("TreeNode",!0);return u(ne)&&u(i)?(m(),w(L,{key:0},[l("p",{style:ye(`margin-left: ${(p.depth+1)*15}px; color: grey;`),onClick:h[1]||(h[1]=I=>{a.value=p.data,o.value=[...p.context,s.value]})},[d(b,{icon:u(ne)[s.value]?.icon,inline:!0,width:"1em",color:"rgb(128,128,128)"},null,8,["icon"]),$(" "+Z(u(ne)[s.value]?.label)+" ",1),d(_,{icon:["fas","pen"]}),["attack","condition","save"].includes(s.value)?(m(),w("span",{key:0,class:"collapse-button",onClick:h[0]||(h[0]=Se(I=>r.value=!r.value,["stop"]))},[r.value?(m(),q(_,{key:1,icon:["fas","chevron-right"]})):(m(),q(_,{key:0,icon:["fas","chevron-down"]}))])):T("",!0)],4),k(l("div",null,[(m(!0),w(L,null,se(p.data,(I,N)=>(m(),w(L,{key:I},[["Effects[]","Effect[]"].includes(u(t)[s.value][N])?(m(),w(L,{key:0},[["root","effects"].includes(N)?T("",!0):(m(),w("p",{key:N,style:ye(`margin-left: ${(p.depth+2)*15}px; color: white;`)},[d(b,{icon:u(ne)[N]?.icon,inline:!0,width:"1em",color:"rgb(128,128,128)"},null,8,["icon"]),$(" "+Z(u(ne)[N]?.label)+" ",1),["onTrue","onFalse","hit","miss","fail","success"].includes(N)?(m(),w("span",{key:0,class:"collapse-button",onClick:Se(C=>f(N),["stop"])},[c.value.includes(N)?(m(),q(_,{key:1,icon:["fas","chevron-right"]})):(m(),q(_,{key:0,icon:["fas","chevron-down"]}))],8,ms)):T("",!0)],4)),c.value.includes(N)?T("",!0):(m(),w(L,{key:1},[(m(!0),w(L,null,se(I,(C,S)=>(m(),q(v,{key:C,data:C,depth:p.depth+(["root","effects"].includes(N)?1:2),"parent-type":N,context:[...p.context,s.value,N,S.toString()]},null,8,["data","depth","parent-type","context"]))),128)),l("p",{style:ye(`margin-left: ${(p.depth+(["root","effects"].includes(N)?2:3))*15}px;`)},[d(wt,{context:[...p.context,s.value],onAdd:C=>I.push(u(i)[C]??{})},null,8,["context","onAdd"])],4)],64))],64)):T("",!0),N==="buttons"&&I.length>0?(m(!0),w(L,{key:1},se(I,(C,S)=>(m(),w(L,{key:C},[l("p",{style:ye(`margin-left: ${(p.depth+1)*15}px; color: white;`)},Z(u(ne)[N].label)+" ("+Z(C.label)+"): ",5),d(ot,{data:C,depth:p.depth+1,"root-type":"button",context:[...p.context,s.value,S.toString(),N]},null,8,["data","depth","context"])],64))),128)):T("",!0),N==="attacks"&&I.length>0?(m(!0),w(L,{key:2},se(I,(C,S)=>(m(),w(L,{key:C},[l("p",{style:ye(`margin-left: ${(p.depth+1)*15}px; color: white;`)},Z(u(ne)[N].label)+" ("+Z(C.name)+"): ",5),d(ot,{data:C,depth:p.depth+1,"root-type":"attack",context:[...p.context,s.value,S.toString(),N]},null,8,["data","depth","context"])],64))),128)):T("",!0)],64))),128))],512),[[En,!r.value]])],64)):T("",!0)}}}),vs=D(hs,[["__scopeId","data-v-44aa962f"]]),gs=P({__name:"TreeRoot",props:{data:{},depth:{default:0},parentType:{default:"root"},rootType:{default:"root"},context:{default:()=>["root"]}},setup(n){const e=j(null);return Ne(async()=>{const{success:t,data:s}=await ie("/api/automationMetaData");t&&(e.value=s)}),xe("metaData",e),xe("defaultNodes",at),(t,s)=>e.value?(m(),w("section",{key:0,class:me({container:t.rootType==="root"})},[(m(!0),w(L,null,se(t.data.automation??[],(i,a)=>(m(),w("div",{key:i.type},[d(vs,{data:i,depth:t.depth,"parent-type":t.parentType,context:[...t.context,a.toString()]},null,8,["data","depth","parent-type","context"])]))),128)),l("p",{style:ye(`background-color: var(--color-surface-0); margin-left: ${(t.depth+1)*15}px`)},[d(wt,{context:t.context,onAdd:s[0]||(s[0]=i=>(t.data?.automation).push(u(at)[i]??{}))},null,8,["context"])],4)],2)):T("",!0)}}),ot=D(gs,[["__scopeId","data-v-9342d9b0"]]),ys={class:"section-header"},bs=P({__name:"SectionHeader",props:{title:{}},setup(n){return(e,t)=>(m(),w("div",ys,[t[0]||(t[0]=l("hr",{class:"left"},null,-1)),t[1]||(t[1]=$()),l("span",null,Z(e.title),1),t[2]||(t[2]=$()),t[3]||(t[3]=l("hr",null,null,-1))]))}}),B=D(bs,[["__scopeId","data-v-a457c527"]]),ws={};function ks(n,e){const t=Fe("tooltip");return k((m(),w("div",{onClick:e[0]||(e[0]=Se(()=>{},["stop"]))},e[1]||(e[1]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 256 256"},[l("path",{fill:"#888888",d:"M54.8 119.49a35 35 0 0 1-5.75 8.51a35 35 0 0 1 5.75 8.51C60 147.24 60 159.83 60 172c0 25.94 1.84 32 20 32a12 12 0 0 1 0 24c-19.14 0-32.2-6.9-38.8-20.51C36 196.76 36 184.17 36 172c0-25.94-1.84-32-20-32a12 12 0 0 1 0-24c18.16 0 20-6.06 20-32c0-12.17 0-24.76 5.2-35.49C47.8 34.9 60.86 28 80 28a12 12 0 0 1 0 24c-18.16 0-20 6.06-20 32c0 12.17 0 24.76-5.2 35.49M240 116c-18.16 0-20-6.06-20-32c0-12.17 0-24.76-5.2-35.49C208.2 34.9 195.14 28 176 28a12 12 0 0 0 0 24c18.16 0 20 6.06 20 32c0 12.17 0 24.76 5.2 35.49A35 35 0 0 0 207 128a35 35 0 0 0-5.75 8.51C196 147.24 196 159.83 196 172c0 25.94-1.84 32-20 32a12 12 0 0 0 0 24c19.14 0 32.2-6.9 38.8-20.51c5.2-10.73 5.2-23.32 5.2-35.49c0-25.94 1.84-32 20-32a12 12 0 0 0 0-24"})],-1)]))),[[t,{content:"<b>AnnotatedExpression</b><br> - Variables and functions allowed<br> - Braces {} required",html:!0},void 0,{bottom:!0}]])}const ce=D(ws,[["render",ks],["__scopeId","data-v-a15976ea"]]),X=(n,e,t)=>{if(n){for(const s of e)Y(()=>n.value[s],()=>{n.value[s]||delete n.value[s]});if(t)for(const s of Object.keys(t)){const i=t[s];if(i)for(const a of i)Y(()=>n.value[s][a],()=>{console.log("triggers?",n.value[s][a],!!n.value[s][a]),(!n.value[s][a]||n.value[s][a]==="0")&&delete n.value[s][a]})}}},_s={class:"two-wide"},Ss={key:0,class:"input-wrapper"},Ns=P({__name:"NodeText",setup(n){const e=V("currentEffect");V("currentContext");const t=j([]);Ne(async()=>{const{success:i,data:a}=await ie("/api/gamedata/limiteduse");i&&(t.value=a)});const s=j(typeof e.value.text=="string");return Y(()=>s.value,()=>{s.value?e.value.text="":e.value.text={id:192,typeId:12168134}}),X(e,["title"]),(i,a)=>{const o=J("v-select");return u(e)?(m(),w(L,{key:0},[d(B,{title:"Text"}),l("div",_s,[d(y,{title:"Title",for:"title"},{default:g(()=>[k(l("input",{id:"title","onUpdate:modelValue":a[0]||(a[0]=r=>u(e).title=r),type:"text",placeholder:"Effect"},null,512),[[x,u(e).title]])]),_:1})]),d(y,{title:"Description",for:"text",style:{"margin-top":"1rem"}},{default:g(()=>[s.value?(m(),w("div",Ss,[k(l("textarea",{id:"text","onUpdate:modelValue":a[1]||(a[1]=r=>u(e).text=r),rows:"20",placeholder:"Description"},null,512),[[x,u(e).text]]),d(ce)])):(m(),q(o,{key:1,modelValue:u(e).text,"onUpdate:modelValue":a[2]||(a[2]=r=>u(e).text=r),options:t.value,label:"name","input-id":"text",reduce:r=>({id:r.id,typeId:r.typeId})},null,8,["modelValue","options","reduce"]))]),_:1}),d(y,{title:"Text Type",for:"textType",style:{"margin-top":"1rem"}},{default:g(()=>[k(l("select",{id:"textType","onUpdate:modelValue":a[3]||(a[3]=r=>s.value=r),class:"ghost"},a[4]||(a[4]=[l("option",{value:!0}," Text ",-1),l("option",{value:!1}," Ability Reference ",-1)]),512),[[Q,s.value]])]),_:1})],64)):T("",!0)}}}),As=D(Ns,[["__scopeId","data-v-04bdd8e9"]]),Is={};function Ts(n,e){const t=Fe("tooltip");return k((m(),w("div",{onClick:e[0]||(e[0]=Se(()=>{},["stop"]))},e[1]||(e[1]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},[l("path",{fill:"currentColor",d:"M5.5 8H6v.5a1 1 0 0 0 2 0V8h.5a1 1 0 0 0 0-2H8v-.5a1 1 0 0 0-2 0V6h-.5a1 1 0 0 0 0 2m-.62 11.12a1 1 0 0 0 1.41 0l.71-.71l.71.71a1 1 0 0 0 1.41 0a1 1 0 0 0 0-1.41L8.41 17l.71-.71a1 1 0 0 0-1.41-1.41l-.71.71l-.71-.71a1 1 0 0 0-1.41 1.41l.71.71l-.71.71a1 1 0 0 0 0 1.41M20 1H4a3 3 0 0 0-3 3v16a3 3 0 0 0 3 3h16a3 3 0 0 0 3-3V4a3 3 0 0 0-3-3m-9 20H4a1 1 0 0 1-1-1v-7h8Zm0-10H3V4a1 1 0 0 1 1-1h7Zm10 9a1 1 0 0 1-1 1h-7v-8h8Zm0-9h-8V3h7a1 1 0 0 1 1 1Zm-5.5 5.5h3a1 1 0 0 0 0-2h-3a1 1 0 0 0 0 2m3-10.5h-3a1 1 0 0 0 0 2h3a1 1 0 0 0 0-2m-3 13.5h3a1 1 0 0 0 0-2h-3a1 1 0 0 0 0 2"})],-1)]))),[[t,{content:"<b>IntExpression</b><br> - Variables and functions allowed<br> - No braces {} required<br>- Must evaluate to a number/boolean<br>- Dice are not allowed",html:!0},void 0,{bottom:!0}]])}const G=D(Is,[["render",Ts],["__scopeId","data-v-66e96c8c"]]),$s={class:"input-wrapper"},Cs=["onUpdate:modelValue"],Es=P({__name:"HigherLevels",props:Rt({isIntExpression:{type:Boolean,default:!1}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=jt(n,"modelValue");return(t,s)=>(m(),w("div",null,[s[2]||(s[2]=$(" For use with the -l argument. ")),l("details",null,[s[1]||(s[1]=l("summary",null," Expand ",-1)),l("ol",null,[(m(),w(L,null,se(9,i=>l("li",{key:i},[l("div",$s,[k(l("input",{"onUpdate:modelValue":a=>e.value[i]=a,type:"text"},null,8,Cs),[[x,e.value[i]]]),s[0]||(s[0]=$()),t.isIntExpression?(m(),q(G,{key:0})):T("",!0)])])),64))])])]))}}),Ze=D(Es,[["__scopeId","data-v-bd14a387"]]),xs={class:"two-wide"},Os={class:"input-wrapper"},Vs={class:"two-wide"},Ls={class:"input-wrapper"},Bs=P({__name:"NodeVariable",setup(n){const e=V("currentEffect");return V("currentContext"),Y(()=>e.value?.higher,()=>{for(const t in e.value.higher){const s=Number.parseInt(t);e.value.higher[s]===""&&delete e.value.higher[s]}},{deep:!0}),He(()=>{Object.values(e.value.higher||{}).some(t=>t!=="")||delete e.value.higher}),Object.hasOwn(e.value,"higher")||(e.value.higher={}),X(e,["onError"]),(t,s)=>u(e)?(m(),w(L,{key:0},[d(B,{title:"Set Variable"}),l("div",xs,[d(y,{title:"Name*",for:"name"},{default:g(()=>[k(l("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=i=>u(e).name=i),type:"text",class:me({required:u(e).name.length===0})},null,2),[[x,u(e).name]])]),_:1})]),d(y,{title:"Value*",for:"value"},{default:g(()=>[l("div",Os,[k(l("input",{id:"value","onUpdate:modelValue":s[1]||(s[1]=i=>u(e).value=i),type:"text",class:me({required:u(e).value.length===0})},null,2),[[x,u(e).value]]),s[4]||(s[4]=$()),d(G)])]),_:1}),d(B,{title:"Additional Options"}),l("div",Vs,[d(y,{title:"On Error",for:"error"},{default:g(()=>[l("div",Ls,[k(l("input",{id:"error","onUpdate:modelValue":s[2]||(s[2]=i=>u(e).onError=i),type:"text"},null,512),[[x,u(e).onError]]),s[5]||(s[5]=$()),d(G)])]),_:1}),d(y,{title:"At higher levels",for:"higherLevels"},{default:g(()=>[d(Ze,{modelValue:u(e).higher,"onUpdate:modelValue":s[3]||(s[3]=i=>u(e).higher=i),"is-int-expression":""},null,8,["modelValue"])]),_:1})])],64)):T("",!0)}}),Us=D(Bs,[["__scopeId","data-v-bf1eebb0"]]),ue=Number.isNaN,Ds=P({components:{LabelledComponent:y},props:{isClearable:{type:Boolean,required:!1,default:!1},min:{type:Number,default:0},max:{type:Number,default:Number.POSITIVE_INFINITY},step:{type:Number,required:!1,default:5},title:{type:String,required:!0},modelValue:{type:Number,default:Number.NaN},labelId:{type:String,required:!1,default:""}},emits:["update:modelValue"],data(){return{value:Number.NaN}},computed:{increasable(){return this.value==null?!0:ue(this.value)||this.value<this.max},decreasable(){return this.value==null?!0:ue(this.value)||this.value>this.min},placeholder(){return this.isClearable?"Override":""}},watch:{modelValue:{immediate:!0,handler(n,e){!(ue(n)&&typeof e>"u")&&n!==this.value&&this.setValue(n)}}},methods:{isNaN:ue,change(n){this.setValue(n?.target.value)},decrease(){if(this.decreasable){let{value:n}=this;if(n==null){this.setValue(0);return}ue(n)&&(n=0),this.setValue(n-this.step)}},increase(){if(this.increasable){let{value:n}=this;if(n==null){this.setValue(0);return}ue(n)&&(n=0),this.setValue(n+this.step)}},setValue(n){if(n==null){const s=this.value,i=null;this.value=i,this.$emit("update:modelValue",i,s);return}const e=this.value;let t=typeof n!="number"?Number.parseFloat(n):n;ue(t)||this.min<=this.max&&(t=Math.min(this.max,Math.max(this.min,t))),this.value=t,t===e&&(this.$refs.input.value=String(t)),this.$emit("update:modelValue",t,e)},clear(){this.setValue(null)}}}),Ms={class:"quantity"},Ps=["id","value","name","min","max","step"],qs={class:"quantity-nav"},Ks=["aria-label"],Rs=["aria-label"],js=["aria-label"];function Fs(n,e,t,s,i,a){const o=J("font-awesome-icon"),r=J("LabelledComponent");return m(),q(r,{title:n.title,for:n.labelId},{default:g(()=>[xn(n.$slots,"default",{},void 0,!0),l("div",Ms,[l("input",{id:n.labelId,ref:"input",value:isNaN(n.value)?"":n.value,type:"number",name:n.title,min:n.min,max:n.max,step:n.step,inputmode:"numeric",onChange:e[0]||(e[0]=(...c)=>n.change&&n.change(...c))},null,40,Ps),l("div",qs,[l("div",{class:"quantity-button quantity-up","aria-label":`Increase ${n.title} by ${n.step}`,onClick:e[1]||(e[1]=Se((...c)=>n.increase&&n.increase(...c),["prevent"]))}," + ",8,Ks),l("div",{class:"quantity-button quantity-down","aria-label":`Decrease ${n.title} by ${n.step}`,onClick:e[2]||(e[2]=Se((...c)=>n.decrease&&n.decrease(...c),["prevent"]))}," - ",8,Rs)]),n.isClearable?(m(),w("span",{key:0,class:"delete-button","aria-label":`Clear override of ${n.title}`,onClick:e[3]||(e[3]=(...c)=>n.clear&&n.clear(...c))},[d(o,{icon:["fas","trash"]})],8,js)):T("",!0)])]),_:3},8,["title","for"])}const Hs=D(Ds,[["render",Fs],["__scopeId","data-v-26ef504d"]]),Gs={class:"two-wide"},Ys={key:0,value:"all"},Ws=["value"],Js={key:2,value:"parent"},Xs={key:3,value:"children"},zs={class:"two-wide"},Zs=P({__name:"NodeTarget",setup(n){const e=V("currentEffect"),t=V("currentContext");Object.hasOwn(e.value,"sortBy")||(e.value.sortBy="user_input"),Y(()=>e.value?.sortBy,()=>{e.value?.sortBy==="user_input"&&delete e.value.sortBy});const s=ae(()=>t.value.includes("buttons")),i=ae(()=>t.value.includes("attacks"));Y(()=>e.value?.target,()=>{e.value?.target||(e.value.target=1)});const a=ae(()=>s.value&&i.value&&t.value.indexOf("attacks")>t.value.indexOf("buttons")?!0:!s.value);return(o,r)=>u(e)?(m(),w(L,{key:0},[d(B,{title:"Target"}),l("div",Gs,[d(y,{title:"Target",for:"target"},{default:g(()=>[k(l("select",{id:"target","onUpdate:modelValue":r[0]||(r[0]=c=>u(e).target=c),title:"Target",class:"ghost"},[a.value?(m(),w("option",Ys," All ")):T("",!0),r[3]||(r[3]=l("option",{value:"self"}," Caster ",-1)),s.value?T("",!0):(m(),w("option",{key:1,value:Number(u(e).target)?u(e).target:1}," Position ",8,Ws)),i.value?(m(),w("option",Js," Parent ")):T("",!0),i.value?(m(),w("option",Xs," Children ")):T("",!0)],512),[[Q,u(e).target]])]),_:1}),Number(u(e).target)?(m(),q(Hs,{key:0,modelValue:u(e).target,"onUpdate:modelValue":r[1]||(r[1]=c=>u(e).target=c),title:"Target Position",min:1,step:1,"is-clearable":!1},null,8,["modelValue"])):T("",!0)]),d(B,{title:"Additional Options"}),l("div",zs,[d(y,{title:"Sort Targets By",for:"sortTargetsBy"},{default:g(()=>[k(l("select",{id:"sortTargetBy","onUpdate:modelValue":r[2]||(r[2]=c=>u(e).sortBy=c),placeholder:"User Input",title:"User input",class:"ghost"},r[4]||(r[4]=[l("option",{value:"user_input"}," User Input ",-1),l("option",{value:"hp_asc"}," HP Ascending ",-1),l("option",{value:"hp_desc"}," HP Desc ",-1)]),512),[[Q,u(e).sortBy]])]),_:1})])],64)):T("",!0)}}),Qs=D(Zs,[["__scopeId","data-v-ea21342d"]]),ei={class:"two-wide"},ti=P({__name:"NodeRemoveIEffect",setup(n){const e=V("currentEffect");return V("currentContext"),X(e,["removeParent"]),(t,s)=>u(e)?(m(),w(L,{key:0},[d(B,{title:"Remove IEffect"}),s[2]||(s[2]=l("span",null,"Remove IEffect only has optional options.",-1)),d(B,{title:"Additional Options"}),l("div",ei,[d(y,{title:"Remove Parent",for:"removeParent"},{default:g(()=>[k(l("select",{id:"removeParent","onUpdate:modelValue":s[0]||(s[0]=i=>u(e).removeParent=i),class:"ghost"},s[1]||(s[1]=[l("option",{value:null}," Never ",-1),l("option",{value:"always"}," Always ",-1),l("option",{value:"if_no_children"}," If No Children ",-1)]),512),[[Q,u(e).removeParent]])]),_:1})])],64)):T("",!0)}}),ni=D(ti,[["__scopeId","data-v-2945c309"]]),si={class:"two-wide"},ii=["value"],ai={class:"two-wide"},oi=P({__name:"NodeSave",setup(n){const e=V("currentEffect");return V("currentContext"),Object.hasOwn(e.value,"adv")||(e.value.adv=0),Y(()=>e.value?.adv,()=>{e.value?.adv===0&&delete e.value.adv}),X(e,["dc"]),(t,s)=>u(e)?(m(),w(L,{key:0},[d(B,{title:"Saving Throw"}),l("div",si,[d(y,{title:"Save Stat",for:"saveStat"},{default:g(()=>[k(l("select",{id:"saveStat","onUpdate:modelValue":s[0]||(s[0]=i=>u(e).stat=i),title:"Saving throw stat",class:"ghost"},[(m(!0),w(L,null,se(u(Bn),(i,a)=>(m(),w("option",{key:a,value:a},Z(i),9,ii))),128))],512),[[Q,u(e).stat]])]),_:1})]),d(B,{title:"Additional Options"}),d(y,{title:"DC",for:"dc"},{default:g(()=>[k(l("input",{id:"dc","onUpdate:modelValue":s[1]||(s[1]=i=>u(e).dc=i),type:"text",placeholder:"DC (Optional)"},null,512),[[x,u(e).dc]])]),_:1}),l("div",ai,[d(y,{title:"Advantage",for:"advantage"},{default:g(()=>[k(l("select",{id:"sortTargetBy","onUpdate:modelValue":s[2]||(s[2]=i=>u(e).adv=i),placeholder:"Advantage (optional)",title:"Advantage",class:"ghost"},s[3]||(s[3]=[l("option",{value:0}," Flat ",-1),l("option",{value:1}," Advantage ",-1),l("option",{value:-1}," Disadvantage ",-1)]),512),[[Q,u(e).adv]])]),_:1})])],64)):T("",!0)}}),li=D(oi,[["__scopeId","data-v-bb39a356"]]),ri={class:"input-wrapper"},ui={class:"two-wide"},di={key:0,value:"custom"},ci=["value"],fi={class:"input-wrapper"},pi=P({__name:"NodeAttack",setup(n){const e=V("currentEffect");V("currentContext"),Y(()=>e?.value?.attackBonus,()=>{e?.value?.attackBonus===""&&delete e?.value.attackBonus}),e.value&&!Object.hasOwn(e.value,"adv")&&(e.value.adv="0"),On(()=>{e?.value?.adv==="0"&&delete e?.value.adv});const t=j(!1),s=()=>{e?.value.adv==="custom"?(t.value=!0,e.value.adv=""):t.value=!1};return X(e,["attackBonus"]),(i,a)=>u(e)?(m(),w(L,{key:0},[d(B,{title:"Attack"}),d(y,{title:"Attack Bonus",for:"attackBonus"},{default:g(()=>[l("div",ri,[k(l("input",{id:"attackBonus","onUpdate:modelValue":a[0]||(a[0]=o=>u(e).attackBonus=o),type:"text"},null,512),[[x,u(e).attackBonus]]),a[3]||(a[3]=$()),d(G)])]),_:1}),d(B,{title:"Additional Options"}),l("div",ui,[d(y,{title:"Advantage (optional)",for:"advantage"},{default:g(()=>[k(l("select",{id:"advantage","onUpdate:modelValue":a[1]||(a[1]=o=>u(e).adv=o),title:"Advantage",class:"ghost",onChange:s},[a[4]||(a[4]=l("option",{value:"0"}," Flat ",-1)),a[5]||(a[5]=l("option",{value:"1"}," Advantage ",-1)),a[6]||(a[6]=l("option",{value:"2"}," Elven Advantage ",-1)),a[7]||(a[7]=l("option",{value:"-1"}," Disadvantage ",-1)),t.value?(m(),w("option",{key:1,value:u(e).adv}," Custom ",8,ci)):(m(),w("option",di," Custom "))],544),[[Q,u(e).adv]])]),_:1}),t.value?(m(),q(y,{key:0,title:"Custom Advantage",for:"customAdvantage"},{default:g(()=>[l("div",fi,[k(l("input",{id:"customAdvantage","onUpdate:modelValue":a[2]||(a[2]=o=>u(e).adv=o),type:"text"},null,512),[[x,u(e).adv]]),a[8]||(a[8]=$()),d(G)])]),_:1})):T("",!0)])],64)):T("",!0)}}),mi=D(pi,[["__scopeId","data-v-5a100e06"]]),hi={class:"input-wrapper"},vi={class:"two-wide"},gi=P({__name:"NodeDamage",setup(n){const e=V("currentEffect");return V("currentContext"),Y(()=>e?.value.higher,()=>{for(const t in e?.value.higher){const s=Number.parseInt(t);e?.value.higher[s]===""&&delete e?.value.higher[s]}},{deep:!0}),He(()=>{Object.values(e?.value.higher||{}).some(t=>t!=="")||delete e?.value.higher}),Object.hasOwn(e.value,"higher")||(e.value.higher={}),X(e,["overheal","cantripScale","fixedValue"]),(t,s)=>u(e)?(m(),w(L,{key:0},[d(B,{title:"Damage"}),d(y,{title:"Damage",for:"damage"},{default:g(()=>[l("div",hi,[k(l("textarea",{id:"damage","onUpdate:modelValue":s[0]||(s[0]=i=>u(e).damage=i),type:"text"},null,512),[[x,u(e).damage]]),d(ce)])]),_:1}),d(B,{title:"Additional Options"}),l("div",vi,[d(y,{title:"Allow Overheal",for:"overheal"},{default:g(()=>[l("span",null,[k(l("input",{id:"overheal","onUpdate:modelValue":s[1]||(s[1]=i=>u(e).overheal=i),type:"checkbox"},null,512),[[H,u(e).overheal]]),s[5]||(s[5]=$()),s[6]||(s[6]=l("label",{for:"overheal"},"Whether this damage should allow a target to exceed its hit point maximum.",-1))])]),_:1}),d(y,{title:"Scales like Cantrip",for:"cantripScale"},{default:g(()=>[l("span",null,[k(l("input",{id:"cantripScale","onUpdate:modelValue":s[2]||(s[2]=i=>u(e).cantripScale=i),type:"checkbox"},null,512),[[H,u(e).cantripScale]]),s[7]||(s[7]=$()),s[8]||(s[8]=l("label",{for:"cantripScale"}," Whether this roll should scale like a cantrip. ",-1))])]),_:1}),d(y,{title:"Fixed value",for:"fixedValue"},{default:g(()=>[l("span",null,[k(l("input",{id:"fixedValue","onUpdate:modelValue":s[3]||(s[3]=i=>u(e).fixedValue=i),type:"checkbox"},null,512),[[H,u(e).fixedValue]]),s[9]||(s[9]=$()),s[10]||(s[10]=l("label",{for:"fixedValue"},[$(" Whether this roll should ignore the "),l("span",{style:{display:"inline-block"}},"-d"),$(" argument and damage bonus effects.")],-1))])]),_:1}),d(y,{title:"At higher levels",for:"higherLevels"},{default:g(()=>[d(Ze,{modelValue:u(e).higher,"onUpdate:modelValue":s[4]||(s[4]=i=>u(e).higher=i)},null,8,["modelValue"])]),_:1})]),$(" "+Z(u(e)),1)],64)):T("",!0)}}),yi=D(gi,[["__scopeId","data-v-f7a91b93"]]),bi={class:"input-wrapper"},wi={key:0,class:"delay",style:{color:"var(--color-warning)","font-size":"small"}},ki={class:"two-wide"},_i=P({__name:"NodeCondition",setup(n){const e=V("currentEffect");V("currentContext");const t=ae(()=>e?.value.condition.includes(" = ")||e?.value.condition.includes("=")&&!e?.value.condition.includes("==")&&e?.value.condition[e?.value.condition.length-1]!=="=");return X(e,["errorBehaviour"]),(s,i)=>u(e)?(m(),w(L,{key:0},[d(B,{title:"Branch"}),d(y,{title:"Condition*",for:"condition"},{default:g(()=>[l("div",bi,[k(l("input",{id:"condition","onUpdate:modelValue":i[0]||(i[0]=a=>u(e).condition=a),type:"text",class:me({required:u(e).condition.length===0,warning:t.value})},null,2),[[x,u(e).condition]]),i[2]||(i[2]=$()),d(G),t.value?(m(),w("span",wi," Equality checks should use double ==.")):T("",!0)])]),_:1}),d(B,{title:"Additional Options"}),l("div",ki,[d(y,{title:"Error Behaviour",for:"error"},{default:g(()=>[k(l("select",{id:"error","onUpdate:modelValue":i[1]||(i[1]=a=>u(e).errorBehaviour=a),title:"Error Behaviour",class:"ghost"},i[3]||(i[3]=[l("option",{value:"true"}," Treat as True ",-1),l("option",{value:"false"}," Treat as False ",-1),l("option",{value:"both"}," Run both ",-1),l("option",{value:"neither"}," Neither ",-1),l("option",{value:"raise"}," Raise ",-1)]),512),[[Q,u(e).errorBehaviour]])]),_:1})])],64)):T("",!0)}}),Si=D(_i,[["__scopeId","data-v-efaaf5d9"]]),Ni={class:"input-wrapper"},Ai={class:"two-wide"},Ii=P({__name:"NodeTempHP",setup(n){const e=V("currentEffect");return V("currentContext"),Y(()=>e.value?.higher,()=>{for(const t in e.value.higher){const s=Number.parseInt(t);e.value.higher[s]===""&&delete e.value.higher[s]}},{deep:!0}),He(()=>{Object.values(e.value.higher||{}).some(t=>t!=="")||delete e.value.higher}),Object.hasOwn(e.value,"higher")||(e.value.higher={}),X(e,["cantripScale"]),(t,s)=>u(e)?(m(),w(L,{key:0},[d(B,{title:"Temp HP"}),d(y,{title:"Amount",for:"amount"},{default:g(()=>[l("div",Ni,[k(l("input",{id:"amount","onUpdate:modelValue":s[0]||(s[0]=i=>u(e).amount=i),type:"text"},null,512),[[x,u(e).amount]]),d(ce)])]),_:1}),d(B,{title:"Additional Options"}),l("div",Ai,[d(y,{title:"Scales like Cantrip",for:"cantripScale"},{default:g(()=>[l("span",null,[k(l("input",{id:"cantripScale","onUpdate:modelValue":s[1]||(s[1]=i=>u(e).cantripScale=i),type:"checkbox"},null,512),[[H,u(e).cantripScale]]),s[3]||(s[3]=$()),s[4]||(s[4]=l("label",{for:"cantripScale"}," Whether this roll should scale like a cantrip. ",-1))])]),_:1}),d(y,{title:"At higher levels",for:"higherLevels"},{default:g(()=>[d(Ze,{modelValue:u(e).higher,"onUpdate:modelValue":s[2]||(s[2]=i=>u(e).higher=i)},null,8,["modelValue"])]),_:1})])],64)):T("",!0)}}),Ti=D(Ii,[["__scopeId","data-v-3df05e41"]]),$i={class:"two-wide"},Ci={class:"input-wrapper"},Ei={class:"two-wide"},xi={class:"two-wide"},Oi=P({__name:"NodeRoll",setup(n){const e=V("currentEffect");return V("currentContext"),Y(()=>e?.value.higher,()=>{for(const t in e.value.higher){const s=Number.parseInt(t);e.value.higher[s]===""&&delete e.value.higher[s]}},{deep:!0}),He(()=>{Object.values(e.value.higher||{}).some(t=>t!=="")||delete e.value.higher}),Object.hasOwn(e.value,"higher")||(e.value.higher={}),X(e,["cantripScale","hidden","displayName","fixedValue"]),(t,s)=>u(e)?(m(),w(L,{key:0},[d(B,{title:"Roll"}),l("div",$i,[d(y,{title:"Name*",for:"name"},{default:g(()=>[k(l("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=i=>u(e).name=i),type:"text"},null,512),[[x,u(e).name]])]),_:1}),d(y,{title:"Dice*",for:"dice"},{default:g(()=>[l("div",Ci,[k(l("input",{id:"dice","onUpdate:modelValue":s[1]||(s[1]=i=>u(e).dice=i),type:"text"},null,512),[[x,u(e).dice]]),d(ce)])]),_:1})]),d(B,{title:"Additional Options"}),l("div",Ei,[d(y,{title:"Display name",for:"displayName"},{default:g(()=>[k(l("input",{id:"displayName","onUpdate:modelValue":s[2]||(s[2]=i=>u(e).displayName=i),type:"text"},null,512),[[x,u(e).displayName]])]),_:1}),d(y,{title:"Fixed value",for:"fixedValue"},{default:g(()=>[l("span",null,[k(l("input",{id:"fixedValue","onUpdate:modelValue":s[3]||(s[3]=i=>u(e).fixedValue=i),type:"checkbox"},null,512),[[H,u(e).fixedValue]]),s[7]||(s[7]=$()),s[8]||(s[8]=l("label",{for:"fixedValue"},[$(" Whether this roll should ignore the "),l("span",{style:{display:"inline-block"}},"-d"),$(" argument and damage bonus effects.")],-1))])]),_:1}),d(y,{title:"Hidden",for:"hidden"},{default:g(()=>[l("span",null,[k(l("input",{id:"hidden","onUpdate:modelValue":s[4]||(s[4]=i=>u(e).hidden=i),type:"checkbox"},null,512),[[H,u(e).hidden]]),s[9]||(s[9]=$()),s[10]||(s[10]=l("label",{for:"overheal"},"Whether to display the roll in the Meta field, or to apply any bonuses from the -d argument.",-1))])]),_:1})]),d(B,{title:"Spell Options"}),l("div",xi,[d(y,{title:"At higher levels",for:"higherLevels"},{default:g(()=>[d(Ze,{modelValue:u(e).higher,"onUpdate:modelValue":s[5]||(s[5]=i=>u(e).higher=i)},null,8,["modelValue"])]),_:1}),d(y,{title:"Scales like Cantrip",for:"cantripScale"},{default:g(()=>[l("span",null,[k(l("input",{id:"cantripScale","onUpdate:modelValue":s[6]||(s[6]=i=>u(e).cantripScale=i),type:"checkbox"},null,512),[[H,u(e).cantripScale]]),s[11]||(s[11]=$()),s[12]||(s[12]=l("label",{for:"cantripScale"}," Whether this roll should scale like a cantrip. ",-1))])]),_:1})])],64)):T("",!0)}}),Vi=D(Oi,[["__scopeId","data-v-b0eee3b3"]]),Li={class:"two-wide"},Bi={class:"input-wrapper"},Ui={class:"input-wrapper"},Di={class:"two-wide"},Mi=P({__name:"NodeUseCounter",setup(n){const e=V("currentEffect");V("currentContext");const t=j("cc");Y(t,i=>{i==="cc"?e.value.counter="":i==="ss"?e.value.counter={slot:1}:i==="abi"&&(e.value.counter={id:0,typeId:0})},{immediate:!0}),Object.hasOwn(e.value,"errorBehaviour")||(e.value.errorBehaviour="warn"),Y(()=>e.value?.errorBehaviour,()=>{e.value?.errorBehaviour==="warn"&&delete e.value.errorBehaviour});const s=j();return Ne(async()=>{const{data:i}=await ie("https://api.avrae.io/gamedata/limiteduse");i&&(s.value=i.data.filter(a=>a.type==="Limited Use"),console.log(s.value))}),X(e,["allowOverflow","fixedValue"]),(i,a)=>u(e)?(m(),w(L,{key:0},[a[15]||(a[15]=l("h3",null," Use Counter Node",-1)),l("div",Li,[d(y,{title:"Counter Type",for:"counterType"},{default:g(()=>[k(l("select",{id:"counterType","onUpdate:modelValue":a[0]||(a[0]=o=>t.value=o),title:"Error Behaviour",class:"ghost"},a[7]||(a[7]=[l("option",{value:"cc"}," Custom Counter ",-1),l("option",{value:"ss"}," Spell Slot ",-1),l("option",{value:"abi"}," Ability ",-1)]),512),[[Q,t.value]])]),_:1}),t.value==="cc"?(m(),q(y,{key:0,title:"Counter Name*",for:"counterName"},{default:g(()=>[k(l("input",{id:"counterName","onUpdate:modelValue":a[1]||(a[1]=o=>u(e).counter=o),type:"text",class:me({required:u(e).counter.length===0})},null,2),[[x,u(e).counter]])]),_:1})):T("",!0),t.value==="ss"?(m(),q(y,{key:1,title:"Slot Level*",for:"slotLevel"},{default:g(()=>[l("div",Bi,[k(l("input",{id:"slotLevel","onUpdate:modelValue":a[2]||(a[2]=o=>u(e).counter.slot=o),type:"text",class:me({required:u(e).counter.slot.toString().length===0})},null,2),[[x,u(e).counter.slot]]),a[8]||(a[8]=$()),d(G)])]),_:1})):T("",!0),t.value==="abi"?(m(),q(y,{key:2,title:"Ability Reference",for:"abilityReference"},{default:g(()=>a[9]||(a[9]=[l("span",{style:{color:"var(--color-destructive)"}}," Ability Reference is not implemented in this editor.",-1)])),_:1})):T("",!0),t.value!=="abi"?(m(),q(y,{key:3,title:"Amount",for:"amount"},{default:g(()=>[l("div",Ui,[k(l("input",{id:"amount","onUpdate:modelValue":a[3]||(a[3]=o=>u(e).amount=o),type:"text"},null,512),[[x,u(e).amount]]),d(G)])]),_:1})):T("",!0)]),a[16]||(a[16]=l("hr",null,null,-1)),a[17]||(a[17]=l("h4",null," Additional Options",-1)),l("div",Di,[d(y,{title:"Allow Overflow",for:"allowOverflow"},{default:g(()=>[l("span",null,[k(l("input",{id:"allowOverflow","onUpdate:modelValue":a[4]||(a[4]=o=>u(e).allowOverflow=o),type:"checkbox"},null,512),[[H,u(e).allowOverflow]]),a[10]||(a[10]=$()),a[11]||(a[11]=l("label",{for:"allowOverflow"}," If False, attempting to overflow/underflow a counter (i.e. use more charges than available or add charges exceeding max) will error instead of clipping to bounds. ",-1))])]),_:1}),d(y,{title:"Fixed value",for:"fixedValue"},{default:g(()=>[l("span",null,[k(l("input",{id:"fixedValue","onUpdate:modelValue":a[5]||(a[5]=o=>u(e).fixedValue=o),type:"checkbox"},null,512),[[H,u(e).fixedValue]]),a[12]||(a[12]=$()),a[13]||(a[13]=l("label",{for:"fixedValue"},[$(" Whether this roll should ignore the "),l("span",{style:{display:"inline-block"}},"-d"),$(" argument and damage bonus effects.")],-1))])]),_:1}),d(y,{title:"Error Behaviour",for:"error"},{default:g(()=>[k(l("select",{id:"error","onUpdate:modelValue":a[6]||(a[6]=o=>u(e).errorBehaviour=o),title:"Error Behaviour",class:"ghost"},a[14]||(a[14]=[l("option",{value:"warn"}," Warn ",-1),l("option",{value:"raise"}," Raise ",-1),l("option",{value:"ignore"}," Ignore ",-1)]),512),[[Q,u(e).errorBehaviour]])]),_:1})])],64)):T("",!0)}}),Pi=D(Mi,[["__scopeId","data-v-13e12e00"]]),qi={class:"two-wide"},Ki=["value"],Ri={class:"two-wide"},ji={class:"input-wrapper"},Fi={class:"input-wrapper"},Hi={class:"input-wrapper"},Gi=P({__name:"NodeSpell",setup(n){const e=V("currentEffect");V("currentContext");const t=j([]);return Ne(async()=>{const{success:s,data:i}=await ie("https://api.avrae.io/gamedata/spells");if(s){const a=[];for(const o of Object.entries(i.data))a.push({label:o[0],id:o[1]});t.value=a}}),X(e,["level","attackBonus","castingMod","parent"]),(s,i)=>{const a=J("v-select");return u(e)?(m(),w(L,{key:0},[d(B,{title:"Cast Spell"}),d(y,{title:"Spell",for:"spell"},{default:g(()=>[d(a,{modelValue:u(e).id,"onUpdate:modelValue":i[0]||(i[0]=o=>u(e).id=o),options:t.value,"input-id":"spell",label:"label",reduce:o=>o.id,clearable:!1,placeholder:"(default level)"},null,8,["modelValue","options","reduce"])]),_:1}),d(B,{title:"Additional Options"}),l("div",qi,[d(y,{title:"Level",for:"level"},{default:g(()=>[k(l("select",{"onUpdate:modelValue":i[1]||(i[1]=o=>u(e).level=o),class:"ghost"},[i[6]||(i[6]=l("option",{value:null}," (default level) ",-1)),(m(),w(L,null,se(10,o=>l("option",{key:o,value:o-1},Z(o-1),9,Ki)),64))],512),[[Q,u(e).level]])]),_:1}),d(y,{title:"Parent Effect",for:"parent"},{default:g(()=>[k(l("input",{id:"parent","onUpdate:modelValue":i[2]||(i[2]=o=>u(e).parent=o),type:"text"},null,512),[[x,u(e).parent]])]),_:1})]),d(B,{title:"Caster Spellcasting Override"}),l("div",Ri,[d(y,{title:"DC",for:"dc"},{default:g(()=>[l("div",ji,[k(l("input",{id:"dc","onUpdate:modelValue":i[3]||(i[3]=o=>u(e).dc=o),type:"text"},null,512),[[x,u(e).dc]]),d(G)])]),_:1}),d(y,{title:"Attack Bonus",for:"attackBonus"},{default:g(()=>[l("div",Fi,[k(l("input",{id:"attackBonus","onUpdate:modelValue":i[4]||(i[4]=o=>u(e).attackBonus=o),type:"text"},null,512),[[x,u(e).attackBonus]]),d(G)])]),_:1}),d(y,{title:"Casting Modifier",for:"castingMod"},{default:g(()=>[l("div",Hi,[k(l("input",{id:"castingMod","onUpdate:modelValue":i[5]||(i[5]=o=>u(e).castingMod=o),type:"text"},null,512),[[x,u(e).castingMod]]),d(G)])]),_:1})])],64)):T("",!0)}}}),Yi=D(Gi,[["__scopeId","data-v-afdd9c63"]]),W="annotatedstring",oe="intexpression",Me=[{label:"Bludgeoning",value:"bludgeoning"},{label:"Piercing",value:"piercing"},{label:"Slashing",value:"slashing"},{label:"Acid",value:"acid"},{label:"Cold",value:"cold"},{label:"Fire",value:"fire"},{label:"Force",value:"force"},{label:"Lightning",value:"lightning"},{label:"Necrotic",value:"necrotic"},{label:"Poison",value:"poison"},{label:"Psychic",value:"psychic"},{label:"Radiant",value:"radiant"},{label:"Thunder",value:"thunder"}],Lt=[{label:"All",value:"all"},{label:"Strength",value:"str"},{label:"Dexterity",value:"dex"},{label:"Constitution",value:"con"},{label:"Intelligence",value:"int"},{label:"Wisdom",value:"wis"},{label:"Charisma",value:"cha"}],Bt=[{label:"All",value:"all"},{label:"Acrobatics",value:"acrobatics"},{label:"Animal Handling",value:"animalHandling"},{label:"Arcana",value:"arcana"},{label:"Athletics",value:"athletics"},{label:"Deception",value:"deception"},{label:"History",value:"history"},{label:"Initiative",value:"initiative"},{label:"Insight",value:"insight"},{label:"Intimidation",value:"intimidation"},{label:"Investigation",value:"investigation"},{label:"Medicine",value:"medicine"},{label:"Nature",value:"nature"},{label:"Perception",value:"perception"},{label:"Performance",value:"performance"},{label:"Persuasion",value:"persuasion"},{label:"Religion",value:"religion"},{label:"Sleight of Hand",value:"sleightOfHand"},{label:"Stealth",value:"stealth"},{label:"Survival",value:"survival"},{label:"Strength",value:"strength"},{label:"Dexterity",value:"dexterity"},{label:"Constitution",value:"constitution"},{label:"Intelligence",value:"intelligence"},{label:"Wisdom",value:"wisdom"},{label:"Charisma",value:"charisma"}],Pe=[{label:"Attack Advantage",value:"attack_advantage",type:oe,defaultOptions:[{label:"Flat",value:"0"},{label:"Advantage",value:"1"},{label:"Disadvantage",value:"-1"},{label:"Elven Accuracy",value:"2"}]},{label:"To Hit Bonus",value:"to_hit_bonus",type:W},{label:"Damage Bonus",value:"damage_bonus",type:W},{label:"Magical Damage",value:"magical_damage",type:oe,defaultOptions:[{label:"True",value:"1"}]},{label:"Silvered Damage",value:"silvered_damage",type:oe,defaultOptions:[{label:"True",value:"1"}]},{label:"Resistance",value:"resistances",type:W,isList:!0,defaultOptions:Me},{label:"Immunity",value:"immunities",type:W,isList:!0,defaultOptions:Me},{label:"Vulnerability",value:"vulnerabilities",type:W,isList:!0,defaultOptions:Me},{label:"Ignore Resistance",value:"ignored_resistances",type:W,isList:!0,defaultOptions:Me},{label:"Set AC",value:"ac_value",type:oe},{label:"AC Bonus",value:"ac_bonus",type:oe},{label:"Set Max HP",value:"max_hp_value",type:oe},{label:"Max HP Bonus",value:"max_hp_bonus",type:oe},{label:"Saving Throw Bonus",value:"save_bonus",type:W},{label:"Saving Throw Advantage",value:"save_adv",type:W,isList:!0,defaultOptions:Lt},{label:"Saving Throw Disadvantage",value:"save_dis",type:W,isList:!0,defaultOptions:Lt},{label:"Ability Check Bonus",value:"check_bonus",type:W},{label:"Ability Check Advantage",value:"check_adv",type:W,isList:!0,defaultOptions:Bt},{label:"Ability Check Disadvantage",value:"check_dis",type:W,isList:!0,defaultOptions:Bt},{label:"DC Bonus",value:"dc_bonus",type:oe}],Wi={class:"two-wide"},Ji={class:"input-wrapper"},Xi={class:"two-wide"},zi={class:"input-wrapper"},Zi={key:0,class:"input-wrapper"},Qi=["id","onUpdate:modelValue"],ea={key:1},ta={class:"two-wide"},na={class:"input-wrapper"},sa={class:"two-wide"},ia=P({__name:"NodeIEffect",setup(n){const e=V("currentEffect");V("currentContext");const t=ae(()=>e?.value?.effects?Pe.filter(o=>!Object.keys(e.value.effects).includes(o.value)):Pe),s=o=>{e.value.effects||(e.value.effects={}),o.isList?e.value.effects[o.value]=[]:(o.type==="intexpression"||o.type==="annotatedstring")&&(e.value.effects[o.value]="1")},i=o=>{for(const r of Pe)if(r.value===o)return r},a=o=>{const r=i(o);if(r)return r.defaultOptions?"list":r.type==="annotatedstring"?"annotatedstring":r.type==="intexpression"?"intexpression":"list"};return e?.value.effects||(e.value.effects={}),X(e,["end","tick_on_caster","conc","desc","save_as","parent","target_self","stacking"],{effects:Pe.map(o=>o.value)}),(o,r)=>{const c=J("v-select");return u(e)?(m(),w(L,{key:0},[d(B,{title:"Initiative Effect"}),l("div",Wi,[d(y,{title:"Name*",for:"name"},{default:g(()=>[l("div",Ji,[k(l("input",{id:"name","onUpdate:modelValue":r[0]||(r[0]=f=>u(e).name=f),type:"text",class:me({required:u(e).name.length===0})},null,2),[[x,u(e).name]]),d(ce)])]),_:1})]),d(B,{title:"Duration Options"}),l("div",Xi,[d(y,{title:"Duration",for:"duration"},{default:g(()=>[l("div",zi,[k(l("input",{id:"duration","onUpdate:modelValue":r[1]||(r[1]=f=>u(e).duration=f),type:"text"},null,512),[[x,u(e).duration]]),r[11]||(r[11]=$()),d(G)])]),_:1}),d(y,{title:"Ticks on End",for:"end"},{default:g(()=>[l("span",null,[k(l("input",{id:"end","onUpdate:modelValue":r[2]||(r[2]=f=>u(e).end=f),type:"checkbox"},null,512),[[H,u(e).end]]),r[12]||(r[12]=$()),r[13]||(r[13]=l("label",{for:"end"},"Ticks on end of turn.",-1))])]),_:1}),d(y,{title:"Ticks on Caster",for:"caster"},{default:g(()=>[l("span",null,[k(l("input",{id:"caster","onUpdate:modelValue":r[3]||(r[3]=f=>u(e).tick_on_caster=f),type:"checkbox"},null,512),[[H,u(e).tick_on_caster]]),r[14]||(r[14]=$()),r[15]||(r[15]=l("label",{for:"caster"},"Ticks on Caster rather than the Target.",-1))])]),_:1}),d(y,{title:"Requires concentration",for:"conc"},{default:g(()=>[l("span",null,[k(l("input",{id:"conc","onUpdate:modelValue":r[4]||(r[4]=f=>u(e).conc=f),type:"checkbox"},null,512),[[H,u(e).conc]]),r[16]||(r[16]=$()),r[17]||(r[17]=l("label",{for:"conc"},"Requires concentration.",-1))])]),_:1})]),d(B,{title:"Passive Effects"}),(m(!0),w(L,null,se(u(e).effects,(f,p)=>(m(),q(y,{key:p,title:i(p)?.label||"",for:p,style:{"margin-top":"1rem"}},{default:g(()=>[a(p)!=="list"?(m(),w("div",Zi,[k(l("input",{id:p,"onUpdate:modelValue":h=>u(e).effects[p]=h,type:"text"},null,8,Qi),[[x,u(e).effects[p]]]),a(p)==="annotatedstring"?(m(),q(ce,{key:0})):(m(),q(G,{key:1}))])):(m(),w("div",ea,[d(c,{modelValue:u(e).effects[p],"onUpdate:modelValue":h=>u(e).effects[p]=h,taggable:"",options:i(p)?.defaultOptions,"input-id":p,multiple:i(p)?.isList,reduce:h=>h.value,"create-option":h=>({label:h,value:h})},null,8,["modelValue","onUpdate:modelValue","options","input-id","multiple","reduce","create-option"])]))]),_:2},1032,["title","for"]))),128)),d(y,{title:"New Passive Effect",for:"newPassiveEffect",style:{"margin-top":"1rem"},class:"standout"},{default:g(()=>[l("div",ta,[d(c,{options:t.value,"onOption:selected":r[5]||(r[5]=f=>s(f))},null,8,["options"])])]),_:1}),d(B,{title:"Additional Options"}),d(y,{title:"Description",for:"text",style:{"margin-bottom":"1rem"}},{default:g(()=>[l("div",na,[k(l("textarea",{id:"text","onUpdate:modelValue":r[6]||(r[6]=f=>u(e).desc=f),rows:"40",placeholder:"Description"},null,512),[[x,u(e).desc]]),d(ce)])]),_:1}),l("div",sa,[d(y,{title:"Save As",for:"saveAs"},{default:g(()=>[k(l("input",{id:"saveAs","onUpdate:modelValue":r[7]||(r[7]=f=>u(e).save_as=f),type:"text"},null,512),[[x,u(e).save_as]])]),_:1}),d(y,{title:"Parent",for:"parent"},{default:g(()=>[k(l("input",{id:"parent","onUpdate:modelValue":r[8]||(r[8]=f=>u(e).parent=f),type:"text"},null,512),[[x,u(e).parent]])]),_:1}),d(y,{title:"Effect Stacking",for:"effectStacking"},{default:g(()=>[l("span",null,[k(l("input",{id:"effectStacking","onUpdate:modelValue":r[9]||(r[9]=f=>u(e).stacking=f),type:"checkbox"},null,512),[[H,u(e).stacking]]),r[18]||(r[18]=$()),r[19]||(r[19]=l("label",{for:"effectStacking"},"Ticks on end of turn.",-1))])]),_:1}),d(y,{title:"Target Self",for:"targetSelf"},{default:g(()=>[l("span",null,[k(l("input",{id:"targetSelf","onUpdate:modelValue":r[10]||(r[10]=f=>u(e).target_self=f),type:"checkbox"},null,512),[[H,u(e).target_self]]),r[20]||(r[20]=$()),r[21]||(r[21]=l("label",{for:"end"},"Target Self",-1))])]),_:1})])],64)):T("",!0)}}}),aa=D(ia,[["__scopeId","data-v-70d0758b"]]),oa=P({__name:"NodeHelper",props:{node:{}},setup(n){const e=n,t=ae(()=>e.node==="text"?As:e.node==="variable"?Us:e.node==="target"?Qs:e.node==="remove_ieffect"?ni:e.node==="save"?li:e.node==="attack"?mi:e.node==="damage"?yi:e.node==="condition"?Si:e.node==="temphp"?Ti:e.node==="roll"?Vi:e.node==="counter"?Pi:e.node==="spell"?Yi:e.node==="ieffect2"?aa:"div");return(s,i)=>(m(),w("div",null,[(m(),q(Vn(t.value)))]))}}),la={class:"two-wide uneven"},ra={class:"tree"},ua={key:1},da={class:"editor"},ca=P({__name:"VisualEditor",props:Rt({name:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=j(null),s=j([]);xe("currentEffect",t),xe("currentContext",s);const i=jt(n,"modelValue");return console.log(i.value),(a,o)=>(m(),w("section",la,[l("div",ra,[o[1]||(o[1]=l("h3",null," Effect Tree",-1)),i.value?(m(),q(ot,{key:0,data:i.value,depth:-1},null,8,["data"])):(m(),w("div",ua,[d(wt,{context:["root"],onAdd:o[0]||(o[0]=r=>i.value={_v:2,name:e.name,automation:[u(at)[r]]})})]))]),l("div",da,[d(Ln,null,{default:g(()=>[t.value?(m(),q(oa,{key:s.value.toString(),node:t.value.type},null,8,["node"])):T("",!0)]),_:1})])]))}}),fa=D(ca,[["__scopeId","data-v-1ac1ab1e"]]),pa={key:0,class:"two-wide uneven"},ma={class:"editor-field__container two-wide"},ha=["minlength","maxlength"],va={class:"editor-field__container"},ga=["maxlength"],ya={class:"editor-field__container two-wide"},ba={key:0,class:"editor-field__container two-wide"},wa={class:"editor-field__container"},ka={class:"editor-field__container"},_a={key:1,class:"editor-field__container"},Sa={key:2},Na=["innerHTML"],Aa={class:"automation-editor"},Ia={key:1,class:"vertical-container"},Ta={class:"two-wide"},$a={class:"two-wide"},Ca={class:"editor-field__container"},Ea=["minlength","maxlength"],xa={class:"editor-field__container"},Oa={class:"two-wide"},Va={class:"editor-field__container"},La={class:"editor-field__container"},Ba={class:"editor-field__container"},Ua={key:0,class:"editor-field__container"},Da={class:"editor-field__container"},Ma=["maxlength"],Pa=P({__name:"AutomationEditor",props:{data:{},isStandAlone:{type:Boolean,default:!1},creatureName:{default:"$NAME$"},isVisualEditor:{type:Boolean,default:!0}},emits:["savedStandaloneData"],setup(n,{emit:e}){const t=e,s=j(null),i=j(!1),a=j({basicExamples:[],srdFeatures:[],myAutomation:[]}),o=async(_,v)=>{const{success:I,data:N,error:C}=await ie(`/api/${_}`);I?a.value[v]=N:(a.value[v]=[],te.error(C))};Ne(async()=>{await o("basic-examples/list","basicExamples"),await o("srd-features/list","srdFeatures"),await o("my-automations","myAutomation")});const r=async(_,v,I=null)=>{const{success:N,data:C,error:S}=await ie(`/api/${_}/${encodeURIComponent(I?.toString()??v)}`);let E=null;if(!N){te.error(`Error: ${S}`);return}if(E=C,!E){te.error(`Error: Failed to import ${v}`);return}if((n.data.name==="New Feature"||!i.value)&&(_==="srd-feature"&&E.name.includes(" - ")?n.data.name=E.name.split("-").slice(1).join("-").trim():n.data.name=E.name),E.description&&(n.data.description=E.description.replaceAll("$NAME$",n.creatureName)),!E.description&&_==="basic-example"&&E.automation&&!Array.isArray(E.automation)&&(n.data.description=E.automation.automation[E.automation.automation.length-1].text),Array.isArray(E.automation))for(const U of E.automation)_==="srd-feature"&&U.name.includes(" - ")&&(U.name=U.name.split("-").slice(1).join("-").trim());c.value=E.automation,await f(!1)},c=j(n.data.automation);xe("automation",c),Ne(()=>{c.value=n.data.automation||null});const f=async(_=!1)=>{const{error:v}=await ie("/api/validate/automation","POST",c.value);if(_&&v){te.error(v,{duration:0});return}if(n.isStandAlone&&"_id"in n.data){const{success:I,error:N}=await ie(`/api/automation/${n.data._id?.toString()}/update`,"POST",n.data);if(I&&_)t("savedStandaloneData");else if(!I){_&&te.error(`${n.data.name||"Unnamed feature"}: ${N}`);return}}_&&te.success("Successfully saved automation!")},p=async()=>{await navigator.clipboard.writeText(ds.stringify(c.value)),te.success("Copied automation to clipboard!")},h=async()=>{const _=Un(n.data.description,n.data.name,0)[0];if(_)try{c.value=_,await f(!1)}catch{te.error("Something went when generating automation!")}},b=async()=>{if(n.isStandAlone)return;const{success:_,error:v}=await ie("/api/automation/add","POST",{name:n.data.name,description:n.data.description,automation:n.data.automation});_?(await o("my-automations","myAutomation"),te.success("Successfully added automation!")):te.error(v)};return(_,v)=>{const I=J("font-awesome-icon"),N=J("v-select"),C=Fe("tooltip");return _.isVisualEditor?(m(),w("div",Ia,[l("div",Ta,[l("div",$a,[l("div",Ca,[d(y,{title:"Feature name",for:"featurename"},{default:g(()=>[k(l("input",{id:"featurename","onUpdate:modelValue":v[11]||(v[11]=S=>_.data.name=S),type:"text",placeholder:"Enter name",minlength:u(le).limits?.nameMin,maxlength:u(le).limits?.nameLength,onChange:v[12]||(v[12]=S=>i.value=!0)},null,40,Ea),[[x,_.data.name]])]),_:1}),d(y,{title:"Save automation",for:"saveautomation"},{default:g(()=>[l("button",{id:"saveautomation",class:"btn confirm",onClick:v[13]||(v[13]=S=>f(!0))}," Save ")]),_:1})]),l("div",xa,[d(y,{title:"Generate",for:"generate"},{default:g(()=>[k((m(),w("button",{id:"generate",class:"btn",onClick:h},[v[22]||(v[22]=$(" Generate ")),d(I,{icon:["fas","circle-info"]})])),[[C,"Generate automation from description. May be incomplete or inaccurate. Only works for basic, to hit attacks."]])]),_:1})])]),l("div",Oa,[l("div",Va,[l("div",La,[d(y,{title:"Import SRD feature",for:"importsrdfeature"},{default:g(()=>[d(N,{options:a.value.srdFeatures,"input-id":"importsrdfeature","onOption:selected":v[14]||(v[14]=S=>r("srd-feature",S))},null,8,["options"])]),_:1})]),l("div",Ba,[d(y,{title:"Import basic example",for:"importbasicexample"},{default:g(()=>[d(N,{options:a.value.basicExamples,"input-id":"importbasicexample","onOption:selected":v[15]||(v[15]=S=>r("basic-example",S))},null,8,["options"])]),_:1})]),_.isStandAlone?T("",!0):(m(),w("div",Ua,[d(y,{title:"Import custom automation",for:"importcustomautomation"},{default:g(()=>[d(N,{options:a.value.myAutomation,"input-id":"importcustomautomation",label:"name","onOption:selected":v[16]||(v[16]=S=>r("automation",S.name,S._id))},null,8,["options"])]),_:1})]))]),l("div",Da,[d(y,{title:"Feature description",for:"featuredescription"},{default:g(()=>[k(l("textarea",{id:"featuredescription","onUpdate:modelValue":v[17]||(v[17]=S=>_.data.description=S),height:"94",placeholder:"Enter description",style:{height:"135px","max-height":"135px",resize:"none"},maxlength:u(le).limits?.descriptionLength},null,8,Ma),[[x,_.data.description]])]),_:1})])])]),v[23]||(v[23]=l("hr",null,null,-1)),l("div",null,[d(fa,{modelValue:c.value,"onUpdate:modelValue":v[18]||(v[18]=S=>c.value=S),name:_.data.name},null,8,["modelValue","name"])])])):(m(),w("div",pa,[l("div",null,[l("div",ma,[d(y,{title:"Feature name",for:"featurename"},{default:g(()=>[k(l("input",{id:"featurename","onUpdate:modelValue":v[0]||(v[0]=S=>_.data.name=S),type:"text",placeholder:"Enter name",minlength:u(le).limits?.nameMin,maxlength:u(le).limits?.nameLength,onChange:v[1]||(v[1]=S=>i.value=!0)},null,40,ha),[[x,_.data.name]])]),_:1}),d(y,{title:"Change Editor",for:"changeEditor"},{default:g(()=>[l("button",{id:"changeEditor",class:"btn",onClick:v[2]||(v[2]=S=>_.isVisualEditor=!0)}," Visual Editor ")]),_:1})]),l("div",va,[d(y,{title:"Feature description",for:"featuredescription"},{default:g(()=>[k(l("textarea",{id:"featuredescription","onUpdate:modelValue":v[3]||(v[3]=S=>_.data.description=S),height:"94",placeholder:"Enter description",style:{height:"93px"},maxlength:u(le).limits?.descriptionLength},null,8,ga),[[x,_.data.description]])]),_:1})]),l("div",ya,[d(y,{title:"Save automation",for:"saveautomation"},{default:g(()=>[l("button",{id:"saveautomation",class:"btn confirm",onClick:v[4]||(v[4]=S=>f(!0))}," Save ")]),_:1}),d(y,{title:"Generate",for:"generate"},{default:g(()=>[k((m(),w("button",{id:"generate",class:"btn",onClick:h},[v[19]||(v[19]=$(" Generate ")),d(I,{icon:["fas","circle-info"]})])),[[C,"Generate automation from description. May be incomplete or inaccurate. Only works for basic, to hit attacks."]])]),_:1})]),u(le).isMobile?(m(),w("div",ba,[d(y,{title:"Clear automation",for:"clearautomation"},{default:g(()=>[l("button",{id:"clearautomation",class:"btn danger",onClick:v[5]||(v[5]=S=>c.value=null)}," Clear ")]),_:1}),d(y,{title:"Copy Automation",for:"copyautomation"},{default:g(()=>[l("button",{id:"copyautomation",class:"btn",onClick:v[6]||(v[6]=S=>p())}," Copy ")]),_:1})])):T("",!0),v[21]||(v[21]=l("hr",null,null,-1)),l("div",wa,[d(y,{title:"Import SRD feature",for:"importsrdfeature"},{default:g(()=>[d(N,{options:a.value.srdFeatures,"input-id":"importsrdfeature","onOption:selected":v[7]||(v[7]=S=>r("srd-feature",S))},null,8,["options"])]),_:1})]),l("div",ka,[d(y,{title:"Import basic example",for:"importbasicexample"},{default:g(()=>[d(N,{options:a.value.basicExamples,"input-id":"importbasicexample","onOption:selected":v[8]||(v[8]=S=>r("basic-example",S))},null,8,["options"])]),_:1})]),_.isStandAlone?T("",!0):(m(),w("div",_a,[d(y,{title:"Import custom automation",for:"importcustomautomation"},{default:g(()=>[d(N,{options:a.value.myAutomation,"input-id":"importcustomautomation",label:"name","onOption:selected":v[9]||(v[9]=S=>r("automation",S.name,S._id))},null,8,["options"])]),_:1})])),s.value?(m(),w("div",Sa,[v[20]||(v[20]=l("hr",null,null,-1)),l("span",{class:"yaml-error",innerHTML:s.value},null,8,Na)])):T("",!0)]),l("div",Aa,[_.isStandAlone?T("",!0):(m(),w("span",{key:0,class:"save-custom-automation",onClick:v[10]||(v[10]=S=>b())},"Click to save as a reusable custom automation!"))])]))}}}),ja=D(Pa,[["__scopeId","data-v-5d41f551"]]);export{ja as A,Hs as L,B as S};
