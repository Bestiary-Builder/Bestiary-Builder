import{a1 as Cs,v as $e,d as _s,_ as Ls,y as Ms,o as Hn,c as Kn,b as Ps,e as qn,f as xs,A as Ds,i as Rs,a0 as js}from"./index-DHg13qmf.js";const wn=Symbol.for("yaml.alias"),cn=Symbol.for("yaml.document"),Be=Symbol.for("yaml.map"),bi=Symbol.for("yaml.pair"),Ae=Symbol.for("yaml.scalar"),Ze=Symbol.for("yaml.seq"),ue=Symbol.for("yaml.node.type"),De=n=>!!n&&typeof n=="object"&&n[ue]===wn,Qe=n=>!!n&&typeof n=="object"&&n[ue]===cn,et=n=>!!n&&typeof n=="object"&&n[ue]===Be,W=n=>!!n&&typeof n=="object"&&n[ue]===bi,q=n=>!!n&&typeof n=="object"&&n[ue]===Ae,tt=n=>!!n&&typeof n=="object"&&n[ue]===Ze;function J(n){if(n&&typeof n=="object")switch(n[ue]){case Be:case Ze:return!0}return!1}function G(n){if(n&&typeof n=="object")switch(n[ue]){case wn:case Be:case Ae:case Ze:return!0}return!1}const Fs=n=>(q(n)||J(n))&&!!n.anchor,se=Symbol("break visit"),wi=Symbol("skip children"),be=Symbol("remove node");function ve(n,e){const t=Si(e);Qe(n)?Ue(null,n.contents,t,Object.freeze([n]))===be&&(n.contents=null):Ue(null,n,t,Object.freeze([]))}ve.BREAK=se;ve.SKIP=wi;ve.REMOVE=be;function Ue(n,e,t,i){const s=Ni(n,e,t,i);if(G(s)||W(s))return ki(n,i,s),Ue(n,s,t,i);if(typeof s!="symbol"){if(J(e)){i=Object.freeze(i.concat(e));for(let r=0;r<e.items.length;++r){const o=Ue(r,e.items[r],t,i);if(typeof o=="number")r=o-1;else{if(o===se)return se;o===be&&(e.items.splice(r,1),r-=1)}}}else if(W(e)){i=Object.freeze(i.concat(e));const r=Ue("key",e.key,t,i);if(r===se)return se;r===be&&(e.key=null);const o=Ue("value",e.value,t,i);if(o===se)return se;o===be&&(e.value=null)}}return s}async function Lt(n,e){const t=Si(e);Qe(n)?await Ve(null,n.contents,t,Object.freeze([n]))===be&&(n.contents=null):await Ve(null,n,t,Object.freeze([]))}Lt.BREAK=se;Lt.SKIP=wi;Lt.REMOVE=be;async function Ve(n,e,t,i){const s=await Ni(n,e,t,i);if(G(s)||W(s))return ki(n,i,s),Ve(n,s,t,i);if(typeof s!="symbol"){if(J(e)){i=Object.freeze(i.concat(e));for(let r=0;r<e.items.length;++r){const o=await Ve(r,e.items[r],t,i);if(typeof o=="number")r=o-1;else{if(o===se)return se;o===be&&(e.items.splice(r,1),r-=1)}}}else if(W(e)){i=Object.freeze(i.concat(e));const r=await Ve("key",e.key,t,i);if(r===se)return se;r===be&&(e.key=null);const o=await Ve("value",e.value,t,i);if(o===se)return se;o===be&&(e.value=null)}}return s}function Si(n){return typeof n=="object"&&(n.Collection||n.Node||n.Value)?Object.assign({Alias:n.Node,Map:n.Node,Scalar:n.Node,Seq:n.Node},n.Value&&{Map:n.Value,Scalar:n.Value,Seq:n.Value},n.Collection&&{Map:n.Collection,Seq:n.Collection},n):n}function Ni(n,e,t,i){if(typeof t=="function")return t(n,e,i);if(et(e))return t.Map?.(n,e,i);if(tt(e))return t.Seq?.(n,e,i);if(W(e))return t.Pair?.(n,e,i);if(q(e))return t.Scalar?.(n,e,i);if(De(e))return t.Alias?.(n,e,i)}function ki(n,e,t){const i=e[e.length-1];if(J(i))i.items[n]=t;else if(W(i))n==="key"?i.key=t:i.value=t;else if(Qe(i))i.contents=t;else{const s=De(i)?"alias":"scalar";throw new Error(`Cannot replace node with ${s} parent`)}}const Us={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},Vs=n=>n.replace(/[!,[\]{}]/g,e=>Us[e]);class ne{constructor(e,t){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},ne.defaultYaml,e),this.tags=Object.assign({},ne.defaultTags,t)}clone(){const e=new ne(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new ne(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:ne.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},ne.defaultTags);break}return e}add(e,t){this.atNextDocument&&(this.yaml={explicit:ne.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},ne.defaultTags),this.atNextDocument=!1);const i=e.trim().split(/[ \t]+/),s=i.shift();switch(s){case"%TAG":{if(i.length!==2&&(t(0,"%TAG directive should contain exactly two parts"),i.length<2))return!1;const[r,o]=i;return this.tags[r]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,i.length!==1)return t(0,"%YAML directive should contain exactly one part"),!1;const[r]=i;if(r==="1.1"||r==="1.2")return this.yaml.version=r,!0;{const o=/^\d+\.\d+$/.test(r);return t(6,`Unsupported YAML version ${r}`,o),!1}}default:return t(0,`Unknown directive ${s}`,!0),!1}}tagName(e,t){if(e==="!")return"!";if(e[0]!=="!")return t(`Not a valid tag: ${e}`),null;if(e[1]==="<"){const o=e.slice(2,-1);return o==="!"||o==="!!"?(t(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(e[e.length-1]!==">"&&t("Verbatim tags must end with a >"),o)}const[,i,s]=e.match(/^(.*!)([^!]*)$/s);s||t(`The ${e} tag has no suffix`);const r=this.tags[i];if(r)try{return r+decodeURIComponent(s)}catch(o){return t(String(o)),null}return i==="!"?e:(t(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[t,i]of Object.entries(this.tags))if(e.startsWith(i))return t+Vs(e.substring(i.length));return e[0]==="!"?e:`!<${e}>`}toString(e){const t=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],i=Object.entries(this.tags);let s;if(e&&i.length>0&&G(e.contents)){const r={};ve(e.contents,(o,a)=>{G(a)&&a.tag&&(r[a.tag]=!0)}),s=Object.keys(r)}else s=[];for(const[r,o]of i)r==="!!"&&o==="tag:yaml.org,2002:"||(!e||s.some(a=>a.startsWith(o)))&&t.push(`%TAG ${r} ${o}`);return t.join(`
`)}}ne.defaultYaml={explicit:!1,version:"1.2"};ne.defaultTags={"!!":"tag:yaml.org,2002:"};function Ti(n){if(/[\x00-\x19\s,[\]{}]/.test(n)){const t=`Anchor must not contain whitespace or control characters: ${JSON.stringify(n)}`;throw new Error(t)}return!0}function Oi(n){const e=new Set;return ve(n,{Value(t,i){i.anchor&&e.add(i.anchor)}}),e}function Ei(n,e){for(let t=1;;++t){const i=`${n}${t}`;if(!e.has(i))return i}}function Hs(n,e){const t=[],i=new Map;let s=null;return{onAnchor:r=>{t.push(r),s||(s=Oi(n));const o=Ei(e,s);return s.add(o),o},setAnchors:()=>{for(const r of t){const o=i.get(r);if(typeof o=="object"&&o.anchor&&(q(o.node)||J(o.node)))o.node.anchor=o.anchor;else{const a=new Error("Failed to resolve repeated object (this should not happen)");throw a.source=r,a}}},sourceObjects:i}}function He(n,e,t,i){if(i&&typeof i=="object")if(Array.isArray(i))for(let s=0,r=i.length;s<r;++s){const o=i[s],a=He(n,i,String(s),o);a===void 0?delete i[s]:a!==o&&(i[s]=a)}else if(i instanceof Map)for(const s of Array.from(i.keys())){const r=i.get(s),o=He(n,i,s,r);o===void 0?i.delete(s):o!==r&&i.set(s,o)}else if(i instanceof Set)for(const s of Array.from(i)){const r=He(n,i,s,s);r===void 0?i.delete(s):r!==s&&(i.delete(s),i.add(r))}else for(const[s,r]of Object.entries(i)){const o=He(n,i,s,r);o===void 0?delete i[s]:o!==r&&(i[s]=o)}return n.call(e,t,i)}function ce(n,e,t){if(Array.isArray(n))return n.map((i,s)=>ce(i,String(s),t));if(n&&typeof n.toJSON=="function"){if(!t||!Fs(n))return n.toJSON(e,t);const i={aliasCount:0,count:1,res:void 0};t.anchors.set(n,i),t.onCreate=r=>{i.res=r,delete t.onCreate};const s=n.toJSON(e,t);return t.onCreate&&t.onCreate(s),s}return typeof n=="bigint"&&!t?.keep?Number(n):n}class Sn{constructor(e){Object.defineProperty(this,ue,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:t,maxAliasCount:i,onAnchor:s,reviver:r}={}){if(!Qe(e))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:e,keep:!0,mapAsMap:t===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},a=ce(this,"",o);if(typeof s=="function")for(const{count:l,res:f}of o.anchors.values())s(f,l);return typeof r=="function"?He(r,{"":a},"",a):a}}class Mt extends Sn{constructor(e){super(wn),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let t;return ve(e,{Node:(i,s)=>{if(s===this)return ve.BREAK;s.anchor===this.source&&(t=s)}}),t}toJSON(e,t){if(!t)return{source:this.source};const{anchors:i,doc:s,maxAliasCount:r}=t,o=this.resolve(s);if(!o){const l=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(l)}let a=i.get(o);if(a||(ce(o,null,t),a=i.get(o)),!a||a.res===void 0){const l="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(l)}if(r>=0&&(a.count+=1,a.aliasCount===0&&(a.aliasCount=Ot(s,o,i)),a.count*a.aliasCount>r)){const l="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(l)}return a.res}toString(e,t,i){const s=`*${this.source}`;if(e){if(Ti(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const r=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(r)}if(e.implicitKey)return`${s} `}return s}}function Ot(n,e,t){if(De(e)){const i=e.resolve(n),s=t&&i&&t.get(i);return s?s.count*s.aliasCount:0}else if(J(e)){let i=0;for(const s of e.items){const r=Ot(n,s,t);r>i&&(i=r)}return i}else if(W(e)){const i=Ot(n,e.key,t),s=Ot(n,e.value,t);return Math.max(i,s)}return 1}const Ai=n=>!n||typeof n!="function"&&typeof n!="object";class M extends Sn{constructor(e){super(Ae),this.value=e}toJSON(e,t){return t?.keep?this.value:ce(this.value,e,t)}toString(){return String(this.value)}}M.BLOCK_FOLDED="BLOCK_FOLDED";M.BLOCK_LITERAL="BLOCK_LITERAL";M.PLAIN="PLAIN";M.QUOTE_DOUBLE="QUOTE_DOUBLE";M.QUOTE_SINGLE="QUOTE_SINGLE";const Ks="tag:yaml.org,2002:";function qs(n,e,t){if(e){const i=t.filter(r=>r.tag===e),s=i.find(r=>!r.format)??i[0];if(!s)throw new Error(`Tag ${e} not found`);return s}return t.find(i=>i.identify?.(n)&&!i.format)}function ut(n,e,t){if(Qe(n)&&(n=n.contents),G(n))return n;if(W(n)){const c=t.schema[Be].createNode?.(t.schema,null,t);return c.items.push(n),c}(n instanceof String||n instanceof Number||n instanceof Boolean||typeof BigInt<"u"&&n instanceof BigInt)&&(n=n.valueOf());const{aliasDuplicateObjects:i,onAnchor:s,onTagObj:r,schema:o,sourceObjects:a}=t;let l;if(i&&n&&typeof n=="object"){if(l=a.get(n),l)return l.anchor||(l.anchor=s(n)),new Mt(l.anchor);l={anchor:null,node:null},a.set(n,l)}e?.startsWith("!!")&&(e=Ks+e.slice(2));let f=qs(n,e,o.tags);if(!f){if(n&&typeof n.toJSON=="function"&&(n=n.toJSON()),!n||typeof n!="object"){const c=new M(n);return l&&(l.node=c),c}f=n instanceof Map?o[Be]:Symbol.iterator in Object(n)?o[Ze]:o[Be]}r&&(r(f),delete t.onTagObj);const h=f?.createNode?f.createNode(t.schema,n,t):typeof f?.nodeClass?.from=="function"?f.nodeClass.from(t.schema,n,t):new M(n);return e?h.tag=e:f.default||(h.tag=f.tag),l&&(l.node=h),h}function $t(n,e,t){let i=t;for(let s=e.length-1;s>=0;--s){const r=e[s];if(typeof r=="number"&&Number.isInteger(r)&&r>=0){const o=[];o[r]=i,i=o}else i=new Map([[r,i]])}return ut(i,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:n,sourceObjects:new Map})}const ft=n=>n==null||typeof n=="object"&&!!n[Symbol.iterator]().next().done;class Nn extends Sn{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map(i=>G(i)||W(i)?i.clone(e):i),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if(ft(e))this.add(t);else{const[i,...s]=e,r=this.get(i,!0);if(J(r))r.addIn(s,t);else if(r===void 0&&this.schema)this.set(i,$t(this.schema,s,t));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${s}`)}}deleteIn(e){const[t,...i]=e;if(i.length===0)return this.delete(t);const s=this.get(t,!0);if(J(s))return s.deleteIn(i);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${i}`)}getIn(e,t){const[i,...s]=e,r=this.get(i,!0);return s.length===0?!t&&q(r)?r.value:r:J(r)?r.getIn(s,t):void 0}hasAllNullValues(e){return this.items.every(t=>{if(!W(t))return!1;const i=t.value;return i==null||e&&q(i)&&i.value==null&&!i.commentBefore&&!i.comment&&!i.tag})}hasIn(e){const[t,...i]=e;if(i.length===0)return this.has(t);const s=this.get(t,!0);return J(s)?s.hasIn(i):!1}setIn(e,t){const[i,...s]=e;if(s.length===0)this.set(i,t);else{const r=this.get(i,!0);if(J(r))r.setIn(s,t);else if(r===void 0&&this.schema)this.set(i,$t(this.schema,s,t));else throw new Error(`Expected YAML collection at ${i}. Remaining path: ${s}`)}}}Nn.maxFlowStringSingleLineLength=60;const Ws=n=>n.replace(/^(?!$)(?: $)?/gm,"#");function Oe(n,e){return/^\n+$/.test(n)?n.substring(1):e?n.replace(/^(?! *$)/gm,e):n}const Le=(n,e,t)=>n.endsWith(`
`)?Oe(t,e):t.includes(`
`)?`
`+Oe(t,e):(n.endsWith(" ")?"":" ")+t,Ii="flow",un="block",Et="quoted";function Pt(n,e,t="flow",{indentAtStart:i,lineWidth:s=80,minContentWidth:r=20,onFold:o,onOverflow:a}={}){if(!s||s<0)return n;const l=Math.max(1+r,1+s-e.length);if(n.length<=l)return n;const f=[],h={};let c=s-e.length;typeof i=="number"&&(i>s-Math.max(2,r)?f.push(0):c=s-i);let d,g,O=!1,p=-1,m=-1,I=-1;t===un&&(p=Wn(n,p,e.length),p!==-1&&(c=p+l));for(let B;B=n[p+=1];){if(t===Et&&B==="\\"){switch(m=p,n[p+1]){case"x":p+=3;break;case"u":p+=5;break;case"U":p+=9;break;default:p+=1}I=p}if(B===`
`)t===un&&(p=Wn(n,p,e.length)),c=p+e.length+l,d=void 0;else{if(B===" "&&g&&g!==" "&&g!==`
`&&g!=="	"){const w=n[p+1];w&&w!==" "&&w!==`
`&&w!=="	"&&(d=p)}if(p>=c)if(d)f.push(d),c=d+l,d=void 0;else if(t===Et){for(;g===" "||g==="	";)g=B,B=n[p+=1],O=!0;const w=p>I+1?p-2:m-1;if(h[w])return n;f.push(w),h[w]=!0,c=w+l,d=void 0}else O=!0}g=B}if(O&&a&&a(),f.length===0)return n;o&&o();let T=n.slice(0,f[0]);for(let B=0;B<f.length;++B){const w=f[B],v=f[B+1]||n.length;w===0?T=`
${e}${n.slice(0,v)}`:(t===Et&&h[w]&&(T+=`${n[w]}\\`),T+=`
${e}${n.slice(w+1,v)}`)}return T}function Wn(n,e,t){let i=e,s=e+1,r=n[s];for(;r===" "||r==="	";)if(e<s+t)r=n[++e];else{do r=n[++e];while(r&&r!==`
`);i=e,s=e+1,r=n[s]}return i}const xt=(n,e)=>({indentAtStart:e?n.indent.length:n.indentAtStart,lineWidth:n.options.lineWidth,minContentWidth:n.options.minContentWidth}),Dt=n=>/^(%|---|\.\.\.)/m.test(n);function Js(n,e,t){if(!e||e<0)return!1;const i=e-t,s=n.length;if(s<=i)return!1;for(let r=0,o=0;r<s;++r)if(n[r]===`
`){if(r-o>i)return!0;if(o=r+1,s-o<=i)return!1}return!0}function ct(n,e){const t=JSON.stringify(n);if(e.options.doubleQuotedAsJSON)return t;const{implicitKey:i}=e,s=e.options.doubleQuotedMinMultiLineLength,r=e.indent||(Dt(n)?"  ":"");let o="",a=0;for(let l=0,f=t[l];f;f=t[++l])if(f===" "&&t[l+1]==="\\"&&t[l+2]==="n"&&(o+=t.slice(a,l)+"\\ ",l+=1,a=l,f="\\"),f==="\\")switch(t[l+1]){case"u":{o+=t.slice(a,l);const h=t.substr(l+2,4);switch(h){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:h.substr(0,2)==="00"?o+="\\x"+h.substr(2):o+=t.substr(l,6)}l+=5,a=l+1}break;case"n":if(i||t[l+2]==='"'||t.length<s)l+=1;else{for(o+=t.slice(a,l)+`

`;t[l+2]==="\\"&&t[l+3]==="n"&&t[l+4]!=='"';)o+=`
`,l+=2;o+=r,t[l+2]===" "&&(o+="\\"),l+=1,a=l+1}break;default:l+=1}return o=a?o+t.slice(a):t,i?o:Pt(o,r,Et,xt(e,!1))}function hn(n,e){if(e.options.singleQuote===!1||e.implicitKey&&n.includes(`
`)||/[ \t]\n|\n[ \t]/.test(n))return ct(n,e);const t=e.indent||(Dt(n)?"  ":""),i="'"+n.replace(/'/g,"''").replace(/\n+/g,`$&
${t}`)+"'";return e.implicitKey?i:Pt(i,t,Ii,xt(e,!1))}function Ke(n,e){const{singleQuote:t}=e.options;let i;if(t===!1)i=ct;else{const s=n.includes('"'),r=n.includes("'");s&&!r?i=hn:r&&!s?i=ct:i=t?hn:ct}return i(n,e)}let dn;try{dn=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{dn=/\n+(?!\n|$)/g}function At({comment:n,type:e,value:t},i,s,r){const{blockQuote:o,commentString:a,lineWidth:l}=i.options;if(!o||/\n[\t ]+$/.test(t)||/^\s*$/.test(t))return Ke(t,i);const f=i.indent||(i.forceBlockIndent||Dt(t)?"  ":""),h=o==="literal"?!0:o==="folded"||e===M.BLOCK_FOLDED?!1:e===M.BLOCK_LITERAL?!0:!Js(t,l,f.length);if(!t)return h?`|
`:`>
`;let c,d;for(d=t.length;d>0;--d){const A=t[d-1];if(A!==`
`&&A!=="	"&&A!==" ")break}let g=t.substring(d);const O=g.indexOf(`
`);O===-1?c="-":t===g||O!==g.length-1?(c="+",r&&r()):c="",g&&(t=t.slice(0,-g.length),g[g.length-1]===`
`&&(g=g.slice(0,-1)),g=g.replace(dn,`$&${f}`));let p=!1,m,I=-1;for(m=0;m<t.length;++m){const A=t[m];if(A===" ")p=!0;else if(A===`
`)I=m;else break}let T=t.substring(0,I<m?I+1:m);T&&(t=t.substring(T.length),T=T.replace(/\n+/g,`$&${f}`));let w=(h?"|":">")+(p?f?"2":"1":"")+c;if(n&&(w+=" "+a(n.replace(/ ?[\r\n]+/g," ")),s&&s()),h)return t=t.replace(/\n+/g,`$&${f}`),`${w}
${f}${T}${t}${g}`;t=t.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${f}`);const v=Pt(`${T}${t}${g}`,f,un,xt(i,!0));return`${w}
${f}${v}`}function Gs(n,e,t,i){const{type:s,value:r}=n,{actualString:o,implicitKey:a,indent:l,indentStep:f,inFlow:h}=e;if(a&&r.includes(`
`)||h&&/[[\]{},]/.test(r))return Ke(r,e);if(!r||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(r))return a||h||!r.includes(`
`)?Ke(r,e):At(n,e,t,i);if(!a&&!h&&s!==M.PLAIN&&r.includes(`
`))return At(n,e,t,i);if(Dt(r)){if(l==="")return e.forceBlockIndent=!0,At(n,e,t,i);if(a&&l===f)return Ke(r,e)}const c=r.replace(/\n+/g,`$&
${l}`);if(o){const d=p=>p.default&&p.tag!=="tag:yaml.org,2002:str"&&p.test?.test(c),{compat:g,tags:O}=e.doc.schema;if(O.some(d)||g?.some(d))return Ke(r,e)}return a?c:Pt(c,l,Ii,xt(e,!1))}function pt(n,e,t,i){const{implicitKey:s,inFlow:r}=e,o=typeof n.value=="string"?n:Object.assign({},n,{value:String(n.value)});let{type:a}=n;a!==M.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(a=M.QUOTE_DOUBLE);const l=h=>{switch(h){case M.BLOCK_FOLDED:case M.BLOCK_LITERAL:return s||r?Ke(o.value,e):At(o,e,t,i);case M.QUOTE_DOUBLE:return ct(o.value,e);case M.QUOTE_SINGLE:return hn(o.value,e);case M.PLAIN:return Gs(o,e,t,i);default:return null}};let f=l(a);if(f===null){const{defaultKeyType:h,defaultStringType:c}=e.options,d=s&&h||c;if(f=l(d),f===null)throw new Error(`Unsupported default string type ${d}`)}return f}function Bi(n,e){const t=Object.assign({blockQuote:!0,commentString:Ws,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},n.schema.toStringOptions,e);let i;switch(t.collectionStyle){case"block":i=!1;break;case"flow":i=!0;break;default:i=null}return{anchors:new Set,doc:n,flowCollectionPadding:t.flowCollectionPadding?" ":"",indent:"",indentStep:typeof t.indent=="number"?" ".repeat(t.indent):"  ",inFlow:i,options:t}}function Ys(n,e){if(e.tag){const s=n.filter(r=>r.tag===e.tag);if(s.length>0)return s.find(r=>r.format===e.format)??s[0]}let t,i;if(q(e)){i=e.value;const s=n.filter(r=>r.identify?.(i));t=s.find(r=>r.format===e.format)??s.find(r=>!r.format)}else i=e,t=n.find(s=>s.nodeClass&&i instanceof s.nodeClass);if(!t){const s=i?.constructor?.name??typeof i;throw new Error(`Tag not resolved for ${s} value`)}return t}function zs(n,e,{anchors:t,doc:i}){if(!i.directives)return"";const s=[],r=(q(n)||J(n))&&n.anchor;r&&Ti(r)&&(t.add(r),s.push(`&${r}`));const o=n.tag?n.tag:e.default?null:e.tag;return o&&s.push(i.directives.tagString(o)),s.join(" ")}function Ye(n,e,t,i){if(W(n))return n.toString(e,t,i);if(De(n)){if(e.doc.directives)return n.toString(e);if(e.resolvedAliases?.has(n))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(n):e.resolvedAliases=new Set([n]),n=n.resolve(e.doc)}let s;const r=G(n)?n:e.doc.createNode(n,{onTagObj:l=>s=l});s||(s=Ys(e.doc.schema.tags,r));const o=zs(r,s,e);o.length>0&&(e.indentAtStart=(e.indentAtStart??0)+o.length+1);const a=typeof s.stringify=="function"?s.stringify(r,e,t,i):q(r)?pt(r,e,t,i):r.toString(e,t,i);return o?q(r)||a[0]==="{"||a[0]==="["?`${o} ${a}`:`${o}
${e.indent}${a}`:a}function Xs({key:n,value:e},t,i,s){const{allNullValues:r,doc:o,indent:a,indentStep:l,options:{commentString:f,indentSeq:h,simpleKeys:c}}=t;let d=G(n)&&n.comment||null;if(c){if(d)throw new Error("With simple keys, key nodes cannot have comments");if(J(n)){const U="With simple keys, collection cannot be used as a key value";throw new Error(U)}}let g=!c&&(!n||d&&e==null&&!t.inFlow||J(n)||(q(n)?n.type===M.BLOCK_FOLDED||n.type===M.BLOCK_LITERAL:typeof n=="object"));t=Object.assign({},t,{allNullValues:!1,implicitKey:!g&&(c||!r),indent:a+l});let O=!1,p=!1,m=Ye(n,t,()=>O=!0,()=>p=!0);if(!g&&!t.inFlow&&m.length>1024){if(c)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");g=!0}if(t.inFlow){if(r||e==null)return O&&i&&i(),m===""?"?":g?`? ${m}`:m}else if(r&&!c||e==null&&g)return m=`? ${m}`,d&&!O?m+=Le(m,t.indent,f(d)):p&&s&&s(),m;O&&(d=null),g?(d&&(m+=Le(m,t.indent,f(d))),m=`? ${m}
${a}:`):(m=`${m}:`,d&&(m+=Le(m,t.indent,f(d))));let I,T,B;G(e)?(I=!!e.spaceBefore,T=e.commentBefore,B=e.comment):(I=!1,T=null,B=null,e&&typeof e=="object"&&(e=o.createNode(e))),t.implicitKey=!1,!g&&!d&&q(e)&&(t.indentAtStart=m.length+1),p=!1,!h&&l.length>=2&&!t.inFlow&&!g&&tt(e)&&!e.flow&&!e.tag&&!e.anchor&&(t.indent=t.indent.substring(2));let w=!1;const v=Ye(e,t,()=>w=!0,()=>p=!0);let A=" ";if(d||I||T){if(A=I?`
`:"",T){const U=f(T);A+=`
${Oe(U,t.indent)}`}v===""&&!t.inFlow?A===`
`&&(A=`

`):A+=`
${t.indent}`}else if(!g&&J(e)){const U=v[0],R=v.indexOf(`
`),L=R!==-1,V=t.inFlow??e.flow??e.items.length===0;if(L||!V){let x=!1;if(L&&(U==="&"||U==="!")){let H=v.indexOf(" ");U==="&"&&H!==-1&&H<R&&v[H+1]==="!"&&(H=v.indexOf(" ",H+1)),(H===-1||R<H)&&(x=!0)}x||(A=`
${t.indent}`)}}else(v===""||v[0]===`
`)&&(A="");return m+=A+v,t.inFlow?w&&i&&i():B&&!w?m+=Le(m,t.indent,f(B)):p&&s&&s(),m}function $i(n,e){(n==="debug"||n==="warn")&&(typeof process<"u"&&process.emitWarning?process.emitWarning(e):console.warn(e))}const Jn="<<";function vi(n,e,{key:t,value:i}){if(n?.doc.schema.merge&&Zs(t))if(i=De(i)?i.resolve(n.doc):i,tt(i))for(const s of i.items)Zt(n,e,s);else if(Array.isArray(i))for(const s of i)Zt(n,e,s);else Zt(n,e,i);else{const s=ce(t,"",n);if(e instanceof Map)e.set(s,ce(i,s,n));else if(e instanceof Set)e.add(s);else{const r=Qs(t,s,n),o=ce(i,r,n);r in e?Object.defineProperty(e,r,{value:o,writable:!0,enumerable:!0,configurable:!0}):e[r]=o}}return e}const Zs=n=>n===Jn||q(n)&&n.value===Jn&&(!n.type||n.type===M.PLAIN);function Zt(n,e,t){const i=n&&De(t)?t.resolve(n.doc):t;if(!et(i))throw new Error("Merge sources must be maps or map aliases");const s=i.toJSON(null,n,Map);for(const[r,o]of s)e instanceof Map?e.has(r)||e.set(r,o):e instanceof Set?e.add(r):Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(e,r,{value:o,writable:!0,enumerable:!0,configurable:!0});return e}function Qs(n,e,t){if(e===null)return"";if(typeof e!="object")return String(e);if(G(n)&&t?.doc){const i=Bi(t.doc,{});i.anchors=new Set;for(const r of t.anchors.keys())i.anchors.add(r.anchor);i.inFlow=!0,i.inStringifyKey=!0;const s=n.toString(i);if(!t.mapKeyWarned){let r=JSON.stringify(s);r.length>40&&(r=r.substring(0,36)+'..."'),$i(t.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${r}. Set mapAsMap: true to use object keys.`),t.mapKeyWarned=!0}return s}return JSON.stringify(e)}function kn(n,e,t){const i=ut(n,void 0,t),s=ut(e,void 0,t);return new te(i,s)}class te{constructor(e,t=null){Object.defineProperty(this,ue,{value:bi}),this.key=e,this.value=t}clone(e){let{key:t,value:i}=this;return G(t)&&(t=t.clone(e)),G(i)&&(i=i.clone(e)),new te(t,i)}toJSON(e,t){const i=t?.mapAsMap?new Map:{};return vi(t,i,this)}toString(e,t,i){return e?.doc?Xs(this,e,t,i):JSON.stringify(this)}}function Ci(n,e,t){return(e.inFlow??n.flow?tr:er)(n,e,t)}function er({comment:n,items:e},t,{blockItemPrefix:i,flowChars:s,itemIndent:r,onChompKeep:o,onComment:a}){const{indent:l,options:{commentString:f}}=t,h=Object.assign({},t,{indent:r,type:null});let c=!1;const d=[];for(let O=0;O<e.length;++O){const p=e[O];let m=null;if(G(p))!c&&p.spaceBefore&&d.push(""),vt(t,d,p.commentBefore,c),p.comment&&(m=p.comment);else if(W(p)){const T=G(p.key)?p.key:null;T&&(!c&&T.spaceBefore&&d.push(""),vt(t,d,T.commentBefore,c))}c=!1;let I=Ye(p,h,()=>m=null,()=>c=!0);m&&(I+=Le(I,r,f(m))),c&&m&&(c=!1),d.push(i+I)}let g;if(d.length===0)g=s.start+s.end;else{g=d[0];for(let O=1;O<d.length;++O){const p=d[O];g+=p?`
${l}${p}`:`
`}}return n?(g+=`
`+Oe(f(n),l),a&&a()):c&&o&&o(),g}function tr({items:n},e,{flowChars:t,itemIndent:i}){const{indent:s,indentStep:r,flowCollectionPadding:o,options:{commentString:a}}=e;i+=r;const l=Object.assign({},e,{indent:i,inFlow:!0,type:null});let f=!1,h=0;const c=[];for(let O=0;O<n.length;++O){const p=n[O];let m=null;if(G(p))p.spaceBefore&&c.push(""),vt(e,c,p.commentBefore,!1),p.comment&&(m=p.comment);else if(W(p)){const T=G(p.key)?p.key:null;T&&(T.spaceBefore&&c.push(""),vt(e,c,T.commentBefore,!1),T.comment&&(f=!0));const B=G(p.value)?p.value:null;B?(B.comment&&(m=B.comment),B.commentBefore&&(f=!0)):p.value==null&&T?.comment&&(m=T.comment)}m&&(f=!0);let I=Ye(p,l,()=>m=null);O<n.length-1&&(I+=","),m&&(I+=Le(I,i,a(m))),!f&&(c.length>h||I.includes(`
`))&&(f=!0),c.push(I),h=c.length}const{start:d,end:g}=t;if(c.length===0)return d+g;if(!f){const O=c.reduce((p,m)=>p+m.length+2,2);f=e.options.lineWidth>0&&O>e.options.lineWidth}if(f){let O=d;for(const p of c)O+=p?`
${r}${s}${p}`:`
`;return`${O}
${s}${g}`}else return`${d}${o}${c.join(" ")}${o}${g}`}function vt({indent:n,options:{commentString:e}},t,i,s){if(i&&s&&(i=i.replace(/^\n+/,"")),i){const r=Oe(e(i),n);t.push(r.trimStart())}}function Me(n,e){const t=q(e)?e.value:e;for(const i of n)if(W(i)&&(i.key===e||i.key===t||q(i.key)&&i.key.value===t))return i}class oe extends Nn{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(Be,e),this.items=[]}static from(e,t,i){const{keepUndefined:s,replacer:r}=i,o=new this(e),a=(l,f)=>{if(typeof r=="function")f=r.call(t,l,f);else if(Array.isArray(r)&&!r.includes(l))return;(f!==void 0||s)&&o.items.push(kn(l,f,i))};if(t instanceof Map)for(const[l,f]of t)a(l,f);else if(t&&typeof t=="object")for(const l of Object.keys(t))a(l,t[l]);return typeof e.sortMapEntries=="function"&&o.items.sort(e.sortMapEntries),o}add(e,t){let i;W(e)?i=e:!e||typeof e!="object"||!("key"in e)?i=new te(e,e?.value):i=new te(e.key,e.value);const s=Me(this.items,i.key),r=this.schema?.sortMapEntries;if(s){if(!t)throw new Error(`Key ${i.key} already set`);q(s.value)&&Ai(i.value)?s.value.value=i.value:s.value=i.value}else if(r){const o=this.items.findIndex(a=>r(i,a)<0);o===-1?this.items.push(i):this.items.splice(o,0,i)}else this.items.push(i)}delete(e){const t=Me(this.items,e);return t?this.items.splice(this.items.indexOf(t),1).length>0:!1}get(e,t){const s=Me(this.items,e)?.value;return(!t&&q(s)?s.value:s)??void 0}has(e){return!!Me(this.items,e)}set(e,t){this.add(new te(e,t),!0)}toJSON(e,t,i){const s=i?new i:t?.mapAsMap?new Map:{};t?.onCreate&&t.onCreate(s);for(const r of this.items)vi(t,s,r);return s}toString(e,t,i){if(!e)return JSON.stringify(this);for(const s of this.items)if(!W(s))throw new Error(`Map items must all be pairs; found ${JSON.stringify(s)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),Ci(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:i,onComment:t})}}const nt={collection:"map",default:!0,nodeClass:oe,tag:"tag:yaml.org,2002:map",resolve(n,e){return et(n)||e("Expected a mapping for this tag"),n},createNode:(n,e,t)=>oe.from(n,e,t)};class Ce extends Nn{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(Ze,e),this.items=[]}add(e){this.items.push(e)}delete(e){const t=Nt(e);return typeof t!="number"?!1:this.items.splice(t,1).length>0}get(e,t){const i=Nt(e);if(typeof i!="number")return;const s=this.items[i];return!t&&q(s)?s.value:s}has(e){const t=Nt(e);return typeof t=="number"&&t<this.items.length}set(e,t){const i=Nt(e);if(typeof i!="number")throw new Error(`Expected a valid index, not ${e}.`);const s=this.items[i];q(s)&&Ai(t)?s.value=t:this.items[i]=t}toJSON(e,t){const i=[];t?.onCreate&&t.onCreate(i);let s=0;for(const r of this.items)i.push(ce(r,String(s++),t));return i}toString(e,t,i){return e?Ci(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:i,onComment:t}):JSON.stringify(this)}static from(e,t,i){const{replacer:s}=i,r=new this(e);if(t&&Symbol.iterator in Object(t)){let o=0;for(let a of t){if(typeof s=="function"){const l=t instanceof Set?a:String(o++);a=s.call(t,l,a)}r.items.push(ut(a,void 0,i))}}return r}}function Nt(n){let e=q(n)?n.value:n;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}const it={collection:"seq",default:!0,nodeClass:Ce,tag:"tag:yaml.org,2002:seq",resolve(n,e){return tt(n)||e("Expected a sequence for this tag"),n},createNode:(n,e,t)=>Ce.from(n,e,t)},Rt={identify:n=>typeof n=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:n=>n,stringify(n,e,t,i){return e=Object.assign({actualString:!0},e),pt(n,e,t,i)}},jt={identify:n=>n==null,createNode:()=>new M(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new M(null),stringify:({source:n},e)=>typeof n=="string"&&jt.test.test(n)?n:e.options.nullStr},Tn={identify:n=>typeof n=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:n=>new M(n[0]==="t"||n[0]==="T"),stringify({source:n,value:e},t){if(n&&Tn.test.test(n)){const i=n[0]==="t"||n[0]==="T";if(e===i)return n}return e?t.options.trueStr:t.options.falseStr}};function ge({format:n,minFractionDigits:e,tag:t,value:i}){if(typeof i=="bigint")return String(i);const s=typeof i=="number"?i:Number(i);if(!isFinite(s))return isNaN(s)?".nan":s<0?"-.inf":".inf";let r=JSON.stringify(i);if(!n&&e&&(!t||t==="tag:yaml.org,2002:float")&&/^\d/.test(r)){let o=r.indexOf(".");o<0&&(o=r.length,r+=".");let a=e-(r.length-o-1);for(;a-- >0;)r+="0"}return r}const _i={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN))$/,resolve:n=>n.slice(-3).toLowerCase()==="nan"?NaN:n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ge},Li={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:n=>parseFloat(n),stringify(n){const e=Number(n.value);return isFinite(e)?e.toExponential():ge(n)}},Mi={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(n){const e=new M(parseFloat(n)),t=n.indexOf(".");return t!==-1&&n[n.length-1]==="0"&&(e.minFractionDigits=n.length-t-1),e},stringify:ge},Ft=n=>typeof n=="bigint"||Number.isInteger(n),On=(n,e,t,{intAsBigInt:i})=>i?BigInt(n):parseInt(n.substring(e),t);function Pi(n,e,t){const{value:i}=n;return Ft(i)&&i>=0?t+i.toString(e):ge(n)}const xi={identify:n=>Ft(n)&&n>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(n,e,t)=>On(n,2,8,t),stringify:n=>Pi(n,8,"0o")},Di={identify:Ft,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(n,e,t)=>On(n,0,10,t),stringify:ge},Ri={identify:n=>Ft(n)&&n>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(n,e,t)=>On(n,2,16,t),stringify:n=>Pi(n,16,"0x")},nr=[nt,it,Rt,jt,Tn,xi,Di,Ri,_i,Li,Mi];function Gn(n){return typeof n=="bigint"||Number.isInteger(n)}const kt=({value:n})=>JSON.stringify(n),ir=[{identify:n=>typeof n=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:n=>n,stringify:kt},{identify:n=>n==null,createNode:()=>new M(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:kt},{identify:n=>typeof n=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:n=>n==="true",stringify:kt},{identify:Gn,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(n,e,{intAsBigInt:t})=>t?BigInt(n):parseInt(n,10),stringify:({value:n})=>Gn(n)?n.toString():JSON.stringify(n)},{identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:n=>parseFloat(n),stringify:kt}],sr={default:!0,tag:"",test:/^/,resolve(n,e){return e(`Unresolved plain scalar ${JSON.stringify(n)}`),n}},rr=[nt,it].concat(ir,sr),En={identify:n=>n instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(n,e){if(typeof Buffer=="function")return Buffer.from(n,"base64");if(typeof atob=="function"){const t=atob(n.replace(/[\n\r]/g,"")),i=new Uint8Array(t.length);for(let s=0;s<t.length;++s)i[s]=t.charCodeAt(s);return i}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),n},stringify({comment:n,type:e,value:t},i,s,r){const o=t;let a;if(typeof Buffer=="function")a=o instanceof Buffer?o.toString("base64"):Buffer.from(o.buffer).toString("base64");else if(typeof btoa=="function"){let l="";for(let f=0;f<o.length;++f)l+=String.fromCharCode(o[f]);a=btoa(l)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e||(e=M.BLOCK_LITERAL),e!==M.QUOTE_DOUBLE){const l=Math.max(i.options.lineWidth-i.indent.length,i.options.minContentWidth),f=Math.ceil(a.length/l),h=new Array(f);for(let c=0,d=0;c<f;++c,d+=l)h[c]=a.substr(d,l);a=h.join(e===M.BLOCK_LITERAL?`
`:" ")}return pt({comment:n,type:e,value:a},i,s,r)}};function ji(n,e){if(tt(n))for(let t=0;t<n.items.length;++t){let i=n.items[t];if(!W(i)){if(et(i)){i.items.length>1&&e("Each pair must have its own sequence indicator");const s=i.items[0]||new te(new M(null));if(i.commentBefore&&(s.key.commentBefore=s.key.commentBefore?`${i.commentBefore}
${s.key.commentBefore}`:i.commentBefore),i.comment){const r=s.value??s.key;r.comment=r.comment?`${i.comment}
${r.comment}`:i.comment}i=s}n.items[t]=W(i)?i:new te(i)}}else e("Expected a sequence for this tag");return n}function Fi(n,e,t){const{replacer:i}=t,s=new Ce(n);s.tag="tag:yaml.org,2002:pairs";let r=0;if(e&&Symbol.iterator in Object(e))for(let o of e){typeof i=="function"&&(o=i.call(e,String(r++),o));let a,l;if(Array.isArray(o))if(o.length===2)a=o[0],l=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const f=Object.keys(o);if(f.length===1)a=f[0],l=o[a];else throw new TypeError(`Expected tuple with one key, not ${f.length} keys`)}else a=o;s.items.push(kn(a,l,t))}return s}const An={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:ji,createNode:Fi};class We extends Ce{constructor(){super(),this.add=oe.prototype.add.bind(this),this.delete=oe.prototype.delete.bind(this),this.get=oe.prototype.get.bind(this),this.has=oe.prototype.has.bind(this),this.set=oe.prototype.set.bind(this),this.tag=We.tag}toJSON(e,t){if(!t)return super.toJSON(e);const i=new Map;t?.onCreate&&t.onCreate(i);for(const s of this.items){let r,o;if(W(s)?(r=ce(s.key,"",t),o=ce(s.value,r,t)):r=ce(s,"",t),i.has(r))throw new Error("Ordered maps must not include duplicate keys");i.set(r,o)}return i}static from(e,t,i){const s=Fi(e,t,i),r=new this;return r.items=s.items,r}}We.tag="tag:yaml.org,2002:omap";const In={collection:"seq",identify:n=>n instanceof Map,nodeClass:We,default:!1,tag:"tag:yaml.org,2002:omap",resolve(n,e){const t=ji(n,e),i=[];for(const{key:s}of t.items)q(s)&&(i.includes(s.value)?e(`Ordered maps must not include duplicate keys: ${s.value}`):i.push(s.value));return Object.assign(new We,t)},createNode:(n,e,t)=>We.from(n,e,t)};function Ui({value:n,source:e},t){return e&&(n?Vi:Hi).test.test(e)?e:n?t.options.trueStr:t.options.falseStr}const Vi={identify:n=>n===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new M(!0),stringify:Ui},Hi={identify:n=>n===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new M(!1),stringify:Ui},or={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?\.(?:inf|Inf|INF|nan|NaN|NAN)$/,resolve:n=>n.slice(-3).toLowerCase()==="nan"?NaN:n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ge},ar={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:n=>parseFloat(n.replace(/_/g,"")),stringify(n){const e=Number(n.value);return isFinite(e)?e.toExponential():ge(n)}},lr={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(n){const e=new M(parseFloat(n.replace(/_/g,""))),t=n.indexOf(".");if(t!==-1){const i=n.substring(t+1).replace(/_/g,"");i[i.length-1]==="0"&&(e.minFractionDigits=i.length)}return e},stringify:ge},mt=n=>typeof n=="bigint"||Number.isInteger(n);function Ut(n,e,t,{intAsBigInt:i}){const s=n[0];if((s==="-"||s==="+")&&(e+=1),n=n.substring(e).replace(/_/g,""),i){switch(t){case 2:n=`0b${n}`;break;case 8:n=`0o${n}`;break;case 16:n=`0x${n}`;break}const o=BigInt(n);return s==="-"?BigInt(-1)*o:o}const r=parseInt(n,t);return s==="-"?-1*r:r}function Bn(n,e,t){const{value:i}=n;if(mt(i)){const s=i.toString(e);return i<0?"-"+t+s.substr(1):t+s}return ge(n)}const fr={identify:mt,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(n,e,t)=>Ut(n,2,2,t),stringify:n=>Bn(n,2,"0b")},cr={identify:mt,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(n,e,t)=>Ut(n,1,8,t),stringify:n=>Bn(n,8,"0")},ur={identify:mt,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(n,e,t)=>Ut(n,0,10,t),stringify:ge},hr={identify:mt,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(n,e,t)=>Ut(n,2,16,t),stringify:n=>Bn(n,16,"0x")};class Je extends oe{constructor(e){super(e),this.tag=Je.tag}add(e){let t;W(e)?t=e:e&&typeof e=="object"&&"key"in e&&"value"in e&&e.value===null?t=new te(e.key,null):t=new te(e,null),Me(this.items,t.key)||this.items.push(t)}get(e,t){const i=Me(this.items,e);return!t&&W(i)?q(i.key)?i.key.value:i.key:i}set(e,t){if(typeof t!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof t}`);const i=Me(this.items,e);i&&!t?this.items.splice(this.items.indexOf(i),1):!i&&t&&this.items.push(new te(e))}toJSON(e,t){return super.toJSON(e,t,Set)}toString(e,t,i){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),t,i);throw new Error("Set items must all have null values")}static from(e,t,i){const{replacer:s}=i,r=new this(e);if(t&&Symbol.iterator in Object(t))for(let o of t)typeof s=="function"&&(o=s.call(t,o,o)),r.items.push(kn(o,null,i));return r}}Je.tag="tag:yaml.org,2002:set";const $n={collection:"map",identify:n=>n instanceof Set,nodeClass:Je,default:!1,tag:"tag:yaml.org,2002:set",createNode:(n,e,t)=>Je.from(n,e,t),resolve(n,e){if(et(n)){if(n.hasAllNullValues(!0))return Object.assign(new Je,n);e("Set items must all have null values")}else e("Expected a mapping for this tag");return n}};function vn(n,e){const t=n[0],i=t==="-"||t==="+"?n.substring(1):n,s=o=>e?BigInt(o):Number(o),r=i.replace(/_/g,"").split(":").reduce((o,a)=>o*s(60)+s(a),s(0));return t==="-"?s(-1)*r:r}function Ki(n){let{value:e}=n,t=o=>o;if(typeof e=="bigint")t=o=>BigInt(o);else if(isNaN(e)||!isFinite(e))return ge(n);let i="";e<0&&(i="-",e*=t(-1));const s=t(60),r=[e%s];return e<60?r.unshift(0):(e=(e-r[0])/s,r.unshift(e%s),e>=60&&(e=(e-r[0])/s,r.unshift(e))),i+r.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const qi={identify:n=>typeof n=="bigint"||Number.isInteger(n),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(n,e,{intAsBigInt:t})=>vn(n,t),stringify:Ki},Wi={identify:n=>typeof n=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:n=>vn(n,!1),stringify:Ki},Vt={identify:n=>n instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(n){const e=n.match(Vt.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,t,i,s,r,o,a]=e.map(Number),l=e[7]?Number((e[7]+"00").substr(1,3)):0;let f=Date.UTC(t,i-1,s,r||0,o||0,a||0,l);const h=e[8];if(h&&h!=="Z"){let c=vn(h,!1);Math.abs(c)<30&&(c*=60),f-=6e4*c}return new Date(f)},stringify:({value:n})=>n.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")},Yn=[nt,it,Rt,jt,Vi,Hi,fr,cr,ur,hr,or,ar,lr,En,In,An,$n,qi,Wi,Vt],zn=new Map([["core",nr],["failsafe",[nt,it,Rt]],["json",rr],["yaml11",Yn],["yaml-1.1",Yn]]),Xn={binary:En,bool:Tn,float:Mi,floatExp:Li,floatNaN:_i,floatTime:Wi,int:Di,intHex:Ri,intOct:xi,intTime:qi,map:nt,null:jt,omap:In,pairs:An,seq:it,set:$n,timestamp:Vt},dr={"tag:yaml.org,2002:binary":En,"tag:yaml.org,2002:omap":In,"tag:yaml.org,2002:pairs":An,"tag:yaml.org,2002:set":$n,"tag:yaml.org,2002:timestamp":Vt};function Qt(n,e){let t=zn.get(e);if(!t)if(Array.isArray(n))t=[];else{const i=Array.from(zn.keys()).filter(s=>s!=="yaml11").map(s=>JSON.stringify(s)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${i} or define customTags array`)}if(Array.isArray(n))for(const i of n)t=t.concat(i);else typeof n=="function"&&(t=n(t.slice()));return t.map(i=>{if(typeof i!="string")return i;const s=Xn[i];if(s)return s;const r=Object.keys(Xn).map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown custom tag "${i}"; use one of ${r}`)})}const pr=(n,e)=>n.key<e.key?-1:n.key>e.key?1:0;class Ht{constructor({compat:e,customTags:t,merge:i,resolveKnownTags:s,schema:r,sortMapEntries:o,toStringDefaults:a}){this.compat=Array.isArray(e)?Qt(e,"compat"):e?Qt(null,e):null,this.merge=!!i,this.name=typeof r=="string"&&r||"core",this.knownTags=s?dr:{},this.tags=Qt(t,this.name),this.toStringOptions=a??null,Object.defineProperty(this,Be,{value:nt}),Object.defineProperty(this,Ae,{value:Rt}),Object.defineProperty(this,Ze,{value:it}),this.sortMapEntries=typeof o=="function"?o:o===!0?pr:null}clone(){const e=Object.create(Ht.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}function mr(n,e){const t=[];let i=e.directives===!0;if(e.directives!==!1&&n.directives){const l=n.directives.toString(n);l?(t.push(l),i=!0):n.directives.docStart&&(i=!0)}i&&t.push("---");const s=Bi(n,e),{commentString:r}=s.options;if(n.commentBefore){t.length!==1&&t.unshift("");const l=r(n.commentBefore);t.unshift(Oe(l,""))}let o=!1,a=null;if(n.contents){if(G(n.contents)){if(n.contents.spaceBefore&&i&&t.push(""),n.contents.commentBefore){const h=r(n.contents.commentBefore);t.push(Oe(h,""))}s.forceBlockIndent=!!n.comment,a=n.contents.comment}const l=a?void 0:()=>o=!0;let f=Ye(n.contents,s,()=>a=null,l);a&&(f+=Le(f,"",r(a))),(f[0]==="|"||f[0]===">")&&t[t.length-1]==="---"?t[t.length-1]=`--- ${f}`:t.push(f)}else t.push(Ye(n.contents,s));if(n.directives?.docEnd)if(n.comment){const l=r(n.comment);l.includes(`
`)?(t.push("..."),t.push(Oe(l,""))):t.push(`... ${l}`)}else t.push("...");else{let l=n.comment;l&&o&&(l=l.replace(/^\n+/,"")),l&&((!o||a)&&t[t.length-1]!==""&&t.push(""),t.push(Oe(r(l),"")))}return t.join(`
`)+`
`}class st{constructor(e,t,i){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,ue,{value:cn});let s=null;typeof t=="function"||Array.isArray(t)?s=t:i===void 0&&t&&(i=t,t=void 0);const r=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,uniqueKeys:!0,version:"1.2"},i);this.options=r;let{version:o}=r;i?._directives?(this.directives=i._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new ne({version:o}),this.setSchema(o,i),this.contents=e===void 0?null:this.createNode(e,s,i)}clone(){const e=Object.create(st.prototype,{[ue]:{value:cn}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=G(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){Re(this.contents)&&this.contents.add(e)}addIn(e,t){Re(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){const i=Oi(this);e.anchor=!t||i.has(t)?Ei(t||"a",i):t}return new Mt(e.anchor)}createNode(e,t,i){let s;if(typeof t=="function")e=t.call({"":e},"",e),s=t;else if(Array.isArray(t)){const m=T=>typeof T=="number"||T instanceof String||T instanceof Number,I=t.filter(m).map(String);I.length>0&&(t=t.concat(I)),s=t}else i===void 0&&t&&(i=t,t=void 0);const{aliasDuplicateObjects:r,anchorPrefix:o,flow:a,keepUndefined:l,onTagObj:f,tag:h}=i??{},{onAnchor:c,setAnchors:d,sourceObjects:g}=Hs(this,o||"a"),O={aliasDuplicateObjects:r??!0,keepUndefined:l??!1,onAnchor:c,onTagObj:f,replacer:s,schema:this.schema,sourceObjects:g},p=ut(e,h,O);return a&&J(p)&&(p.flow=!0),d(),p}createPair(e,t,i={}){const s=this.createNode(e,null,i),r=this.createNode(t,null,i);return new te(s,r)}delete(e){return Re(this.contents)?this.contents.delete(e):!1}deleteIn(e){return ft(e)?this.contents==null?!1:(this.contents=null,!0):Re(this.contents)?this.contents.deleteIn(e):!1}get(e,t){return J(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return ft(e)?!t&&q(this.contents)?this.contents.value:this.contents:J(this.contents)?this.contents.getIn(e,t):void 0}has(e){return J(this.contents)?this.contents.has(e):!1}hasIn(e){return ft(e)?this.contents!==void 0:J(this.contents)?this.contents.hasIn(e):!1}set(e,t){this.contents==null?this.contents=$t(this.schema,[e],t):Re(this.contents)&&this.contents.set(e,t)}setIn(e,t){ft(e)?this.contents=t:this.contents==null?this.contents=$t(this.schema,Array.from(e),t):Re(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){typeof e=="number"&&(e=String(e));let i;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new ne({version:"1.1"}),i={merge:!0,resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new ne({version:e}),i={merge:!1,resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,i=null;break;default:{const s=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${s}`)}}if(t.schema instanceof Object)this.schema=t.schema;else if(i)this.schema=new Ht(Object.assign(i,t));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:t,mapAsMap:i,maxAliasCount:s,onAnchor:r,reviver:o}={}){const a={anchors:new Map,doc:this,keep:!e,mapAsMap:i===!0,mapKeyWarned:!1,maxAliasCount:typeof s=="number"?s:100},l=ce(this.contents,t??"",a);if(typeof r=="function")for(const{count:f,res:h}of a.anchors.values())r(h,f);return typeof o=="function"?He(o,{"":l},"",l):l}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return mr(this,e)}}function Re(n){if(J(n))return!0;throw new Error("Expected a YAML collection as document contents")}class Cn extends Error{constructor(e,t,i,s){super(),this.name=e,this.code=i,this.message=s,this.pos=t}}class Pe extends Cn{constructor(e,t,i){super("YAMLParseError",e,t,i)}}class Ji extends Cn{constructor(e,t,i){super("YAMLWarning",e,t,i)}}const Ct=(n,e)=>t=>{if(t.pos[0]===-1)return;t.linePos=t.pos.map(a=>e.linePos(a));const{line:i,col:s}=t.linePos[0];t.message+=` at line ${i}, column ${s}`;let r=s-1,o=n.substring(e.lineStarts[i-1],e.lineStarts[i]).replace(/[\n\r]+$/,"");if(r>=60&&o.length>80){const a=Math.min(r-39,o.length-79);o="…"+o.substring(a),r-=a-1}if(o.length>80&&(o=o.substring(0,79)+"…"),i>1&&/^ *$/.test(o.substring(0,r))){let a=n.substring(e.lineStarts[i-2],e.lineStarts[i-1]);a.length>80&&(a=a.substring(0,79)+`…
`),o=a+o}if(/[^ ]/.test(o)){let a=1;const l=t.linePos[1];l&&l.line===i&&l.col>s&&(a=Math.max(1,Math.min(l.col-s,80-r)));const f=" ".repeat(r)+"^".repeat(a);t.message+=`:

${o}
${f}
`}};function ze(n,{flow:e,indicator:t,next:i,offset:s,onError:r,startOnNewline:o}){let a=!1,l=o,f=o,h="",c="",d=!1,g=!1,O=!1,p=null,m=null,I=null,T=null,B=null;for(const A of n)switch(O&&(A.type!=="space"&&A.type!=="newline"&&A.type!=="comma"&&r(A.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),O=!1),A.type){case"space":!e&&l&&t!=="doc-start"&&A.source[0]==="	"&&r(A,"TAB_AS_INDENT","Tabs are not allowed as indentation"),f=!0;break;case"comment":{f||r(A,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const U=A.source.substring(1)||" ";h?h+=c+U:h=U,c="",l=!1;break}case"newline":l?h?h+=A.source:a=!0:c+=A.source,l=!0,d=!0,(p||m)&&(g=!0),f=!0;break;case"anchor":p&&r(A,"MULTIPLE_ANCHORS","A node can have at most one anchor"),A.source.endsWith(":")&&r(A.offset+A.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),p=A,B===null&&(B=A.offset),l=!1,f=!1,O=!0;break;case"tag":{m&&r(A,"MULTIPLE_TAGS","A node can have at most one tag"),m=A,B===null&&(B=A.offset),l=!1,f=!1,O=!0;break}case t:(p||m)&&r(A,"BAD_PROP_ORDER",`Anchors and tags must be after the ${A.source} indicator`),T&&r(A,"UNEXPECTED_TOKEN",`Unexpected ${A.source} in ${e??"collection"}`),T=A,l=!1,f=!1;break;case"comma":if(e){I&&r(A,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),I=A,l=!1,f=!1;break}default:r(A,"UNEXPECTED_TOKEN",`Unexpected ${A.type} token`),l=!1,f=!1}const w=n[n.length-1],v=w?w.offset+w.source.length:s;return O&&i&&i.type!=="space"&&i.type!=="newline"&&i.type!=="comma"&&(i.type!=="scalar"||i.source!=="")&&r(i.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),{comma:I,found:T,spaceBefore:a,comment:h,hasNewline:d,hasNewlineAfterProp:g,anchor:p,tag:m,end:v,start:B??v}}function ht(n){if(!n)return null;switch(n.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(n.source.includes(`
`))return!0;if(n.end){for(const e of n.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(const e of n.items){for(const t of e.start)if(t.type==="newline")return!0;if(e.sep){for(const t of e.sep)if(t.type==="newline")return!0}if(ht(e.key)||ht(e.value))return!0}return!1;default:return!0}}function pn(n,e,t){if(e?.type==="flow-collection"){const i=e.end[0];i.indent===n&&(i.source==="]"||i.source==="}")&&ht(e)&&t(i,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function Gi(n,e,t){const{uniqueKeys:i}=n.options;if(i===!1)return!1;const s=typeof i=="function"?i:(r,o)=>r===o||q(r)&&q(o)&&r.value===o.value&&!(r.value==="<<"&&n.schema.merge);return e.some(r=>s(r.key,t))}const Zn="All mapping items must start at the same column";function gr({composeNode:n,composeEmptyNode:e},t,i,s,r){const o=r?.nodeClass??oe,a=new o(t.schema);t.atRoot&&(t.atRoot=!1);let l=i.offset,f=null;for(const h of i.items){const{start:c,key:d,sep:g,value:O}=h,p=ze(c,{indicator:"explicit-key-ind",next:d??g?.[0],offset:l,onError:s,startOnNewline:!0}),m=!p.found;if(m){if(d&&(d.type==="block-seq"?s(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in d&&d.indent!==i.indent&&s(l,"BAD_INDENT",Zn)),!p.anchor&&!p.tag&&!g){f=p.end,p.comment&&(a.comment?a.comment+=`
`+p.comment:a.comment=p.comment);continue}(p.hasNewlineAfterProp||ht(d))&&s(d??c[c.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else p.found?.indent!==i.indent&&s(l,"BAD_INDENT",Zn);const I=p.end,T=d?n(t,d,p,s):e(t,I,c,null,p,s);t.schema.compat&&pn(i.indent,d,s),Gi(t,a.items,T)&&s(I,"DUPLICATE_KEY","Map keys must be unique");const B=ze(g??[],{indicator:"map-value-ind",next:O,offset:T.range[2],onError:s,startOnNewline:!d||d.type==="block-scalar"});if(l=B.end,B.found){m&&(O?.type==="block-map"&&!B.hasNewline&&s(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),t.options.strict&&p.start<B.found.offset-1024&&s(T.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const w=O?n(t,O,B,s):e(t,l,g,null,B,s);t.schema.compat&&pn(i.indent,O,s),l=w.range[2];const v=new te(T,w);t.options.keepSourceTokens&&(v.srcToken=h),a.items.push(v)}else{m&&s(T.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),B.comment&&(T.comment?T.comment+=`
`+B.comment:T.comment=B.comment);const w=new te(T);t.options.keepSourceTokens&&(w.srcToken=h),a.items.push(w)}}return f&&f<l&&s(f,"IMPOSSIBLE","Map comment with trailing content"),a.range=[i.offset,l,f??l],a}function yr({composeNode:n,composeEmptyNode:e},t,i,s,r){const o=r?.nodeClass??Ce,a=new o(t.schema);t.atRoot&&(t.atRoot=!1);let l=i.offset,f=null;for(const{start:h,value:c}of i.items){const d=ze(h,{indicator:"seq-item-ind",next:c,offset:l,onError:s,startOnNewline:!0});if(!d.found)if(d.anchor||d.tag||c)c&&c.type==="block-seq"?s(d.end,"BAD_INDENT","All sequence items must start at the same column"):s(l,"MISSING_CHAR","Sequence item without - indicator");else{f=d.end,d.comment&&(a.comment=d.comment);continue}const g=c?n(t,c,d,s):e(t,d.end,h,null,d,s);t.schema.compat&&pn(i.indent,c,s),l=g.range[2],a.items.push(g)}return a.range=[i.offset,l,f??l],a}function gt(n,e,t,i){let s="";if(n){let r=!1,o="";for(const a of n){const{source:l,type:f}=a;switch(f){case"space":r=!0;break;case"comment":{t&&!r&&i(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const h=l.substring(1)||" ";s?s+=o+h:s=h,o="";break}case"newline":s&&(o+=l),r=!0;break;default:i(a,"UNEXPECTED_TOKEN",`Unexpected ${f} at node end`)}e+=l.length}}return{comment:s,offset:e}}const en="Block collections are not allowed within flow collections",tn=n=>n&&(n.type==="block-map"||n.type==="block-seq");function br({composeNode:n,composeEmptyNode:e},t,i,s,r){const o=i.start.source==="{",a=o?"flow map":"flow sequence",l=r?.nodeClass??(o?oe:Ce),f=new l(t.schema);f.flow=!0;const h=t.atRoot;h&&(t.atRoot=!1);let c=i.offset+i.start.source.length;for(let m=0;m<i.items.length;++m){const I=i.items[m],{start:T,key:B,sep:w,value:v}=I,A=ze(T,{flow:a,indicator:"explicit-key-ind",next:B??w?.[0],offset:c,onError:s,startOnNewline:!1});if(!A.found){if(!A.anchor&&!A.tag&&!w&&!v){m===0&&A.comma?s(A.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):m<i.items.length-1&&s(A.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),A.comment&&(f.comment?f.comment+=`
`+A.comment:f.comment=A.comment),c=A.end;continue}!o&&t.options.strict&&ht(B)&&s(B,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(m===0)A.comma&&s(A.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(A.comma||s(A.start,"MISSING_CHAR",`Missing , between ${a} items`),A.comment){let U="";e:for(const R of T)switch(R.type){case"comma":case"space":break;case"comment":U=R.source.substring(1);break e;default:break e}if(U){let R=f.items[f.items.length-1];W(R)&&(R=R.value??R.key),R.comment?R.comment+=`
`+U:R.comment=U,A.comment=A.comment.substring(U.length+1)}}if(!o&&!w&&!A.found){const U=v?n(t,v,A,s):e(t,A.end,w,null,A,s);f.items.push(U),c=U.range[2],tn(v)&&s(U.range,"BLOCK_IN_FLOW",en)}else{const U=A.end,R=B?n(t,B,A,s):e(t,U,T,null,A,s);tn(B)&&s(R.range,"BLOCK_IN_FLOW",en);const L=ze(w??[],{flow:a,indicator:"map-value-ind",next:v,offset:R.range[2],onError:s,startOnNewline:!1});if(L.found){if(!o&&!A.found&&t.options.strict){if(w)for(const H of w){if(H===L.found)break;if(H.type==="newline"){s(H,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}A.start<L.found.offset-1024&&s(L.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else v&&("source"in v&&v.source&&v.source[0]===":"?s(v,"MISSING_CHAR",`Missing space after : in ${a}`):s(L.start,"MISSING_CHAR",`Missing , or : between ${a} items`));const V=v?n(t,v,L,s):L.found?e(t,L.end,w,null,L,s):null;V?tn(v)&&s(V.range,"BLOCK_IN_FLOW",en):L.comment&&(R.comment?R.comment+=`
`+L.comment:R.comment=L.comment);const x=new te(R,V);if(t.options.keepSourceTokens&&(x.srcToken=I),o){const H=f;Gi(t,H.items,R)&&s(U,"DUPLICATE_KEY","Map keys must be unique"),H.items.push(x)}else{const H=new oe(t.schema);H.flow=!0,H.items.push(x),f.items.push(H)}c=V?V.range[2]:L.end}}const d=o?"}":"]",[g,...O]=i.end;let p=c;if(g&&g.source===d)p=g.offset+g.source.length;else{const m=a[0].toUpperCase()+a.substring(1),I=h?`${m} must end with a ${d}`:`${m} in block collection must be sufficiently indented and end with a ${d}`;s(c,h?"MISSING_CHAR":"BAD_INDENT",I),g&&g.source.length!==1&&O.unshift(g)}if(O.length>0){const m=gt(O,p,t.options.strict,s);m.comment&&(f.comment?f.comment+=`
`+m.comment:f.comment=m.comment),f.range=[i.offset,p,m.offset]}else f.range=[i.offset,p,p];return f}function nn(n,e,t,i,s,r){const o=t.type==="block-map"?gr(n,e,t,i,r):t.type==="block-seq"?yr(n,e,t,i,r):br(n,e,t,i,r),a=o.constructor;return s==="!"||s===a.tagName?(o.tag=a.tagName,o):(s&&(o.tag=s),o)}function wr(n,e,t,i,s){const r=i?e.directives.tagName(i.source,c=>s(i,"TAG_RESOLVE_FAILED",c)):null,o=t.type==="block-map"?"map":t.type==="block-seq"?"seq":t.start.source==="{"?"map":"seq";if(!i||!r||r==="!"||r===oe.tagName&&o==="map"||r===Ce.tagName&&o==="seq"||!o)return nn(n,e,t,s,r);let a=e.schema.tags.find(c=>c.tag===r&&c.collection===o);if(!a){const c=e.schema.knownTags[r];if(c&&c.collection===o)e.schema.tags.push(Object.assign({},c,{default:!1})),a=c;else return c?.collection?s(i,"BAD_COLLECTION_TYPE",`${c.tag} used for ${o} collection, but expects ${c.collection}`,!0):s(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${r}`,!0),nn(n,e,t,s,r)}const l=nn(n,e,t,s,r,a),f=a.resolve?.(l,c=>s(i,"TAG_RESOLVE_FAILED",c),e.options)??l,h=G(f)?f:new M(f);return h.range=l.range,h.tag=r,a?.format&&(h.format=a.format),h}function Yi(n,e,t){const i=n.offset,s=Sr(n,e,t);if(!s)return{value:"",type:null,comment:"",range:[i,i,i]};const r=s.mode===">"?M.BLOCK_FOLDED:M.BLOCK_LITERAL,o=n.source?Nr(n.source):[];let a=o.length;for(let p=o.length-1;p>=0;--p){const m=o[p][1];if(m===""||m==="\r")a=p;else break}if(a===0){const p=s.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let m=i+s.length;return n.source&&(m+=n.source.length),{value:p,type:r,comment:s.comment,range:[i,m,m]}}let l=n.indent+s.indent,f=n.offset+s.length,h=0;for(let p=0;p<a;++p){const[m,I]=o[p];if(I===""||I==="\r")s.indent===0&&m.length>l&&(l=m.length);else{m.length<l&&t(f+m.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),s.indent===0&&(l=m.length),h=p;break}f+=m.length+I.length+1}for(let p=o.length-1;p>=a;--p)o[p][0].length>l&&(a=p+1);let c="",d="",g=!1;for(let p=0;p<h;++p)c+=o[p][0].slice(l)+`
`;for(let p=h;p<a;++p){let[m,I]=o[p];f+=m.length+I.length+1;const T=I[I.length-1]==="\r";if(T&&(I=I.slice(0,-1)),I&&m.length<l){const w=`Block scalar lines must not be less indented than their ${s.indent?"explicit indentation indicator":"first line"}`;t(f-I.length-(T?2:1),"BAD_INDENT",w),m=""}r===M.BLOCK_LITERAL?(c+=d+m.slice(l)+I,d=`
`):m.length>l||I[0]==="	"?(d===" "?d=`
`:!g&&d===`
`&&(d=`

`),c+=d+m.slice(l)+I,d=`
`,g=!0):I===""?d===`
`?c+=`
`:d=`
`:(c+=d+I,d=" ",g=!1)}switch(s.chomp){case"-":break;case"+":for(let p=a;p<o.length;++p)c+=`
`+o[p][0].slice(l);c[c.length-1]!==`
`&&(c+=`
`);break;default:c+=`
`}const O=i+s.length+n.source.length;return{value:c,type:r,comment:s.comment,range:[i,O,O]}}function Sr({offset:n,props:e},t,i){if(e[0].type!=="block-scalar-header")return i(e[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:s}=e[0],r=s[0];let o=0,a="",l=-1;for(let d=1;d<s.length;++d){const g=s[d];if(!a&&(g==="-"||g==="+"))a=g;else{const O=Number(g);!o&&O?o=O:l===-1&&(l=n+d)}}l!==-1&&i(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${s}`);let f=!1,h="",c=s.length;for(let d=1;d<e.length;++d){const g=e[d];switch(g.type){case"space":f=!0;case"newline":c+=g.source.length;break;case"comment":t&&!f&&i(g,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),c+=g.source.length,h=g.source.substring(1);break;case"error":i(g,"UNEXPECTED_TOKEN",g.message),c+=g.source.length;break;default:{const O=`Unexpected token in block scalar header: ${g.type}`;i(g,"UNEXPECTED_TOKEN",O);const p=g.source;p&&typeof p=="string"&&(c+=p.length)}}}return{mode:r,indent:o,chomp:a,comment:h,length:c}}function Nr(n){const e=n.split(/\n( *)/),t=e[0],i=t.match(/^( *)/),r=[i?.[1]?[i[1],t.slice(i[1].length)]:["",t]];for(let o=1;o<e.length;o+=2)r.push([e[o],e[o+1]]);return r}function zi(n,e,t){const{offset:i,type:s,source:r,end:o}=n;let a,l;const f=(d,g,O)=>t(i+d,g,O);switch(s){case"scalar":a=M.PLAIN,l=kr(r,f);break;case"single-quoted-scalar":a=M.QUOTE_SINGLE,l=Tr(r,f);break;case"double-quoted-scalar":a=M.QUOTE_DOUBLE,l=Or(r,f);break;default:return t(n,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${s}`),{value:"",type:null,comment:"",range:[i,i+r.length,i+r.length]}}const h=i+r.length,c=gt(o,h,e,t);return{value:l,type:a,comment:c.comment,range:[i,h,c.offset]}}function kr(n,e){let t="";switch(n[0]){case"	":t="a tab character";break;case",":t="flow indicator character ,";break;case"%":t="directive indicator character %";break;case"|":case">":{t=`block scalar indicator ${n[0]}`;break}case"@":case"`":{t=`reserved character ${n[0]}`;break}}return t&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${t}`),Xi(n)}function Tr(n,e){return(n[n.length-1]!=="'"||n.length===1)&&e(n.length,"MISSING_CHAR","Missing closing 'quote"),Xi(n.slice(1,-1)).replace(/''/g,"'")}function Xi(n){let e,t;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),t=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,t=/[ \t]*(.*?)[ \t]*\r?\n/sy}let i=e.exec(n);if(!i)return n;let s=i[1],r=" ",o=e.lastIndex;for(t.lastIndex=o;i=t.exec(n);)i[1]===""?r===`
`?s+=r:r=`
`:(s+=r+i[1],r=" "),o=t.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=o,i=a.exec(n),s+r+(i?.[1]??"")}function Or(n,e){let t="";for(let i=1;i<n.length-1;++i){const s=n[i];if(!(s==="\r"&&n[i+1]===`
`))if(s===`
`){const{fold:r,offset:o}=Er(n,i);t+=r,i=o}else if(s==="\\"){let r=n[++i];const o=Ar[r];if(o)t+=o;else if(r===`
`)for(r=n[i+1];r===" "||r==="	";)r=n[++i+1];else if(r==="\r"&&n[i+1]===`
`)for(r=n[++i+1];r===" "||r==="	";)r=n[++i+1];else if(r==="x"||r==="u"||r==="U"){const a={x:2,u:4,U:8}[r];t+=Ir(n,i+1,a,e),i+=a}else{const a=n.substr(i-1,2);e(i-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),t+=a}}else if(s===" "||s==="	"){const r=i;let o=n[i+1];for(;o===" "||o==="	";)o=n[++i+1];o!==`
`&&!(o==="\r"&&n[i+2]===`
`)&&(t+=i>r?n.slice(r,i+1):s)}else t+=s}return(n[n.length-1]!=='"'||n.length===1)&&e(n.length,"MISSING_CHAR",'Missing closing "quote'),t}function Er(n,e){let t="",i=n[e+1];for(;(i===" "||i==="	"||i===`
`||i==="\r")&&!(i==="\r"&&n[e+2]!==`
`);)i===`
`&&(t+=`
`),e+=1,i=n[e+1];return t||(t=" "),{fold:t,offset:e}}const Ar={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function Ir(n,e,t,i){const s=n.substr(e,t),o=s.length===t&&/^[0-9a-fA-F]+$/.test(s)?parseInt(s,16):NaN;if(isNaN(o)){const a=n.substr(e-2,t+2);return i(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),a}return String.fromCodePoint(o)}function Zi(n,e,t,i){const{value:s,type:r,comment:o,range:a}=e.type==="block-scalar"?Yi(e,n.options.strict,i):zi(e,n.options.strict,i),l=t?n.directives.tagName(t.source,c=>i(t,"TAG_RESOLVE_FAILED",c)):null,f=t&&l?Br(n.schema,s,l,t,i):e.type==="scalar"?$r(n,s,e,i):n.schema[Ae];let h;try{const c=f.resolve(s,d=>i(t??e,"TAG_RESOLVE_FAILED",d),n.options);h=q(c)?c:new M(c)}catch(c){const d=c instanceof Error?c.message:String(c);i(t??e,"TAG_RESOLVE_FAILED",d),h=new M(s)}return h.range=a,h.source=s,r&&(h.type=r),l&&(h.tag=l),f.format&&(h.format=f.format),o&&(h.comment=o),h}function Br(n,e,t,i,s){if(t==="!")return n[Ae];const r=[];for(const a of n.tags)if(!a.collection&&a.tag===t)if(a.default&&a.test)r.push(a);else return a;for(const a of r)if(a.test?.test(e))return a;const o=n.knownTags[t];return o&&!o.collection?(n.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(s(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${t}`,t!=="tag:yaml.org,2002:str"),n[Ae])}function $r({directives:n,schema:e},t,i,s){const r=e.tags.find(o=>o.default&&o.test?.test(t))||e[Ae];if(e.compat){const o=e.compat.find(a=>a.default&&a.test?.test(t))??e[Ae];if(r.tag!==o.tag){const a=n.tagString(r.tag),l=n.tagString(o.tag),f=`Value may be parsed as either ${a} or ${l}`;s(i,"TAG_RESOLVE_FAILED",f,!0)}}return r}function vr(n,e,t){if(e){t===null&&(t=e.length);for(let i=t-1;i>=0;--i){let s=e[i];switch(s.type){case"space":case"comment":case"newline":n-=s.source.length;continue}for(s=e[++i];s?.type==="space";)n+=s.source.length,s=e[++i];break}}return n}const Cr={composeNode:Qi,composeEmptyNode:_n};function Qi(n,e,t,i){const{spaceBefore:s,comment:r,anchor:o,tag:a}=t;let l,f=!0;switch(e.type){case"alias":l=_r(n,e,i),(o||a)&&i(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":l=Zi(n,e,a,i),o&&(l.anchor=o.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":l=wr(Cr,n,e,a,i),o&&(l.anchor=o.source.substring(1));break;default:{const h=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;i(e,"UNEXPECTED_TOKEN",h),l=_n(n,e.offset,void 0,null,t,i),f=!1}}return o&&l.anchor===""&&i(o,"BAD_ALIAS","Anchor cannot be an empty string"),s&&(l.spaceBefore=!0),r&&(e.type==="scalar"&&e.source===""?l.comment=r:l.commentBefore=r),n.options.keepSourceTokens&&f&&(l.srcToken=e),l}function _n(n,e,t,i,{spaceBefore:s,comment:r,anchor:o,tag:a,end:l},f){const h={type:"scalar",offset:vr(e,t,i),indent:-1,source:""},c=Zi(n,h,a,f);return o&&(c.anchor=o.source.substring(1),c.anchor===""&&f(o,"BAD_ALIAS","Anchor cannot be an empty string")),s&&(c.spaceBefore=!0),r&&(c.comment=r,c.range[2]=l),c}function _r({options:n},{offset:e,source:t,end:i},s){const r=new Mt(t.substring(1));r.source===""&&s(e,"BAD_ALIAS","Alias cannot be an empty string"),r.source.endsWith(":")&&s(e+t.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=e+t.length,a=gt(i,o,n.strict,s);return r.range=[e,o,a.offset],a.comment&&(r.comment=a.comment),r}function Lr(n,e,{offset:t,start:i,value:s,end:r},o){const a=Object.assign({_directives:e},n),l=new st(void 0,a),f={atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},h=ze(i,{indicator:"doc-start",next:s??r?.[0],offset:t,onError:o,startOnNewline:!0});h.found&&(l.directives.docStart=!0,s&&(s.type==="block-map"||s.type==="block-seq")&&!h.hasNewline&&o(h.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=s?Qi(f,s,h,o):_n(f,h.end,i,null,h,o);const c=l.contents.range[2],d=gt(r,c,!1,o);return d.comment&&(l.comment=d.comment),l.range=[t,c,d.offset],l}function at(n){if(typeof n=="number")return[n,n+1];if(Array.isArray(n))return n.length===2?n:[n[0],n[1]];const{offset:e,source:t}=n;return[e,e+(typeof t=="string"?t.length:1)]}function Qn(n){let e="",t=!1,i=!1;for(let s=0;s<n.length;++s){const r=n[s];switch(r[0]){case"#":e+=(e===""?"":i?`

`:`
`)+(r.substring(1)||" "),t=!0,i=!1;break;case"%":n[s+1]?.[0]!=="#"&&(s+=1),t=!1;break;default:t||(i=!0),t=!1}}return{comment:e,afterEmptyLine:i}}class Ln{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(t,i,s,r)=>{const o=at(t);r?this.warnings.push(new Ji(o,i,s)):this.errors.push(new Pe(o,i,s))},this.directives=new ne({version:e.version||"1.2"}),this.options=e}decorate(e,t){const{comment:i,afterEmptyLine:s}=Qn(this.prelude);if(i){const r=e.contents;if(t)e.comment=e.comment?`${e.comment}
${i}`:i;else if(s||e.directives.docStart||!r)e.commentBefore=i;else if(J(r)&&!r.flow&&r.items.length>0){let o=r.items[0];W(o)&&(o=o.key);const a=o.commentBefore;o.commentBefore=a?`${i}
${a}`:i}else{const o=r.commentBefore;r.commentBefore=o?`${i}
${o}`:i}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:Qn(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,i=-1){for(const s of e)yield*this.next(s);yield*this.end(t,i)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(t,i,s)=>{const r=at(e);r[0]+=t,this.onError(r,"BAD_DIRECTIVE",i,s)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const t=Lr(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,i=new Pe(at(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(i):this.doc.errors.push(i);break}case"doc-end":{if(!this.doc){const i="Unexpected doc-end without preceding document";this.errors.push(new Pe(at(e),"UNEXPECTED_TOKEN",i));break}this.doc.directives.docEnd=!0;const t=gt(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){const i=this.doc.comment;this.doc.comment=i?`${i}
${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new Pe(at(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const i=Object.assign({_directives:this.directives},this.options),s=new st(void 0,i);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),s.range=[0,t,t],this.decorate(s,!1),yield s}}}function Mr(n,e=!0,t){if(n){const i=(s,r,o)=>{const a=typeof s=="number"?s:Array.isArray(s)?s[0]:s.offset;if(t)t(a,r,o);else throw new Pe([a,a+1],r,o)};switch(n.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return zi(n,e,i);case"block-scalar":return Yi(n,e,i)}}return null}function Pr(n,e){const{implicitKey:t=!1,indent:i,inFlow:s=!1,offset:r=-1,type:o="PLAIN"}=e,a=pt({type:o,value:n},{implicitKey:t,indent:i>0?" ".repeat(i):"",inFlow:s,options:{blockQuote:!0,lineWidth:-1}}),l=e.end??[{type:"newline",offset:-1,indent:i,source:`
`}];switch(a[0]){case"|":case">":{const f=a.indexOf(`
`),h=a.substring(0,f),c=a.substring(f+1)+`
`,d=[{type:"block-scalar-header",offset:r,indent:i,source:h}];return es(d,l)||d.push({type:"newline",offset:-1,indent:i,source:`
`}),{type:"block-scalar",offset:r,indent:i,props:d,source:c}}case'"':return{type:"double-quoted-scalar",offset:r,indent:i,source:a,end:l};case"'":return{type:"single-quoted-scalar",offset:r,indent:i,source:a,end:l};default:return{type:"scalar",offset:r,indent:i,source:a,end:l}}}function xr(n,e,t={}){let{afterKey:i=!1,implicitKey:s=!1,inFlow:r=!1,type:o}=t,a="indent"in n?n.indent:null;if(i&&typeof a=="number"&&(a+=2),!o)switch(n.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{const f=n.props[0];if(f.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=f.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}const l=pt({type:o,value:e},{implicitKey:s||a===null,indent:a!==null&&a>0?" ".repeat(a):"",inFlow:r,options:{blockQuote:!0,lineWidth:-1}});switch(l[0]){case"|":case">":Dr(n,l);break;case'"':sn(n,l,"double-quoted-scalar");break;case"'":sn(n,l,"single-quoted-scalar");break;default:sn(n,l,"scalar")}}function Dr(n,e){const t=e.indexOf(`
`),i=e.substring(0,t),s=e.substring(t+1)+`
`;if(n.type==="block-scalar"){const r=n.props[0];if(r.type!=="block-scalar-header")throw new Error("Invalid block scalar header");r.source=i,n.source=s}else{const{offset:r}=n,o="indent"in n?n.indent:-1,a=[{type:"block-scalar-header",offset:r,indent:o,source:i}];es(a,"end"in n?n.end:void 0)||a.push({type:"newline",offset:-1,indent:o,source:`
`});for(const l of Object.keys(n))l!=="type"&&l!=="offset"&&delete n[l];Object.assign(n,{type:"block-scalar",indent:o,props:a,source:s})}}function es(n,e){if(e)for(const t of e)switch(t.type){case"space":case"comment":n.push(t);break;case"newline":return n.push(t),!0}return!1}function sn(n,e,t){switch(n.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":n.type=t,n.source=e;break;case"block-scalar":{const i=n.props.slice(1);let s=e.length;n.props[0].type==="block-scalar-header"&&(s-=n.props[0].source.length);for(const r of i)r.offset+=s;delete n.props,Object.assign(n,{type:t,source:e,end:i});break}case"block-map":case"block-seq":{const s={type:"newline",offset:n.offset+e.length,indent:n.indent,source:`
`};delete n.items,Object.assign(n,{type:t,source:e,end:[s]});break}default:{const i="indent"in n?n.indent:-1,s="end"in n&&Array.isArray(n.end)?n.end.filter(r=>r.type==="space"||r.type==="comment"||r.type==="newline"):[];for(const r of Object.keys(n))r!=="type"&&r!=="offset"&&delete n[r];Object.assign(n,{type:t,indent:i,source:e,end:s})}}}const Rr=n=>"type"in n?_t(n):It(n);function _t(n){switch(n.type){case"block-scalar":{let e="";for(const t of n.props)e+=_t(t);return e+n.source}case"block-map":case"block-seq":{let e="";for(const t of n.items)e+=It(t);return e}case"flow-collection":{let e=n.start.source;for(const t of n.items)e+=It(t);for(const t of n.end)e+=t.source;return e}case"document":{let e=It(n);if(n.end)for(const t of n.end)e+=t.source;return e}default:{let e=n.source;if("end"in n&&n.end)for(const t of n.end)e+=t.source;return e}}}function It({start:n,key:e,sep:t,value:i}){let s="";for(const r of n)s+=r.source;if(e&&(s+=_t(e)),t)for(const r of t)s+=r.source;return i&&(s+=_t(i)),s}const mn=Symbol("break visit"),jr=Symbol("skip children"),ts=Symbol("remove item");function xe(n,e){"type"in n&&n.type==="document"&&(n={start:n.start,value:n.value}),ns(Object.freeze([]),n,e)}xe.BREAK=mn;xe.SKIP=jr;xe.REMOVE=ts;xe.itemAtPath=(n,e)=>{let t=n;for(const[i,s]of e){const r=t?.[i];if(r&&"items"in r)t=r.items[s];else return}return t};xe.parentCollection=(n,e)=>{const t=xe.itemAtPath(n,e.slice(0,-1)),i=e[e.length-1][0],s=t?.[i];if(s&&"items"in s)return s;throw new Error("Parent collection not found")};function ns(n,e,t){let i=t(e,n);if(typeof i=="symbol")return i;for(const s of["key","value"]){const r=e[s];if(r&&"items"in r){for(let o=0;o<r.items.length;++o){const a=ns(Object.freeze(n.concat([[s,o]])),r.items[o],t);if(typeof a=="number")o=a-1;else{if(a===mn)return mn;a===ts&&(r.items.splice(o,1),o-=1)}}typeof i=="function"&&s==="key"&&(i=i(e,n))}}return typeof i=="function"?i(e,n):i}const Kt="\uFEFF",qt="",Wt="",dt="",Fr=n=>!!n&&"items"in n,Ur=n=>!!n&&(n.type==="scalar"||n.type==="single-quoted-scalar"||n.type==="double-quoted-scalar"||n.type==="block-scalar");function Vr(n){switch(n){case Kt:return"<BOM>";case qt:return"<DOC>";case Wt:return"<FLOW_END>";case dt:return"<SCALAR>";default:return JSON.stringify(n)}}function is(n){switch(n){case Kt:return"byte-order-mark";case qt:return"doc-mode";case Wt:return"flow-error-end";case dt:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(n[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const Hr=Object.freeze(Object.defineProperty({__proto__:null,BOM:Kt,DOCUMENT:qt,FLOW_END:Wt,SCALAR:dt,createScalarToken:Pr,isCollection:Fr,isScalar:Ur,prettyToken:Vr,resolveAsScalar:Mr,setScalarValue:xr,stringify:Rr,tokenType:is,visit:xe},Symbol.toStringTag,{value:"Module"}));function le(n){switch(n){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const ei="0123456789ABCDEFabcdef".split(""),Kr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()".split(""),rn=",[]{}".split(""),qr=` ,[]{}
\r	`.split(""),on=n=>!n||qr.includes(n);class ss{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,t=!1){e&&(this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null),this.atEnd=!t;let i=this.next??"stream";for(;i&&(t||this.hasChars(1));)i=yield*this.parseNext(i)}atLineEnd(){let e=this.pos,t=this.buffer[e];for(;t===" "||t==="	";)t=this.buffer[++e];return!t||t==="#"||t===`
`?!0:t==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let t=this.buffer[e];if(this.indentNext>0){let i=0;for(;t===" ";)t=this.buffer[++i+e];if(t==="\r"){const s=this.buffer[i+e+1];if(s===`
`||!s&&!this.atEnd)return e+i+1}return t===`
`||i>=this.indentNext||!t&&!this.atEnd?e+i:-1}if(t==="-"||t==="."){const i=this.buffer.substr(e,3);if((i==="---"||i==="...")&&le(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===Kt&&(yield*this.pushCount(1),e=e.substring(1)),e[0]==="%"){let t=e.length;const i=e.indexOf("#");if(i!==-1){const r=e[i-1];(r===" "||r==="	")&&(t=i-1)}for(;;){const r=e[t-1];if(r===" "||r==="	")t-=1;else break}const s=(yield*this.pushCount(t))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-s),this.pushNewline(),"stream"}if(this.atLineEnd()){const t=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-t),yield*this.pushNewline(),"stream"}return yield qt,yield*this.parseLineStart()}*parseLineStart(){const e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const t=this.peek(3);if(t==="---"&&le(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,"doc";if(t==="..."&&le(this.charAt(3)))return yield*this.pushCount(3),"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!le(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[e,t]=this.peek(2);if(!t&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&le(t)){const i=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=i,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const e=this.getLine();if(e===null)return this.setNext("doc");let t=yield*this.pushIndicators();switch(e[t]){case"#":yield*this.pushCount(e.length-t);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(on),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return t+=yield*this.parseBlockScalarHeader(),t+=yield*this.pushSpaces(!0),yield*this.pushCount(e.length-t),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,t,i=-1;do e=yield*this.pushNewline(),e>0?(t=yield*this.pushSpaces(!1),this.indentValue=i=t):t=0,t+=yield*this.pushSpaces(!0);while(e+t>0);const s=this.getLine();if(s===null)return this.setNext("flow");if((i!==-1&&i<this.indentNext&&s[0]!=="#"||i===0&&(s.startsWith("---")||s.startsWith("..."))&&le(s[3]))&&!(i===this.indentNext-1&&this.flowLevel===1&&(s[0]==="]"||s[0]==="}")))return this.flowLevel=0,yield Wt,yield*this.parseLineStart();let r=0;for(;s[r]===",";)r+=yield*this.pushCount(1),r+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(r+=yield*this.pushIndicators(),s[r]){case void 0:return"flow";case"#":return yield*this.pushCount(s.length-r),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(on),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||le(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const e=this.charAt(0);let t=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;t!==-1&&this.buffer[t+1]==="'";)t=this.buffer.indexOf("'",t+2);else for(;t!==-1;){let r=0;for(;this.buffer[t-1-r]==="\\";)r+=1;if(r%2===0)break;t=this.buffer.indexOf('"',t+1)}const i=this.buffer.substring(0,t);let s=i.indexOf(`
`,this.pos);if(s!==-1){for(;s!==-1;){const r=this.continueScalar(s+1);if(r===-1)break;s=i.indexOf(`
`,r)}s!==-1&&(t=s-(i[s-1]==="\r"?2:1))}if(t===-1){if(!this.atEnd)return this.setNext("quoted-scalar");t=this.buffer.length}return yield*this.pushToIndex(t+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){const t=this.buffer[++e];if(t==="+")this.blockScalarKeep=!0;else if(t>"0"&&t<="9")this.blockScalarIndent=Number(t)-1;else if(t!=="-")break}return yield*this.pushUntil(t=>le(t)||t==="#")}*parseBlockScalar(){let e=this.pos-1,t=0,i;e:for(let s=this.pos;i=this.buffer[s];++s)switch(i){case" ":t+=1;break;case`
`:e=s,t=0;break;case"\r":{const r=this.buffer[s+1];if(!r&&!this.atEnd)return this.setNext("block-scalar");if(r===`
`)break}default:break e}if(!i&&!this.atEnd)return this.setNext("block-scalar");if(t>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=t:this.indentNext+=this.blockScalarIndent;do{const s=this.continueScalar(e+1);if(s===-1)break;e=this.buffer.indexOf(`
`,s)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}if(!this.blockScalarKeep)do{let s=e-1,r=this.buffer[s];r==="\r"&&(r=this.buffer[--s]);const o=s;for(;r===" "||r==="	";)r=this.buffer[--s];if(r===`
`&&s>=this.pos&&s+1+t>o)e=s;else break}while(!0);return yield dt,yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const e=this.flowLevel>0;let t=this.pos-1,i=this.pos-1,s;for(;s=this.buffer[++i];)if(s===":"){const r=this.buffer[i+1];if(le(r)||e&&r===",")break;t=i}else if(le(s)){let r=this.buffer[i+1];if(s==="\r"&&(r===`
`?(i+=1,s=`
`,r=this.buffer[i+1]):t=i),r==="#"||e&&rn.includes(r))break;if(s===`
`){const o=this.continueScalar(i+1);if(o===-1)break;i=Math.max(i,o-2)}}else{if(e&&rn.includes(s))break;t=i}return!s&&!this.atEnd?this.setNext("plain-scalar"):(yield dt,yield*this.pushToIndex(t+1,!0),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,t){const i=this.buffer.slice(this.pos,e);return i?(yield i,this.pos+=i.length,i.length):(t&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(on))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const e=this.flowLevel>0,t=this.charAt(1);if(le(t)||e&&rn.includes(t))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,t=this.buffer[e];for(;!le(t)&&t!==">";)t=this.buffer[++e];return yield*this.pushToIndex(t===">"?e+1:e,!1)}else{let e=this.pos+1,t=this.buffer[e];for(;t;)if(Kr.includes(t))t=this.buffer[++e];else if(t==="%"&&ei.includes(this.buffer[e+1])&&ei.includes(this.buffer[e+2]))t=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){const e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):e==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let t=this.pos-1,i;do i=this.buffer[++t];while(i===" "||e&&i==="	");const s=t-this.pos;return s>0&&(yield this.buffer.substr(this.pos,s),this.pos=t),s}*pushUntil(e){let t=this.pos,i=this.buffer[t];for(;!e(i);)i=this.buffer[++t];return yield*this.pushToIndex(t,!1)}}class rs{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,i=this.lineStarts.length;for(;t<i;){const r=t+i>>1;this.lineStarts[r]<e?t=r+1:i=r}if(this.lineStarts[t]===e)return{line:t+1,col:1};if(t===0)return{line:0,col:e};const s=this.lineStarts[t-1];return{line:t,col:e-s+1}}}}function me(n,e){for(let t=0;t<n.length;++t)if(n[t].type===e)return!0;return!1}function ti(n){for(let e=0;e<n.length;++e)switch(n[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function os(n){switch(n?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function Tt(n){switch(n.type){case"document":return n.start;case"block-map":{const e=n.items[n.items.length-1];return e.sep??e.start}case"block-seq":return n.items[n.items.length-1].start;default:return[]}}function je(n){if(n.length===0)return[];let e=n.length;e:for(;--e>=0;)switch(n[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;n[++e]?.type==="space";);return n.splice(e,n.length)}function ni(n){if(n.start.type==="flow-seq-start")for(const e of n.items)e.sep&&!e.value&&!me(e.start,"explicit-key-ind")&&!me(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,os(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}class Mn{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new ss,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const i of this.lexer.lex(e,t))yield*this.next(i);t||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}const t=is(e);if(t)if(t==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*this.step(),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const i=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:i,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){const t=e??this.stack.pop();if(!t)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield t;else{const i=this.peek(1);switch(t.type==="block-scalar"?t.indent="indent"in i?i.indent:0:t.type==="flow-collection"&&i.type==="document"&&(t.indent=0),t.type==="flow-collection"&&ni(t),i.type){case"document":i.value=t;break;case"block-scalar":i.props.push(t);break;case"block-map":{const s=i.items[i.items.length-1];if(s.value){i.items.push({start:[],key:t,sep:[]}),this.onKeyLine=!0;return}else if(s.sep)s.value=t;else{Object.assign(s,{key:t,sep:[]}),this.onKeyLine=!me(s.start,"explicit-key-ind");return}break}case"block-seq":{const s=i.items[i.items.length-1];s.value?i.items.push({start:[],value:t}):s.value=t;break}case"flow-collection":{const s=i.items[i.items.length-1];!s||s.value?i.items.push({start:[],key:t,sep:[]}):s.sep?s.value=t:Object.assign(s,{key:t,sep:[]});return}default:yield*this.pop(),yield*this.pop(t)}if((i.type==="document"||i.type==="block-map"||i.type==="block-seq")&&(t.type==="block-map"||t.type==="block-seq")){const s=t.items[t.items.length-1];s&&!s.sep&&!s.value&&s.start.length>0&&ti(s.start)===-1&&(t.indent===0||s.start.every(r=>r.type!=="comment"||r.indent<t.indent))&&(i.type==="document"?i.end=s.start:i.items.push({start:s.start}),t.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{ti(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}const t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){const t=Tt(this.peek(2)),i=je(t);let s;e.end?(s=e.end,s.push(this.sourceToken),delete e.end):s=[this.sourceToken];const r={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:i,key:e,sep:s}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=r}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){const t=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,t.value){const i="end"in t.value?t.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else if(t.sep)t.sep.push(this.sourceToken);else{if(this.atIndentedComment(t.start,e.indent)){const s=e.items[e.items.length-2]?.value?.end;if(Array.isArray(s)){Array.prototype.push.apply(s,t.start),s.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const i=!this.onKeyLine&&this.indent===e.indent&&t.sep&&this.type!=="seq-item-ind";let s=[];if(i&&t.sep&&!t.value){const r=[];for(let o=0;o<t.sep.length;++o){const a=t.sep[o];switch(a.type){case"newline":r.push(o);break;case"space":break;case"comment":a.indent>e.indent&&(r.length=0);break;default:r.length=0}}r.length>=2&&(s=t.sep.splice(r[1]))}switch(this.type){case"anchor":case"tag":i||t.value?(s.push(this.sourceToken),e.items.push({start:s}),this.onKeyLine=!0):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"explicit-key-ind":!t.sep&&!me(t.start,"explicit-key-ind")?t.start.push(this.sourceToken):i||t.value?(s.push(this.sourceToken),e.items.push({start:s})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]}),this.onKeyLine=!0;return;case"map-value-ind":if(me(t.start,"explicit-key-ind"))if(t.sep)if(t.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(me(t.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]});else if(os(t.key)&&!me(t.sep,"newline")){const r=je(t.start),o=t.key,a=t.sep;a.push(this.sourceToken),delete t.key,delete t.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:o,sep:a}]})}else s.length>0?t.sep=t.sep.concat(s,this.sourceToken):t.sep.push(this.sourceToken);else if(me(t.start,"newline"))Object.assign(t,{key:null,sep:[this.sourceToken]});else{const r=je(t.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]})}else t.sep?t.value||i?e.items.push({start:s,key:null,sep:[this.sourceToken]}):me(t.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);i||t.value?(e.items.push({start:s,key:r,sep:[]}),this.onKeyLine=!0):t.sep?this.stack.push(r):(Object.assign(t,{key:r,sep:[]}),this.onKeyLine=!0);return}default:{const r=this.startBlockValue(e);if(r){i&&r.type!=="block-seq"&&me(t.start,"explicit-key-ind")&&e.items.push({start:s}),this.stack.push(r);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){const t=e.items[e.items.length-1];switch(this.type){case"newline":if(t.value){const i="end"in t.value?t.value.end:void 0;(Array.isArray(i)?i[i.length-1]:void 0)?.type==="comment"?i?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(t.start,e.indent)){const s=e.items[e.items.length-2]?.value?.end;if(Array.isArray(s)){Array.prototype.push.apply(s,t.start),s.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return;case"anchor":case"tag":if(t.value||this.indent<=e.indent)break;t.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;t.value||me(t.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return}if(this.indent>e.indent){const i=this.startBlockValue(e);if(i){this.stack.push(i);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){const t=e.items[e.items.length-1];if(this.type==="flow-error-end"){let i;do yield*this.pop(),i=this.peek(1);while(i&&i.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return;case"map-value-ind":!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const s=this.flowScalar(this.type);!t||t.value?e.items.push({start:[],key:s,sep:[]}):t.sep?this.stack.push(s):Object.assign(t,{key:s,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}const i=this.startBlockValue(e);i?this.stack.push(i):(yield*this.pop(),yield*this.step())}else{const i=this.peek(2);if(i.type==="block-map"&&(this.type==="map-value-ind"&&i.indent===e.indent||this.type==="newline"&&!i.items[i.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&i.type!=="flow-collection"){const s=Tt(i),r=je(s);ni(e);const o=e.end.splice(1,e.end.length);o.push(this.sourceToken);const a={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:r,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const t=Tt(e),i=je(t);return i.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i}]}}case"map-value-ind":{this.onKeyLine=!0;const t=Tt(e),i=je(t);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return this.type!=="comment"||this.indent<=t?!1:e.every(i=>i.type==="newline"||i.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function as(n){const e=n.prettyErrors!==!1;return{lineCounter:n.lineCounter||e&&new rs||null,prettyErrors:e}}function Wr(n,e={}){const{lineCounter:t,prettyErrors:i}=as(e),s=new Mn(t?.addNewLine),r=new Ln(e),o=Array.from(r.compose(s.parse(n)));if(i&&t)for(const a of o)a.errors.forEach(Ct(n,t)),a.warnings.forEach(Ct(n,t));return o.length>0?o:Object.assign([],{empty:!0},r.streamInfo())}function ls(n,e={}){const{lineCounter:t,prettyErrors:i}=as(e),s=new Mn(t?.addNewLine),r=new Ln(e);let o=null;for(const a of r.compose(s.parse(n),!0,n.length))if(!o)o=a;else if(o.options.logLevel!=="silent"){o.errors.push(new Pe(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return i&&t&&(o.errors.forEach(Ct(n,t)),o.warnings.forEach(Ct(n,t))),o}function Jr(n,e,t){let i;typeof e=="function"?i=e:t===void 0&&e&&typeof e=="object"&&(t=e);const s=ls(n,t);if(!s)return null;if(s.warnings.forEach(r=>$i(s.options.logLevel,r)),s.errors.length>0){if(s.options.logLevel!=="silent")throw s.errors[0];s.errors=[]}return s.toJS(Object.assign({reviver:i},t))}function Gr(n,e,t){let i=null;if(typeof e=="function"||Array.isArray(e)?i=e:t===void 0&&e&&(t=e),typeof t=="string"&&(t=t.length),typeof t=="number"){const s=Math.round(t);t=s<1?void 0:s>8?{indent:8}:{indent:s}}if(n===void 0){const{keepUndefined:s}=t??e??{};if(!s)return}return new st(n,i,t).toString(t)}const Yr=Object.freeze(Object.defineProperty({__proto__:null,Alias:Mt,CST:Hr,Composer:Ln,Document:st,Lexer:ss,LineCounter:rs,Pair:te,Parser:Mn,Scalar:M,Schema:Ht,YAMLError:Cn,YAMLMap:oe,YAMLParseError:Pe,YAMLSeq:Ce,YAMLWarning:Ji,isAlias:De,isCollection:J,isDocument:Qe,isMap:et,isNode:G,isPair:W,isScalar:q,isSeq:tt,parse:Jr,parseAllDocuments:Wr,parseDocument:ls,stringify:Gr,visit:ve,visitAsync:Lt},Symbol.toStringTag,{value:"Module"}));function zr(n){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(n))}function fs(n){return Object.prototype.toString.call(n)==="[object Uint8Array]"}function Xr(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function cs(n){return Object.prototype.toString.call(n)==="[object Map]"}function Zr(n){return Object.prototype.toString.call(n)==="[object Date]"}function ae(n,e){return JSON.stringify(n,(t,i)=>typeof i=="bigint"?{$numberLong:`${i}`}:cs(i)?Object.fromEntries(i):i)}function Qr(n){if(n!=null&&typeof n=="object"&&"stylize"in n&&typeof n.stylize=="function")return n.stylize}const Pn=6,us=2147483647,hs=-2147483648,ds=Math.pow(2,63)-1,ps=-Math.pow(2,63),eo=Math.pow(2,53),to=-Math.pow(2,53),ms=4;class _ extends Error{get bsonError(){return!0}get name(){return"BSONError"}constructor(e,t){super(e,t)}static isBSONError(e){return e!=null&&typeof e=="object"&&"bsonError"in e&&e.bsonError===!0&&"name"in e&&"message"in e&&"stack"in e}}class no extends _{get name(){return"BSONVersionError"}constructor(){super(`Unsupported BSON version, bson types must be from bson ${Pn}.x.x`)}}class ii extends _{get name(){return"BSONRuntimeError"}constructor(e){super(e)}}const io=128,so=192,ro=224,oo=240,ao=248,lo=192,fo=224,co=240,uo=128;function ho(n,e,t){let i=0;for(let s=e;s<t;s+=1){const r=n[s];if(i){if((r&so)!==uo)return!1;i-=1}else if(r&io)if((r&ro)===lo)i=1;else if((r&oo)===fo)i=2;else if((r&ao)===co)i=3;else return!1}return!i}function gs(n,e,t){if(n.length===0)return"";const i=t-e;if(i===0)return"";if(i>20)return null;if(i===1&&n[e]<128)return String.fromCharCode(n[e]);if(i===2&&n[e]<128&&n[e+1]<128)return String.fromCharCode(n[e])+String.fromCharCode(n[e+1]);if(i===3&&n[e]<128&&n[e+1]<128&&n[e+2]<128)return String.fromCharCode(n[e])+String.fromCharCode(n[e+1])+String.fromCharCode(n[e+2]);const s=[];for(let r=e;r<t;r++){const o=n[r];if(o>127)return null;s.push(o)}return String.fromCharCode(...s)}function po(n){return Ie.fromNumberArray(Array.from({length:n},()=>Math.floor(Math.random()*256)))}const mo=await(async()=>{try{return(await Cs(()=>import("./__vite-browser-external-BIHI7g3E.js"),[])).randomBytes}catch{return po}})(),Ie={toLocalBufferType(n){if(Buffer.isBuffer(n))return n;if(ArrayBuffer.isView(n))return Buffer.from(n.buffer,n.byteOffset,n.byteLength);const e=n?.[Symbol.toStringTag]??Object.prototype.toString.call(n);if(e==="ArrayBuffer"||e==="SharedArrayBuffer"||e==="[object ArrayBuffer]"||e==="[object SharedArrayBuffer]")return Buffer.from(n);throw new _(`Cannot create Buffer from ${String(n)}`)},allocate(n){return Buffer.alloc(n)},equals(n,e){return Ie.toLocalBufferType(n).equals(e)},fromNumberArray(n){return Buffer.from(n)},fromBase64(n){return Buffer.from(n,"base64")},toBase64(n){return Ie.toLocalBufferType(n).toString("base64")},fromISO88591(n){return Buffer.from(n,"binary")},toISO88591(n){return Ie.toLocalBufferType(n).toString("binary")},fromHex(n){return Buffer.from(n,"hex")},toHex(n){return Ie.toLocalBufferType(n).toString("hex")},fromUTF8(n){return Buffer.from(n,"utf8")},toUTF8(n,e,t,i){const s=t-e<=20?gs(n,e,t):null;if(s!=null)return s;const r=Ie.toLocalBufferType(n).toString("utf8",e,t);if(i){for(let o=0;o<r.length;o++)if(r.charCodeAt(o)===65533){if(!ho(n,e,t))throw new _("Invalid UTF-8 string in BSON document");break}}return r},utf8ByteLength(n){return Buffer.byteLength(n,"utf8")},encodeUTF8Into(n,e,t){return Ie.toLocalBufferType(n).write(e,t,void 0,"utf8")},randomBytes:mo};function go(){const{navigator:n}=globalThis;return typeof n=="object"&&n.product==="ReactNative"}function yo(n){if(n<0)throw new RangeError(`The argument 'byteLength' is invalid. Received ${n}`);return Ge.fromNumberArray(Array.from({length:n},()=>Math.floor(Math.random()*256)))}const bo=(()=>{const{crypto:n}=globalThis;if(n!=null&&typeof n.getRandomValues=="function")return e=>n.getRandomValues(Ge.allocate(e));if(go()){const{console:e}=globalThis;e?.warn?.("BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.")}return yo})(),si=/(\d|[a-f])/i,Ge={toLocalBufferType(n){const e=n?.[Symbol.toStringTag]??Object.prototype.toString.call(n);if(e==="Uint8Array")return n;if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength));if(e==="ArrayBuffer"||e==="SharedArrayBuffer"||e==="[object ArrayBuffer]"||e==="[object SharedArrayBuffer]")return new Uint8Array(n);throw new _(`Cannot make a Uint8Array from ${String(n)}`)},allocate(n){if(typeof n!="number")throw new TypeError(`The "size" argument must be of type number. Received ${String(n)}`);return new Uint8Array(n)},equals(n,e){if(n.byteLength!==e.byteLength)return!1;for(let t=0;t<n.byteLength;t++)if(n[t]!==e[t])return!1;return!0},fromNumberArray(n){return Uint8Array.from(n)},fromBase64(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))},toBase64(n){return btoa(Ge.toISO88591(n))},fromISO88591(n){return Uint8Array.from(n,e=>e.charCodeAt(0)&255)},toISO88591(n){return Array.from(Uint16Array.from(n),e=>String.fromCharCode(e)).join("")},fromHex(n){const e=n.length%2===0?n:n.slice(0,n.length-1),t=[];for(let i=0;i<e.length;i+=2){const s=e[i],r=e[i+1];if(!si.test(s)||!si.test(r))break;const o=Number.parseInt(`${s}${r}`,16);t.push(o)}return Uint8Array.from(t)},toHex(n){return Array.from(n,e=>e.toString(16).padStart(2,"0")).join("")},fromUTF8(n){return new TextEncoder().encode(n)},toUTF8(n,e,t,i){const s=t-e<=20?gs(n,e,t):null;if(s!=null)return s;if(i)try{return new TextDecoder("utf8",{fatal:i}).decode(n.slice(e,t))}catch(r){throw new _("Invalid UTF-8 string in BSON document",{cause:r})}return new TextDecoder("utf8",{fatal:i}).decode(n.slice(e,t))},utf8ByteLength(n){return Ge.fromUTF8(n).byteLength},encodeUTF8Into(n,e,t){const i=Ge.fromUTF8(e);return n.set(i,t),i.byteLength},randomBytes:bo},wo=typeof Buffer=="function"&&Buffer.prototype?._isBuffer!==!0,C=wo?Ie:Ge;class an extends DataView{static fromUint8Array(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}}class he{get[Symbol.for("@@mdb.bson.version")](){return Pn}[Symbol.for("nodejs.util.inspect.custom")](e,t,i){return this.inspect(e,t,i)}}class K extends he{get _bsontype(){return"Binary"}constructor(e,t){if(super(),e!=null&&typeof e=="string"&&!ArrayBuffer.isView(e)&&!zr(e)&&!Array.isArray(e))throw new _("Binary can only be constructed from Uint8Array or number[]");this.sub_type=t??K.BSON_BINARY_SUBTYPE_DEFAULT,e==null?(this.buffer=C.allocate(K.BUFFER_SIZE),this.position=0):(this.buffer=Array.isArray(e)?C.fromNumberArray(e):C.toLocalBufferType(e),this.position=this.buffer.byteLength)}put(e){if(typeof e=="string"&&e.length!==1)throw new _("only accepts single character String");if(typeof e!="number"&&e.length!==1)throw new _("only accepts single character Uint8Array or Array");let t;if(typeof e=="string"?t=e.charCodeAt(0):typeof e=="number"?t=e:t=e[0],t<0||t>255)throw new _("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.byteLength>this.position)this.buffer[this.position++]=t;else{const i=C.allocate(K.BUFFER_SIZE+this.buffer.length);i.set(this.buffer,0),this.buffer=i,this.buffer[this.position++]=t}}write(e,t){if(t=typeof t=="number"?t:this.position,this.buffer.byteLength<t+e.length){const i=C.allocate(this.buffer.byteLength+e.length);i.set(this.buffer,0),this.buffer=i}if(ArrayBuffer.isView(e))this.buffer.set(C.toLocalBufferType(e),t),this.position=t+e.byteLength>this.position?t+e.length:this.position;else if(typeof e=="string")throw new _("input cannot be string")}read(e,t){return t=t&&t>0?t:this.position,this.buffer.slice(e,e+t)}value(){return this.buffer.length===this.position?this.buffer:this.buffer.subarray(0,this.position)}length(){return this.position}toJSON(){return C.toBase64(this.buffer)}toString(e){return e==="hex"?C.toHex(this.buffer):e==="base64"?C.toBase64(this.buffer):e==="utf8"||e==="utf-8"?C.toUTF8(this.buffer,0,this.buffer.byteLength,!1):C.toUTF8(this.buffer,0,this.buffer.byteLength,!1)}toExtendedJSON(e){e=e||{};const t=C.toBase64(this.buffer),i=Number(this.sub_type).toString(16);return e.legacy?{$binary:t,$type:i.length===1?"0"+i:i}:{$binary:{base64:t,subType:i.length===1?"0"+i:i}}}toUUID(){if(this.sub_type===K.SUBTYPE_UUID)return new ie(this.buffer.slice(0,this.position));throw new _(`Binary sub_type "${this.sub_type}" is not supported for converting to UUID. Only "${K.SUBTYPE_UUID}" is currently supported.`)}static createFromHexString(e,t){return new K(C.fromHex(e),t)}static createFromBase64(e,t){return new K(C.fromBase64(e),t)}static fromExtendedJSON(e,t){t=t||{};let i,s;if("$binary"in e?t.legacy&&typeof e.$binary=="string"&&"$type"in e?(s=e.$type?parseInt(e.$type,16):0,i=C.fromBase64(e.$binary)):typeof e.$binary!="string"&&(s=e.$binary.subType?parseInt(e.$binary.subType,16):0,i=C.fromBase64(e.$binary.base64)):"$uuid"in e&&(s=4,i=ie.bytesFromString(e.$uuid)),!i)throw new _(`Unexpected Binary Extended JSON format ${JSON.stringify(e)}`);return s===ms?new ie(i):new K(i,s)}inspect(e,t,i){i??=ae;const s=C.toBase64(this.buffer.subarray(0,this.position)),r=i(s,t),o=i(this.sub_type,t);return`Binary.createFromBase64(${r}, ${o})`}}K.BSON_BINARY_SUBTYPE_DEFAULT=0;K.BUFFER_SIZE=256;K.SUBTYPE_DEFAULT=0;K.SUBTYPE_FUNCTION=1;K.SUBTYPE_BYTE_ARRAY=2;K.SUBTYPE_UUID_OLD=3;K.SUBTYPE_UUID=4;K.SUBTYPE_MD5=5;K.SUBTYPE_ENCRYPTED=6;K.SUBTYPE_COLUMN=7;K.SUBTYPE_USER_DEFINED=128;const ln=16,So=/^[0-9A-F]{32}$/i,No=/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i;class ie extends K{constructor(e){let t;if(e==null)t=ie.generate();else if(e instanceof ie)t=C.toLocalBufferType(new Uint8Array(e.buffer));else if(ArrayBuffer.isView(e)&&e.byteLength===ln)t=C.toLocalBufferType(e);else if(typeof e=="string")t=ie.bytesFromString(e);else throw new _("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");super(t,ms)}get id(){return this.buffer}set id(e){this.buffer=e}toHexString(e=!0){return e?[C.toHex(this.buffer.subarray(0,4)),C.toHex(this.buffer.subarray(4,6)),C.toHex(this.buffer.subarray(6,8)),C.toHex(this.buffer.subarray(8,10)),C.toHex(this.buffer.subarray(10,16))].join("-"):C.toHex(this.buffer)}toString(e){return e==="hex"?C.toHex(this.id):e==="base64"?C.toBase64(this.id):this.toHexString()}toJSON(){return this.toHexString()}equals(e){if(!e)return!1;if(e instanceof ie)return C.equals(e.id,this.id);try{return C.equals(new ie(e).id,this.id)}catch{return!1}}toBinary(){return new K(this.id,K.SUBTYPE_UUID)}static generate(){const e=C.randomBytes(ln);return e[6]=e[6]&15|64,e[8]=e[8]&63|128,e}static isValid(e){return e?typeof e=="string"?ie.isValidUUIDString(e):fs(e)?e.byteLength===ln:e._bsontype==="Binary"&&e.sub_type===this.SUBTYPE_UUID&&e.buffer.byteLength===16:!1}static createFromHexString(e){const t=ie.bytesFromString(e);return new ie(t)}static createFromBase64(e){return new ie(C.fromBase64(e))}static bytesFromString(e){if(!ie.isValidUUIDString(e))throw new _("UUID string representation must be 32 hex digits or canonical hyphenated representation");return C.fromHex(e.replace(/-/g,""))}static isValidUUIDString(e){return So.test(e)||No.test(e)}inspect(e,t,i){return i??=ae,`new UUID(${i(this.toHexString(),t)})`}}class yt extends he{get _bsontype(){return"Code"}constructor(e,t){super(),this.code=e.toString(),this.scope=t??null}toJSON(){return this.scope!=null?{code:this.code,scope:this.scope}:{code:this.code}}toExtendedJSON(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}}static fromExtendedJSON(e){return new yt(e.$code,e.$scope)}inspect(e,t,i){i??=ae;let s=i(this.code,t);const r=s.includes(`
`);this.scope!=null&&(s+=`,${r?`
`:" "}${i(this.scope,t)}`);const o=r&&this.scope===null;return`new Code(${r?`
`:""}${s}${o?`
`:""})`}}function ko(n){return n!=null&&typeof n=="object"&&"$id"in n&&n.$id!=null&&"$ref"in n&&typeof n.$ref=="string"&&(!("$db"in n)||"$db"in n&&typeof n.$db=="string")}class Xe extends he{get _bsontype(){return"DBRef"}constructor(e,t,i,s){super();const r=e.split(".");r.length===2&&(i=r.shift(),e=r.shift()),this.collection=e,this.oid=t,this.db=i,this.fields=s||{}}get namespace(){return this.collection}set namespace(e){this.collection=e}toJSON(){const e=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(e.$db=this.db),e}toExtendedJSON(e){e=e||{};let t={$ref:this.collection,$id:this.oid};return e.legacy||(this.db&&(t.$db=this.db),t=Object.assign(t,this.fields)),t}static fromExtendedJSON(e){const t=Object.assign({},e);return delete t.$ref,delete t.$id,delete t.$db,new Xe(e.$ref,e.$id,e.$db,t)}inspect(e,t,i){i??=ae;const s=[i(this.namespace,t),i(this.oid,t),...this.db?[i(this.db,t)]:[],...Object.keys(this.fields).length>0?[i(this.fields,t)]:[]];return s[1]=i===ae?`new ObjectId(${s[1]})`:s[1],`new DBRef(${s.join(", ")})`}}let fe;try{fe=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}const ri=65536,To=1<<24,qe=ri*ri,ys=qe*qe,oi=ys/2,ai={},li={},Oo=20,Eo=/^(\+?0|(\+|-)?[1-9][0-9]*)$/;class u extends he{get _bsontype(){return"Long"}get __isLong__(){return!0}constructor(e=0,t,i){super(),typeof e=="bigint"?Object.assign(this,u.fromBigInt(e,!!t)):typeof e=="string"?Object.assign(this,u.fromString(e,!!t)):(this.low=e|0,this.high=t|0,this.unsigned=!!i)}static fromBits(e,t,i){return new u(e,t,i)}static fromInt(e,t){let i,s,r;return t?(e>>>=0,(r=0<=e&&e<256)&&(s=li[e],s)?s:(i=u.fromBits(e,(e|0)<0?-1:0,!0),r&&(li[e]=i),i)):(e|=0,(r=-128<=e&&e<128)&&(s=ai[e],s)?s:(i=u.fromBits(e,e<0?-1:0,!1),r&&(ai[e]=i),i))}static fromNumber(e,t){if(isNaN(e))return t?u.UZERO:u.ZERO;if(t){if(e<0)return u.UZERO;if(e>=ys)return u.MAX_UNSIGNED_VALUE}else{if(e<=-oi)return u.MIN_VALUE;if(e+1>=oi)return u.MAX_VALUE}return e<0?u.fromNumber(-e,t).neg():u.fromBits(e%qe|0,e/qe|0,t)}static fromBigInt(e,t){return u.fromString(e.toString(),t)}static fromString(e,t,i){if(e.length===0)throw new _("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return u.ZERO;if(typeof t=="number"?(i=t,t=!1):t=!!t,i=i||10,i<2||36<i)throw new _("radix");let s;if((s=e.indexOf("-"))>0)throw new _("interior hyphen");if(s===0)return u.fromString(e.substring(1),t,i).neg();const r=u.fromNumber(Math.pow(i,8));let o=u.ZERO;for(let a=0;a<e.length;a+=8){const l=Math.min(8,e.length-a),f=parseInt(e.substring(a,a+l),i);if(l<8){const h=u.fromNumber(Math.pow(i,l));o=o.mul(h).add(u.fromNumber(f))}else o=o.mul(r),o=o.add(u.fromNumber(f))}return o.unsigned=t,o}static fromBytes(e,t,i){return i?u.fromBytesLE(e,t):u.fromBytesBE(e,t)}static fromBytesLE(e,t){return new u(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)}static fromBytesBE(e,t){return new u(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}static isLong(e){return e!=null&&typeof e=="object"&&"__isLong__"in e&&e.__isLong__===!0}static fromValue(e,t){return typeof e=="number"?u.fromNumber(e,t):typeof e=="string"?u.fromString(e,t):u.fromBits(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}add(e){u.isLong(e)||(e=u.fromValue(e));const t=this.high>>>16,i=this.high&65535,s=this.low>>>16,r=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,f=e.low&65535;let h=0,c=0,d=0,g=0;return g+=r+f,d+=g>>>16,g&=65535,d+=s+l,c+=d>>>16,d&=65535,c+=i+a,h+=c>>>16,c&=65535,h+=t+o,h&=65535,u.fromBits(d<<16|g,h<<16|c,this.unsigned)}and(e){return u.isLong(e)||(e=u.fromValue(e)),u.fromBits(this.low&e.low,this.high&e.high,this.unsigned)}compare(e){if(u.isLong(e)||(e=u.fromValue(e)),this.eq(e))return 0;const t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1}comp(e){return this.compare(e)}divide(e){if(u.isLong(e)||(e=u.fromValue(e)),e.isZero())throw new _("division by zero");if(fe){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;const r=(this.unsigned?fe.div_u:fe.div_s)(this.low,this.high,e.low,e.high);return u.fromBits(r,fe.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?u.UZERO:u.ZERO;let t,i,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return u.UZERO;if(e.gt(this.shru(1)))return u.UONE;s=u.UZERO}else{if(this.eq(u.MIN_VALUE))return e.eq(u.ONE)||e.eq(u.NEG_ONE)?u.MIN_VALUE:e.eq(u.MIN_VALUE)?u.ONE:(t=this.shr(1).div(e).shl(1),t.eq(u.ZERO)?e.isNegative()?u.ONE:u.NEG_ONE:(i=this.sub(e.mul(t)),s=t.add(i.div(e)),s));if(e.eq(u.MIN_VALUE))return this.unsigned?u.UZERO:u.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=u.ZERO}for(i=this;i.gte(e);){t=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));const r=Math.ceil(Math.log(t)/Math.LN2),o=r<=48?1:Math.pow(2,r-48);let a=u.fromNumber(t),l=a.mul(e);for(;l.isNegative()||l.gt(i);)t-=o,a=u.fromNumber(t,this.unsigned),l=a.mul(e);a.isZero()&&(a=u.ONE),s=s.add(a),i=i.sub(l)}return s}div(e){return this.divide(e)}equals(e){return u.isLong(e)||(e=u.fromValue(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low}eq(e){return this.equals(e)}getHighBits(){return this.high}getHighBitsUnsigned(){return this.high>>>0}getLowBits(){return this.low}getLowBitsUnsigned(){return this.low>>>0}getNumBitsAbs(){if(this.isNegative())return this.eq(u.MIN_VALUE)?64:this.neg().getNumBitsAbs();const e=this.high!==0?this.high:this.low;let t;for(t=31;t>0&&!(e&1<<t);t--);return this.high!==0?t+33:t+1}greaterThan(e){return this.comp(e)>0}gt(e){return this.greaterThan(e)}greaterThanOrEqual(e){return this.comp(e)>=0}gte(e){return this.greaterThanOrEqual(e)}ge(e){return this.greaterThanOrEqual(e)}isEven(){return(this.low&1)===0}isNegative(){return!this.unsigned&&this.high<0}isOdd(){return(this.low&1)===1}isPositive(){return this.unsigned||this.high>=0}isZero(){return this.high===0&&this.low===0}lessThan(e){return this.comp(e)<0}lt(e){return this.lessThan(e)}lessThanOrEqual(e){return this.comp(e)<=0}lte(e){return this.lessThanOrEqual(e)}modulo(e){if(u.isLong(e)||(e=u.fromValue(e)),fe){const t=(this.unsigned?fe.rem_u:fe.rem_s)(this.low,this.high,e.low,e.high);return u.fromBits(t,fe.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))}mod(e){return this.modulo(e)}rem(e){return this.modulo(e)}multiply(e){if(this.isZero())return u.ZERO;if(u.isLong(e)||(e=u.fromValue(e)),fe){const O=fe.mul(this.low,this.high,e.low,e.high);return u.fromBits(O,fe.get_high(),this.unsigned)}if(e.isZero())return u.ZERO;if(this.eq(u.MIN_VALUE))return e.isOdd()?u.MIN_VALUE:u.ZERO;if(e.eq(u.MIN_VALUE))return this.isOdd()?u.MIN_VALUE:u.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(u.TWO_PWR_24)&&e.lt(u.TWO_PWR_24))return u.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);const t=this.high>>>16,i=this.high&65535,s=this.low>>>16,r=this.low&65535,o=e.high>>>16,a=e.high&65535,l=e.low>>>16,f=e.low&65535;let h=0,c=0,d=0,g=0;return g+=r*f,d+=g>>>16,g&=65535,d+=s*f,c+=d>>>16,d&=65535,d+=r*l,c+=d>>>16,d&=65535,c+=i*f,h+=c>>>16,c&=65535,c+=s*l,h+=c>>>16,c&=65535,c+=r*a,h+=c>>>16,c&=65535,h+=t*f+i*l+s*a+r*o,h&=65535,u.fromBits(d<<16|g,h<<16|c,this.unsigned)}mul(e){return this.multiply(e)}negate(){return!this.unsigned&&this.eq(u.MIN_VALUE)?u.MIN_VALUE:this.not().add(u.ONE)}neg(){return this.negate()}not(){return u.fromBits(~this.low,~this.high,this.unsigned)}notEquals(e){return!this.equals(e)}neq(e){return this.notEquals(e)}ne(e){return this.notEquals(e)}or(e){return u.isLong(e)||(e=u.fromValue(e)),u.fromBits(this.low|e.low,this.high|e.high,this.unsigned)}shiftLeft(e){return u.isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?u.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):u.fromBits(0,this.low<<e-32,this.unsigned)}shl(e){return this.shiftLeft(e)}shiftRight(e){return u.isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?u.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):u.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)}shr(e){return this.shiftRight(e)}shiftRightUnsigned(e){if(u.isLong(e)&&(e=e.toInt()),e&=63,e===0)return this;{const t=this.high;if(e<32){const i=this.low;return u.fromBits(i>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?u.fromBits(t,0,this.unsigned):u.fromBits(t>>>e-32,0,this.unsigned)}}shr_u(e){return this.shiftRightUnsigned(e)}shru(e){return this.shiftRightUnsigned(e)}subtract(e){return u.isLong(e)||(e=u.fromValue(e)),this.add(e.neg())}sub(e){return this.subtract(e)}toInt(){return this.unsigned?this.low>>>0:this.low}toNumber(){return this.unsigned?(this.high>>>0)*qe+(this.low>>>0):this.high*qe+(this.low>>>0)}toBigInt(){return BigInt(this.toString())}toBytes(e){return e?this.toBytesLE():this.toBytesBE()}toBytesLE(){const e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]}toBytesBE(){const e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]}toSigned(){return this.unsigned?u.fromBits(this.low,this.high,!1):this}toString(e){if(e=e||10,e<2||36<e)throw new _("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(u.MIN_VALUE)){const r=u.fromNumber(e),o=this.div(r),a=o.mul(r).sub(this);return o.toString(e)+a.toInt().toString(e)}else return"-"+this.neg().toString(e);const t=u.fromNumber(Math.pow(e,6),this.unsigned);let i=this,s="";for(;;){const r=i.div(t);let a=(i.sub(r.mul(t)).toInt()>>>0).toString(e);if(i=r,i.isZero())return a+s;for(;a.length<6;)a="0"+a;s=""+a+s}}toUnsigned(){return this.unsigned?this:u.fromBits(this.low,this.high,!0)}xor(e){return u.isLong(e)||(e=u.fromValue(e)),u.fromBits(this.low^e.low,this.high^e.high,this.unsigned)}eqz(){return this.isZero()}le(e){return this.lessThanOrEqual(e)}toExtendedJSON(e){return e&&e.relaxed?this.toNumber():{$numberLong:this.toString()}}static fromExtendedJSON(e,t){const{useBigInt64:i=!1,relaxed:s=!0}={...t};if(e.$numberLong.length>Oo)throw new _("$numberLong string is too long");if(!Eo.test(e.$numberLong))throw new _(`$numberLong string "${e.$numberLong}" is in an invalid format`);if(i){const o=BigInt(e.$numberLong);return BigInt.asIntN(64,o)}const r=u.fromString(e.$numberLong);return s?r.toNumber():r}inspect(e,t,i){i??=ae;const s=i(this.toString(),t),r=this.unsigned?`, ${i(this.unsigned,t)}`:"";return`new Long(${s}${r})`}}u.TWO_PWR_24=u.fromInt(To);u.MAX_UNSIGNED_VALUE=u.fromBits(-1,-1,!0);u.ZERO=u.fromInt(0);u.UZERO=u.fromInt(0,!0);u.ONE=u.fromInt(1);u.UONE=u.fromInt(1,!0);u.NEG_ONE=u.fromInt(-1);u.MAX_VALUE=u.fromBits(-1,2147483647,!1);u.MIN_VALUE=u.fromBits(0,-2147483648,!1);const Ao=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,Io=/^(\+|-)?(Infinity|inf)$/i,Bo=/^(\+|-)?NaN$/i,Fe=6111,lt=-6176,fi=6176,ci=34,fn=C.fromNumberArray([124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),ui=C.fromNumberArray([248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),hi=C.fromNumberArray([120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse()),$o=/^([-+])?(\d+)?$/,vo=31,di=16383,Co=30,_o=31;function pi(n){return!isNaN(parseInt(n,10))}function Lo(n){const e=u.fromNumber(1e9);let t=u.fromNumber(0);if(!n.parts[0]&&!n.parts[1]&&!n.parts[2]&&!n.parts[3])return{quotient:n,rem:t};for(let i=0;i<=3;i++)t=t.shiftLeft(32),t=t.add(new u(n.parts[i],0)),n.parts[i]=t.div(e).low,t=t.modulo(e);return{quotient:n,rem:t}}function Mo(n,e){if(!n&&!e)return{high:u.fromNumber(0),low:u.fromNumber(0)};const t=n.shiftRightUnsigned(32),i=new u(n.getLowBits(),0),s=e.shiftRightUnsigned(32),r=new u(e.getLowBits(),0);let o=t.multiply(s),a=t.multiply(r);const l=i.multiply(s);let f=i.multiply(r);return o=o.add(a.shiftRightUnsigned(32)),a=new u(a.getLowBits(),0).add(l).add(f.shiftRightUnsigned(32)),o=o.add(a.shiftRightUnsigned(32)),f=a.shiftLeft(32).add(new u(f.getLowBits(),0)),{high:o,low:f}}function Po(n,e){const t=n.high>>>0,i=e.high>>>0;if(t<i)return!0;if(t===i){const s=n.low>>>0,r=e.low>>>0;if(s<r)return!0}return!1}function pe(n,e){throw new _(`"${n}" is not a valid Decimal128 string - ${e}`)}class re extends he{get _bsontype(){return"Decimal128"}constructor(e){if(super(),typeof e=="string")this.bytes=re.fromString(e).bytes;else if(fs(e)){if(e.byteLength!==16)throw new _("Decimal128 must take a Buffer of 16 bytes");this.bytes=e}else throw new _("Decimal128 must take a Buffer or string")}static fromString(e){return re._fromString(e,{allowRounding:!1})}static fromStringWithRounding(e){return re._fromString(e,{allowRounding:!0})}static _fromString(e,t){let i=!1,s=!1,r=!1,o=!1,a=0,l=0,f=0,h=0,c=0;const d=[0];let g=0,O=0,p=0,m=0,I=new u(0,0),T=new u(0,0),B=0,w=0;if(e.length>=7e3)throw new _(""+e+" not a valid Decimal128 string");const v=e.match(Ao),A=e.match(Io),U=e.match(Bo);if(!v&&!A&&!U||e.length===0)throw new _(""+e+" not a valid Decimal128 string");if(v){const x=v[2],H=v[4],ye=v[5],X=v[6];H&&X===void 0&&pe(e,"missing exponent power"),H&&x===void 0&&pe(e,"missing exponent base"),H===void 0&&(ye||X)&&pe(e,"missing e before exponent")}if((e[w]==="+"||e[w]==="-")&&(s=!0,i=e[w++]==="-"),!pi(e[w])&&e[w]!=="."){if(e[w]==="i"||e[w]==="I")return new re(i?ui:hi);if(e[w]==="N")return new re(fn)}for(;pi(e[w])||e[w]===".";){if(e[w]==="."){r&&pe(e,"contains multiple periods"),r=!0,w=w+1;continue}g<ci&&(e[w]!=="0"||o)&&(o||(c=l),o=!0,d[O++]=parseInt(e[w],10),g=g+1),o&&(f=f+1),r&&(h=h+1),l=l+1,w=w+1}if(r&&!l)throw new _(""+e+" not a valid Decimal128 string");if(e[w]==="e"||e[w]==="E"){const x=e.substr(++w).match($o);if(!x||!x[2])return new re(fn);m=parseInt(x[0],10),w=w+x[0].length}if(e[w])return new re(fn);if(!g)d[0]=0,f=1,g=1,a=0;else if(p=g-1,a=f,a!==1)for(;e[c+a-1+Number(s)+Number(r)]==="0";)a=a-1;for(m<=h&&h>m+16384?m=lt:m=m-h;m>Fe;){if(p=p+1,p>=ci){if(a===0){m=Fe;break}pe(e,"overflow")}m=m-1}if(t.allowRounding){for(;m<lt||g<f;){if(p===0&&a<g){m=lt,a=0;break}if(g<f?f=f-1:p=p-1,m<Fe)m=m+1;else{if(d.join("").match(/^0+$/)){m=Fe;break}pe(e,"overflow")}}if(p+1<a){let x=l;r&&(c=c+1,x=x+1),s&&(c=c+1,x=x+1);const H=parseInt(e[c+p+1],10);let ye=0;if(H>=5&&(ye=1,H===5)){ye=d[p]%2===1?1:0;for(let X=c+p+2;X<x;X++)if(parseInt(e[X],10)){ye=1;break}}if(ye){let X=p;for(;X>=0&&++d[X]>9;X--)if(d[X]=0,X===0)if(m<Fe)m=m+1,d[X]=1;else return new re(i?ui:hi)}}}else{for(;m<lt||g<f;){if(p===0){if(a===0){m=lt;break}pe(e,"exponent underflow")}g<f?(e[f-1+Number(s)+Number(r)]!=="0"&&a!==0&&pe(e,"inexact rounding"),f=f-1):(d[p]!==0&&pe(e,"inexact rounding"),p=p-1),m<Fe?m=m+1:pe(e,"overflow")}p+1<a&&(r&&(c=c+1),s&&(c=c+1),parseInt(e[c+p+1],10)!==0&&pe(e,"inexact rounding"))}if(I=u.fromNumber(0),T=u.fromNumber(0),a===0)I=u.fromNumber(0),T=u.fromNumber(0);else if(p<17){let x=0;for(T=u.fromNumber(d[x++]),I=new u(0,0);x<=p;x++)T=T.multiply(u.fromNumber(10)),T=T.add(u.fromNumber(d[x]))}else{let x=0;for(I=u.fromNumber(d[x++]);x<=p-17;x++)I=I.multiply(u.fromNumber(10)),I=I.add(u.fromNumber(d[x]));for(T=u.fromNumber(d[x++]);x<=p;x++)T=T.multiply(u.fromNumber(10)),T=T.add(u.fromNumber(d[x]))}const R=Mo(I,u.fromString("100000000000000000"));R.low=R.low.add(T),Po(R.low,T)&&(R.high=R.high.add(u.fromNumber(1))),B=m+fi;const L={low:u.fromNumber(0),high:u.fromNumber(0)};R.high.shiftRightUnsigned(49).and(u.fromNumber(1)).equals(u.fromNumber(1))?(L.high=L.high.or(u.fromNumber(3).shiftLeft(61)),L.high=L.high.or(u.fromNumber(B).and(u.fromNumber(16383).shiftLeft(47))),L.high=L.high.or(R.high.and(u.fromNumber(0x7fffffffffff)))):(L.high=L.high.or(u.fromNumber(B&16383).shiftLeft(49)),L.high=L.high.or(R.high.and(u.fromNumber(562949953421311)))),L.low=R.low,i&&(L.high=L.high.or(u.fromString("9223372036854775808")));const V=C.allocate(16);return w=0,V[w++]=L.low.low&255,V[w++]=L.low.low>>8&255,V[w++]=L.low.low>>16&255,V[w++]=L.low.low>>24&255,V[w++]=L.low.high&255,V[w++]=L.low.high>>8&255,V[w++]=L.low.high>>16&255,V[w++]=L.low.high>>24&255,V[w++]=L.high.low&255,V[w++]=L.high.low>>8&255,V[w++]=L.high.low>>16&255,V[w++]=L.high.low>>24&255,V[w++]=L.high.high&255,V[w++]=L.high.high>>8&255,V[w++]=L.high.high>>16&255,V[w++]=L.high.high>>24&255,new re(V)}toString(){let e,t=0;const i=new Array(36);for(let w=0;w<i.length;w++)i[w]=0;let s=0,r=!1,o,a={parts:[0,0,0,0]},l,f;const h=[];s=0;const c=this.bytes,d=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24,g=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24,O=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24,p=c[s++]|c[s++]<<8|c[s++]<<16|c[s++]<<24;s=0,{low:new u(d,g),high:new u(O,p)}.high.lessThan(u.ZERO)&&h.push("-");const I=p>>26&vo;if(I>>3===3){if(I===Co)return h.join("")+"Infinity";if(I===_o)return"NaN";e=p>>15&di,o=8+(p>>14&1)}else o=p>>14&7,e=p>>17&di;const T=e-fi;if(a.parts[0]=(p&16383)+((o&15)<<14),a.parts[1]=O,a.parts[2]=g,a.parts[3]=d,a.parts[0]===0&&a.parts[1]===0&&a.parts[2]===0&&a.parts[3]===0)r=!0;else for(f=3;f>=0;f--){let w=0;const v=Lo(a);if(a=v.quotient,w=v.rem.low,!!w)for(l=8;l>=0;l--)i[f*9+l]=w%10,w=Math.floor(w/10)}if(r)t=1,i[s]=0;else for(t=36;!i[s];)t=t-1,s=s+1;const B=t-1+T;if(B>=34||B<=-7||T>0){if(t>34)return h.push("0"),T>0?h.push(`E+${T}`):T<0&&h.push(`E${T}`),h.join("");h.push(`${i[s++]}`),t=t-1,t&&h.push(".");for(let w=0;w<t;w++)h.push(`${i[s++]}`);h.push("E"),B>0?h.push(`+${B}`):h.push(`${B}`)}else if(T>=0)for(let w=0;w<t;w++)h.push(`${i[s++]}`);else{let w=t+T;if(w>0)for(let v=0;v<w;v++)h.push(`${i[s++]}`);else h.push("0");for(h.push(".");w++<0;)h.push("0");for(let v=0;v<t-Math.max(w-1,0);v++)h.push(`${i[s++]}`)}return h.join("")}toJSON(){return{$numberDecimal:this.toString()}}toExtendedJSON(){return{$numberDecimal:this.toString()}}static fromExtendedJSON(e){return re.fromString(e.$numberDecimal)}inspect(e,t,i){return i??=ae,`new Decimal128(${i(this.toString(),t)})`}}class bt extends he{get _bsontype(){return"Double"}constructor(e){super(),e instanceof Number&&(e=e.valueOf()),this.value=+e}valueOf(){return this.value}toJSON(){return this.value}toString(e){return this.value.toString(e)}toExtendedJSON(e){return e&&(e.legacy||e.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-0.0"}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}}static fromExtendedJSON(e,t){const i=parseFloat(e.$numberDouble);return t&&t.relaxed?i:new bt(i)}inspect(e,t,i){return i??=ae,`new Double(${i(this.value,t)})`}}class wt extends he{get _bsontype(){return"Int32"}constructor(e){super(),e instanceof Number&&(e=e.valueOf()),this.value=+e|0}valueOf(){return this.value}toString(e){return this.value.toString(e)}toJSON(){return this.value}toExtendedJSON(e){return e&&(e.relaxed||e.legacy)?this.value:{$numberInt:this.value.toString()}}static fromExtendedJSON(e,t){return t&&t.relaxed?parseInt(e.$numberInt,10):new wt(e.$numberInt)}inspect(e,t,i){return i??=ae,`new Int32(${i(this.value,t)})`}}class Jt extends he{get _bsontype(){return"MaxKey"}toExtendedJSON(){return{$maxKey:1}}static fromExtendedJSON(){return new Jt}inspect(){return"new MaxKey()"}}class Gt extends he{get _bsontype(){return"MinKey"}toExtendedJSON(){return{$minKey:1}}static fromExtendedJSON(){return new Gt}inspect(){return"new MinKey()"}}const xo=new RegExp("^[0-9a-fA-F]{24}$");let _e=null;const Ne=Symbol("id");class Y extends he{get _bsontype(){return"ObjectId"}constructor(e){super();let t;if(typeof e=="object"&&e&&"id"in e){if(typeof e.id!="string"&&!ArrayBuffer.isView(e.id))throw new _("Argument passed in must have an id that is of type string or Buffer");"toHexString"in e&&typeof e.toHexString=="function"?t=C.fromHex(e.toHexString()):t=e.id}else t=e;if(t==null||typeof t=="number")this[Ne]=Y.generate(typeof t=="number"?t:void 0);else if(ArrayBuffer.isView(t)&&t.byteLength===12)this[Ne]=C.toLocalBufferType(t);else if(typeof t=="string")if(t.length===24&&xo.test(t))this[Ne]=C.fromHex(t);else throw new _("input must be a 24 character hex string, 12 byte Uint8Array, or an integer");else throw new _("Argument passed in does not match the accepted types");Y.cacheHexString&&(this.__id=C.toHex(this.id))}get id(){return this[Ne]}set id(e){this[Ne]=e,Y.cacheHexString&&(this.__id=C.toHex(e))}toHexString(){if(Y.cacheHexString&&this.__id)return this.__id;const e=C.toHex(this.id);return Y.cacheHexString&&!this.__id&&(this.__id=e),e}static getInc(){return Y.index=(Y.index+1)%16777215}static generate(e){typeof e!="number"&&(e=Math.floor(Date.now()/1e3));const t=Y.getInc(),i=C.allocate(12);return an.fromUint8Array(i).setUint32(0,e,!1),_e===null&&(_e=C.randomBytes(5)),i[4]=_e[0],i[5]=_e[1],i[6]=_e[2],i[7]=_e[3],i[8]=_e[4],i[11]=t&255,i[10]=t>>8&255,i[9]=t>>16&255,i}toString(e){return e==="base64"?C.toBase64(this.id):e==="hex"?this.toHexString():this.toHexString()}toJSON(){return this.toHexString()}static is(e){return e!=null&&typeof e=="object"&&"_bsontype"in e&&e._bsontype==="ObjectId"}equals(e){if(e==null)return!1;if(Y.is(e))return this[Ne][11]===e[Ne][11]&&C.equals(this[Ne],e[Ne]);if(typeof e=="string")return e.toLowerCase()===this.toHexString();if(typeof e=="object"&&typeof e.toHexString=="function"){const t=e.toHexString(),i=this.toHexString();return typeof t=="string"&&t.toLowerCase()===i}return!1}getTimestamp(){const e=new Date,t=an.fromUint8Array(this.id).getUint32(0,!1);return e.setTime(Math.floor(t)*1e3),e}static createPk(){return new Y}static createFromTime(e){const t=C.fromNumberArray([0,0,0,0,0,0,0,0,0,0,0,0]);return an.fromUint8Array(t).setUint32(0,e,!1),new Y(t)}static createFromHexString(e){if(e?.length!==24)throw new _("hex string must be 24 characters");return new Y(C.fromHex(e))}static createFromBase64(e){if(e?.length!==16)throw new _("base64 string must be 16 characters");return new Y(C.fromBase64(e))}static isValid(e){if(e==null)return!1;try{return new Y(e),!0}catch{return!1}}toExtendedJSON(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}}static fromExtendedJSON(e){return new Y(e.$oid)}inspect(e,t,i){return i??=ae,`new ObjectId(${i(this.toHexString(),t)})`}}Y.index=Math.floor(Math.random()*16777215);function Do(n){return n.split("").sort().join("")}class Ee extends he{get _bsontype(){return"BSONRegExp"}constructor(e,t){if(super(),this.pattern=e,this.options=Do(t??""),this.pattern.indexOf("\0")!==-1)throw new _(`BSON Regex patterns cannot contain null bytes, found: ${JSON.stringify(this.pattern)}`);if(this.options.indexOf("\0")!==-1)throw new _(`BSON Regex options cannot contain null bytes, found: ${JSON.stringify(this.options)}`);for(let i=0;i<this.options.length;i++)if(!(this.options[i]==="i"||this.options[i]==="m"||this.options[i]==="x"||this.options[i]==="l"||this.options[i]==="s"||this.options[i]==="u"))throw new _(`The regular expression option [${this.options[i]}] is not supported`)}static parseOptions(e){return e?e.split("").sort().join(""):""}toExtendedJSON(e){return e=e||{},e.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}}static fromExtendedJSON(e){if("$regex"in e)if(typeof e.$regex!="string"){if(e.$regex._bsontype==="BSONRegExp")return e}else return new Ee(e.$regex,Ee.parseOptions(e.$options));if("$regularExpression"in e)return new Ee(e.$regularExpression.pattern,Ee.parseOptions(e.$regularExpression.options));throw new _(`Unexpected BSONRegExp EJSON object form: ${JSON.stringify(e)}`)}inspect(e,t,i){const s=Qr(t)??(a=>a);i??=ae;const r=s(i(this.pattern),"regexp"),o=s(i(this.options),"regexp");return`new BSONRegExp(${r}, ${o})`}}class Yt extends he{get _bsontype(){return"BSONSymbol"}constructor(e){super(),this.value=e}valueOf(){return this.value}toString(){return this.value}toJSON(){return this.value}toExtendedJSON(){return{$symbol:this.value}}static fromExtendedJSON(e){return new Yt(e.$symbol)}inspect(e,t,i){return i??=ae,`new BSONSymbol(${i(this.value,t)})`}}const Ro=u;class Te extends Ro{get _bsontype(){return"Timestamp"}constructor(e){if(e==null)super(0,0,!0);else if(typeof e=="bigint")super(e,!0);else if(u.isLong(e))super(e.low,e.high,!0);else if(typeof e=="object"&&"t"in e&&"i"in e){if(typeof e.t!="number"&&(typeof e.t!="object"||e.t._bsontype!=="Int32"))throw new _("Timestamp constructed from { t, i } must provide t as a number");if(typeof e.i!="number"&&(typeof e.i!="object"||e.i._bsontype!=="Int32"))throw new _("Timestamp constructed from { t, i } must provide i as a number");const t=Number(e.t),i=Number(e.i);if(t<0||Number.isNaN(t))throw new _("Timestamp constructed from { t, i } must provide a positive t");if(i<0||Number.isNaN(i))throw new _("Timestamp constructed from { t, i } must provide a positive i");if(t>4294967295)throw new _("Timestamp constructed from { t, i } must provide t equal or less than uint32 max");if(i>4294967295)throw new _("Timestamp constructed from { t, i } must provide i equal or less than uint32 max");super(i,t,!0)}else throw new _("A Timestamp can only be constructed with: bigint, Long, or { t: number; i: number }")}toJSON(){return{$timestamp:this.toString()}}static fromInt(e){return new Te(u.fromInt(e,!0))}static fromNumber(e){return new Te(u.fromNumber(e,!0))}static fromBits(e,t){return new Te({i:e,t})}static fromString(e,t){return new Te(u.fromString(e,!0,t))}toExtendedJSON(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}}static fromExtendedJSON(e){const t=u.isLong(e.$timestamp.i)?e.$timestamp.i.getLowBitsUnsigned():e.$timestamp.i,i=u.isLong(e.$timestamp.t)?e.$timestamp.t.getLowBitsUnsigned():e.$timestamp.t;return new Te({t:i,i:t})}inspect(e,t,i){i??=ae;const s=i(this.high>>>0,t),r=i(this.low>>>0,t);return`new Timestamp({ t: ${s}, i: ${r} })`}}Te.MAX_VALUE=u.MAX_UNSIGNED_VALUE;u.fromNumber(eo);u.fromNumber(to);const bs=new DataView(new ArrayBuffer(8),0,8);new Uint8Array(bs.buffer,0,4);new Uint8Array(bs.buffer,0,8);function jo(n){return n!=null&&typeof n=="object"&&"_bsontype"in n&&typeof n._bsontype=="string"}const Fo={$oid:Y,$binary:K,$uuid:K,$symbol:Yt,$numberInt:wt,$numberDecimal:re,$numberDouble:bt,$numberLong:u,$minKey:Gt,$maxKey:Jt,$regex:Ee,$regularExpression:Ee,$timestamp:Te};function ws(n,e={}){if(typeof n=="number"){const i=n<=us&&n>=hs,s=n<=ds&&n>=ps;if(e.relaxed||e.legacy)return n;if(Number.isInteger(n)&&!Object.is(n,-0)){if(i)return new wt(n);if(s)return e.useBigInt64?BigInt(n):u.fromNumber(n)}return new bt(n)}if(n==null||typeof n!="object")return n;if(n.$undefined)return null;const t=Object.keys(n).filter(i=>i.startsWith("$")&&n[i]!=null);for(let i=0;i<t.length;i++){const s=Fo[t[i]];if(s)return s.fromExtendedJSON(n,e)}if(n.$date!=null){const i=n.$date,s=new Date;if(e.legacy)if(typeof i=="number")s.setTime(i);else if(typeof i=="string")s.setTime(Date.parse(i));else if(typeof i=="bigint")s.setTime(Number(i));else throw new ii(`Unrecognized type for EJSON date: ${typeof i}`);else if(typeof i=="string")s.setTime(Date.parse(i));else if(u.isLong(i))s.setTime(i.toNumber());else if(typeof i=="number"&&e.relaxed)s.setTime(i);else if(typeof i=="bigint")s.setTime(Number(i));else throw new ii(`Unrecognized type for EJSON date: ${typeof i}`);return s}if(n.$code!=null){const i=Object.assign({},n);return n.$scope&&(i.$scope=ws(n.$scope)),yt.fromExtendedJSON(n)}if(ko(n)||n.$dbPointer){const i=n.$ref?n:n.$dbPointer;if(i instanceof Xe)return i;const s=Object.keys(i).filter(o=>o.startsWith("$"));let r=!0;if(s.forEach(o=>{["$ref","$id","$db"].indexOf(o)===-1&&(r=!1)}),r)return Xe.fromExtendedJSON(i)}return n}function Uo(n,e){return n.map((t,i)=>{e.seenObjects.push({propertyName:`index ${i}`,obj:null});try{return ke(t,e)}finally{e.seenObjects.pop()}})}function mi(n){const e=n.toISOString();return n.getUTCMilliseconds()!==0?e:e.slice(0,-5)+"Z"}function ke(n,e){if(n instanceof Map||cs(n)){const t=Object.create(null);for(const[i,s]of n){if(typeof i!="string")throw new _("Can only serialize maps with string keys");t[i]=s}return ke(t,e)}if((typeof n=="object"||typeof n=="function")&&n!==null){const t=e.seenObjects.findIndex(i=>i.obj===n);if(t!==-1){const i=e.seenObjects.map(h=>h.propertyName),s=i.slice(0,t).map(h=>`${h} -> `).join(""),r=i[t],o=" -> "+i.slice(t+1,i.length-1).map(h=>`${h} -> `).join(""),a=i[i.length-1],l=" ".repeat(s.length+r.length/2),f="-".repeat(o.length+(r.length+a.length)/2-1);throw new _(`Converting circular structure to EJSON:
    ${s}${r}${o}${a}
    ${l}\\${f}/`)}e.seenObjects[e.seenObjects.length-1].obj=n}if(Array.isArray(n))return Uo(n,e);if(n===void 0)return null;if(n instanceof Date||Zr(n)){const t=n.getTime(),i=t>-1&&t<2534023188e5;return e.legacy?e.relaxed&&i?{$date:n.getTime()}:{$date:mi(n)}:e.relaxed&&i?{$date:mi(n)}:{$date:{$numberLong:n.getTime().toString()}}}if(typeof n=="number"&&(!e.relaxed||!isFinite(n))){if(Number.isInteger(n)&&!Object.is(n,-0)){if(n>=hs&&n<=us)return{$numberInt:n.toString()};if(n>=ps&&n<=ds)return{$numberLong:n.toString()}}return{$numberDouble:Object.is(n,-0)?"-0.0":n.toString()}}if(typeof n=="bigint")return e.relaxed?Number(BigInt.asIntN(64,n)):{$numberLong:BigInt.asIntN(64,n).toString()};if(n instanceof RegExp||Xr(n)){let t=n.flags;if(t===void 0){const s=n.toString().match(/[gimuy]*$/);s&&(t=s[0])}return new Ee(n.source,t).toExtendedJSON(e)}return n!=null&&typeof n=="object"?Ho(n,e):n}const Vo={Binary:n=>new K(n.value(),n.sub_type),Code:n=>new yt(n.code,n.scope),DBRef:n=>new Xe(n.collection||n.namespace,n.oid,n.db,n.fields),Decimal128:n=>new re(n.bytes),Double:n=>new bt(n.value),Int32:n=>new wt(n.value),Long:n=>u.fromBits(n.low!=null?n.low:n.low_,n.low!=null?n.high:n.high_,n.low!=null?n.unsigned:n.unsigned_),MaxKey:()=>new Jt,MinKey:()=>new Gt,ObjectId:n=>new Y(n),BSONRegExp:n=>new Ee(n.pattern,n.options),BSONSymbol:n=>new Yt(n.value),Timestamp:n=>Te.fromBits(n.low,n.high)};function Ho(n,e){if(n==null||typeof n!="object")throw new _("not an object instance");const t=n._bsontype;if(typeof t>"u"){const i={};for(const s of Object.keys(n)){e.seenObjects.push({propertyName:s,obj:null});try{const r=ke(n[s],e);s==="__proto__"?Object.defineProperty(i,s,{value:r,writable:!0,enumerable:!0,configurable:!0}):i[s]=r}finally{e.seenObjects.pop()}}return i}else{if(n!=null&&typeof n=="object"&&typeof n._bsontype=="string"&&n[Symbol.for("@@mdb.bson.version")]!==Pn)throw new no;if(jo(n)){let i=n;if(typeof i.toExtendedJSON!="function"){const s=Vo[n._bsontype];if(!s)throw new _("Unrecognized or invalid _bsontype: "+n._bsontype);i=s(i)}return t==="Code"&&i.scope?i=new yt(i.code,ke(i.scope,e)):t==="DBRef"&&i.oid&&(i=new Xe(ke(i.collection,e),ke(i.oid,e),ke(i.db,e),ke(i.fields,e))),i.toExtendedJSON(e)}else throw new _("_bsontype must be a string, but was: "+typeof t)}}function Ss(n,e){const t={useBigInt64:e?.useBigInt64??!1,relaxed:e?.relaxed??!0,legacy:e?.legacy??!1};return JSON.parse(n,(i,s)=>{if(i.indexOf("\0")!==-1)throw new _(`BSON Document field names cannot contain null bytes, found: ${JSON.stringify(i)}`);return ws(s,t)})}function Ns(n,e,t,i){t!=null&&typeof t=="object"&&(i=t,t=0),e!=null&&typeof e=="object"&&!Array.isArray(e)&&(i=e,e=void 0,t=0);const s=Object.assign({relaxed:!0,legacy:!1},i,{seenObjects:[{propertyName:"(root)",obj:null}]}),r=ke(n,s);return JSON.stringify(r,e,t)}function Ko(n,e){return e=e||{},JSON.parse(Ns(n,e))}function qo(n,e){return e=e||{},Ss(JSON.stringify(n),e)}const St=Object.create(null);St.parse=Ss;St.stringify=Ns;St.serialize=Ko;St.deserialize=qo;Object.freeze(St);const Wo=1024*1024*17;C.allocate(Wo);const la={description:{name:"New Creature",isProperNoun:!1,description:"",image:"",faction:"",environment:"",alignment:"Unaligned",cr:0,xp:0},core:{proficiencyBonus:2,race:"Humanoid",size:"Medium",speed:[{name:"Walk",value:30,unit:"ft",comment:""}],senses:[],languages:[]},abilities:{stats:{str:10,dex:10,con:10,wis:10,int:10,cha:10},saves:{str:{isProficient:!1,override:null},dex:{isProficient:!1,override:null},con:{isProficient:!1,override:null},wis:{isProficient:!1,override:null},int:{isProficient:!1,override:null},cha:{isProficient:!1,override:null}},skills:[]},defenses:{hp:{numOfHitDie:1,sizeOfHitDie:6,override:null},ac:{ac:10,acSource:"natural armor"},vulnerabilities:[],resistances:[],immunities:[],conditionImmunities:[]},features:{features:[],actions:[],bonus:[],reactions:[],legendary:[],lair:[],mythic:[],regional:[]},spellcasting:{innateSpells:{spellList:{0:[],1:[],2:[],3:[]},spellDcOverride:null,spellBonusOverride:null,spellCastingAbility:null,noComponentsOfType:["Material","Verbal","Somatic"],isPsionics:!1,displayAsAction:!1},casterSpells:{casterLevel:null,castingClass:null,spellCastingAbility:null,spellCastingAbilityOverride:null,spellList:[[],[],[],[],[],[],[],[],[],[]],spellSlotList:{},spellDcOverride:null,spellBonusOverride:null,displayAsAction:!1}},misc:{legActionsPerRound:3,telepathy:0,passivePerceptionOverride:null,featureHeaderTexts:{features:"",actions:"",bonus:"",reactions:"",legendary:"The creature can take $NUM$ legendary actions, choosing from the options below. Only one legendary action can be used at a time and only at the end of another creature's turn. The creature regains spent legendary actions at the start of its turn.",lair:"On initiative count 20 (losing initiative ties), the creature can take one of the following lair actions; it can't take the same lair action two rounds in a row",mythic:"If the creatures' Mythic trait is active, it can use the options below as legendary actions.",regional:"The region containing the creatures lair can be transformed by its presence, creating one or more of the following effects:"}}},Jo=[0,200,450,700,1100,1800,2300,2900,3900,5e3,5900,7200,8400,1e4,11500,13e3,15e3,18e3,2e4,22e3,25e3,33e3,41e3,5e4,62e3,75e3,9e4,105e3,12e4,135e3,255e3];function fa(n){return n==.125?25:n==.25?50:n==.5?100:Jo[n]??0}function ca(n,e){return!n||!e?{}:n=="Warlock"?{1:{1:1},2:{1:2},3:{2:2},4:{2:2},5:{3:2},6:{3:2},7:{4:2},8:{4:2},9:{5:2},10:{5:2},11:{5:3},12:{5:3},13:{5:3},14:{5:3},15:{5:3},16:{5:3},17:{5:4},18:{5:4},19:{5:4},20:{5:4}}[e]:["Ranger","Paladin","Artificer"].includes(n)?e==1&&n=="Artificer"?{1:2}:{1:{},2:{1:2},3:{1:3},4:{1:3},5:{1:4,2:2},6:{1:4,2:2},7:{1:4,2:3},8:{1:4,2:3},9:{1:4,2:3,3:2},10:{1:4,2:3,3:2},11:{1:4,2:3,3:3},12:{1:4,2:3,3:3},13:{1:4,2:3,3:3,4:1},14:{1:4,2:3,3:3,4:1},15:{1:4,2:3,3:3,4:2},16:{1:4,2:3,3:3,4:2},17:{1:4,2:3,3:3,4:3,5:1},18:{1:4,2:3,3:3,4:3,5:1},19:{1:4,2:3,3:3,4:3,5:2},20:{1:4,2:3,3:3,4:3,5:2}}[e]:{1:{1:2},2:{1:3},3:{1:4,2:2},4:{1:4,2:3},5:{1:4,2:3,3:2},6:{1:4,2:3,3:3},7:{1:4,2:3,3:3,4:1},8:{1:4,2:3,3:3,4:2},9:{1:4,2:3,3:3,4:3,5:1},10:{1:4,2:3,3:3,4:3,5:2},11:{1:4,2:3,3:3,4:3,5:2},12:{1:4,2:3,3:3,4:3,5:2,6:1},13:{1:4,2:3,3:3,4:3,5:2,6:1,7:1},14:{1:4,2:3,3:3,4:3,5:2,6:1,7:1},15:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1},16:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1},17:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1,9:1},18:{1:4,2:3,3:3,4:3,5:2,6:1,7:1,8:1,9:1},19:{1:4,2:3,3:3,4:3,5:2,6:2,7:1,8:1,9:1},20:{1:4,2:3,3:3,4:3,5:2,6:2,7:2,8:1,9:1}}[e]}const gi={0:["Acid Splash","Blade Ward","Booming Blade","Chill Touch","Control Flames","Create Bonfire","Dancing Lights","Druidcraft","Eldritch Blast","Encode Thoughts","Fire Bolt","Friends","Frostbite","Green-Flame Blade","Guidance","Gust","Infestation","Light","Lightning Lure","Mage Hand","Magic Stone","Mending","Message","Mind Sliver","Minor Illusion","Mold Earth","Poison Spray","Prestidigitation","Primal Savagery","Produce Flame","Ray of Frost","Resistance","Sacred Flame","Sapping Sting","Shape Water","Shillelagh","Shocking Grasp","Spare the Dying","Sword Burst","Thaumaturgy","Thorn Whip","Thunderclap","Toll the Dead","True Strike","Vicious Mockery","Word of Radiance"],1:["Absorb Elements","Alarm","Animal Friendship","Armor of Agathys","Arms of Hadar","Bane","Beast Bond","Bless","Burning Hands","Catapult","Cause Fear","Ceremony","Chaos Bolt","Charm Person","Chromatic Orb","Color Spray","Command","Compelled Duel","Comprehend Languages","Create or Destroy Water","Cure Wounds","Detect Evil and Good","Detect Magic","Detect Poison and Disease","Disguise Self","Dissonant Whispers","Distort Value","Divine Favor","Earth Tremor","Ensnaring Strike","Entangle","Expeditious Retreat","Faerie Fire","False Life","Feather Fall","Find Familiar","Floating Disk","Fog Cloud","Frost Fingers","Gift of Alacrity","Goodberry","Grease","Guiding Bolt","Hail of Thorns","Healing Word","Hellish Rebuke","Heroism","Hex","Hideous Laughter","Hunter's Mark","Ice Knife","Identify","Illusory Script","Inflict Wounds","Jim's Magic Missile","Jump","Longstrider","Mage Armor","Magic Missile","Magnify Gravity","Protection from Evil and Good","Purify Food and Drink","Ray of Sickness","Sanctuary","Searing Smite","Shield","Shield of Faith","Silent Image","Silvery Barbs","Sleep","Snare","Speak with Animals","Tasha's Caustic Brew","Tasha's Hideous Laughter","Tenser's Floating Disk","Thunderous Smite","Thunderwave","Unseen Servant","Witch Bolt","Wrathful Smite","Zephyr Strike"],2:["Acid Arrow","Aganazzar's Scorcher","Aid","Air Bubble","Alter Self","Animal Messenger","Arcane Lock","Arcanist's Magic Aura","Augury","Barkskin","Beast Sense","Blindness/Deafness","Blur","Borrowed Knowledge","Branding Smite","Calm Emotions","Cloud of Daggers","Continual Flame","Cordon of Arrows","Crown of Madness","Darkness","Darkvision","Detect Thoughts","Dragon's Breath","Dust Devil","Earthbind","Enhance Ability","Enlarge/Reduce","Enthrall","Find Steed","Find Traps","Flame Blade","Flaming Sphere","Flock of Familiars","Fortune's Favor","Gentle Repose","Gift of Gab","Gust of Wind","Healing Spirit","Heat Metal","Hold Person","Immovable Object","Invisibility","Jim's Glowing Coin","Kinetic Jaunt","Knock","Lesser Restoration","Levitate","Locate Animals or Plants","Locate Object","Magic Mouth","Magic Weapon","Maximilian's Earthen Grasp","Melf's Acid Arrow","Mind Spike","Mirror Image","Misty Step","Moonbeam","Nathair's Mischief","Nystul's Magic Aura","Pass without Trace","Phantasmal Force","Prayer of Healing","Protection from Poison","Pyrotechnics","Ray of Enfeeblement","Rime's Binding Ice","Rope Trick","Scorching Ray","See Invisibility","Shadow Blade","Shatter","Silence","Skywrite","Snilloc's Snowball Swarm","Spider Climb","Spike Growth","Spiritual Weapon","Spray of Cards","Suggestion","Summon Beast","Tasha's Mind Whip","Vortex Warp","Warding Bond","Warding Wind","Warp Sense","Web","Wither and Bloom","Wristpocket","Zone of Truth"],3:["Animate Dead","Antagonize","Ashardalon's Stride","Aura of Vitality","Beacon of Hope","Bestow Curse","Blinding Smite","Blink","Call Lightning","Catnap","Clairvoyance","Conjure Animals","Conjure Barrage","Counterspell","Create Food and Water","Crusader's Mantle","Daylight","Dispel Magic","Elemental Weapon","Enemies Abound","Erupting Earth","Fast Friends","Fear","Feign Death","Fireball","Flame Arrows","Fly","Freedom of the Waves","Galder's Tower","Gaseous Form","Glyph of Warding","Haste","Hunger of Hadar","Hypnotic Pattern","Incite Greed","Intellect Fortress","Leomund's Tiny Hut","Life Transference","Lightning Arrow","Lightning Bolt","Magic Circle","Major Image","Mass Healing Word","Meld into Stone","Melf's Minute Meteors","Motivational Speech","Nondetection","Phantom Steed","Plant Growth","Protection from Energy","Pulse Wave","Remove Curse","Revivify","Sending","Sleet Storm","Slow","Speak with Dead","Speak with Plants","Spirit Guardians","Spirit Shroud","Stinking Cloud","Summon Fey","Summon Lesser Demons","Summon Shadowspawn","Summon Undead","Thunder Step","Tidal Wave","Tiny Hut","Tiny Servant","Tongues","Vampiric Touch","Wall of Sand","Wall of Water","Water Breathing","Water Walk","Wind Wall"],4:["Arcane Eye","Aura of Life","Aura of Purity","Banishment","Black Tentacles","Blight","Charm Monster","Compulsion","Confusion","Conjure Minor Elementals","Conjure Woodland Beings","Control Water","Death Ward","Dimension Door","Divination","Dominate Beast","Elemental Bane","Evard's Black Tentacles","Fabricate","Faithful Hound","Find Greater Steed","Fire Shield","Freedom of Movement","Galder's Speedy Courier","Gate Seal","Giant Insect","Grasping Vine","Gravity Sinkhole","Greater Invisibility","Guardian of Faith","Guardian of Nature","Hallucinatory Terrain","Ice Storm","Leomund's Secret Chest","Locate Creature","Mordenkainen's Faithful Hound","Mordenkainen's Private Sanctum","Otiluke's Resilient Sphere","Phantasmal Killer","Polymorph","Private Sanctum","Raulothim's Psychic Lance","Resilient Sphere","Secret Chest","Shadow of Moil","Sickening Radiance","Spirit of Death","Staggering Smite","Stone Shape","Stoneskin","Storm Sphere","Summon Aberration","Summon Construct","Summon Elemental","Summon Greater Demon","Vitriolic Sphere","Wall of Fire","Watery Sphere"],5:["Animate Objects","Antilife Shell","Arcane Hand","Awaken","Banishing Smite","Bigby's Hand","Circle of Power","Cloudkill","Commune","Commune with Nature","Cone of Cold","Conjure Elemental","Conjure Volley","Contact Other Plane","Contagion","Control Winds","Create Spelljamming Helm","Creation","Danse Macabre","Dawn","Destructive Wave","Dispel Evil and Good","Dominate Person","Dream","Enervation","Far Step","Flame Strike","Freedom of the Winds","Geas","Greater Restoration","Hallow","Hold Monster","Holy Weapon","Immolation","Infernal Calling","Insect Plague","Legend Lore","Maelstrom","Mass Cure Wounds","Mislead","Modify Memory","Negative Energy Flood","Passwall","Planar Binding","Raise Dead","Rary's Telepathic Bond","Reincarnate","Scrying","Seeming","Skill Empowerment","Steel Wind Strike","Summon Celestial","Summon Draconic Spirit","Swift Quiver","Synaptic Static","Telekinesis","Telepathic Bond","Teleportation Circle","Temporal Shunt","Transmute Rock","Tree Stride","Wall of Force","Wall of Light","Wall of Stone","Wrath of Nature"],6:["Arcane Gate","Blade Barrier","Bones of the Earth","Chain Lightning","Circle of Death","Conjure Fey","Contingency","Create Homunculus","Create Undead","Disintegrate","Drawmij's Instant Summons","Druid Grove","Eyebite","Find the Path","Fizban's Platinum Shield","Flesh to Stone","Forbiddance","Freezing Sphere","Globe of Invulnerability","Gravity Fissure","Guards and Wards","Harm","Heal","Heroes' Feast","Instant Summons","Investiture of Flame","Investiture of Ice","Investiture of Stone","Investiture of Wind","Magic Jar","Mass Suggestion","Mental Prison","Move Earth","Otiluke's Freezing Sphere","Otto's Irresistible Dance","Planar Ally","Primordial Ward","Programmed Illusion","Scatter","Soul Cage","Summon Fiend","Sunbeam","Tasha's Otherworldly Guise","Tenser's Transformation","Transport via Plants","True Seeing","Wall of Ice","Wall of Thorns","Wind Walk","Word of Recall"],7:["Conjure Celestial","Create Magen","Crown of Stars","Delayed Blast Fireball","Divine Word","Draconic Transformation","Dream of the Blue Veil","Etherealness","Finger of Death","Fire Storm","Forcecage","Magnificent Mansion","Mirage Arcane","Mordenkainen's Magnificent Mansion","Mordenkainen's Sword","Plane Shift","Power Word Pain","Prismatic Spray","Project Image","Regenerate","Resurrection","Reverse Gravity","Sequester","Simulacrum","Symbol","Teleport","Temple of the Gods","Tether Essence","Whirlwind"],8:["Abi-Dalzim's Horrid Wilting","Animal Shapes","Antimagic Field","Antipathy/Sympathy","Clone","Control Weather","Dark Star","Demiplane","Dominate Monster","Earthquake","Feeblemind","Glibness","Holy Aura","Illusory Dragon","Incendiary Cloud","Maddening Darkness","Maze","Mighty Fortress","Mind Blank","Power Word Stun","Reality Break","Sunburst","Telepathy","Tsunami"],9:["Astral Projection","Blade of Disaster","Foresight","Gate","Imprisonment","Invulnerability","Mass Heal","Mass Polymorph","Meteor Swarm","Power Word Heal","Power Word Kill","Prismatic Wall","Psychic Scream","Ravenous Void","Shapechange","Storm of Vengeance","Time Ravage","Time Stop","True Polymorph","True Resurrection","Weird","Wish"]};let gn=[];for(let n in gi)gn=gn.concat(gi[n]);gn.sort();var k={},yn={},we={},Go=$e&&$e.__extends||function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var r in s)s.hasOwnProperty(r)&&(i[r]=s[r])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),yi=$e&&$e.__spreadArrays||function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),s=0,e=0;e<t;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,s++)i[s]=r[o];return i};Object.defineProperty(we,"__esModule",{value:!0});we.DetailContext=we.NoopContext=we.VError=void 0;var ks=function(n){Go(e,n);function e(t,i){var s=n.call(this,i)||this;return s.path=t,Object.setPrototypeOf(s,e.prototype),s}return e}(Error);we.VError=ks;var Yo=function(){function n(){this._failed=!1}return n.prototype.fail=function(e,t,i){return this._failed=!0,!1},n.prototype.fork=function(){return this},n.prototype.completeFork=function(){return!this._failed},n.prototype.failed=function(){return this._failed},n.prototype.unionResolver=function(){return this},n.prototype.createContext=function(){return this._failed=!1,this},n.prototype.resolveUnion=function(e){},n}();we.NoopContext=Yo;var Ts=function(){function n(){this._propNames=[],this._messages=[],this._failedForks=[],this._currentFork=null,this._score=0}return n.prototype.fail=function(e,t,i){return this._propNames.push(e),this._messages.push(t),this._score+=i,!1},n.prototype.unionResolver=function(){return new zo},n.prototype.resolveUnion=function(e){for(var t,i,s,r=e,o=null,a=0,l=r.contexts;a<l.length;a++){var f=l[a];(!o||f._score>=o._score)&&(o=f)}o&&o._score>0&&((t=this._propNames).push.apply(t,o._propNames),(i=this._messages).push.apply(i,o._messages),(s=this._failedForks).push.apply(s,o._failedForks))},n.prototype.getError=function(e){var t=bn(this.getErrorDetails(e).map(Os)).join(`
`);return new ks(e,t)},n.prototype.getErrorDetails=function(e){for(var t=null,i,s=[],r=this._propNames.length-1;r>=0;r--){var o=this._propNames[r];e+=typeof o=="number"?"["+o+"]":o?"."+o:"";var a=this._messages[r];a&&(i={path:e,message:a},t?t.nested=[i]:s.push(i),t=i)}var l=bn(this._failedForks.map(function(f){return f.getErrorDetails(e)}));return t?l.length&&(t.nested=l):s=l,s},n.prototype.fork=function(){return this._currentFork==null&&(this._currentFork=new n),this._currentFork},n.prototype.completeFork=function(){var e=this._currentFork;return e._failed()&&(this._failedForks.push(e),this._currentFork=null,this._failedForks.length===1&&(this._score=e._score)),this._failedForks.length<n.maxForks},n.prototype.failed=function(){return this._failed()},n.prototype._failed=function(){return this._propNames.length+this._failedForks.length>0},n.maxForks=3,n}();we.DetailContext=Ts;var zo=function(){function n(){this.contexts=[]}return n.prototype.createContext=function(){var e=new Ts;return this.contexts.push(e),e},n}(),Os=function(n){var e=n.path+" "+n.message,t=n.nested||[],i=bn(t.map(Os));if(t.length==1){var s=i[0],r=i.slice(1);return yi([e+"; "+s],r)}else return yi([e],i.map(function(o){return"    "+o}))};function bn(n){var e;return(e=[]).concat.apply(e,n)}(function(n){var e=$e&&$e.__extends||function(){var y=function(b,S){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,E){N.__proto__=E}||function(N,E){for(var $ in E)E.hasOwnProperty($)&&(N[$]=E[$])},y(b,S)};return function(b,S){y(b,S);function N(){this.constructor=b}b.prototype=S===null?Object.create(S):(N.prototype=S.prototype,new N)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.basicTypes=n.BasicType=n.TParamList=n.TParam=n.param=n.TFunc=n.func=n.TProp=n.TOptional=n.opt=n.TIface=n.iface=n.indexKey=n.TEnumLiteral=n.enumlit=n.TEnumType=n.enumtype=n.TIntersection=n.intersection=n.TUnion=n.union=n.TTuple=n.tuple=n.RestType=n.rest=n.TArray=n.array=n.TLiteral=n.lit=n.TName=n.name=n.TType=void 0;var t=we,i=function(){function y(){}return y}();n.TType=i;function s(y){return typeof y=="string"?o(y):y}function r(y,b){var S=y[b];if(!S)throw new Error("Unknown type "+b);return S}function o(y){return new a(y)}n.name=o;var a=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.name=S,N._failMsg="is not a "+S,N}return b.prototype.getChecker=function(S,N,E){var $=this._checkerBeingBuilt;if(!$){this._checkerBeingBuilt=function(P,D){return $(P,D)};try{$=this._getChecker(S,N,E)}finally{this._checkerBeingBuilt=void 0}}return $},b.prototype._getChecker=function(S,N,E){var $=this,P=r(S,this.name),D=P.getChecker(S,N,E);return P instanceof Z||P instanceof b?D:function(j,F){return D(j,F)?!0:F.fail(null,$._failMsg,0)}},b}(i);n.TName=a;function l(y){return new f(y)}n.lit=l;var f=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.value=S,N.name=JSON.stringify(S),N._failMsg="is not "+N.name,N}return b.prototype.getChecker=function(S,N){var E=this;return function($,P){return $===E.value?!0:P.fail(null,E._failMsg,-1)}},b}(i);n.TLiteral=f;function h(y){return new c(s(y))}n.array=h;var c=function(y){e(b,y);function b(S){var N=y.call(this)||this;N.ttype=S;var E=Un(S);return E&&(N.name=E+"[]"),N}return b.prototype.getChecker=function(S,N){var E=this.ttype.getChecker(S,N);return function($,P){if(!Array.isArray($))return P.fail(null,"is not an array",0);for(var D=0;D<$.length;D++){var j=E($[D],P);if(!j)return P.fail(D,null,1)}return!0}},b}(i);n.TArray=c;function d(y){return new g(y)}n.rest=d;var g=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.typeSpec=S,N}return b.prototype.setStart=function(S){this._start=S},b.prototype.getChecker=function(S,N){var E=typeof this.typeSpec=="string"?r(S,this.typeSpec):this.typeSpec;if(!(E instanceof c))throw new Error("Rest type must be an array");var $=E.ttype.getChecker(S,N),P=this._start;return function(D,j){for(var F=P;F<D.length;F++)if(!$(D[F],j))return j.fail(F,null,1);return!0}},b}(i);n.RestType=g;function O(){for(var y=[],b=0;b<arguments.length;b++)y[b]=arguments[b];return new p(y.map(function(S){return s(S)}))}n.tuple=O;var p=function(y){e(b,y);function b(S){var N=y.call(this)||this;N.ttypes=S;var E=S[S.length-1];return E instanceof g&&(S.pop(),N._restType=E,N._restType.setStart(S.length)),N}return b.prototype.getChecker=function(S,N){var E=this.ttypes.map(function(D){return D.getChecker(S,N)}),$=function(D,j){if(!Array.isArray(D))return j.fail(null,"is not an array",0);for(var F=0;F<E.length;F++){var Q=E[F](D[F],j);if(!Q)return j.fail(F,null,1)}return!0};if(this._restType){var P=this._restType.getChecker(S,N);return function(D,j){return $(D,j)&&P(D,j)}}return N?function(D,j){return $(D,j)?D.length<=E.length?!0:j.fail(E.length,"is extraneous",2):!1}:$},b}(i);n.TTuple=p;function m(){for(var y=[],b=0;b<arguments.length;b++)y[b]=arguments[b];return new I(y.map(function(S){return s(S)}))}n.union=m;var I=function(y){e(b,y);function b(S){var N=y.call(this)||this;N.ttypes=S;var E=S.map(Un).filter(function(P){return P}),$=S.length-E.length;return E.length?($>0&&E.push($+" more"),N._failMsg="is none of "+E.join(", ")):N._failMsg="is none of "+$+" types",N}return b.prototype.getChecker=function(S,N,E){var $=this,P=this.ttypes.map(function(D){return D.getChecker(S,N,E)});return function(D,j){for(var F=j.unionResolver(),Q=0;Q<P.length;Q++){var de=P[Q](D,F.createContext());if(de)return!0}return j.resolveUnion(F),j.fail(null,$._failMsg,0)}},b}(i);n.TUnion=I;function T(){for(var y=[],b=0;b<arguments.length;b++)y[b]=arguments[b];return new B(y.map(function(S){return s(S)}))}n.intersection=T;var B=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.ttypes=S,N}return b.prototype.getChecker=function(S,N,E){E===void 0&&(E=new Set);var $=this.ttypes.map(function(P){return P.getChecker(S,N,E)});return function(P,D){return $.every(function(j){return j(P,D.fork()),D.completeFork()})&&!D.failed()}},b}(i);n.TIntersection=B;function w(y){return new v(y)}n.enumtype=w;var v=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.members=S,N.validValues=new Set,N._failMsg="is not a valid enum value",N.validValues=new Set(Object.keys(S).map(function(E){return S[E]})),N}return b.prototype.getChecker=function(S,N){var E=this;return function($,P){return E.validValues.has($)?!0:P.fail(null,E._failMsg,0)}},b}(i);n.TEnumType=v;function A(y,b){return new U(y,b)}n.enumlit=A;var U=function(y){e(b,y);function b(S,N){var E=y.call(this)||this;return E.enumName=S,E.prop=N,E._failMsg="is not "+S+"."+N,E}return b.prototype.getChecker=function(S,N){var E=this,$=r(S,this.enumName);if(!($ instanceof v))throw new Error("Type "+this.enumName+" used in enumlit is not an enum type");var P=$.members[this.prop];if(!$.members.hasOwnProperty(this.prop))throw new Error("Unknown value "+this.enumName+"."+this.prop+" used in enumlit");return function(D,j){return D===P?!0:j.fail(null,E._failMsg,-1)}},b}(i);n.TEnumLiteral=U;function R(y){return Object.keys(y).filter(function(b){return b!==n.indexKey}).map(function(b){return L(b,y[b])})}function L(y,b){return b instanceof ye?new X(y,b.ttype,!0):new X(y,s(b),!1)}n.indexKey=Symbol();function V(y,b){return new x(y,R(b),b[n.indexKey])}n.iface=V;var x=function(y){e(b,y);function b(S,N,E){var $=y.call(this)||this;return $.bases=S,$.props=N,$.indexType=E?s(E):void 0,$.propSet=new Set(N.map(function(P){return P.name})),$}return b.prototype.getChecker=function(S,N,E){var $=this,P;E===void 0&&(E=new Set),this.propSet.forEach(function(z){return E.add(z)});var D=this.bases.map(function(z){return r(S,z).getChecker(S,N,E)}),j=this.props.map(function(z){return z.ttype.getChecker(S,N)}),F=(P=this.indexType)===null||P===void 0?void 0:P.getChecker(S,N),Q=new t.NoopContext,de=this.props.map(function(z,ee){return!z.isOpt&&!j[ee](void 0,Q)});return function(z,ee){if(typeof z!="object"||z===null)return ee.fail(null,"is not an object",0);for(var Se=0;Se<D.length;Se++)if(D[Se](z,ee.fork()),!ee.completeFork())return!1;for(var Se=0;Se<j.length;Se++){var Xt=$.props[Se].name,Vn=z[Xt];if(Vn===void 0){if(de[Se]&&(ee.fork().fail(Xt,"is missing",1),!ee.completeFork()))return!1}else{var rt=ee.fork(),vs=j[Se](Vn,rt);if(vs||rt.fail(Xt,null,1),!ee.completeFork())return!1}}if(F)for(var ot in z){var rt=ee.fork();if(F(z[ot],rt)||rt.fail(ot,null,1),!ee.completeFork())return!1}else if(N){for(var ot in z)if(!E.has(ot)&&(ee.fork().fail(ot,"is extraneous",2),!ee.completeFork()))return!1}return!ee.failed()}},b}(i);n.TIface=x;function H(y){return new ye(s(y))}n.opt=H;var ye=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.ttype=S,N}return b.prototype.getChecker=function(S,N){var E=this.ttype.getChecker(S,N);return function($,P){return $===void 0||E($,P)}},b}(i);n.TOptional=ye;var X=function(){function y(b,S,N){this.name=b,this.ttype=S,this.isOpt=N}return y}();n.TProp=X;function Es(y){for(var b=[],S=1;S<arguments.length;S++)b[S-1]=arguments[S];return new xn(new Rn(b),s(y))}n.func=Es;var xn=function(y){e(b,y);function b(S,N){var E=y.call(this)||this;return E.paramList=S,E.result=N,E}return b.prototype.getChecker=function(S,N){return function(E,$){return typeof E=="function"?!0:$.fail(null,"is not a function",0)}},b}(i);n.TFunc=xn;function As(y,b,S){return new Dn(y,s(b),!!S)}n.param=As;var Dn=function(){function y(b,S,N){this.name=b,this.ttype=S,this.isOpt=N}return y}();n.TParam=Dn;var Rn=function(y){e(b,y);function b(S){var N=y.call(this)||this;return N.params=S,N}return b.prototype.getChecker=function(S,N){var E=this,$=this.params.map(function(F){return F.ttype.getChecker(S,N)}),P=new t.NoopContext,D=this.params.map(function(F,Q){return!F.isOpt&&!$[Q](void 0,P)}),j=function(F,Q){if(!Array.isArray(F))return Q.fail(null,"is not an array",0);for(var de=0;de<$.length;de++){var z=E.params[de];if(F[de]===void 0){if(D[de])return Q.fail(z.name,"is missing",1)}else{var ee=$[de](F[de],Q);if(!ee)return Q.fail(z.name,null,1)}}return!0};return N?function(F,Q){return j(F,Q)?F.length<=$.length?!0:Q.fail($.length,"is extraneous",2):!1}:j},b}(i);n.TParamList=Rn;var Z=function(y){e(b,y);function b(S,N){var E=y.call(this)||this;return E.validator=S,E.message=N,E}return b.prototype.getChecker=function(S,N){var E=this;return function($,P){return E.validator($)?!0:P.fail(null,E.message,0)}},b}(i);n.BasicType=Z,n.basicTypes={any:new Z(function(y){return!0},"is invalid"),unknown:new Z(function(y){return!0},"is invalid"),number:new Z(function(y){return typeof y=="number"},"is not a number"),object:new Z(function(y){return typeof y=="object"&&y},"is not an object"),boolean:new Z(function(y){return typeof y=="boolean"},"is not a boolean"),string:new Z(function(y){return typeof y=="string"},"is not a string"),symbol:new Z(function(y){return typeof y=="symbol"},"is not a symbol"),void:new Z(function(y){return y==null},"is not void"),undefined:new Z(function(y){return y===void 0},"is not undefined"),null:new Z(function(y){return y===null},"is not null"),never:new Z(function(y){return!1},"is unexpected"),Date:new Z(jn("[object Date]"),"is not a Date"),RegExp:new Z(jn("[object RegExp]"),"is not a RegExp")};var Is=Object.prototype.toString;function jn(y){return function(b){return typeof b=="object"&&b&&Is.call(b)===y}}typeof Buffer<"u"&&(n.basicTypes.Buffer=new Z(function(y){return Buffer.isBuffer(y)},"is not a Buffer"));for(var Bs=function(y){n.basicTypes[y.name]=new Z(function(b){return b instanceof y},"is not a "+y.name)},zt=0,Fn=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,ArrayBuffer];zt<Fn.length;zt++){var $s=Fn[zt];Bs($s)}function Un(y){if(y instanceof a||y instanceof f||y instanceof c)return y.name}})(yn);(function(n){var e=$e&&$e.__spreadArrays||function(){for(var l=0,f=0,h=arguments.length;f<h;f++)l+=arguments[f].length;for(var c=Array(l),d=0,f=0;f<h;f++)for(var g=arguments[f],O=0,p=g.length;O<p;O++,d++)c[d]=g[O];return c};Object.defineProperty(n,"__esModule",{value:!0}),n.Checker=n.createCheckers=void 0;var t=yn,i=we,s=yn;Object.defineProperty(n,"TArray",{enumerable:!0,get:function(){return s.TArray}}),Object.defineProperty(n,"TEnumType",{enumerable:!0,get:function(){return s.TEnumType}}),Object.defineProperty(n,"TEnumLiteral",{enumerable:!0,get:function(){return s.TEnumLiteral}}),Object.defineProperty(n,"TFunc",{enumerable:!0,get:function(){return s.TFunc}}),Object.defineProperty(n,"TIface",{enumerable:!0,get:function(){return s.TIface}}),Object.defineProperty(n,"TLiteral",{enumerable:!0,get:function(){return s.TLiteral}}),Object.defineProperty(n,"TName",{enumerable:!0,get:function(){return s.TName}}),Object.defineProperty(n,"TOptional",{enumerable:!0,get:function(){return s.TOptional}}),Object.defineProperty(n,"TParam",{enumerable:!0,get:function(){return s.TParam}}),Object.defineProperty(n,"TParamList",{enumerable:!0,get:function(){return s.TParamList}}),Object.defineProperty(n,"TProp",{enumerable:!0,get:function(){return s.TProp}}),Object.defineProperty(n,"TTuple",{enumerable:!0,get:function(){return s.TTuple}}),Object.defineProperty(n,"TType",{enumerable:!0,get:function(){return s.TType}}),Object.defineProperty(n,"TUnion",{enumerable:!0,get:function(){return s.TUnion}}),Object.defineProperty(n,"TIntersection",{enumerable:!0,get:function(){return s.TIntersection}}),Object.defineProperty(n,"array",{enumerable:!0,get:function(){return s.array}}),Object.defineProperty(n,"enumlit",{enumerable:!0,get:function(){return s.enumlit}}),Object.defineProperty(n,"enumtype",{enumerable:!0,get:function(){return s.enumtype}}),Object.defineProperty(n,"func",{enumerable:!0,get:function(){return s.func}}),Object.defineProperty(n,"iface",{enumerable:!0,get:function(){return s.iface}}),Object.defineProperty(n,"lit",{enumerable:!0,get:function(){return s.lit}}),Object.defineProperty(n,"name",{enumerable:!0,get:function(){return s.name}}),Object.defineProperty(n,"opt",{enumerable:!0,get:function(){return s.opt}}),Object.defineProperty(n,"param",{enumerable:!0,get:function(){return s.param}}),Object.defineProperty(n,"tuple",{enumerable:!0,get:function(){return s.tuple}}),Object.defineProperty(n,"union",{enumerable:!0,get:function(){return s.union}}),Object.defineProperty(n,"intersection",{enumerable:!0,get:function(){return s.intersection}}),Object.defineProperty(n,"rest",{enumerable:!0,get:function(){return s.rest}}),Object.defineProperty(n,"indexKey",{enumerable:!0,get:function(){return s.indexKey}}),Object.defineProperty(n,"BasicType",{enumerable:!0,get:function(){return s.BasicType}});var r=we;Object.defineProperty(n,"VError",{enumerable:!0,get:function(){return r.VError}});function o(){for(var l=[],f=0;f<arguments.length;f++)l[f]=arguments[f];for(var h=Object.assign.apply(Object,e([{},t.basicTypes],l)),c={},d=0,g=l;d<g.length;d++)for(var O=g[d],p=0,m=Object.keys(O);p<m.length;p++){var I=m[p];c[I]=new a(h,O[I])}return c}n.createCheckers=o;var a=function(){function l(f,h,c){if(c===void 0&&(c="value"),this.suite=f,this.ttype=h,this._path=c,this.props=new Map,h instanceof t.TIface)for(var d=0,g=h.props;d<g.length;d++){var O=g[d];this.props.set(O.name,O.ttype)}this.checkerPlain=this.ttype.getChecker(f,!1),this.checkerStrict=this.ttype.getChecker(f,!0)}return l.prototype.setReportedPath=function(f){this._path=f},l.prototype.check=function(f){return this._doCheck(this.checkerPlain,f)},l.prototype.test=function(f){return this.checkerPlain(f,new i.NoopContext)},l.prototype.validate=function(f){return this._doValidate(this.checkerPlain,f)},l.prototype.strictCheck=function(f){return this._doCheck(this.checkerStrict,f)},l.prototype.strictTest=function(f){return this.checkerStrict(f,new i.NoopContext)},l.prototype.strictValidate=function(f){return this._doValidate(this.checkerStrict,f)},l.prototype.getProp=function(f){var h=this.props.get(f);if(!h)throw new Error("Type has no property "+f);return new l(this.suite,h,this._path+"."+f)},l.prototype.methodArgs=function(f){var h=this._getMethod(f);return new l(this.suite,h.paramList)},l.prototype.methodResult=function(f){var h=this._getMethod(f);return new l(this.suite,h.result)},l.prototype.getArgs=function(){if(!(this.ttype instanceof t.TFunc))throw new Error("getArgs() applied to non-function");return new l(this.suite,this.ttype.paramList)},l.prototype.getResult=function(){if(!(this.ttype instanceof t.TFunc))throw new Error("getResult() applied to non-function");return new l(this.suite,this.ttype.result)},l.prototype.getType=function(){return this.ttype},l.prototype._doCheck=function(f,h){var c=new i.NoopContext;if(!f(h,c)){var d=new i.DetailContext;throw f(h,d),d.getError(this._path)}},l.prototype._doValidate=function(f,h){var c=new i.NoopContext;if(f(h,c))return null;var d=new i.DetailContext;return f(h,d),d.getErrorDetails(this._path)},l.prototype._getMethod=function(f){var h=this.props.get(f);if(!h)throw new Error("Type has no property "+f);if(!(h instanceof t.TFunc))throw new Error("Property "+f+" is not a method");return h},l}();n.Checker=a})(k);k.iface([],{search:"string",page:"number",mode:k.union(k.lit("popular"),k.lit("recent")),tags:k.array("string")});k.union(k.lit("str"),k.lit("dex"),k.lit("con"),k.lit("int"),k.lit("cha"),k.lit("wis"));k.iface([],{description:"Description",core:"Core",abilities:"Abilities",defenses:"Defenses",features:"Features",spellcasting:"SpellCasting",misc:"Misc"});k.iface([],{legActionsPerRound:"number",telepathy:"number",passivePerceptionOverride:k.union("number","null"),featureHeaderTexts:"FeatureHeaderTexts"});k.iface([],{features:"string",actions:"string",bonus:"string",reactions:"string",legendary:"string",lair:"string",mythic:"string",regional:"string"});k.iface([],{name:"string",isProperNoun:"boolean",description:"string",image:"string",faction:"string",environment:"string",alignment:"string",cr:"number",xp:"number"});k.iface([],{proficiencyBonus:"number",race:"string",size:"string",speed:k.array("SpeedEntity"),senses:k.array("SenseEntity"),languages:k.union(k.array("string"),"null")});k.iface([],{walk:"number",fly:"number",isHover:"boolean",burrow:"number",swim:"number",climb:"number"});k.union(k.lit("ft"),k.lit("m"),k.lit("km"),k.lit("mi"),k.lit("none"));k.iface([],{name:"string",value:"number",unit:"Unit",comment:"string"});k.iface([],{name:"string",value:"number",unit:"Unit",comment:"string"});k.iface([],{stats:"Stats",saves:"Saves",skills:k.array("SkillsEntity")});k.iface([],{str:"number",dex:"number",con:"number",int:"number",cha:"number",wis:"number"});k.iface([],{str:"SaveEntity",dex:"SaveEntity",con:"SaveEntity",int:"SaveEntity",cha:"SaveEntity",wis:"SaveEntity"});k.iface([],{isProficient:"boolean",override:k.union("number","null")});k.iface([],{skillName:"string",isHalfProficient:"boolean",isProficient:"boolean",isExpertise:"boolean",override:k.union("number","null")});k.iface([],{hp:"Hp",ac:"Ac",vulnerabilities:k.array("string"),resistances:k.array("string"),immunities:k.array("string"),conditionImmunities:k.array("string")});k.iface([],{numOfHitDie:"number",sizeOfHitDie:"number",override:k.union("number","null")});k.iface([],{ac:"number",acSource:"string"});k.iface([],{features:k.array("FeatureEntity"),actions:k.array("FeatureEntity"),bonus:k.array("FeatureEntity"),reactions:k.array("FeatureEntity"),legendary:k.array("FeatureEntity"),mythic:k.array("FeatureEntity"),lair:k.array("FeatureEntity"),regional:k.array("FeatureEntity")});k.iface([],{name:"string",description:"string",automation:k.union("null","object",k.array("object"))});k.iface([],{innateSpells:"InnateSpells",casterSpells:"CasterSpells"});k.iface([],{spellList:"InnateSpellsList",spellDcOverride:k.union("null","number"),spellBonusOverride:k.union("null","number"),spellCastingAbility:k.union("Stat","null"),noComponentsOfType:k.array("string"),isPsionics:"boolean",displayAsAction:"boolean"});k.iface([],{casterLevel:k.union("number","null"),castingClass:k.union(k.lit("Wizard"),k.lit("Druid"),k.lit("Cleric"),k.lit("Bard"),k.lit("Sorcerer"),k.lit("Paladin"),k.lit("Ranger"),k.lit("Artificer"),k.lit("Warlock"),"null"),spellList:k.array(k.array("string")),spellSlotList:k.union("SpellSlotEntity","undefined"),spellDcOverride:k.union("null","number"),spellBonusOverride:k.union("null","number"),spellCastingAbility:k.union("Stat","null"),spellCastingAbilityOverride:k.union("Stat","null"),displayAsAction:"boolean"});k.iface([],{[k.indexKey]:k.array("InnateSpellsEntity")});k.iface([],{spell:"string",comment:"string"});k.iface([],{[k.indexKey]:"number"});const Xo=_s({props:{title:{type:String,required:!0},id:{type:Number,required:!1},takesCustomTextInput:{type:Boolean,required:!1,default:!1}},data(){return{elId:""}},mounted(){this.id?this.elId=this.title.toLowerCase().replaceAll(" ","")+this.id:this.elId=this.title.toLowerCase().replaceAll(" ","")}}),Zo={class:"container"},Qo=["for"],ea={key:0};function ta(n,e,t,i,s,r){const o=Ms("tooltip");return Hn(),Kn("div",Zo,[Ps("label",{class:"editor-field__title",for:n.elId},[qn(xs(n.title),1),n.takesCustomTextInput?Ds((Hn(),Kn("span",ea,[qn("*")])),[[o,"Supports custom text input"]]):Rs("",!0)],8,Qo),js(n.$slots,"default",{},void 0,!0)])}const ua=Ls(Xo,[["render",ta],["__scopeId","data-v-14f42cf2"]]);function ha(n,e){let t=[],i=[];for(let s of n??[]){let r=Bt(s.name);if(s.description&&r.toLowerCase().includes("spellcasting"))continue;let o=na(s.entries||s.description.replaceAll("<i>","*").replaceAll("<b>","**").replaceAll("</i>","*").replaceAll("</b>","**")),[a,l]=oa(o,r,e);l&&i.push(l),t.push({name:r,description:o.replace(/<avrae hidden>.*?<\/avrae>/gis,""),automation:a})}return[t,i]}function na(n){if(typeof n=="string")return n;let e=[];for(let t of n)if(typeof t=="string"&&e.push(Bt(t)),typeof t=="object"&&t.type=="list")for(let i of t.items)e.push(`<br><b class="indent">${Bt(i.name)}</b> ${Bt(i.entry||i?.entries.join(`
`))}`);return e.join(`
`)}function Bt(n){return n=n.replaceAll("{@atk mw}","*Melee Weapon Attack:*").replaceAll("{@atk rw}","*Ranged Weapon Attack:*").replaceAll("{@atk mw,rw}","*Melee or Ranged Weapon Attack:*").replaceAll("{@atk ms}","*Melee Spell Attack:*").replaceAll("{@atk rs}","*Ranged Spell Attack:*").replaceAll("{@atk ms,rs}","*Melee or Ranged Spell Attack:*").replaceAll("{@h}","*Hit:* ").replace(/\{@damage\s+([^}]+)\}/g,"$1").replace(/\{@dc\s+([^}]+)\}/g,"DC $1").replace(/\{@dice\s+([^}]+)\}/g,"$1").replace(/\{@spell\s+([^}]+)\}/g,"$1").replace(/\{@item\s+([^}]+)\}/g,"$1").replace(/\{@condition\s+([^}]+)\}/g,"<u>$1</u>").replace(/\{@recharge\s+(\d+)\}/g,"(Recharge $1-6)").replace(/\{@quickref\s+[a-z\s]+[|]+[0-9]+\}/,"$1".replace(/(^|\s)\S/g,function(e){return e.toUpperCase()})).replace("Recharge 6-6","Recharge 6").replace("{@recharge}","(Recharge 6)").replace(/\{@hit\s+(-?\d+)\}/g,(e,t)=>t>=0?`+${t}`:t).replaceAll("<u>","*").replaceAll("</u>","*"),n}const ia=new RegExp("<avrae hidden>(?:(?<simple>(.*?)\\|([+-]?\\d*)\\|(.*?))|(?<freeform>.*?))</avrae>","gsi"),sa=new RegExp(/[+-]?\d+ \((.+?)\) (\w+) damage/,"i"),ra=new RegExp(/(?:\*)?(?:\w+ ){1,4}Attack:(?:\*)? (?<attackBonus>[+-]?\d+) to hit, .*?(?:\*)?Hit:(?:\*)? [+-]?(?:\d+ \((?<damageDiceBase>.+?)\)|(?<damageIntBase>\d+)) (?<damageTypeBase>[aA-zZ ]+) damage[., ]??(?: in melee[.,]?? or [+-]?(?:\d+ \((?<damageRangedDice>.+?)\)|(?<damageRangedInt>\d+)) (?<damageTypeRanged>[aA-zZ ]+) damage at range[,.]?)?(?:,? or [+-]?(?:\d+ \((?<damageDiceVers>.+?)\)|(?<damageIntVers>\d+)) (?<damageTypeVers>[aA-zZ ]+) damage if used with two hands(?: to make a melee attack)?)?(?:,? (?:plus|and) [+-]?(?:\d+ \((?<damageBonusDice>.+?)\)|(?<damageBonusInt>\d+)) (?<damageTypeBonus>[aA-zZ ]+) damage)?/,"i");function oa(n,e="",t){t<1&&(t=1);const i=Array.from(n.matchAll(ia),o=>o.groups?.freeform),s=n.match(ra),r=n.match(sa);if(i.length>0)for(let o of i)try{return[Yr.parse(o??""),null]}catch{return[null,`${e}: Attempted to parse into Avrae Automation but an error occured.`]}else if(s?.groups){let o=[];const a=s.groups,l=a.attackBonus.replace("+","");let f="";if(a.damageTypeBonus&&(a.damageBonusInt||a.damageBonusDice)&&(f=` + ${a.damageBonusInt??a.damageBonusDice} [${a.damageTypeBonus}]`),a.damageTypeVers&&(a.damageIntVers||a.damageDiceVers)){let c=`${a.damageIntVers??a.damageDiceVers} [${a.damageTypeVers}]`+f;o.push({name:`2-Handed ${e}`,automation:[{type:"target",target:"each",effects:[{type:"attack",hit:[{type:"damage",damage:c,overheal:!1}],miss:[],attackBonus:l}]},{type:"text",text:n,title:"Effect"}],_v:2,activation_type:t})}if(a.damageTypeRanged&&(a.damageRangedInt||a.damageRangedDice)){let c=`${a.damageRangedInt??a.damageRangedDice} [${a.damageTypeRanged}]`+f;o.push({name:`Ranged ${e}`,automation:[{type:"target",target:"each",effects:[{type:"attack",hit:[{type:"damage",damage:c,overheal:!1}],miss:[],attackBonus:l}]},{type:"text",text:n,title:"Effect"}],_v:2,activation_type:t})}let h=`${a.damageIntBase??a.damageDiceBase} [${a.damageTypeBase}]`+f;return o.push({name:e,automation:[{type:"target",target:"each",effects:[{type:"attack",hit:[{type:"damage",damage:h,overheal:!1}],miss:[],attackBonus:l}]},{type:"text",text:n,title:"Effect"}],_v:2,activation_type:t}),o?o.length==1?[o[0],null]:[o,null]:[null,`${e}: Attempted to parse into Avrae Automation but an error occured.`]}else if(r)return n.includes(" DC ")?[null,`${e}: Cannot generate automation for save-based attacks.`]:[{name:e,automation:[{type:"target",target:"each",effects:[{type:"damage",damage:r[1]+`[${r[2]}]`,overheal:!1}]},{type:"text",text:n,title:"Effect"}],_v:2,activation_type:t},null];return[null,`${e}: Did not Generate Avrae Automation.`]}function da(n){return n.charAt(0).toUpperCase()+n.slice(1)}export{ua as L,Yr as Y,ha as a,ca as b,da as c,la as d,gi as e,Gr as f,fa as g,oa as p,gn as s};
