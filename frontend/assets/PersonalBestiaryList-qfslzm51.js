import{d as h,b as k,e as g,f as p,g as f,h as $,i as D,o as n,j as m,k as y,w as l,l as x,m as a,c as M,n as N,t as S,p as F,F as P}from"./index-BnguSVmB.js";import{_ as T}from"./Modal.vue_vue_type_style_index_0_lang-By_BwBhp.js";import{B as V}from"./BestiaryList-D9cBQSWA.js";import{t as r,_ as L}from"./Breadcrumbs.vue_vue_type_style_index_0_lang-D1kcEJMB.js";import{$ as b}from"./loading-CBYs1_jt.js";import"./StatusIcon-COz_s1qn.js";const j={class:"content"},z={key:1,class:"zero-found"},H=h({__name:"PersonalBestiaryList",setup(A){const w=k();g(async()=>{const t=b.show();await c(),t.hide()});const i=p([]),c=async()=>{const{success:t,data:e,error:s}=await f("/api/my-bestiaries");t?i.value=e:(i.value=[],r.error(s))},v=async()=>{const{success:t,data:e,error:s}=await f("/api/bestiary/add","POST",{name:"New bestiary",description:"",status:"private",creatures:[]});t?(r.success("Created bestiary"),await w.push(`/bestiary-viewer/${e._id?.toString()}`)):r.error(s),await c()},_=async t=>{if(!t)return;const e=b.show(),{success:s,error:d}=await f(`/api/bestiary/${t._id?.toString()}/delete`);s?(r.success("Deleted bestiary succesfully"),o.value=!1):r.error(d),e.hide(),await c()},o=p(!1),u=p(null),C=t=>{u.value=t,o.value=!0};return(t,e)=>{const s=$("font-awesome-icon"),d=D("tooltip");return n(),m(P,null,[y(L,{routes:[{path:"",text:"My Bestiaries",isCurrent:!0}]},{default:l(()=>[x((n(),m("button",{class:"inverted","aria-label":"Create bestiary",onClick:v},[y(s,{icon:["fas","plus"]})])),[[d,"Create bestiary!"]])]),_:1}),a("div",j,[i.value?(n(),M(V,{key:0,personal:!0,bestiaries:i.value,onDeleteBestiary:C},null,8,["bestiaries"])):(n(),m("div",z,[e[3]||(e[3]=a("span",null," You do not have any bestiaries. ",-1)),a("button",{class:"btn confirm",onClick:v}," Create a bestiary ")]))]),y(T,{show:o.value,onClose:e[2]||(e[2]=B=>o.value=!1)},{header:l(()=>[N(" Are you sure you want to delete "+S(u.value?.name),1)]),body:l(()=>e[4]||(e[4]=[a("p",{class:"modal-desc"}," Please confirm you want to permanently delete this bestiary. This action is not reversible. ",-1)])),footer:l(()=>[a("button",{class:"btn",onClick:e[0]||(e[0]=B=>o.value=!1)}," Cancel "),a("button",{class:"btn danger",onClick:e[1]||(e[1]=F(()=>_(u.value),["prevent"]))}," Confirm ")]),_:1},8,["show"])],64)}}});export{H as default};
